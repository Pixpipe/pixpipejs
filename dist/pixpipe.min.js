// Build date: 2018-0319T16:15:25

/*
* Author   Jonathan Lurie - http://me.jonathanlurie.fr
* License  MIT
* Link     https://github.com/Pixpipe/pixpipejs
* Lab      MCIN - Montreal Neurological Institute
*/
/*
 Chen, Yi-Cyuan 2014-2017
 @license MIT
 @source http://purl.eligrey.com/github/FileSaver.js/blob/master/FileSaver.js  Determine if an object is a Buffer

 @author   Feross Aboukhadijeh <feross@feross.org> <http://feross.org>
 @license  MIT
 Based on ndef.parser, by Raphael Graf(r@undefined.ch)
       http://www.undefined.ch/mparser/index.html

       Ported to JavaScript and modified by Matthew Crumley (email@matthewcrumley.com, http://silentmatt.com/)

       You are free to use and modify this code in anyway you find useful. Please leave this comment in the code
       to acknowledge its original source. If you feel like it, I enjoy hearing about projects that use my code,
       but don't feel like you have to let me know or ask permission.
 Copyright (C) 2010-2013 Raymond Hill: https://github.com/gorhill/Javascript-Voronoi
          MIT License: See https://github.com/gorhill/Javascript-Voronoi/LICENSE.md
*/
'use strict';var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.defineProperty="function"==typeof Object.defineProperties?Object.defineProperty:function(q,D,B){if(B.get||B.set)throw new TypeError("ES3 does not support getters and setters.");q!=Array.prototype&&q!=Object.prototype&&(q[D]=B.value)};$jscomp.getGlobal=function(q){return"undefined"!=typeof window&&window===q?q:"undefined"!=typeof global&&null!=global?global:q};$jscomp.global=$jscomp.getGlobal(this);$jscomp.SYMBOL_PREFIX="jscomp_symbol_";
$jscomp.initSymbol=function(){$jscomp.initSymbol=function(){};$jscomp.global.Symbol||($jscomp.global.Symbol=$jscomp.Symbol)};$jscomp.symbolCounter_=0;$jscomp.Symbol=function(q){return $jscomp.SYMBOL_PREFIX+(q||"")+$jscomp.symbolCounter_++};
$jscomp.initSymbolIterator=function(){$jscomp.initSymbol();var q=$jscomp.global.Symbol.iterator;q||(q=$jscomp.global.Symbol.iterator=$jscomp.global.Symbol("iterator"));"function"!=typeof Array.prototype[q]&&$jscomp.defineProperty(Array.prototype,q,{configurable:!0,writable:!0,value:function(){return $jscomp.arrayIterator(this)}});$jscomp.initSymbolIterator=function(){}};$jscomp.arrayIterator=function(q){var D=0;return $jscomp.iteratorPrototype(function(){return D<q.length?{done:!1,value:q[D++]}:{done:!0}})};
$jscomp.iteratorPrototype=function(q){$jscomp.initSymbolIterator();q={next:q};q[$jscomp.global.Symbol.iterator]=function(){return this};return q};$jscomp.polyfill=function(q,D,B,H){if(D){B=$jscomp.global;q=q.split(".");for(H=0;H<q.length-1;H++){var R=q[H];R in B||(B[R]={});B=B[R]}q=q[q.length-1];H=B[q];D=D(H);D!=H&&null!=D&&$jscomp.defineProperty(B,q,{configurable:!0,writable:!0,value:D})}};
$jscomp.polyfill("Array.from",function(q){return q?q:function(q,B,H){$jscomp.initSymbolIterator();B=null!=B?B:function(q){return q};var D=[],S=q[Symbol.iterator];if("function"==typeof S)for(q=S.call(q);!(S=q.next()).done;)D.push(B.call(H,S.value));else for(var S=q.length,ga=0;ga<S;ga++)D.push(B.call(H,q[ga]));return D}},"es6-impl","es3");$jscomp.owns=function(q,D){return Object.prototype.hasOwnProperty.call(q,D)};
$jscomp.polyfill("Object.assign",function(q){return q?q:function(q,B){for(var D=1;D<arguments.length;D++){var R=arguments[D];if(R)for(var S in R)$jscomp.owns(R,S)&&(q[S]=R[S])}return q}},"es6-impl","es3");$jscomp.iteratorFromArray=function(q,D){$jscomp.initSymbolIterator();q instanceof String&&(q+="");var B=0,H={next:function(){if(B<q.length){var R=B++;return{value:D(R,q[R]),done:!1}}H.next=function(){return{done:!0,value:void 0}};return H.next()}};H[Symbol.iterator]=function(){return H};return H};
$jscomp.polyfill("Array.prototype.keys",function(q){return q?q:function(){return $jscomp.iteratorFromArray(this,function(q){return q})}},"es6-impl","es3");$jscomp.makeIterator=function(q){$jscomp.initSymbolIterator();var D=q[Symbol.iterator];return D?D.call(q):$jscomp.arrayIterator(q)};
$jscomp.polyfill("WeakMap",function(q){function D(q){$jscomp.owns(q,H)||$jscomp.defineProperty(q,H,{value:{}})}function B(q){var B=Object[q];B&&(Object[q]=function(q){D(q);return B(q)})}if(function(){if(!q||!Object.seal)return!1;try{var D=Object.seal({}),B=Object.seal({}),H=new q([[D,2],[B,3]]);if(2!=H.get(D)||3!=H.get(B))return!1;H.delete(D);H.set(B,4);return!H.has(D)&&4==H.get(B)}catch(od){return!1}}())return q;var H="$jscomp_hidden_"+Math.random().toString().substring(2);B("freeze");B("preventExtensions");
B("seal");var R=0,S=function(q){this.id_=(R+=Math.random()+1).toString();if(q){$jscomp.initSymbol();$jscomp.initSymbolIterator();q=$jscomp.makeIterator(q);for(var D;!(D=q.next()).done;)D=D.value,this.set(D[0],D[1])}};S.prototype.set=function(q,B){D(q);if(!$jscomp.owns(q,H))throw Error("WeakMap key fail: "+q);q[H][this.id_]=B;return this};S.prototype.get=function(q){return $jscomp.owns(q,H)?q[H][this.id_]:void 0};S.prototype.has=function(q){return $jscomp.owns(q,H)&&$jscomp.owns(q[H],this.id_)};S.prototype.delete=
function(q){return $jscomp.owns(q,H)&&$jscomp.owns(q[H],this.id_)?delete q[H][this.id_]:!1};return S},"es6-impl","es3");$jscomp.MapEntry=function(){};$jscomp.ASSUME_NO_NATIVE_MAP=!1;
$jscomp.polyfill("Map",function(q){if(!$jscomp.ASSUME_NO_NATIVE_MAP&&function(){if(!q||!q.prototype.entries||"function"!=typeof Object.seal)return!1;try{var D=Object.seal({x:4}),B=new q($jscomp.makeIterator([[D,"s"]]));if("s"!=B.get(D)||1!=B.size||B.get({x:4})||B.set({x:4},"t")!=B||2!=B.size)return!1;var H=B.entries(),R=H.next();if(R.done||R.value[0]!=D||"s"!=R.value[1])return!1;R=H.next();return R.done||4!=R.value[0].x||"t"!=R.value[1]||!H.next().done?!1:!0}catch(pe){return!1}}())return q;$jscomp.initSymbol();
$jscomp.initSymbolIterator();var D=new WeakMap,B=function(q){this.data_={};this.head_=S();this.size=0;if(q){q=$jscomp.makeIterator(q);for(var D;!(D=q.next()).done;)D=D.value,this.set(D[0],D[1])}};B.prototype.set=function(q,D){var B=H(this,q);B.list||(B.list=this.data_[B.id]=[]);B.entry?B.entry.value=D:(B.entry={next:this.head_,previous:this.head_.previous,head:this.head_,key:q,value:D},B.list.push(B.entry),this.head_.previous.next=B.entry,this.head_.previous=B.entry,this.size++);return this};B.prototype.delete=
function(q){q=H(this,q);return q.entry&&q.list?(q.list.splice(q.index,1),q.list.length||delete this.data_[q.id],q.entry.previous.next=q.entry.next,q.entry.next.previous=q.entry.previous,q.entry.head=null,this.size--,!0):!1};B.prototype.clear=function(){this.data_={};this.head_=this.head_.previous=S();this.size=0};B.prototype.has=function(q){return!!H(this,q).entry};B.prototype.get=function(q){return(q=H(this,q).entry)&&q.value};B.prototype.entries=function(){return R(this,function(q){return[q.key,
q.value]})};B.prototype.keys=function(){return R(this,function(q){return q.key})};B.prototype.values=function(){return R(this,function(q){return q.value})};B.prototype.forEach=function(q,D){for(var B=this.entries(),H;!(H=B.next()).done;)H=H.value,q.call(D,H[1],H[0],this)};B.prototype[Symbol.iterator]=B.prototype.entries;var H=function(q,B){var H;H=B&&typeof B;"object"==H||"function"==H?D.has(B)?H=D.get(B):(H=""+ ++ga,D.set(B,H)):H="p_"+B;var R=q.data_[H];if(R&&$jscomp.owns(q.data_,H))for(q=0;q<R.length;q++){var S=
R[q];if(B!==B&&S.key!==S.key||B===S.key)return{id:H,list:R,index:q,entry:S}}return{id:H,list:R,index:-1,entry:void 0}},R=function(q,D){var B=q.head_;return $jscomp.iteratorPrototype(function(){if(B){for(;B.head!=q.head_;)B=B.previous;for(;B.next!=B.head;)return B=B.next,{done:!1,value:D(B)};B=null}return{done:!0,value:void 0}})},S=function(){var q={};return q.previous=q.next=q.head=q},ga=0;return B},"es6-impl","es3");$jscomp.ASSUME_NO_NATIVE_SET=!1;
$jscomp.polyfill("Set",function(q){if(!$jscomp.ASSUME_NO_NATIVE_SET&&function(){if(!q||!q.prototype.entries||"function"!=typeof Object.seal)return!1;try{var D=Object.seal({x:4}),H=new q($jscomp.makeIterator([D]));if(!H.has(D)||1!=H.size||H.add(D)!=H||1!=H.size||H.add({x:4})!=H||2!=H.size)return!1;var R=H.entries(),S=R.next();if(S.done||S.value[0]!=D||S.value[1]!=D)return!1;S=R.next();return S.done||S.value[0]==D||4!=S.value[0].x||S.value[1]!=S.value[0]?!1:R.next().done}catch(ga){return!1}}())return q;
$jscomp.initSymbol();$jscomp.initSymbolIterator();var D=function(q){this.map_=new Map;if(q){q=$jscomp.makeIterator(q);for(var D;!(D=q.next()).done;)this.add(D.value)}this.size=this.map_.size};D.prototype.add=function(q){this.map_.set(q,q);this.size=this.map_.size;return this};D.prototype.delete=function(q){q=this.map_.delete(q);this.size=this.map_.size;return q};D.prototype.clear=function(){this.map_.clear();this.size=0};D.prototype.has=function(q){return this.map_.has(q)};D.prototype.entries=function(){return this.map_.entries()};
D.prototype.values=function(){return this.map_.values()};D.prototype.keys=D.prototype.values;D.prototype[Symbol.iterator]=D.prototype.values;D.prototype.forEach=function(q,D){var B=this;this.map_.forEach(function(H){return q.call(D,H,H,B)})};return D},"es6-impl","es3");$jscomp.polyfill("Number.MAX_SAFE_INTEGER",function(){return 9007199254740991},"es6-impl","es3");
$jscomp.polyfill("Number.isFinite",function(q){return q?q:function(q){return"number"!==typeof q?!1:!isNaN(q)&&Infinity!==q&&-Infinity!==q}},"es6-impl","es3");$jscomp.polyfill("Number.isInteger",function(q){return q?q:function(q){return Number.isFinite(q)?q===Math.floor(q):!1}},"es6-impl","es3");$jscomp.polyfill("Number.isSafeInteger",function(q){return q?q:function(q){return Number.isInteger(q)&&Math.abs(q)<=Number.MAX_SAFE_INTEGER}},"es6-impl","es3");
$jscomp.polyfill("Array.prototype.values",function(q){return q?q:function(){return $jscomp.iteratorFromArray(this,function(q,B){return B})}},"es6","es3");$jscomp.polyfill("Number.isNaN",function(q){return q?q:function(q){return"number"===typeof q&&isNaN(q)}},"es6-impl","es3");$jscomp.findInternal=function(q,D,B){q instanceof String&&(q=String(q));for(var H=q.length,R=0;R<H;R++){var S=q[R];if(D.call(B,S,R,q))return{i:R,v:S}}return{i:-1,v:void 0}};
$jscomp.polyfill("Array.prototype.find",function(q){return q?q:function(q,B){return $jscomp.findInternal(this,q,B).v}},"es6-impl","es3");$jscomp.polyfill("Array.prototype.entries",function(q){return q?q:function(){return $jscomp.iteratorFromArray(this,function(q,B){return[q,B]})}},"es6-impl","es3");
$jscomp.polyfill("Array.prototype.fill",function(q){return q?q:function(q,B,H){var D=this.length||0;0>B&&(B=Math.max(0,D+B));if(null==H||H>D)H=D;H=Number(H);0>H&&(H=Math.max(0,D+H));for(B=Number(B||0);B<H;B++)this[B]=q;return this}},"es6-impl","es3");$jscomp.polyfill("Math.log2",function(q){return q?q:function(q){return Math.log(q)/Math.LN2}},"es6-impl","es3");$jscomp.polyfill("Math.sign",function(q){return q?q:function(q){q=Number(q);return 0===q||isNaN(q)?q:0<q?1:-1}},"es6-impl","es3");
$jscomp.polyfill("Math.sinh",function(q){if(q)return q;var D=Math.exp;return function(q){q=Number(q);return 0===q?q:(D(q)-D(-q))/2}},"es6-impl","es3");$jscomp.polyfill("Math.cosh",function(q){if(q)return q;var D=Math.exp;return function(q){q=Number(q);return(D(q)+D(-q))/2}},"es6-impl","es3");$jscomp.polyfill("Math.tanh",function(q){return q?q:function(q){q=Number(q);if(0===q)return q;var D=Math.exp(-2*Math.abs(q)),D=(1-D)/(1+D);return 0>q?-D:D}},"es6-impl","es3");
$jscomp.polyfill("Math.asinh",function(q){return q?q:function(q){q=Number(q);if(0===q)return q;var D=Math.log(Math.abs(q)+Math.sqrt(q*q+1));return 0>q?-D:D}},"es6-impl","es3");$jscomp.polyfill("Math.acosh",function(q){return q?q:function(q){q=Number(q);return Math.log(q+Math.sqrt(q*q-1))}},"es6-impl","es3");
$jscomp.polyfill("Math.log1p",function(q){return q?q:function(q){q=Number(q);if(.25>q&&-.25<q){for(var D=q,H=1,R=q,S=0,ga=1;S!=R;)D*=q,ga*=-1,R=(S=R)+ga*D/++H;return R}return Math.log(1+q)}},"es6-impl","es3");$jscomp.polyfill("Math.atanh",function(q){if(q)return q;var D=Math.log1p;return function(q){q=Number(q);return(D(q)-D(-q))/2}},"es6-impl","es3");$jscomp.polyfill("Math.log10",function(q){return q?q:function(q){return Math.log(q)/Math.LN10}},"es6-impl","es3");
$jscomp.polyfill("Math.trunc",function(q){return q?q:function(q){q=Number(q);if(isNaN(q)||Infinity===q||-Infinity===q||0===q)return q;var D=Math.floor(Math.abs(q));return 0>q?-D:D}},"es6-impl","es3");
$jscomp.polyfill("Math.hypot",function(q){return q?q:function(q,B,H){q=Number(q);B=Number(B);var D,S,ga,Ea=Math.max(Math.abs(q),Math.abs(B));for(D=2;D<arguments.length;D++)Ea=Math.max(Ea,Math.abs(arguments[D]));if(1E100<Ea||1E-100>Ea){q/=Ea;B/=Ea;ga=q*q+B*B;for(D=2;D<arguments.length;D++)S=Number(arguments[D])/Ea,ga+=S*S;return Math.sqrt(ga)*Ea}ga=q*q+B*B;for(D=2;D<arguments.length;D++)S=Number(arguments[D]),ga+=S*S;return Math.sqrt(ga)}},"es6-impl","es3");
$jscomp.polyfill("Array.prototype.findIndex",function(q){return q?q:function(q,B){return $jscomp.findInternal(this,q,B).i}},"es6-impl","es3");
(function(q,D){"object"===typeof exports&&"undefined"!==typeof module?D(exports):"function"===typeof define&&define.amd?define(["exports"],D):D(q.pixpipe={})})(this,function(q){function D(){var h=new La(9);h[0]=1;h[1]=0;h[2]=0;h[3]=0;h[4]=1;h[5]=0;h[6]=0;h[7]=0;h[8]=1;return h}function B(){var h=new La(16);h[0]=1;h[1]=0;h[2]=0;h[3]=0;h[4]=0;h[5]=1;h[6]=0;h[7]=0;h[8]=0;h[9]=0;h[10]=1;h[11]=0;h[12]=0;h[13]=0;h[14]=0;h[15]=1;return h}function H(h,c,b,a,d,g,e,f,k,l,m,n,r,u,p,t){var y=new La(16);y[0]=
h;y[1]=c;y[2]=b;y[3]=a;y[4]=d;y[5]=g;y[6]=e;y[7]=f;y[8]=k;y[9]=l;y[10]=m;y[11]=n;y[12]=r;y[13]=u;y[14]=p;y[15]=t;return y}function R(h,c){var b=c[0],a=c[1],d=c[2],g=c[3],e=c[4],f=c[5],k=c[6],l=c[7],m=c[8],n=c[9],r=c[10],u=c[11],p=c[12],t=c[13],y=c[14];c=c[15];var w=b*f-a*e,x=b*k-d*e,v=b*l-g*e,A=a*k-d*f,F=a*l-g*f,C=d*l-g*k,q=m*t-n*p,G=m*y-r*p,K=m*c-u*p,M=n*y-r*t,aa=n*c-u*t,J=r*c-u*y,E=w*J-x*aa+v*M+A*K-F*G+C*q;if(!E)return null;E=1/E;h[0]=(f*J-k*aa+l*M)*E;h[1]=(d*aa-a*J-g*M)*E;h[2]=(t*C-y*F+c*A)*E;
h[3]=(r*F-n*C-u*A)*E;h[4]=(k*K-e*J-l*G)*E;h[5]=(b*J-d*K+g*G)*E;h[6]=(y*v-p*C-c*x)*E;h[7]=(m*C-r*v+u*x)*E;h[8]=(e*aa-f*K+l*q)*E;h[9]=(a*K-b*aa-g*q)*E;h[10]=(p*F-t*v+c*w)*E;h[11]=(n*v-m*F-u*w)*E;h[12]=(f*G-e*M-k*q)*E;h[13]=(b*M-a*G+d*q)*E;h[14]=(t*x-p*A-y*w)*E;h[15]=(m*A-n*x+r*w)*E;return h}function S(){var h=new La(3);h[0]=0;h[1]=0;h[2]=0;return h}function ga(h,c,b){var a=new La(3);a[0]=h;a[1]=c;a[2]=b;return a}function Ea(h,c,b){var a=c[0],d=c[1];c=c[2];var g=b[0],e=b[1];b=b[2];h[0]=d*b-c*e;h[1]=
c*g-a*b;h[2]=a*e-d*g;return h}function oe(){var h=new La(4);h[0]=0;h[1]=0;h[2]=0;h[3]=0;return h}function od(){var h=new La(4);h[0]=0;h[1]=0;h[2]=0;h[3]=1;return h}function pd(h,c,b,a){var d=c[0],g=c[1],e=c[2];c=c[3];var f=b[0],k=b[1],l=b[2];b=b[3];var m,n,r;n=d*f+g*k+e*l+c*b;0>n&&(n=-n,f=-f,k=-k,l=-l,b=-b);1E-6<1-n?(m=Math.acos(n),r=Math.sin(m),n=Math.sin((1-a)*m)/r,a=Math.sin(a*m)/r):n=1-a;h[0]=n*d+a*f;h[1]=n*g+a*k;h[2]=n*e+a*l;h[3]=n*c+a*b;return h}function pe(){var h=new La(2);h[0]=0;h[1]=0;return h}
function db(){throw Error("Dynamic requires are not currently supported by rollup-plugin-commonjs");}function ma(h,c){return c={exports:{}},h(c,c.exports),c.exports}function qe(){throw Error("setTimeout has not been defined");}function re(){throw Error("clearTimeout has not been defined");}function se(h){if(eb===setTimeout)return setTimeout(h,0);if((eb===qe||!eb)&&setTimeout)return eb=setTimeout,setTimeout(h,0);try{return eb(h,0)}catch(c){try{return eb.call(null,h,0)}catch(b){return eb.call(this,
h,0)}}}function Jh(h){if(fb===clearTimeout)return clearTimeout(h);if((fb===re||!fb)&&clearTimeout)return fb=clearTimeout,clearTimeout(h);try{return fb(h)}catch(c){try{return fb.call(null,h)}catch(b){return fb.call(this,h)}}}function Kh(){Kb&&sb&&(Kb=!1,sb.length?Va=sb.concat(Va):Mc=-1,Va.length&&te())}function te(){if(!Kb){var h=se(Kh);Kb=!0;for(var c=Va.length;c;){sb=Va;for(Va=[];++Mc<c;)sb&&sb[Mc].run();Mc=-1;c=Va.length}sb=null;Kb=!1;Jh(h)}}function ue(h,c){this.fun=h;this.array=c}function tb(){}
function ve(){qd=!0;for(var h=0;64>h;++h)Ma[h]="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"[h],Fa["ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charCodeAt(h)]=h;Fa[45]=62;Fa[95]=63}function Lh(h,c,b){for(var a=[],d=c;d<b;d+=3)c=(h[d]<<16)+(h[d+1]<<8)+h[d+2],a.push(Ma[c>>18&63]+Ma[c>>12&63]+Ma[c>>6&63]+Ma[c&63]);return a.join("")}function we(h){qd||ve();for(var c=h.length,b=c%3,a="",d=[],g=0,e=c-b;g<e;g+=16383)d.push(Lh(h,g,g+16383>e?e:g+16383));1===b?(h=
h[c-1],a+=Ma[h>>2],a+=Ma[h<<4&63],a+="=="):2===b&&(h=(h[c-2]<<8)+h[c-1],a+=Ma[h>>10],a+=Ma[h>>4&63],a+=Ma[h<<2&63],a+="=");d.push(a);return d.join("")}function Nc(h,c,b,a,d){var g;g=8*d-a-1;var e=(1<<g)-1,f=e>>1,k=-7;d=b?d-1:0;var l=b?-1:1,m=h[c+d];d+=l;b=m&(1<<-k)-1;m>>=-k;for(k+=g;0<k;b=256*b+h[c+d],d+=l,k-=8);g=b&(1<<-k)-1;b>>=-k;for(k+=a;0<k;g=256*g+h[c+d],d+=l,k-=8);if(0===b)b=1-f;else{if(b===e)return g?NaN:Infinity*(m?-1:1);g+=Math.pow(2,a);b-=f}return(m?-1:1)*g*Math.pow(2,b-a)}function xe(h,
c,b,a,d,g){var e,f=8*g-d-1,k=(1<<f)-1,l=k>>1,m=23===d?Math.pow(2,-24)-Math.pow(2,-77):0;g=a?0:g-1;var n=a?1:-1,r=0>c||0===c&&0>1/c?1:0;c=Math.abs(c);isNaN(c)||Infinity===c?(c=isNaN(c)?1:0,a=k):(a=Math.floor(Math.log(c)/Math.LN2),1>c*(e=Math.pow(2,-a))&&(a--,e*=2),c=1<=a+l?c+m/e:c+m*Math.pow(2,1-l),2<=c*e&&(a++,e/=2),a+l>=k?(c=0,a=k):1<=a+l?(c=(c*e-1)*Math.pow(2,d),a+=l):(c=c*Math.pow(2,l-1)*Math.pow(2,d),a=0));for(;8<=d;h[b+g]=c&255,g+=n,c/=256,d-=8);a=a<<d|c;for(f+=d;0<f;h[b+g]=a&255,g+=n,a/=256,
f-=8);h[b+g-n]|=128*r}function Wa(h,c){if((z.TYPED_ARRAY_SUPPORT?2147483647:1073741823)<c)throw new RangeError("Invalid typed array length");z.TYPED_ARRAY_SUPPORT?(h=new Uint8Array(c),h.__proto__=z.prototype):(null===h&&(h=new z(c)),h.length=c);return h}function z(h,c,b){if(!(z.TYPED_ARRAY_SUPPORT||this instanceof z))return new z(h,c,b);if("number"===typeof h){if("string"===typeof c)throw Error("If encoding is specified then the first argument must be a string");return rd(this,h)}return ye(this,h,
c,b)}function ye(h,c,b,a){if("number"===typeof c)throw new TypeError('"value" argument must not be a number');if("undefined"!==typeof ArrayBuffer&&c instanceof ArrayBuffer){c.byteLength;if(0>b||c.byteLength<b)throw new RangeError("'offset' is out of bounds");if(c.byteLength<b+(a||0))throw new RangeError("'length' is out of bounds");c=void 0===b&&void 0===a?new Uint8Array(c):void 0===a?new Uint8Array(c,b):new Uint8Array(c,b,a);z.TYPED_ARRAY_SUPPORT?(h=c,h.__proto__=z.prototype):h=sd(h,c);return h}if("string"===
typeof c){a=h;h=b;if("string"!==typeof h||""===h)h="utf8";if(!z.isEncoding(h))throw new TypeError('"encoding" must be a valid string encoding');b=ze(c,h)|0;a=Wa(a,b);c=a.write(c,h);c!==b&&(a=a.slice(0,c));return a}return Mh(h,c)}function Ae(h){if("number"!==typeof h)throw new TypeError('"size" argument must be a number');if(0>h)throw new RangeError('"size" argument must not be negative');}function rd(h,c){Ae(c);h=Wa(h,0>c?0:td(c)|0);if(!z.TYPED_ARRAY_SUPPORT)for(var b=0;b<c;++b)h[b]=0;return h}function sd(h,
c){var b=0>c.length?0:td(c.length)|0;h=Wa(h,b);for(var a=0;a<b;a+=1)h[a]=c[a]&255;return h}function Mh(h,c){if(Na(c)){var b=td(c.length)|0;h=Wa(h,b);if(0===h.length)return h;c.copy(h,0,0,b);return h}if(c){if("undefined"!==typeof ArrayBuffer&&c.buffer instanceof ArrayBuffer||"length"in c)return(b="number"!==typeof c.length)||(b=c.length,b=b!==b),b?Wa(h,0):sd(h,c);if("Buffer"===c.type&&Be(c.data))return sd(h,c.data)}throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.");
}function td(h){if(h>=(z.TYPED_ARRAY_SUPPORT?2147483647:1073741823))throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+(z.TYPED_ARRAY_SUPPORT?2147483647:1073741823).toString(16)+" bytes");return h|0}function Na(h){return!(null==h||!h._isBuffer)}function ze(h,c){if(Na(h))return h.length;if("undefined"!==typeof ArrayBuffer&&"function"===typeof ArrayBuffer.isView&&(ArrayBuffer.isView(h)||h instanceof ArrayBuffer))return h.byteLength;"string"!==typeof h&&(h=""+h);var b=h.length;
if(0===b)return 0;for(var a=!1;;)switch(c){case "ascii":case "latin1":case "binary":return b;case "utf8":case "utf-8":case void 0:return Oc(h).length;case "ucs2":case "ucs-2":case "utf16le":case "utf-16le":return 2*b;case "hex":return b>>>1;case "base64":return Ce(h).length;default:if(a)return Oc(h).length;c=(""+c).toLowerCase();a=!0}}function Nh(h,c,b){var a=!1;if(void 0===c||0>c)c=0;if(c>this.length)return"";if(void 0===b||b>this.length)b=this.length;if(0>=b)return"";b>>>=0;c>>>=0;if(b<=c)return"";
for(h||(h="utf8");;)switch(h){case "hex":h=c;c=b;b=this.length;if(!h||0>h)h=0;if(!c||0>c||c>b)c=b;a="";for(b=h;b<c;++b)h=a,a=this[b],a=16>a?"0"+a.toString(16):a.toString(16),a=h+a;return a;case "utf8":case "utf-8":return De(this,c,b);case "ascii":h="";for(b=Math.min(this.length,b);c<b;++c)h+=String.fromCharCode(this[c]&127);return h;case "latin1":case "binary":h="";for(b=Math.min(this.length,b);c<b;++c)h+=String.fromCharCode(this[c]);return h;case "base64":return c=0===c&&b===this.length?we(this):
we(this.slice(c,b)),c;case "ucs2":case "ucs-2":case "utf16le":case "utf-16le":c=this.slice(c,b);b="";for(h=0;h<c.length;h+=2)b+=String.fromCharCode(c[h]+256*c[h+1]);return b;default:if(a)throw new TypeError("Unknown encoding: "+h);h=(h+"").toLowerCase();a=!0}}function ub(h,c,b){var a=h[c];h[c]=h[b];h[b]=a}function Ee(h,c,b,a,d){if(0===h.length)return-1;"string"===typeof b?(a=b,b=0):2147483647<b?b=2147483647:-2147483648>b&&(b=-2147483648);b=+b;isNaN(b)&&(b=d?0:h.length-1);0>b&&(b=h.length+b);if(b>=
h.length){if(d)return-1;b=h.length-1}else if(0>b)if(d)b=0;else return-1;"string"===typeof c&&(c=z.from(c,a));if(Na(c))return 0===c.length?-1:Fe(h,c,b,a,d);if("number"===typeof c)return c&=255,z.TYPED_ARRAY_SUPPORT&&"function"===typeof Uint8Array.prototype.indexOf?d?Uint8Array.prototype.indexOf.call(h,c,b):Uint8Array.prototype.lastIndexOf.call(h,c,b):Fe(h,[c],b,a,d);throw new TypeError("val must be string, number or Buffer");}function Fe(h,c,b,a,d){function g(a,d){return 1===e?a[d]:a.readUInt16BE(d*
e)}var e=1,f=h.length,k=c.length;if(void 0!==a&&(a=String(a).toLowerCase(),"ucs2"===a||"ucs-2"===a||"utf16le"===a||"utf-16le"===a)){if(2>h.length||2>c.length)return-1;e=2;f/=2;k/=2;b/=2}if(d)for(a=-1;b<f;b++)if(g(h,b)===g(c,-1===a?0:b-a)){if(-1===a&&(a=b),b-a+1===k)return a*e}else-1!==a&&(b-=b-a),a=-1;else for(b+k>f&&(b=f-k);0<=b;b--){f=!0;for(a=0;a<k;a++)if(g(h,b+a)!==g(c,a)){f=!1;break}if(f)return b}return-1}function De(h,c,b){b=Math.min(h.length,b);for(var a=[];c<b;){var d=h[c],g=null,e=239<d?
4:223<d?3:191<d?2:1;if(c+e<=b){var f,k,l;switch(e){case 1:128>d&&(g=d);break;case 2:f=h[c+1];128===(f&192)&&(d=(d&31)<<6|f&63,127<d&&(g=d));break;case 3:f=h[c+1];k=h[c+2];128===(f&192)&&128===(k&192)&&(d=(d&15)<<12|(f&63)<<6|k&63,2047<d&&(55296>d||57343<d)&&(g=d));break;case 4:f=h[c+1],k=h[c+2],l=h[c+3],128===(f&192)&&128===(k&192)&&128===(l&192)&&(d=(d&15)<<18|(f&63)<<12|(k&63)<<6|l&63,65535<d&&1114112>d&&(g=d))}}null===g?(g=65533,e=1):65535<g&&(g-=65536,a.push(g>>>10&1023|55296),g=56320|g&1023);
a.push(g);c+=e}h=a.length;if(h<=Ge)a=String.fromCharCode.apply(String,a);else{b="";for(c=0;c<h;)b+=String.fromCharCode.apply(String,a.slice(c,c+=Ge));a=b}return a}function ia(h,c,b){if(0!==h%1||0>h)throw new RangeError("offset is not uint");if(h+c>b)throw new RangeError("Trying to access beyond buffer length");}function va(h,c,b,a,d,g){if(!Na(h))throw new TypeError('"buffer" argument must be a Buffer instance');if(c>d||c<g)throw new RangeError('"value" argument is out of bounds');if(b+a>h.length)throw new RangeError("Index out of range");
}function Pc(h,c,b,a){0>c&&(c=65535+c+1);for(var d=0,g=Math.min(h.length-b,2);d<g;++d)h[b+d]=(c&255<<8*(a?d:1-d))>>>8*(a?d:1-d)}function Qc(h,c,b,a){0>c&&(c=4294967295+c+1);for(var d=0,g=Math.min(h.length-b,4);d<g;++d)h[b+d]=c>>>8*(a?d:3-d)&255}function He(h,c,b,a,d,g){if(b+a>h.length)throw new RangeError("Index out of range");if(0>b)throw new RangeError("Index out of range");}function Ie(h,c,b,a,d){d||He(h,c,b,4,3.4028234663852886E38,-3.4028234663852886E38);xe(h,c,b,a,23,4);return b+4}function Je(h,
c,b,a,d){d||He(h,c,b,8,1.7976931348623157E308,-1.7976931348623157E308);xe(h,c,b,a,52,8);return b+8}function Oc(h,c){c=c||Infinity;for(var b,a=h.length,d=null,g=[],e=0;e<a;++e){b=h.charCodeAt(e);if(55295<b&&57344>b){if(!d){if(56319<b){-1<(c-=3)&&g.push(239,191,189);continue}else if(e+1===a){-1<(c-=3)&&g.push(239,191,189);continue}d=b;continue}if(56320>b){-1<(c-=3)&&g.push(239,191,189);d=b;continue}b=(d-55296<<10|b-56320)+65536}else d&&-1<(c-=3)&&g.push(239,191,189);d=null;if(128>b){if(0>--c)break;
g.push(b)}else if(2048>b){if(0>(c-=2))break;g.push(b>>6|192,b&63|128)}else if(65536>b){if(0>(c-=3))break;g.push(b>>12|224,b>>6&63|128,b&63|128)}else if(1114112>b){if(0>(c-=4))break;g.push(b>>18|240,b>>12&63|128,b>>6&63|128,b&63|128)}else throw Error("Invalid code point");}return g}function Ke(h){for(var c=[],b=0;b<h.length;++b)c.push(h.charCodeAt(b)&255);return c}function Ce(h){h=(h.trim?h.trim():h.replace(/^\s+|\s+$/g,"")).replace(Oh,"");if(2>h.length)h="";else for(;0!==h.length%4;)h+="=";qd||ve();
var c,b,a,d,g;c=h.length;if(0<c%4)throw Error("Invalid string. Length must be a multiple of 4");d="="===h[c-2]?2:"="===h[c-1]?1:0;g=new Ph(3*c/4-d);b=0<d?c-4:c;var e=0;for(c=0;c<b;c+=4)a=Fa[h.charCodeAt(c)]<<18|Fa[h.charCodeAt(c+1)]<<12|Fa[h.charCodeAt(c+2)]<<6|Fa[h.charCodeAt(c+3)],g[e++]=a>>16&255,g[e++]=a>>8&255,g[e++]=a&255;2===d?(a=Fa[h.charCodeAt(c)]<<2|Fa[h.charCodeAt(c+1)]>>4,g[e++]=a&255):1===d&&(a=Fa[h.charCodeAt(c)]<<10|Fa[h.charCodeAt(c+1)]<<4|Fa[h.charCodeAt(c+2)]>>2,g[e++]=a>>8&255,
g[e++]=a&255);return g}function ec(h,c,b,a){for(var d=0;d<a&&!(d+b>=c.length||d>=h.length);++d)c[d+b]=h[d];return d}function ud(h){return null!=h&&(!!h._isBuffer||Le(h)||"function"===typeof h.readFloatLE&&"function"===typeof h.slice&&Le(h.slice(0,0)))}function Le(h){return!!h.constructor&&"function"===typeof h.constructor.isBuffer&&h.constructor.isBuffer(h)}function Lb(h){for(var c=h.length;0<=--c;)h[c]=0}function vd(h,c,b,a,d){this.static_tree=h;this.extra_bits=c;this.extra_base=b;this.elems=a;this.max_length=
d;this.has_stree=h&&h.length}function wd(h,c){this.dyn_tree=h;this.max_code=0;this.stat_desc=c}function fc(h,c){h.pending_buf[h.pending++]=c&255;h.pending_buf[h.pending++]=c>>>8&255}function wa(h,c,b){h.bi_valid>16-b?(h.bi_buf|=c<<h.bi_valid&65535,fc(h,h.bi_buf),h.bi_buf=c>>16-h.bi_valid,h.bi_valid+=b-16):(h.bi_buf|=c<<h.bi_valid&65535,h.bi_valid+=b)}function Oa(h,c,b){wa(h,b[2*c],b[2*c+1])}function Me(h,c){var b=0;do b|=h&1,h>>>=1,b<<=1;while(0<--c);return b>>>1}function Ne(h,c,b){var a=Array(16),
d=0,g;for(g=1;15>=g;g++)a[g]=d=d+b[g-1]<<1;for(b=0;b<=c;b++)d=h[2*b+1],0!==d&&(h[2*b]=Me(a[d]++,d))}function Oe(h){var c;for(c=0;286>c;c++)h.dyn_ltree[2*c]=0;for(c=0;30>c;c++)h.dyn_dtree[2*c]=0;for(c=0;19>c;c++)h.bl_tree[2*c]=0;h.dyn_ltree[512]=1;h.opt_len=h.static_len=0;h.last_lit=h.matches=0}function Pe(h){8<h.bi_valid?fc(h,h.bi_buf):0<h.bi_valid&&(h.pending_buf[h.pending++]=h.bi_buf);h.bi_buf=0;h.bi_valid=0}function Qe(h,c,b,a){var d=2*c,g=2*b;return h[d]<h[g]||h[d]===h[g]&&a[c]<=a[b]}function xd(h,
c,b){for(var a=h.heap[b],d=b<<1;d<=h.heap_len;){d<h.heap_len&&Qe(c,h.heap[d+1],h.heap[d],h.depth)&&d++;if(Qe(c,a,h.heap[d],h.depth))break;h.heap[b]=h.heap[d];b=d;d<<=1}h.heap[b]=a}function Re(h,c,b){var a,d,g=0,e,f;if(0!==h.last_lit){do a=h.pending_buf[h.d_buf+2*g]<<8|h.pending_buf[h.d_buf+2*g+1],d=h.pending_buf[h.l_buf+g],g++,0===a?Oa(h,d,c):(e=gc[d],Oa(h,e+256+1,c),f=yd[e],0!==f&&(d-=zd[e],wa(h,d,f)),a--,e=256>a?vb[a]:vb[256+(a>>>7)],Oa(h,e,b),f=Rc[e],0!==f&&(a-=Sc[e],wa(h,a,f)));while(g<h.last_lit)
}Oa(h,256,c)}function Ad(h,c){var b=c.dyn_tree,a=c.stat_desc.static_tree,d=c.stat_desc.has_stree,g=c.stat_desc.elems,e,f=-1,k;h.heap_len=0;h.heap_max=573;for(e=0;e<g;e++)0!==b[2*e]?(h.heap[++h.heap_len]=f=e,h.depth[e]=0):b[2*e+1]=0;for(;2>h.heap_len;)k=h.heap[++h.heap_len]=2>f?++f:0,b[2*k]=1,h.depth[k]=0,h.opt_len--,d&&(h.static_len-=a[2*k+1]);c.max_code=f;for(e=h.heap_len>>1;1<=e;e--)xd(h,b,e);k=g;do e=h.heap[1],h.heap[1]=h.heap[h.heap_len--],xd(h,b,1),a=h.heap[1],h.heap[--h.heap_max]=e,h.heap[--h.heap_max]=
a,b[2*k]=b[2*e]+b[2*a],h.depth[k]=(h.depth[e]>=h.depth[a]?h.depth[e]:h.depth[a])+1,b[2*e+1]=b[2*a+1]=k,h.heap[1]=k++,xd(h,b,1);while(2<=h.heap_len);h.heap[--h.heap_max]=h.heap[1];e=c.dyn_tree;k=c.max_code;var a=c.stat_desc.static_tree,d=c.stat_desc.has_stree,g=c.stat_desc.extra_bits,l=c.stat_desc.extra_base,m=c.stat_desc.max_length,n,r,u,p,t=0;for(r=0;15>=r;r++)h.bl_count[r]=0;e[2*h.heap[h.heap_max]+1]=0;for(c=h.heap_max+1;573>c;c++)n=h.heap[c],r=e[2*e[2*n+1]+1]+1,r>m&&(r=m,t++),e[2*n+1]=r,n>k||(h.bl_count[r]++,
u=0,n>=l&&(u=g[n-l]),p=e[2*n],h.opt_len+=p*(r+u),d&&(h.static_len+=p*(a[2*n+1]+u)));if(0!==t){do{for(r=m-1;0===h.bl_count[r];)r--;h.bl_count[r]--;h.bl_count[r+1]+=2;h.bl_count[m]--;t-=2}while(0<t);for(r=m;0!==r;r--)for(n=h.bl_count[r];0!==n;)a=h.heap[--c],a>k||(e[2*a+1]!==r&&(h.opt_len+=(r-e[2*a+1])*e[2*a],e[2*a+1]=r),n--)}Ne(b,f,h.bl_count)}function Se(h,c,b){var a,d=-1,g,e=c[1],f=0,k=7,l=4;0===e&&(k=138,l=3);c[2*(b+1)+1]=65535;for(a=0;a<=b;a++)g=e,e=c[2*(a+1)+1],++f<k&&g===e||(f<l?h.bl_tree[2*g]+=
f:0!==g?(g!==d&&h.bl_tree[2*g]++,h.bl_tree[32]++):10>=f?h.bl_tree[34]++:h.bl_tree[36]++,f=0,d=g,0===e?(k=138,l=3):g===e?(k=6,l=3):(k=7,l=4))}function Te(h,c,b){var a,d=-1,g,e=c[1],f=0,k=7,l=4;0===e&&(k=138,l=3);for(a=0;a<=b;a++)if(g=e,e=c[2*(a+1)+1],!(++f<k&&g===e)){if(f<l){do Oa(h,g,h.bl_tree);while(0!==--f)}else 0!==g?(g!==d&&(Oa(h,g,h.bl_tree),f--),Oa(h,16,h.bl_tree),wa(h,f-3,2)):10>=f?(Oa(h,17,h.bl_tree),wa(h,f-3,3)):(Oa(h,18,h.bl_tree),wa(h,f-11,7));f=0;d=g;0===e?(k=138,l=3):g===e?(k=6,l=3):
(k=7,l=4)}}function Qh(h){var c=4093624447,b;for(b=0;31>=b;b++,c>>>=1)if(c&1&&0!==h.dyn_ltree[2*b])return 0;if(0!==h.dyn_ltree[18]||0!==h.dyn_ltree[20]||0!==h.dyn_ltree[26])return 1;for(b=32;256>b;b++)if(0!==h.dyn_ltree[2*b])return 1;return 0}function Ue(h,c,b,a){wa(h,0+(a?1:0),3);Pe(h);fc(h,b);fc(h,~b);U.arraySet(h.pending_buf,h.window,c,b,h.pending);h.pending+=b}function gb(h,c){h.msg=Mb[c];return c}function hb(h){for(var c=h.length;0<=--c;)h[c]=0}function ib(h){var c=h.state,b=c.pending;b>h.avail_out&&
(b=h.avail_out);0!==b&&(U.arraySet(h.output,c.pending_buf,c.pending_out,b,h.next_out),h.next_out+=b,c.pending_out+=b,h.total_out+=b,h.avail_out-=b,c.pending-=b,0===c.pending&&(c.pending_out=0))}function oa(h,c){Ga._tr_flush_block(h,0<=h.block_start?h.block_start:-1,h.strstart-h.block_start,c);h.block_start=h.strstart;ib(h.strm)}function ba(h,c){h.pending_buf[h.pending++]=c}function hc(h,c){h.pending_buf[h.pending++]=c>>>8&255;h.pending_buf[h.pending++]=c&255}function Ve(h,c){var b=h.max_chain_length,
a=h.strstart,d,g=h.prev_length,e=h.nice_match,f=h.strstart>h.w_size-262?h.strstart-(h.w_size-262):0,k=h.window,l=h.w_mask,m=h.prev,n=h.strstart+258,r=k[a+g-1],u=k[a+g];h.prev_length>=h.good_match&&(b>>=2);e>h.lookahead&&(e=h.lookahead);do if(d=c,k[d+g]===u&&k[d+g-1]===r&&k[d]===k[a]&&k[++d]===k[a+1]){a+=2;for(d++;k[++a]===k[++d]&&k[++a]===k[++d]&&k[++a]===k[++d]&&k[++a]===k[++d]&&k[++a]===k[++d]&&k[++a]===k[++d]&&k[++a]===k[++d]&&k[++a]===k[++d]&&a<n;);d=258-(n-a);a=n-258;if(d>g){h.match_start=c;
g=d;if(d>=e)break;r=k[a+g-1];u=k[a+g]}}while((c=m[c&l])>f&&0!==--b);return g<=h.lookahead?g:h.lookahead}function wb(h){var c=h.w_size,b,a,d,g;do{g=h.window_size-h.lookahead-h.strstart;if(h.strstart>=c+(c-262)){U.arraySet(h.window,h.window,c,c,0);h.match_start-=c;h.strstart-=c;h.block_start-=c;b=a=h.hash_size;do d=h.head[--b],h.head[b]=d>=c?d-c:0;while(--a);b=a=c;do d=h.prev[--b],h.prev[b]=d>=c?d-c:0;while(--a);g+=c}if(0===h.strm.avail_in)break;b=h.strm;a=h.window;d=h.strstart+h.lookahead;var e=b.avail_in;
e>g&&(e=g);0===e?a=0:(b.avail_in-=e,U.arraySet(a,b.input,b.next_in,e,d),1===b.state.wrap?b.adler=ic(b.adler,a,e,d):2===b.state.wrap&&(b.adler=na(b.adler,a,e,d)),b.next_in+=e,b.total_in+=e,a=e);h.lookahead+=a;if(3<=h.lookahead+h.insert)for(g=h.strstart-h.insert,h.ins_h=h.window[g],h.ins_h=(h.ins_h<<h.hash_shift^h.window[g+1])&h.hash_mask;h.insert&&!(h.ins_h=(h.ins_h<<h.hash_shift^h.window[g+3-1])&h.hash_mask,h.prev[g&h.w_mask]=h.head[h.ins_h],h.head[h.ins_h]=g,g++,h.insert--,3>h.lookahead+h.insert););
}while(262>h.lookahead&&0!==h.strm.avail_in)}function Bd(h,c){for(var b;;){if(262>h.lookahead){wb(h);if(262>h.lookahead&&0===c)return 1;if(0===h.lookahead)break}b=0;3<=h.lookahead&&(h.ins_h=(h.ins_h<<h.hash_shift^h.window[h.strstart+3-1])&h.hash_mask,b=h.prev[h.strstart&h.w_mask]=h.head[h.ins_h],h.head[h.ins_h]=h.strstart);0!==b&&h.strstart-b<=h.w_size-262&&(h.match_length=Ve(h,b));if(3<=h.match_length)if(b=Ga._tr_tally(h,h.strstart-h.match_start,h.match_length-3),h.lookahead-=h.match_length,h.match_length<=
h.max_lazy_match&&3<=h.lookahead){h.match_length--;do h.strstart++,h.ins_h=(h.ins_h<<h.hash_shift^h.window[h.strstart+3-1])&h.hash_mask,h.prev[h.strstart&h.w_mask]=h.head[h.ins_h],h.head[h.ins_h]=h.strstart;while(0!==--h.match_length);h.strstart++}else h.strstart+=h.match_length,h.match_length=0,h.ins_h=h.window[h.strstart],h.ins_h=(h.ins_h<<h.hash_shift^h.window[h.strstart+1])&h.hash_mask;else b=Ga._tr_tally(h,0,h.window[h.strstart]),h.lookahead--,h.strstart++;if(b&&(oa(h,!1),0===h.strm.avail_out))return 1}h.insert=
2>h.strstart?h.strstart:2;return 4===c?(oa(h,!0),0===h.strm.avail_out?3:4):h.last_lit&&(oa(h,!1),0===h.strm.avail_out)?1:2}function Nb(h,c){for(var b,a;;){if(262>h.lookahead){wb(h);if(262>h.lookahead&&0===c)return 1;if(0===h.lookahead)break}b=0;3<=h.lookahead&&(h.ins_h=(h.ins_h<<h.hash_shift^h.window[h.strstart+3-1])&h.hash_mask,b=h.prev[h.strstart&h.w_mask]=h.head[h.ins_h],h.head[h.ins_h]=h.strstart);h.prev_length=h.match_length;h.prev_match=h.match_start;h.match_length=2;0!==b&&h.prev_length<h.max_lazy_match&&
h.strstart-b<=h.w_size-262&&(h.match_length=Ve(h,b),5>=h.match_length&&(1===h.strategy||3===h.match_length&&4096<h.strstart-h.match_start)&&(h.match_length=2));if(3<=h.prev_length&&h.match_length<=h.prev_length){a=h.strstart+h.lookahead-3;b=Ga._tr_tally(h,h.strstart-1-h.prev_match,h.prev_length-3);h.lookahead-=h.prev_length-1;h.prev_length-=2;do++h.strstart<=a&&(h.ins_h=(h.ins_h<<h.hash_shift^h.window[h.strstart+3-1])&h.hash_mask,h.prev[h.strstart&h.w_mask]=h.head[h.ins_h],h.head[h.ins_h]=h.strstart);
while(0!==--h.prev_length);h.match_available=0;h.match_length=2;h.strstart++;if(b&&(oa(h,!1),0===h.strm.avail_out))return 1}else if(h.match_available){if((b=Ga._tr_tally(h,0,h.window[h.strstart-1]))&&oa(h,!1),h.strstart++,h.lookahead--,0===h.strm.avail_out)return 1}else h.match_available=1,h.strstart++,h.lookahead--}h.match_available&&(Ga._tr_tally(h,0,h.window[h.strstart-1]),h.match_available=0);h.insert=2>h.strstart?h.strstart:2;return 4===c?(oa(h,!0),0===h.strm.avail_out?3:4):h.last_lit&&(oa(h,
!1),0===h.strm.avail_out)?1:2}function Rh(h,c){for(var b,a,d,g=h.window;;){if(258>=h.lookahead){wb(h);if(258>=h.lookahead&&0===c)return 1;if(0===h.lookahead)break}h.match_length=0;if(3<=h.lookahead&&0<h.strstart&&(a=h.strstart-1,b=g[a],b===g[++a]&&b===g[++a]&&b===g[++a])){for(d=h.strstart+258;b===g[++a]&&b===g[++a]&&b===g[++a]&&b===g[++a]&&b===g[++a]&&b===g[++a]&&b===g[++a]&&b===g[++a]&&a<d;);h.match_length=258-(d-a);h.match_length>h.lookahead&&(h.match_length=h.lookahead)}3<=h.match_length?(b=Ga._tr_tally(h,
1,h.match_length-3),h.lookahead-=h.match_length,h.strstart+=h.match_length,h.match_length=0):(b=Ga._tr_tally(h,0,h.window[h.strstart]),h.lookahead--,h.strstart++);if(b&&(oa(h,!1),0===h.strm.avail_out))return 1}h.insert=0;return 4===c?(oa(h,!0),0===h.strm.avail_out?3:4):h.last_lit&&(oa(h,!1),0===h.strm.avail_out)?1:2}function Sh(h,c){for(var b;;){if(0===h.lookahead&&(wb(h),0===h.lookahead)){if(0===c)return 1;break}h.match_length=0;b=Ga._tr_tally(h,0,h.window[h.strstart]);h.lookahead--;h.strstart++;
if(b&&(oa(h,!1),0===h.strm.avail_out))return 1}h.insert=0;return 4===c?(oa(h,!0),0===h.strm.avail_out?3:4):h.last_lit&&(oa(h,!1),0===h.strm.avail_out)?1:2}function Pa(h,c,b,a,d){this.good_length=h;this.max_lazy=c;this.nice_length=b;this.max_chain=a;this.func=d}function Th(){this.strm=null;this.status=0;this.pending_buf=null;this.wrap=this.pending=this.pending_out=this.pending_buf_size=0;this.gzhead=null;this.gzindex=0;this.method=8;this.last_flush=-1;this.w_mask=this.w_bits=this.w_size=0;this.window=
null;this.window_size=0;this.head=this.prev=null;this.nice_match=this.good_match=this.strategy=this.level=this.max_lazy_match=this.max_chain_length=this.prev_length=this.lookahead=this.match_start=this.strstart=this.match_available=this.prev_match=this.match_length=this.block_start=this.hash_shift=this.hash_mask=this.hash_bits=this.hash_size=this.ins_h=0;this.dyn_ltree=new U.Buf16(1146);this.dyn_dtree=new U.Buf16(122);this.bl_tree=new U.Buf16(78);hb(this.dyn_ltree);hb(this.dyn_dtree);hb(this.bl_tree);
this.bl_desc=this.d_desc=this.l_desc=null;this.bl_count=new U.Buf16(16);this.heap=new U.Buf16(573);hb(this.heap);this.heap_max=this.heap_len=0;this.depth=new U.Buf16(573);hb(this.depth);this.bi_valid=this.bi_buf=this.insert=this.matches=this.static_len=this.opt_len=this.d_buf=this.last_lit=this.lit_bufsize=this.l_buf=0}function We(h){var c;if(!h||!h.state)return gb(h,-2);h.total_in=h.total_out=0;h.data_type=2;c=h.state;c.pending=0;c.pending_out=0;0>c.wrap&&(c.wrap=-c.wrap);c.status=c.wrap?42:113;
h.adler=2===c.wrap?0:1;c.last_flush=0;Ga._tr_init(c);return 0}function Xe(h){var c=We(h);0===c&&(h=h.state,h.window_size=2*h.w_size,hb(h.head),h.max_lazy_match=Ob[h.level].max_lazy,h.good_match=Ob[h.level].good_length,h.nice_match=Ob[h.level].nice_length,h.max_chain_length=Ob[h.level].max_chain,h.strstart=0,h.block_start=0,h.lookahead=0,h.insert=0,h.match_length=h.prev_length=2,h.match_available=0,h.ins_h=0);return c}function Ye(h,c,b,a,d,g){if(!h)return-2;var e=1;-1===c&&(c=6);0>a?(e=0,a=-a):15<
a&&(e=2,a-=16);if(1>d||9<d||8!==b||8>a||15<a||0>c||9<c||0>g||4<g)return gb(h,-2);8===a&&(a=9);var f=new Th;h.state=f;f.strm=h;f.wrap=e;f.gzhead=null;f.w_bits=a;f.w_size=1<<f.w_bits;f.w_mask=f.w_size-1;f.hash_bits=d+7;f.hash_size=1<<f.hash_bits;f.hash_mask=f.hash_size-1;f.hash_shift=~~((f.hash_bits+3-1)/3);f.window=new U.Buf8(2*f.w_size);f.head=new U.Buf16(f.hash_size);f.prev=new U.Buf16(f.w_size);f.lit_bufsize=1<<d+6;f.pending_buf_size=4*f.lit_bufsize;f.pending_buf=new U.Buf8(f.pending_buf_size);
f.d_buf=1*f.lit_bufsize;f.l_buf=3*f.lit_bufsize;f.level=c;f.strategy=g;f.method=b;return Xe(h)}function Ze(h,c){if(65537>c&&(h.subarray&&$e||!h.subarray&&af))return String.fromCharCode.apply(null,U.shrinkBuf(h,c));for(var b="",a=0;a<c;a++)b+=String.fromCharCode(h[a]);return b}function xb(h){if(!(this instanceof xb))return new xb(h);h=this.options=U.assign({level:-1,method:8,chunkSize:16384,windowBits:15,memLevel:8,strategy:0,to:""},h||{});h.raw&&0<h.windowBits?h.windowBits=-h.windowBits:h.gzip&&0<
h.windowBits&&16>h.windowBits&&(h.windowBits+=16);this.err=0;this.msg="";this.ended=!1;this.chunks=[];this.strm=new bf;this.strm.avail_out=0;var c=jc.deflateInit2(this.strm,h.level,h.method,h.windowBits,h.memLevel,h.strategy);if(0!==c)throw Error(Mb[c]);h.header&&jc.deflateSetHeader(this.strm,h.header);if(h.dictionary){h="string"===typeof h.dictionary?yb.string2buf(h.dictionary):"[object ArrayBuffer]"===cf.call(h.dictionary)?new Uint8Array(h.dictionary):h.dictionary;c=jc.deflateSetDictionary(this.strm,
h);if(0!==c)throw Error(Mb[c]);this._dict_set=!0}}function Cd(h,c){c=new xb(c);c.push(h,!0);if(c.err)throw c.msg||Mb[c.err];return c.result}function df(h){return(h>>>24&255)+(h>>>8&65280)+((h&65280)<<8)+((h&255)<<24)}function Uh(){this.mode=0;this.last=!1;this.wrap=0;this.havedict=!1;this.total=this.check=this.dmax=this.flags=0;this.head=null;this.wnext=this.whave=this.wsize=this.wbits=0;this.window=null;this.extra=this.offset=this.length=this.bits=this.hold=0;this.distcode=this.lencode=null;this.have=
this.ndist=this.nlen=this.ncode=this.distbits=this.lenbits=0;this.next=null;this.lens=new U.Buf16(320);this.work=new U.Buf16(288);this.distdyn=this.lendyn=null;this.was=this.back=this.sane=0}function ef(h){var c;if(!h||!h.state)return-2;c=h.state;h.total_in=h.total_out=c.total=0;h.msg="";c.wrap&&(h.adler=c.wrap&1);c.mode=1;c.last=0;c.havedict=0;c.dmax=32768;c.head=null;c.hold=0;c.bits=0;c.lencode=c.lendyn=new U.Buf32(852);c.distcode=c.distdyn=new U.Buf32(592);c.sane=1;c.back=-1;return 0}function ff(h){var c;
if(!h||!h.state)return-2;c=h.state;c.wsize=0;c.whave=0;c.wnext=0;return ef(h)}function gf(h,c){var b,a;if(!h||!h.state)return-2;a=h.state;0>c?(b=0,c=-c):(b=(c>>4)+1,48>c&&(c&=15));if(c&&(8>c||15<c))return-2;null!==a.window&&a.wbits!==c&&(a.window=null);a.wrap=b;a.wbits=c;return ff(h)}function hf(h,c){var b;if(!h)return-2;b=new Uh;h.state=b;b.window=null;c=gf(h,c);0!==c&&(h.state=null);return c}function jf(h,c,b,a){var d=h.state;null===d.window&&(d.wsize=1<<d.wbits,d.wnext=0,d.whave=0,d.window=new U.Buf8(d.wsize));
a>=d.wsize?(U.arraySet(d.window,c,b-d.wsize,d.wsize,0),d.wnext=0,d.whave=d.wsize):(h=d.wsize-d.wnext,h>a&&(h=a),U.arraySet(d.window,c,b-a,h,d.wnext),(a-=h)?(U.arraySet(d.window,c,b-a,a,0),d.wnext=a,d.whave=d.wsize):(d.wnext+=h,d.wnext===d.wsize&&(d.wnext=0),d.whave<d.wsize&&(d.whave+=h)));return 0}function zb(h){if(!(this instanceof zb))return new zb(h);var c=this.options=U.assign({chunkSize:16384,windowBits:0,to:""},h||{});c.raw&&0<=c.windowBits&&16>c.windowBits&&(c.windowBits=-c.windowBits,0===
c.windowBits&&(c.windowBits=-15));!(0<=c.windowBits&&16>c.windowBits)||h&&h.windowBits||(c.windowBits+=32);15<c.windowBits&&48>c.windowBits&&0===(c.windowBits&15)&&(c.windowBits|=15);this.err=0;this.msg="";this.ended=!1;this.chunks=[];this.strm=new bf;this.strm.avail_out=0;h=kc.inflateInit2(this.strm,c.windowBits);if(h!==ha.Z_OK)throw Error(Mb[h]);this.header=new Vh;kc.inflateGetHeader(this.strm,this.header)}function Dd(h,c){c=new zb(c);c.push(h,!0);if(c.err)throw c.msg||Mb[c.err];return c.result}
function kf(h,c){return c={exports:{}},h(c,c.exports),c.exports}function Pb(h){for(var c=h.length;0<=--c;)h[c]=0}function Ed(h,c,b,a,d){this.static_tree=h;this.extra_bits=c;this.extra_base=b;this.elems=a;this.max_length=d;this.has_stree=h&&h.length}function Fd(h,c){this.dyn_tree=h;this.max_code=0;this.stat_desc=c}function lc(h,c){h.pending_buf[h.pending++]=c&255;h.pending_buf[h.pending++]=c>>>8&255}function xa(h,c,b){h.bi_valid>16-b?(h.bi_buf|=c<<h.bi_valid&65535,lc(h,h.bi_buf),h.bi_buf=c>>16-h.bi_valid,
h.bi_valid+=b-16):(h.bi_buf|=c<<h.bi_valid&65535,h.bi_valid+=b)}function Qa(h,c,b){xa(h,b[2*c],b[2*c+1])}function lf(h,c){var b=0;do b|=h&1,h>>>=1,b<<=1;while(0<--c);return b>>>1}function mf(h,c,b){var a=Array(16),d=0,g;for(g=1;15>=g;g++)a[g]=d=d+b[g-1]<<1;for(b=0;b<=c;b++)d=h[2*b+1],0!==d&&(h[2*b]=lf(a[d]++,d))}function nf(h){var c;for(c=0;286>c;c++)h.dyn_ltree[2*c]=0;for(c=0;30>c;c++)h.dyn_dtree[2*c]=0;for(c=0;19>c;c++)h.bl_tree[2*c]=0;h.dyn_ltree[512]=1;h.opt_len=h.static_len=0;h.last_lit=h.matches=
0}function of(h){8<h.bi_valid?lc(h,h.bi_buf):0<h.bi_valid&&(h.pending_buf[h.pending++]=h.bi_buf);h.bi_buf=0;h.bi_valid=0}function pf(h,c,b,a){var d=2*c,g=2*b;return h[d]<h[g]||h[d]===h[g]&&a[c]<=a[b]}function Gd(h,c,b){for(var a=h.heap[b],d=b<<1;d<=h.heap_len;){d<h.heap_len&&pf(c,h.heap[d+1],h.heap[d],h.depth)&&d++;if(pf(c,a,h.heap[d],h.depth))break;h.heap[b]=h.heap[d];b=d;d<<=1}h.heap[b]=a}function qf(h,c,b){var a,d,g=0,e,f;if(0!==h.last_lit){do a=h.pending_buf[h.d_buf+2*g]<<8|h.pending_buf[h.d_buf+
2*g+1],d=h.pending_buf[h.l_buf+g],g++,0===a?Qa(h,d,c):(e=mc[d],Qa(h,e+256+1,c),f=Hd[e],0!==f&&(d-=Id[e],xa(h,d,f)),a--,e=256>a?Ab[a]:Ab[256+(a>>>7)],Qa(h,e,b),f=Tc[e],0!==f&&(a-=Uc[e],xa(h,a,f)));while(g<h.last_lit)}Qa(h,256,c)}function Jd(h,c){var b=c.dyn_tree,a=c.stat_desc.static_tree,d=c.stat_desc.has_stree,g=c.stat_desc.elems,e,f=-1,k;h.heap_len=0;h.heap_max=573;for(e=0;e<g;e++)0!==b[2*e]?(h.heap[++h.heap_len]=f=e,h.depth[e]=0):b[2*e+1]=0;for(;2>h.heap_len;)k=h.heap[++h.heap_len]=2>f?++f:0,b[2*
k]=1,h.depth[k]=0,h.opt_len--,d&&(h.static_len-=a[2*k+1]);c.max_code=f;for(e=h.heap_len>>1;1<=e;e--)Gd(h,b,e);k=g;do e=h.heap[1],h.heap[1]=h.heap[h.heap_len--],Gd(h,b,1),a=h.heap[1],h.heap[--h.heap_max]=e,h.heap[--h.heap_max]=a,b[2*k]=b[2*e]+b[2*a],h.depth[k]=(h.depth[e]>=h.depth[a]?h.depth[e]:h.depth[a])+1,b[2*e+1]=b[2*a+1]=k,h.heap[1]=k++,Gd(h,b,1);while(2<=h.heap_len);h.heap[--h.heap_max]=h.heap[1];e=c.dyn_tree;k=c.max_code;var a=c.stat_desc.static_tree,d=c.stat_desc.has_stree,g=c.stat_desc.extra_bits,
l=c.stat_desc.extra_base,m=c.stat_desc.max_length,n,r,u,p,t=0;for(r=0;15>=r;r++)h.bl_count[r]=0;e[2*h.heap[h.heap_max]+1]=0;for(c=h.heap_max+1;573>c;c++)n=h.heap[c],r=e[2*e[2*n+1]+1]+1,r>m&&(r=m,t++),e[2*n+1]=r,n>k||(h.bl_count[r]++,u=0,n>=l&&(u=g[n-l]),p=e[2*n],h.opt_len+=p*(r+u),d&&(h.static_len+=p*(a[2*n+1]+u)));if(0!==t){do{for(r=m-1;0===h.bl_count[r];)r--;h.bl_count[r]--;h.bl_count[r+1]+=2;h.bl_count[m]--;t-=2}while(0<t);for(r=m;0!==r;r--)for(n=h.bl_count[r];0!==n;)a=h.heap[--c],a>k||(e[2*a+
1]!==r&&(h.opt_len+=(r-e[2*a+1])*e[2*a],e[2*a+1]=r),n--)}mf(b,f,h.bl_count)}function rf(h,c,b){var a,d=-1,g,e=c[1],f=0,k=7,l=4;0===e&&(k=138,l=3);c[2*(b+1)+1]=65535;for(a=0;a<=b;a++)g=e,e=c[2*(a+1)+1],++f<k&&g===e||(f<l?h.bl_tree[2*g]+=f:0!==g?(g!==d&&h.bl_tree[2*g]++,h.bl_tree[32]++):10>=f?h.bl_tree[34]++:h.bl_tree[36]++,f=0,d=g,0===e?(k=138,l=3):g===e?(k=6,l=3):(k=7,l=4))}function sf(h,c,b){var a,d=-1,g,e=c[1],f=0,k=7,l=4;0===e&&(k=138,l=3);for(a=0;a<=b;a++)if(g=e,e=c[2*(a+1)+1],!(++f<k&&g===e)){if(f<
l){do Qa(h,g,h.bl_tree);while(0!==--f)}else 0!==g?(g!==d&&(Qa(h,g,h.bl_tree),f--),Qa(h,16,h.bl_tree),xa(h,f-3,2)):10>=f?(Qa(h,17,h.bl_tree),xa(h,f-3,3)):(Qa(h,18,h.bl_tree),xa(h,f-11,7));f=0;d=g;0===e?(k=138,l=3):g===e?(k=6,l=3):(k=7,l=4)}}function Wh(h){var c=4093624447,b;for(b=0;31>=b;b++,c>>>=1)if(c&1&&0!==h.dyn_ltree[2*b])return 0;if(0!==h.dyn_ltree[18]||0!==h.dyn_ltree[20]||0!==h.dyn_ltree[26])return 1;for(b=32;256>b;b++)if(0!==h.dyn_ltree[2*b])return 1;return 0}function tf(h,c,b,a){xa(h,0+(a?
1:0),3);of(h);lc(h,b);lc(h,~b);V.arraySet(h.pending_buf,h.window,c,b,h.pending);h.pending+=b}function jb(h,c){h.msg=Qb[c];return c}function kb(h){for(var c=h.length;0<=--c;)h[c]=0}function lb(h){var c=h.state,b=c.pending;b>h.avail_out&&(b=h.avail_out);0!==b&&(V.arraySet(h.output,c.pending_buf,c.pending_out,b,h.next_out),h.next_out+=b,c.pending_out+=b,h.total_out+=b,h.avail_out-=b,c.pending-=b,0===c.pending&&(c.pending_out=0))}function pa(h,c){Ha._tr_flush_block(h,0<=h.block_start?h.block_start:-1,
h.strstart-h.block_start,c);h.block_start=h.strstart;lb(h.strm)}function ca(h,c){h.pending_buf[h.pending++]=c}function nc(h,c){h.pending_buf[h.pending++]=c>>>8&255;h.pending_buf[h.pending++]=c&255}function uf(h,c){var b=h.max_chain_length,a=h.strstart,d,g=h.prev_length,e=h.nice_match,f=h.strstart>h.w_size-262?h.strstart-(h.w_size-262):0,k=h.window,l=h.w_mask,m=h.prev,n=h.strstart+258,r=k[a+g-1],u=k[a+g];h.prev_length>=h.good_match&&(b>>=2);e>h.lookahead&&(e=h.lookahead);do if(d=c,k[d+g]===u&&k[d+
g-1]===r&&k[d]===k[a]&&k[++d]===k[a+1]){a+=2;for(d++;k[++a]===k[++d]&&k[++a]===k[++d]&&k[++a]===k[++d]&&k[++a]===k[++d]&&k[++a]===k[++d]&&k[++a]===k[++d]&&k[++a]===k[++d]&&k[++a]===k[++d]&&a<n;);d=258-(n-a);a=n-258;if(d>g){h.match_start=c;g=d;if(d>=e)break;r=k[a+g-1];u=k[a+g]}}while((c=m[c&l])>f&&0!==--b);return g<=h.lookahead?g:h.lookahead}function Bb(h){var c=h.w_size,b,a,d,g;do{g=h.window_size-h.lookahead-h.strstart;if(h.strstart>=c+(c-262)){V.arraySet(h.window,h.window,c,c,0);h.match_start-=c;
h.strstart-=c;h.block_start-=c;b=a=h.hash_size;do d=h.head[--b],h.head[b]=d>=c?d-c:0;while(--a);b=a=c;do d=h.prev[--b],h.prev[b]=d>=c?d-c:0;while(--a);g+=c}if(0===h.strm.avail_in)break;b=h.strm;a=h.window;d=h.strstart+h.lookahead;var e=b.avail_in;e>g&&(e=g);0===e?a=0:(b.avail_in-=e,V.arraySet(a,b.input,b.next_in,e,d),1===b.state.wrap?b.adler=oc(b.adler,a,e,d):2===b.state.wrap&&(b.adler=ja(b.adler,a,e,d)),b.next_in+=e,b.total_in+=e,a=e);h.lookahead+=a;if(3<=h.lookahead+h.insert)for(g=h.strstart-h.insert,
h.ins_h=h.window[g],h.ins_h=(h.ins_h<<h.hash_shift^h.window[g+1])&h.hash_mask;h.insert&&!(h.ins_h=(h.ins_h<<h.hash_shift^h.window[g+3-1])&h.hash_mask,h.prev[g&h.w_mask]=h.head[h.ins_h],h.head[h.ins_h]=g,g++,h.insert--,3>h.lookahead+h.insert););}while(262>h.lookahead&&0!==h.strm.avail_in)}function Kd(h,c){for(var b;;){if(262>h.lookahead){Bb(h);if(262>h.lookahead&&0===c)return 1;if(0===h.lookahead)break}b=0;3<=h.lookahead&&(h.ins_h=(h.ins_h<<h.hash_shift^h.window[h.strstart+3-1])&h.hash_mask,b=h.prev[h.strstart&
h.w_mask]=h.head[h.ins_h],h.head[h.ins_h]=h.strstart);0!==b&&h.strstart-b<=h.w_size-262&&(h.match_length=uf(h,b));if(3<=h.match_length)if(b=Ha._tr_tally(h,h.strstart-h.match_start,h.match_length-3),h.lookahead-=h.match_length,h.match_length<=h.max_lazy_match&&3<=h.lookahead){h.match_length--;do h.strstart++,h.ins_h=(h.ins_h<<h.hash_shift^h.window[h.strstart+3-1])&h.hash_mask,h.prev[h.strstart&h.w_mask]=h.head[h.ins_h],h.head[h.ins_h]=h.strstart;while(0!==--h.match_length);h.strstart++}else h.strstart+=
h.match_length,h.match_length=0,h.ins_h=h.window[h.strstart],h.ins_h=(h.ins_h<<h.hash_shift^h.window[h.strstart+1])&h.hash_mask;else b=Ha._tr_tally(h,0,h.window[h.strstart]),h.lookahead--,h.strstart++;if(b&&(pa(h,!1),0===h.strm.avail_out))return 1}h.insert=2>h.strstart?h.strstart:2;return 4===c?(pa(h,!0),0===h.strm.avail_out?3:4):h.last_lit&&(pa(h,!1),0===h.strm.avail_out)?1:2}function Rb(h,c){for(var b,a;;){if(262>h.lookahead){Bb(h);if(262>h.lookahead&&0===c)return 1;if(0===h.lookahead)break}b=0;
3<=h.lookahead&&(h.ins_h=(h.ins_h<<h.hash_shift^h.window[h.strstart+3-1])&h.hash_mask,b=h.prev[h.strstart&h.w_mask]=h.head[h.ins_h],h.head[h.ins_h]=h.strstart);h.prev_length=h.match_length;h.prev_match=h.match_start;h.match_length=2;0!==b&&h.prev_length<h.max_lazy_match&&h.strstart-b<=h.w_size-262&&(h.match_length=uf(h,b),5>=h.match_length&&(1===h.strategy||3===h.match_length&&4096<h.strstart-h.match_start)&&(h.match_length=2));if(3<=h.prev_length&&h.match_length<=h.prev_length){a=h.strstart+h.lookahead-
3;b=Ha._tr_tally(h,h.strstart-1-h.prev_match,h.prev_length-3);h.lookahead-=h.prev_length-1;h.prev_length-=2;do++h.strstart<=a&&(h.ins_h=(h.ins_h<<h.hash_shift^h.window[h.strstart+3-1])&h.hash_mask,h.prev[h.strstart&h.w_mask]=h.head[h.ins_h],h.head[h.ins_h]=h.strstart);while(0!==--h.prev_length);h.match_available=0;h.match_length=2;h.strstart++;if(b&&(pa(h,!1),0===h.strm.avail_out))return 1}else if(h.match_available){if((b=Ha._tr_tally(h,0,h.window[h.strstart-1]))&&pa(h,!1),h.strstart++,h.lookahead--,
0===h.strm.avail_out)return 1}else h.match_available=1,h.strstart++,h.lookahead--}h.match_available&&(Ha._tr_tally(h,0,h.window[h.strstart-1]),h.match_available=0);h.insert=2>h.strstart?h.strstart:2;return 4===c?(pa(h,!0),0===h.strm.avail_out?3:4):h.last_lit&&(pa(h,!1),0===h.strm.avail_out)?1:2}function Xh(h,c){for(var b,a,d,g=h.window;;){if(258>=h.lookahead){Bb(h);if(258>=h.lookahead&&0===c)return 1;if(0===h.lookahead)break}h.match_length=0;if(3<=h.lookahead&&0<h.strstart&&(a=h.strstart-1,b=g[a],
b===g[++a]&&b===g[++a]&&b===g[++a])){for(d=h.strstart+258;b===g[++a]&&b===g[++a]&&b===g[++a]&&b===g[++a]&&b===g[++a]&&b===g[++a]&&b===g[++a]&&b===g[++a]&&a<d;);h.match_length=258-(d-a);h.match_length>h.lookahead&&(h.match_length=h.lookahead)}3<=h.match_length?(b=Ha._tr_tally(h,1,h.match_length-3),h.lookahead-=h.match_length,h.strstart+=h.match_length,h.match_length=0):(b=Ha._tr_tally(h,0,h.window[h.strstart]),h.lookahead--,h.strstart++);if(b&&(pa(h,!1),0===h.strm.avail_out))return 1}h.insert=0;return 4===
c?(pa(h,!0),0===h.strm.avail_out?3:4):h.last_lit&&(pa(h,!1),0===h.strm.avail_out)?1:2}function Yh(h,c){for(var b;;){if(0===h.lookahead&&(Bb(h),0===h.lookahead)){if(0===c)return 1;break}h.match_length=0;b=Ha._tr_tally(h,0,h.window[h.strstart]);h.lookahead--;h.strstart++;if(b&&(pa(h,!1),0===h.strm.avail_out))return 1}h.insert=0;return 4===c?(pa(h,!0),0===h.strm.avail_out?3:4):h.last_lit&&(pa(h,!1),0===h.strm.avail_out)?1:2}function Ra(h,c,b,a,d){this.good_length=h;this.max_lazy=c;this.nice_length=b;
this.max_chain=a;this.func=d}function Zh(){this.strm=null;this.status=0;this.pending_buf=null;this.wrap=this.pending=this.pending_out=this.pending_buf_size=0;this.gzhead=null;this.gzindex=0;this.method=8;this.last_flush=-1;this.w_mask=this.w_bits=this.w_size=0;this.window=null;this.window_size=0;this.head=this.prev=null;this.nice_match=this.good_match=this.strategy=this.level=this.max_lazy_match=this.max_chain_length=this.prev_length=this.lookahead=this.match_start=this.strstart=this.match_available=
this.prev_match=this.match_length=this.block_start=this.hash_shift=this.hash_mask=this.hash_bits=this.hash_size=this.ins_h=0;this.dyn_ltree=new V.Buf16(1146);this.dyn_dtree=new V.Buf16(122);this.bl_tree=new V.Buf16(78);kb(this.dyn_ltree);kb(this.dyn_dtree);kb(this.bl_tree);this.bl_desc=this.d_desc=this.l_desc=null;this.bl_count=new V.Buf16(16);this.heap=new V.Buf16(573);kb(this.heap);this.heap_max=this.heap_len=0;this.depth=new V.Buf16(573);kb(this.depth);this.bi_valid=this.bi_buf=this.insert=this.matches=
this.static_len=this.opt_len=this.d_buf=this.last_lit=this.lit_bufsize=this.l_buf=0}function vf(h){var c;if(!h||!h.state)return jb(h,-2);h.total_in=h.total_out=0;h.data_type=2;c=h.state;c.pending=0;c.pending_out=0;0>c.wrap&&(c.wrap=-c.wrap);c.status=c.wrap?42:113;h.adler=2===c.wrap?0:1;c.last_flush=0;Ha._tr_init(c);return 0}function wf(h){var c=vf(h);0===c&&(h=h.state,h.window_size=2*h.w_size,kb(h.head),h.max_lazy_match=Sb[h.level].max_lazy,h.good_match=Sb[h.level].good_length,h.nice_match=Sb[h.level].nice_length,
h.max_chain_length=Sb[h.level].max_chain,h.strstart=0,h.block_start=0,h.lookahead=0,h.insert=0,h.match_length=h.prev_length=2,h.match_available=0,h.ins_h=0);return c}function xf(h,c,b,a,d,g){if(!h)return-2;var e=1;-1===c&&(c=6);0>a?(e=0,a=-a):15<a&&(e=2,a-=16);if(1>d||9<d||8!==b||8>a||15<a||0>c||9<c||0>g||4<g)return jb(h,-2);8===a&&(a=9);var f=new Zh;h.state=f;f.strm=h;f.wrap=e;f.gzhead=null;f.w_bits=a;f.w_size=1<<f.w_bits;f.w_mask=f.w_size-1;f.hash_bits=d+7;f.hash_size=1<<f.hash_bits;f.hash_mask=
f.hash_size-1;f.hash_shift=~~((f.hash_bits+3-1)/3);f.window=new V.Buf8(2*f.w_size);f.head=new V.Buf16(f.hash_size);f.prev=new V.Buf16(f.w_size);f.lit_bufsize=1<<d+6;f.pending_buf_size=4*f.lit_bufsize;f.pending_buf=new V.Buf8(f.pending_buf_size);f.d_buf=1*f.lit_bufsize;f.l_buf=3*f.lit_bufsize;f.level=c;f.strategy=g;f.method=b;return wf(h)}function yf(h,c){if(65537>c&&(h.subarray&&zf||!h.subarray&&Af))return String.fromCharCode.apply(null,V.shrinkBuf(h,c));for(var b="",a=0;a<c;a++)b+=String.fromCharCode(h[a]);
return b}function Cb(h){if(!(this instanceof Cb))return new Cb(h);h=this.options=V.assign({level:-1,method:8,chunkSize:16384,windowBits:15,memLevel:8,strategy:0,to:""},h||{});h.raw&&0<h.windowBits?h.windowBits=-h.windowBits:h.gzip&&0<h.windowBits&&16>h.windowBits&&(h.windowBits+=16);this.err=0;this.msg="";this.ended=!1;this.chunks=[];this.strm=new Bf;this.strm.avail_out=0;var c=pc.deflateInit2(this.strm,h.level,h.method,h.windowBits,h.memLevel,h.strategy);if(0!==c)throw Error(Qb[c]);h.header&&pc.deflateSetHeader(this.strm,
h.header);if(h.dictionary){h="string"===typeof h.dictionary?Db.string2buf(h.dictionary):"[object ArrayBuffer]"===Cf.call(h.dictionary)?new Uint8Array(h.dictionary):h.dictionary;c=pc.deflateSetDictionary(this.strm,h);if(0!==c)throw Error(Qb[c]);this._dict_set=!0}}function Ld(h,c){c=new Cb(c);c.push(h,!0);if(c.err)throw c.msg||Qb[c.err];return c.result}function Df(h){return(h>>>24&255)+(h>>>8&65280)+((h&65280)<<8)+((h&255)<<24)}function $h(){this.mode=0;this.last=!1;this.wrap=0;this.havedict=!1;this.total=
this.check=this.dmax=this.flags=0;this.head=null;this.wnext=this.whave=this.wsize=this.wbits=0;this.window=null;this.extra=this.offset=this.length=this.bits=this.hold=0;this.distcode=this.lencode=null;this.have=this.ndist=this.nlen=this.ncode=this.distbits=this.lenbits=0;this.next=null;this.lens=new V.Buf16(320);this.work=new V.Buf16(288);this.distdyn=this.lendyn=null;this.was=this.back=this.sane=0}function Ef(h){var c;if(!h||!h.state)return-2;c=h.state;h.total_in=h.total_out=c.total=0;h.msg="";c.wrap&&
(h.adler=c.wrap&1);c.mode=1;c.last=0;c.havedict=0;c.dmax=32768;c.head=null;c.hold=0;c.bits=0;c.lencode=c.lendyn=new V.Buf32(852);c.distcode=c.distdyn=new V.Buf32(592);c.sane=1;c.back=-1;return 0}function Ff(h){var c;if(!h||!h.state)return-2;c=h.state;c.wsize=0;c.whave=0;c.wnext=0;return Ef(h)}function Gf(h,c){var b,a;if(!h||!h.state)return-2;a=h.state;0>c?(b=0,c=-c):(b=(c>>4)+1,48>c&&(c&=15));if(c&&(8>c||15<c))return-2;null!==a.window&&a.wbits!==c&&(a.window=null);a.wrap=b;a.wbits=c;return Ff(h)}
function Hf(h,c){var b;if(!h)return-2;b=new $h;h.state=b;b.window=null;c=Gf(h,c);0!==c&&(h.state=null);return c}function If(h,c,b,a){var d=h.state;null===d.window&&(d.wsize=1<<d.wbits,d.wnext=0,d.whave=0,d.window=new V.Buf8(d.wsize));a>=d.wsize?(V.arraySet(d.window,c,b-d.wsize,d.wsize,0),d.wnext=0,d.whave=d.wsize):(h=d.wsize-d.wnext,h>a&&(h=a),V.arraySet(d.window,c,b-a,h,d.wnext),(a-=h)?(V.arraySet(d.window,c,b-a,a,0),d.wnext=a,d.whave=d.wsize):(d.wnext+=h,d.wnext===d.wsize&&(d.wnext=0),d.whave<d.wsize&&
(d.whave+=h)));return 0}function Eb(h){if(!(this instanceof Eb))return new Eb(h);var c=this.options=V.assign({chunkSize:16384,windowBits:0,to:""},h||{});c.raw&&0<=c.windowBits&&16>c.windowBits&&(c.windowBits=-c.windowBits,0===c.windowBits&&(c.windowBits=-15));!(0<=c.windowBits&&16>c.windowBits)||h&&h.windowBits||(c.windowBits+=32);15<c.windowBits&&48>c.windowBits&&0===(c.windowBits&15)&&(c.windowBits|=15);this.err=0;this.msg="";this.ended=!1;this.chunks=[];this.strm=new Bf;this.strm.avail_out=0;h=
qc.inflateInit2(this.strm,c.windowBits);if(h!==X.Z_OK)throw Error(Qb[h]);this.header=new ai;qc.inflateGetHeader(this.strm,this.header)}function Md(h,c){c=new Eb(c);c.push(h,!0);if(c.err)throw c.msg||Qb[c.err];return c.result}function Jf(){throw Error("setTimeout has not been defined");}function Kf(){throw Error("clearTimeout has not been defined");}function Lf(h){if(mb===setTimeout)return setTimeout(h,0);if((mb===Jf||!mb)&&setTimeout)return mb=setTimeout,setTimeout(h,0);try{return mb(h,0)}catch(c){try{return mb.call(null,
h,0)}catch(b){return mb.call(this,h,0)}}}function bi(h){if(nb===clearTimeout)return clearTimeout(h);if((nb===Kf||!nb)&&clearTimeout)return nb=clearTimeout,clearTimeout(h);try{return nb(h)}catch(c){try{return nb.call(null,h)}catch(b){return nb.call(this,h)}}}function ci(){Tb&&Fb&&(Tb=!1,Fb.length?Xa=Fb.concat(Xa):Vc=-1,Xa.length&&Mf())}function Mf(){if(!Tb){var h=Lf(ci);Tb=!0;for(var c=Xa.length;c;){Fb=Xa;for(Xa=[];++Vc<c;)Fb&&Fb[Vc].run();Vc=-1;c=Xa.length}Fb=null;Tb=!1;bi(h)}}function Nf(h,c){this.fun=
h;this.array=c}function Gb(){}function Of(){}function di(h,c,b,a,d){function g(a){var c=a.slice(1,-1);if(c in b)return b[c];if("#"===c.charAt(0))return a=parseInt(c.substr(1).replace("x","0x")),65535<a?(a-=65536,a=String.fromCharCode(55296+(a>>10),56320+(a&1023))):a=String.fromCharCode(a),a;d.error("entity not found:"+a);return a}function e(d){if(d>u){var b=h.substring(u,d).replace(/&#?\w+;/g,g);n&&f(u);a.characters(b,0,d-u);u=d}}function f(a,d){for(;a>=l&&(d=m.exec(h));)k=d.index,l=k+d[0].length,
n.lineNumber++;n.columnNumber=a-k+1}var k=0,l=0,m=/.*(?:\r\n?|\n)|.*$/g,n=a.locator;c=[{currentNSMap:c}];for(var r={},u=0;;){try{var p=h.indexOf("<",u);if(0>p){if(!h.substr(u).match(/^\s*$/)){var t=a.doc,y=t.createTextNode(h.substr(u));t.appendChild(y);a.currentElement=y}break}p>u&&e(p);switch(h.charAt(p+1)){case "/":var w=h.indexOf(">",p+3),x=h.substring(p+2,w),v=c.pop();0>w?(x=h.substring(p+2).replace(/[\s<].*/,""),d.error("end tag name: "+x+" is not complete:"+v.tagName),w=p+1+x.length):x.match(/\s</)&&
(x=x.replace(/[\s<].*/,""),d.error("end tag name: "+x+" maybe not complete"),w=p+1+x.length);var A=v.localNSMap,F=v.tagName==x;if(F||v.tagName&&v.tagName.toLowerCase()==x.toLowerCase()){a.endElement(v.uri,v.localName,x);if(A)for(var C in A)a.endPrefixMapping(C);F||d.fatalError("end tag name: "+x+" is not match the current start tagName:"+v.tagName)}else c.push(v);w++;break;case "?":n&&f(p);w=ei(h,p,a);break;case "!":n&&f(p);w=fi(h,p,a,d);break;default:n&&f(p);var q=new Pf,G=c[c.length-1].currentNSMap,
w=gi(h,p,q,G,g,d),K=q.length;!q.closed&&hi(h,w,q.tagName,r)&&(q.closed=!0,b.nbsp||d.warning("unclosed xml attribute"));if(n&&K){for(var M=Qf(n,{}),aa=0;aa<K;aa++){var J=q[aa];f(J.offset);J.locator=Qf(n,{})}a.locator=M;Rf(q,a,G)&&c.push(q);a.locator=n}else Rf(q,a,G)&&c.push(q);"http://www.w3.org/1999/xhtml"!==q.uri||q.closed?w++:w=ii(h,w,q.tagName,g,a)}}catch(E){d.error("element parse error: "+E),w=-1}w>u?u=w:e(Math.max(p,u)+1)}}function Qf(h,c){c.lineNumber=h.lineNumber;c.columnNumber=h.columnNumber;
return c}function gi(h,c,b,a,d,g){for(var e,f,k=++c,l=0;;){var m=h.charAt(k);switch(m){case "=":if(1===l)e=h.slice(c,k),l=3;else if(2===l)l=3;else throw Error("attribute equal must after attrName");break;case "'":case '"':if(3===l||1===l)if(1===l&&(g.warning('attribute value must after "="'),e=h.slice(c,k)),c=k+1,k=h.indexOf(m,c),0<k)f=h.slice(c,k).replace(/&#?\w+;/g,d),b.add(e,f,c-1),l=5;else throw Error("attribute value no end '"+m+"' match");else if(4==l)f=h.slice(c,k).replace(/&#?\w+;/g,d),b.add(e,
f,c),g.warning('attribute "'+e+'" missed start quot('+m+")!!"),c=k+1,l=5;else throw Error('attribute value must after "="');break;case "/":switch(l){case 0:b.setTagName(h.slice(c,k));case 5:case 6:case 7:l=7,b.closed=!0;case 4:case 1:case 2:break;default:throw Error("attribute invalid close char('/')");}break;case "":return g.error("unexpected end of input"),0==l&&b.setTagName(h.slice(c,k)),k;case ">":switch(l){case 0:b.setTagName(h.slice(c,k));case 5:case 6:case 7:break;case 4:case 1:f=h.slice(c,
k),"/"===f.slice(-1)&&(b.closed=!0,f=f.slice(0,-1));case 2:2===l&&(f=e);4==l?(g.warning('attribute "'+f+'" missed quot(")!!'),b.add(e,f.replace(/&#?\w+;/g,d),c)):("http://www.w3.org/1999/xhtml"===a[""]&&f.match(/^(?:disabled|checked|selected)$/i)||g.warning('attribute "'+f+'" missed value!! "'+f+'" instead!!'),b.add(f,f,c));break;case 3:throw Error("attribute value missed!!");}return k;case "\u0080":m=" ";default:if(" ">=m)switch(l){case 0:b.setTagName(h.slice(c,k));l=6;break;case 1:e=h.slice(c,k);
l=2;break;case 4:f=h.slice(c,k).replace(/&#?\w+;/g,d),g.warning('attribute "'+f+'" missed quot(")!!'),b.add(e,f,c);case 5:l=6}else switch(l){case 2:"http://www.w3.org/1999/xhtml"===a[""]&&e.match(/^(?:disabled|checked|selected)$/i)||g.warning('attribute "'+e+'" missed value!! "'+e+'" instead2!!');b.add(e,e,c);c=k;l=1;break;case 5:g.warning('attribute space is required"'+e+'"!!');case 6:l=1;c=k;break;case 3:l=4;c=k;break;case 7:throw Error("elements closed character '/' and '>' must be connected to");
}}k++}}function Rf(h,c,b){for(var a=h.tagName,d=null,g=h.length;g--;){var e=h[g],f=e.qName,k=e.value,l=f.indexOf(":");if(0<l)var m=e.prefix=f.slice(0,l),l=f.slice(l+1),m="xmlns"===m&&l;else l=f,m="xmlns"===f&&"";e.localName=l;!1!==m&&(null==d&&(d={},Sf(b,b={})),b[m]=d[m]=k,e.uri="http://www.w3.org/2000/xmlns/",c.startPrefixMapping(m,k))}for(g=h.length;g--;)if(e=h[g],m=e.prefix)"xml"===m&&(e.uri="http://www.w3.org/XML/1998/namespace"),"xmlns"!==m&&(e.uri=b[m||""]);l=a.indexOf(":");0<l?(m=h.prefix=
a.slice(0,l),l=h.localName=a.slice(l+1)):(m=null,l=h.localName=a);g=h.uri=b[m||""];c.startElement(g,l,a,h);if(h.closed){if(c.endElement(g,l,a),d)for(m in d)c.endPrefixMapping(m)}else return h.currentNSMap=b,h.localNSMap=d,!0}function ii(h,c,b,a,d){if(/^(?:script|textarea)$/i.test(b)){var g=h.indexOf("</"+b+">",c);h=h.substring(c+1,g);if(/[&<]/.test(h)){if(/^script$/i.test(b))return d.characters(h,0,h.length),g;h=h.replace(/&#?\w+;/g,a);d.characters(h,0,h.length);return g}}return c+1}function hi(h,
c,b,a){var d=a[b];null==d&&(d=h.lastIndexOf("</"+b+">"),d<c&&(d=h.lastIndexOf("</"+b)),a[b]=d);return d<c}function Sf(h,c){for(var b in h)c[b]=h[b]}function fi(h,c,b,a){switch(h.charAt(c+2)){case "-":if("-"===h.charAt(c+3)){var d=h.indexOf("--\x3e",c+4);if(d>c)return b.comment(h,c+4,d-c-4),d+3;a.error("Unclosed comment")}break;default:if("CDATA["==h.substr(c+3,6))return d=h.indexOf("]]\x3e",c+9),b.startCDATA(),b.characters(h,c+9,d-c-9),b.endCDATA(),d+3;a:{a=[];d=/'[^']+'|"[^"]+"|[^\s<>\/=]+=?|(\/?\s*>|<)/g;
d.lastIndex=c;for(d.exec(h);c=d.exec(h);)if(a.push(c),c[1]){d=a;break a}d=void 0}var g=d.length;if(1<g&&/!doctype/i.test(d[0][0]))return h=d[1][0],c=3<g&&/^public$/i.test(d[2][0])&&d[3][0],a=4<g&&d[4][0],d=d[g-1],b.startDTD(h,c&&c.replace(/^(['"])(.*?)\1$/,"$2"),a&&a.replace(/^(['"])(.*?)\1$/,"$2")),b.endDTD(),d.index+d[0].length}return-1}function ei(h,c,b){var a=h.indexOf("?>",c);return a&&(h=h.substring(c,a).match(/^<\?(\S*)\s*([\s\S]*?)\s*$/))?(b.processingInstruction(h[1],h[2]),a+2):-1}function Pf(h){}
function Wc(h,c){h.__proto__=c;return h}function rc(h,c){for(var b in h)c[b]=h[b]}function ya(h,c){var b=h.prototype;if(Object.create){var a=Object.create(c.prototype);b.__proto__=a}b instanceof c||(a=function(){},a.prototype=c.prototype,a=new a,rc(b,a),h.prototype=b=a);b.constructor!=h&&("function"!=typeof h&&console.error("unknow Class:"+h),b.constructor=h)}function Ub(h,c){if(c instanceof Error)var b=c;else b=this,Error.call(this,ka[h]),this.message=ka[h],Error.captureStackTrace&&Error.captureStackTrace(this,
Ub);b.code=h;c&&(this.message=this.message+": "+c);return b}function ob(){}function sc(h,c){this._node=h;this._refresh=c;Nd(this)}function Nd(h){var c=h._node._inc||h._node.ownerDocument._inc;if(h._inc!=c){var b=h._refresh(h._node);Tf(h,"length",b.length);rc(b,h);h._inc=c}}function Xc(){}function Uf(h,c){for(var b=h.length;b--;)if(h[b]===c)return b}function Vf(h,c,b,a){a?c[Uf(c,a)]=b:c[c.length++]=b;h&&(b.ownerElement=h,c=h.ownerDocument)&&(a&&Wf(c,h,a),c&&c._inc++,"http://www.w3.org/2000/xmlns/"==
b.namespaceURI&&(h._nsMap[b.prefix?b.localName:""]=b.value))}function Xf(h,c,b){var a=Uf(c,b);if(0<=a){for(var d=c.length-1;a<d;)c[a]=c[++a];c.length=d;h&&(c=h.ownerDocument)&&(Wf(c,h,b),b.ownerElement=null)}else throw Ub(ji,Error(h.tagName+"@"+b));}function Yf(h){this._features={};if(h)for(var c in h)this._features=h[c]}function ta(){}function Zf(h){return"<"==h&&"&lt;"||">"==h&&"&gt;"||"&"==h&&"&amp;"||'"'==h&&"&quot;"||"&#"+h.charCodeAt()+";"}function Yc(h,c){if(c(h))return!0;if(h=h.firstChild){do if(Yc(h,
c))return!0;while(h=h.nextSibling)}}function tc(){}function Wf(h,c,b,a){h&&h._inc++;"http://www.w3.org/2000/xmlns/"==b.namespaceURI&&delete c._nsMap[b.prefix?b.localName:""]}function Od(h,c,b){if(h&&h._inc)if(h._inc++,h=c.childNodes,b)h[h.length++]=b;else{c=c.firstChild;for(b=0;c;)h[b++]=c,c=c.nextSibling;h.length=b}}function $f(h,c){var b=c.previousSibling,a=c.nextSibling;b?b.nextSibling=a:h.firstChild=a;a?a.previousSibling=b:h.lastChild=b;Od(h.ownerDocument,h);return c}function ag(h,c,b){var a=
c.parentNode;a&&a.removeChild(c);if(c.nodeType===Ya){a=c.firstChild;if(null==a)return c;var d=c.lastChild}else a=d=c;var g=b?b.previousSibling:h.lastChild;a.previousSibling=g;d.nextSibling=b;g?g.nextSibling=a:h.firstChild=a;null==b?h.lastChild=d:b.previousSibling=d;do a.parentNode=h;while(a!==d&&(a=a.nextSibling));Od(h.ownerDocument||h,h);c.nodeType==Ya&&(c.firstChild=c.lastChild=null);return c}function Vb(){this._nsMap={}}function Zc(){}function uc(){}function Pd(){}function Qd(){}function Rd(){}
function Sd(){}function bg(){}function cg(){}function Td(){}function $c(){}function Ud(){}function dg(){}function eg(h,c){var b=[],a=9==this.nodeType?this.documentElement:this,d=a.prefix,g=a.namespaceURI;if(g&&null==d&&(d=a.lookupPrefix(g),null==d))var e=[{namespace:g,prefix:null}];Wb(this,b,h,c,e);return b.join("")}function fg(h,c,b){c=h.prefix||"";h=h.namespaceURI;if(!c&&!h||"xml"===c&&"http://www.w3.org/XML/1998/namespace"===h||"http://www.w3.org/2000/xmlns/"==h)return!1;for(var a=b.length;a--;){var d=
b[a];if(d.prefix==c)return d.namespace!=h}return!0}function Wb(h,c,b,a,d){if(a)if(h=a(h)){if("string"==typeof h){c.push(h);return}}else return;switch(h.nodeType){case Sa:d||(d=[]);var g=h.attributes,e=g.length,f=h.firstChild,k=h.tagName;b="http://www.w3.org/1999/xhtml"===h.namespaceURI||b;c.push("<",k);for(var l=0;l<e;l++){var m=g.item(l);"xmlns"==m.prefix?d.push({prefix:m.localName,namespace:m.value}):"xmlns"==m.nodeName&&d.push({prefix:"",namespace:m.value})}for(l=0;l<e;l++){m=g.item(l);if(fg(m,
b,d)){var n=m.prefix||"",r=m.namespaceURI;c.push(n?" xmlns:"+n:" xmlns",'="',r,'"');d.push({prefix:n,namespace:r})}Wb(m,c,b,a,d)}fg(h,b,d)&&(n=h.prefix||"",r=h.namespaceURI,c.push(n?" xmlns:"+n:" xmlns",'="',r,'"'),d.push({prefix:n,namespace:r}));if(f||b&&!/^(?:meta|link|img|br|hr|input)$/i.test(k)){c.push(">");if(b&&/^script$/i.test(k))for(;f;)f.data?c.push(f.data):Wb(f,c,b,a,d),f=f.nextSibling;else for(;f;)Wb(f,c,b,a,d),f=f.nextSibling;c.push("</",k,">")}else c.push("/>");break;case gg:case Ya:for(f=
h.firstChild;f;)Wb(f,c,b,a,d),f=f.nextSibling;break;case Xb:return c.push(" ",h.name,'="',h.value.replace(/[<&"]/g,Zf),'"');case ad:return c.push(h.data.replace(/[<&]/g,Zf));case hg:return c.push("<![CDATA[",h.data,"]]\x3e");case ig:return c.push("\x3c!--",h.data,"--\x3e");case jg:b=h.publicId;a=h.systemId;c.push("<!DOCTYPE ",h.name);b?(c.push(' PUBLIC "',b),a&&"."!=a&&c.push('" "',a),c.push('">')):a&&"."!=a?c.push(' SYSTEM "',a,'">'):((h=h.internalSubset)&&c.push(" [",h,"]"),c.push(">"));break;case kg:return c.push("<?",
h.target," ",h.data,"?>");case lg:return c.push("&",h.nodeName,";");default:c.push("??",h.nodeName)}}function mg(h,c,b){var a;switch(c.nodeType){case Sa:a=c.cloneNode(!1),a.ownerDocument=h;case Ya:break;case Xb:b=!0}a||(a=c.cloneNode(!1));a.ownerDocument=h;a.parentNode=null;if(b)for(c=c.firstChild;c;)a.appendChild(mg(h,c,b)),c=c.nextSibling;return a}function Vd(h,c,b){var a=new c.constructor,d;for(d in c){var g=c[d];"object"!=("undefined"===typeof g?"undefined":O(g))&&g!=a[d]&&(a[d]=g)}c.childNodes&&
(a.childNodes=new ob);a.ownerDocument=h;switch(a.nodeType){case Sa:d=c.attributes;var e=a.attributes=new Xc,g=d.length;e._ownerElement=a;for(e=0;e<g;e++)a.setAttributeNode(Vd(h,d.item(e),!0));break;case Xb:b=!0}if(b)for(c=c.firstChild;c;)a.appendChild(Vd(h,c,b)),c=c.nextSibling;return a}function Tf(h,c,b){h[c]=b}function vc(){}function wc(){}function Wd(){this.littleEndian=!1;this.position=0;this._makeEntryLookup=!1;this.dictionary=[]}function xc(){this.decompressor=new Wd}function yc(){}function zc(){}
function ng(h,c,b,a,d){this.fileDirectory=h;this.geoKeys=c;this.dataView=b;this.littleEndian=a;this.tiles=d?{}:null;this.isTiled=h.StripOffsets?!1:!0;h=h.PlanarConfiguration;this.planarConfiguration="undefined"===typeof h?1:h;if(1!==this.planarConfiguration&&2!==this.planarConfiguration)throw Error("Invalid planar configuration.");switch(this.fileDirectory.Compression){case void 0:case 1:this.decoder=new ki;break;case 5:this.decoder=new li;break;case 6:throw Error("JPEG compression not supported.");
case 8:this.decoder=new mi;break;case 32773:this.decoder=new ni;break;default:throw Error("Unknown compresseion method identifier: "+this.fileDirectory.Compression);}}function og(h,c){this.dataView=new oi(h);c=c||{};this.cache=c.cache||!1;h=this.dataView.getUint16(0,0);if(18761===h)this.littleEndian=!0;else if(19789===h)this.littleEndian=!1;else throw new TypeError("Invalid byte order value.");h=this.dataView.getUint16(2,this.littleEndian);if(42===this.dataView.getUint16(2,this.littleEndian))this.bigTiff=
!1;else if(43===h){if(this.bigTiff=!0,8!==this.dataView.getUint16(4,this.littleEndian))throw Error("Unsupported offset byte-size.");}else throw new TypeError("Invalid magic number.");this.fileDirectories=this.parseFileDirectories(this.getOffset(this.bigTiff?8:4))}function pi(h){function c(a,d){for(var b=0,c=0,g=[],e=1;16>=e;e++){for(var f=1;f<=a[e];f++)g[d[c]]=[],g[d[c]][0]=b,g[d[c]][1]=e,c++,b++;b*=2}return g}function b(d){var b=d[0];for(d=d[1]-1;0<=d;)b&1<<d&&(F|=1<<C),d--,C--,0>C&&(255==F?(a(255),
a(0)):a(F),C=7,F=0)}function a(a){A.push(a)}function d(d){a(d>>8&255);a(d&255)}function g(a,d,c,g,e){var f=e[0],p=e[240],h,k,n,t,l,m,r,u,A,F=0;for(h=0;8>h;++h){k=a[F];n=a[F+1];t=a[F+2];l=a[F+3];m=a[F+4];r=a[F+5];u=a[F+6];A=a[F+7];var C=k+A;k-=A;A=n+u;n-=u;u=t+r;t-=r;r=l+m;l-=m;m=C+r;C-=r;r=A+u;A-=u;a[F]=m+r;a[F+4]=m-r;m=.707106781*(A+C);a[F+2]=C+m;a[F+6]=C-m;m=l+t;r=t+n;A=n+k;t=.382683433*(m-A);l=.5411961*m+t;m=1.306562965*A+t;r*=.707106781;t=k+r;k-=r;a[F+5]=k+l;a[F+3]=k-l;a[F+1]=t+m;a[F+7]=t-m;F+=
8}for(h=F=0;8>h;++h)k=a[F],n=a[F+8],t=a[F+16],l=a[F+24],m=a[F+32],r=a[F+40],u=a[F+48],A=a[F+56],C=k+A,k-=A,A=n+u,n-=u,u=t+r,t-=r,r=l+m,l-=m,m=C+r,C-=r,r=A+u,A-=u,a[F]=m+r,a[F+32]=m-r,m=.707106781*(A+C),a[F+16]=C+m,a[F+48]=C-m,m=l+t,r=t+n,A=n+k,t=.382683433*(m-A),l=.5411961*m+t,m=1.306562965*A+t,r*=.707106781,t=k+r,k-=r,a[F+40]=k+l,a[F+24]=k-l,a[F+8]=t+m,a[F+56]=t-m,F++;for(h=0;64>h;++h)F=a[h]*d[h],x[h]=0<F?F+.5|0:F-.5|0;a=x;for(d=0;64>d;++d)v[E[d]]=a[d];a=v[0]-c;c=v[0];0==a?b(g[0]):(h=32767+a,b(g[w[h]]),
b(y[h]));for(g=63;0<g&&0==v[g];g--);if(0==g)return b(f),c;for(a=1;a<=g;){for(d=a;0==v[a]&&a<=g;++a);d=a-d;if(16<=d){h=d>>4;for(F=1;F<=h;++F)b(p);d&=15}h=32767+v[a];b(e[(d<<4)+w[h]]);b(y[h]);a++}63!=g&&b(f);return c}function e(a){0>=a&&(a=1);100<a&&(a=100);if(J!=a){for(var d=50>a?Math.floor(5E3/a):Math.floor(200-2*a),b=[16,11,10,16,24,40,51,61,12,12,14,19,26,58,60,55,14,13,16,24,40,57,69,56,14,17,22,29,51,87,80,62,18,22,37,56,68,109,103,77,24,35,55,64,81,104,113,92,49,64,78,87,103,121,120,101,72,92,
95,98,112,100,103,99],c=0;64>c;c++){var g=f((b[c]*d+50)/100);1>g?g=1:255<g&&(g=255);k[E[c]]=g}b=[17,18,24,47,99,99,99,99,18,21,26,66,99,99,99,99,24,26,56,99,99,99,99,99,47,66,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99];for(c=0;64>c;c++)g=f((b[c]*d+50)/100),1>g?g=1:255<g&&(g=255),l[E[c]]=g;d=[1,1.387039845,1.306562965,1.175875602,1,.785694958,.5411961,.275899379];for(c=b=0;8>c;c++)for(g=0;8>g;g++)m[b]=1/(k[E[b]]*d[c]*d[g]*8),n[b]=
1/(l[E[b]]*d[c]*d[g]*8),b++;J=a}}var f=Math.floor,k=Array(64),l=Array(64),m=Array(64),n=Array(64),r,u,p,t,y=Array(65535),w=Array(65535),x=Array(64),v=Array(64),A=[],F=0,C=7,q=Array(64),G=Array(64),K=Array(64),M=Array(256),aa=Array(2048),J,E=[0,1,5,6,14,15,27,28,2,4,7,13,16,26,29,42,3,8,12,17,25,30,41,43,9,11,18,24,31,40,44,53,10,19,23,32,39,45,52,54,20,22,33,38,46,51,55,60,21,34,37,47,50,56,59,61,35,36,48,49,57,58,62,63],fa=[0,0,1,5,1,1,1,1,1,1,0,0,0,0,0,0,0],D=[0,1,2,3,4,5,6,7,8,9,10,11],qg=[0,0,
2,1,3,3,2,4,3,5,5,4,4,0,0,1,125],B=[1,2,3,0,4,17,5,18,33,49,65,6,19,81,97,7,34,113,20,50,129,145,161,8,35,66,177,193,21,82,209,240,36,51,98,114,130,9,10,22,23,24,25,26,37,38,39,40,41,42,52,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,
212,213,214,215,216,217,218,225,226,227,228,229,230,231,232,233,234,241,242,243,244,245,246,247,248,249,250],rg=[0,0,3,1,1,1,1,1,1,1,1,1,0,0,0,0,0],bd=[0,1,2,3,4,5,6,7,8,9,10,11],H=[0,0,2,1,2,4,4,3,4,7,5,4,4,0,1,2,119],I=[0,1,2,3,17,4,5,33,49,6,18,65,81,7,97,113,19,34,50,129,8,20,66,145,161,177,193,9,35,51,82,240,21,98,114,209,10,22,36,52,225,37,241,23,24,25,26,38,39,40,41,42,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,
122,130,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,226,227,228,229,230,231,232,233,234,242,243,244,245,246,247,248,249,250];this.encode=function(c,f){(new Date).getTime();f&&e(f);A=[];F=0;C=7;d(65496);d(65504);d(16);a(74);a(70);a(73);a(70);a(0);a(1);a(1);a(0);d(1);d(1);a(0);a(0);d(65499);d(132);a(0);for(f=0;64>f;f++)a(k[f]);a(1);for(f=
0;64>f;f++)a(l[f]);f=c.width;var h=c.height;d(65472);d(17);a(8);d(h);d(f);a(3);a(1);a(17);a(0);a(2);a(17);a(1);a(3);a(17);a(1);d(65476);d(418);a(0);for(f=0;16>f;f++)a(fa[f+1]);for(f=0;11>=f;f++)a(D[f]);a(16);for(f=0;16>f;f++)a(qg[f+1]);for(f=0;161>=f;f++)a(B[f]);a(1);for(f=0;16>f;f++)a(rg[f+1]);for(f=0;11>=f;f++)a(bd[f]);a(17);for(f=0;16>f;f++)a(H[f+1]);for(f=0;161>=f;f++)a(I[f]);d(65498);d(12);a(3);a(1);a(0);a(2);a(17);a(3);a(17);a(0);a(63);a(0);var y=h=f=0;F=0;C=7;this.encode.displayName="_encode_";
var w=c.data,x=c.height;c=4*c.width;for(var v,T=0,M,E,J,pg,pb;T<x;){for(v=0;v<c;){pg=c*T+v;for(pb=0;64>pb;pb++)E=pb>>3,M=4*(pb&7),J=pg+E*c+M,T+E>=x&&(J-=c*(T+1+E-x)),v+M>=c&&(J-=v+M-c+4),M=w[J++],E=w[J++],J=w[J++],q[pb]=(aa[M]+aa[E+256>>0]+aa[J+512>>0]>>16)-128,G[pb]=(aa[M+768>>0]+aa[E+1024>>0]+aa[J+1280>>0]>>16)-128,K[pb]=(aa[M+1280>>0]+aa[E+1536>>0]+aa[J+1792>>0]>>16)-128;f=g(q,m,f,r,p);h=g(G,n,h,u,t);y=g(K,n,y,u,t);v+=32}T+=8}0<=C&&(c=[],c[1]=C+1,c[0]=(1<<C+1)-1,b(c));d(65497);return new z(A)};
(function(){(new Date).getTime();h||(h=50);for(var a=String.fromCharCode,d=0;256>d;d++)M[d]=a(d);r=c(fa,D);u=c(rg,bd);p=c(qg,B);t=c(H,I);for(var a=1,d=2,b=1;15>=b;b++){for(var g=a;g<d;g++)w[32767+g]=b,y[32767+g]=[],y[32767+g][1]=b,y[32767+g][0]=g;for(g=-(d-1);g<=-a;g++)w[32767+g]=b,y[32767+g]=[],y[32767+g][1]=b,y[32767+g][0]=d-1+g;a<<=1;d<<=1}for(a=0;256>a;a++)aa[a]=19595*a,aa[a+256>>0]=38470*a,aa[a+512>>0]=7471*a+32768,aa[a+768>>0]=-11059*a,aa[a+1024>>0]=-21709*a,aa[a+1280>>0]=32768*a+8421375,aa[a+
1536>>0]=-27439*a,aa[a+1792>>0]=-5329*a;e(h);(new Date).getTime()})()}function sg(h){return!!h.constructor&&"function"===typeof h.constructor.isBuffer&&h.constructor.isBuffer(h)}function qi(h,c){return h[0]-c[0]}function ri(){var h=this.stride,c=Array(h.length),b;for(b=0;b<c.length;++b)c[b]=[Math.abs(h[b]),b];c.sort(qi);h=Array(c.length);for(b=0;b<h.length;++b)h[b]=c[b][1];return h}function si(h,c){var b=["View",c,"d",h].join("");0>c&&(b="View_Nil"+h);var a="generic"===h;if(-1===c){var d;c=new Function("function "+
b+"(a){this.data=a;};var proto="+b+".prototype;proto.dtype='"+h+"';proto.index=function(){return -1};proto.size=0;proto.dimension=-1;proto.shape=proto.stride=proto.order=[];proto.lo=proto.hi=proto.transpose=proto.step=function(){return new "+b+"(this.data);};proto.get=proto.set=function(){};proto.pick=function(){return null};return function construct_"+b+"(a){return new "+b+"(a);}");return c()}if(0===c)return c=new Function("TrivialArray","function "+b+"(a,d) {this.data = a;this.offset = d};var proto="+
b+".prototype;proto.dtype='"+h+"';proto.index=function(){return this.offset};proto.dimension=0;proto.size=1;proto.shape=proto.stride=proto.order=[];proto.lo=proto.hi=proto.transpose=proto.step=function "+b+"_copy() {return new "+b+"(this.data,this.offset)};proto.pick=function "+b+"_pick(){return TrivialArray(this.data);};proto.valueOf=proto.get=function "+b+"_get(){return "+(a?"this.data.get(this.offset)":"this.data[this.offset]")+"};proto.set=function "+b+"_set(v){return "+(a?"this.data.set(this.offset,v)":
"this.data[this.offset]=v")+"};return function construct_"+b+"(a,b,c,d){return new "+b+"(a,d)}"),c(cd[h][0]);d=["'use strict'"];var g=ti(c),e=g.map(function(a){return"i"+a}),f="this.offset+"+g.map(function(a){return"this.stride["+a+"]*i"+a}).join("+"),k=g.map(function(a){return"b"+a}).join(","),l=g.map(function(a){return"c"+a}).join(",");d.push("function "+b+"(a,"+k+","+l+",d){this.data=a","this.shape=["+k+"]","this.stride=["+l+"]","this.offset=d|0}","var proto="+b+".prototype","proto.dtype='"+h+
"'","proto.dimension="+c);d.push("Object.defineProperty(proto,'size',{get:function "+b+"_size(){return "+g.map(function(a){return"this.shape["+a+"]"}).join("*"),"}})");1===c?d.push("proto.order=[0]"):(d.push("Object.defineProperty(proto,'order',{get:"),4>c?(d.push("function "+b+"_order(){"),2===c?d.push("return (Math.abs(this.stride[0])>Math.abs(this.stride[1]))?[1,0]:[0,1]}})"):3===c&&d.push("var s0=Math.abs(this.stride[0]),s1=Math.abs(this.stride[1]),s2=Math.abs(this.stride[2]);if(s0>s1){if(s1>s2){return [2,1,0];}else if(s0>s2){return [1,2,0];}else{return [1,0,2];}}else if(s0>s2){return [2,0,1];}else if(s2>s1){return [0,1,2];}else{return [0,2,1];}}})")):
d.push("ORDER})"));d.push("proto.set=function "+b+"_set("+e.join(",")+",v){");a?d.push("return this.data.set("+f+",v)}"):d.push("return this.data["+f+"]=v}");d.push("proto.get=function "+b+"_get("+e.join(",")+"){");a?d.push("return this.data.get("+f+")}"):d.push("return this.data["+f+"]}");d.push("proto.index=function "+b+"_index(",e.join(),"){return "+f+"}");d.push("proto.hi=function "+b+"_hi("+e.join(",")+"){return new "+b+"(this.data,"+g.map(function(a){return["(typeof i",a,"!=='number'||i",a,
"<0)?this.shape[",a,"]:i",a,"|0"].join("")}).join(",")+","+g.map(function(a){return"this.stride["+a+"]"}).join(",")+",this.offset)}");a=g.map(function(a){return"a"+a+"=this.shape["+a+"]"});f=g.map(function(a){return"c"+a+"=this.stride["+a+"]"});d.push("proto.lo=function "+b+"_lo("+e.join(",")+"){var b=this.offset,d=0,"+a.join(",")+","+f.join(","));for(a=0;a<c;++a)d.push("if(typeof i"+a+"==='number'&&i"+a+">=0){d=i"+a+"|0;b+=c"+a+"*d;a"+a+"-=d}");d.push("return new "+b+"(this.data,"+g.map(function(a){return"a"+
a}).join(",")+","+g.map(function(a){return"c"+a}).join(",")+",b)}");d.push("proto.step=function "+b+"_step("+e.join(",")+"){var "+g.map(function(a){return"a"+a+"=this.shape["+a+"]"}).join(",")+","+g.map(function(a){return"b"+a+"=this.stride["+a+"]"}).join(",")+",c=this.offset,d=0,ceil=Math.ceil");for(a=0;a<c;++a)d.push("if(typeof i"+a+"==='number'){d=i"+a+"|0;if(d<0){c+=b"+a+"*(a"+a+"-1);a"+a+"=ceil(-a"+a+"/d)}else{a"+a+"=ceil(a"+a+"/d)}b"+a+"*=d}");d.push("return new "+b+"(this.data,"+g.map(function(a){return"a"+
a}).join(",")+","+g.map(function(a){return"b"+a}).join(",")+",c)}");f=Array(c);k=Array(c);for(a=0;a<c;++a)f[a]="a[i"+a+"]",k[a]="b[i"+a+"]";d.push("proto.transpose=function "+b+"_transpose("+e+"){"+e.map(function(a,d){return a+"=("+a+"===undefined?"+d+":"+a+"|0)"}).join(";"),"var a=this.shape,b=this.stride;return new "+b+"(this.data,"+f.join(",")+","+k.join(",")+",this.offset)}");d.push("proto.pick=function "+b+"_pick("+e+"){var a=[],b=[],c=this.offset");for(a=0;a<c;++a)d.push("if(typeof i"+a+"==='number'&&i"+
a+">=0){c=(c+this.stride["+a+"]*i"+a+")|0}else{a.push(this.shape["+a+"]);b.push(this.stride["+a+"])}");d.push("var ctor=CTOR_LIST[a.length+1];return ctor(this.data,a,b,c)}");d.push("return function construct_"+b+"(data,shape,stride,offset){return new "+b+"(data,"+g.map(function(a){return"shape["+a+"]"}).join(",")+","+g.map(function(a){return"stride["+a+"]"}).join(",")+",offset)}");c=new Function("CTOR_LIST","ORDER",d.join("\n"));return c(cd[h],ri)}function ui(h){if(null!=h&&(sg(h)||"function"===typeof h.readFloatLE&&
"function"===typeof h.slice&&sg(h.slice(0,0))||h._isBuffer))return"buffer";if(vi)switch(Object.prototype.toString.call(h)){case "[object Float64Array]":return"float64";case "[object Float32Array]":return"float32";case "[object Int8Array]":return"int8";case "[object Int16Array]":return"int16";case "[object Int32Array]":return"int32";case "[object Uint8Array]":return"uint8";case "[object Uint16Array]":return"uint16";case "[object Uint32Array]":return"uint32";case "[object Uint8ClampedArray]":return"uint8_clamped"}return Array.isArray(h)?
"array":"generic"}function wi(h){switch(h){case "uint8":return Uint8Array;case "uint16":return Uint16Array;case "uint32":return Uint32Array;case "int8":return Int8Array;case "int16":return Int16Array;case "int32":return Int32Array;case "float":case "float32":return Float32Array;case "double":case "float64":return Float64Array;case "uint8_clamped":return Uint8ClampedArray;case "generic":case "buffer":case "data":case "dataview":return ArrayBuffer;case "array":return Array}}function xi(h){var c=h.map(function(a){return a.getMetadata("width")});
if(!c.reduce(function(a,b){return a&&b===c[0]},!0))return!1;var b=h.map(function(a){return a.getMetadata("height")});if(!b.reduce(function(a,c){return a&&c===b[0]},!0))return!1;var a=h.map(function(a){return a.getData().constructor});return a.reduce(function(d,b){return d&&b===a[0]},!0)?!0:!1}function tg(h,c,b){var a=h.length,d=c.arrayArgs.length;c=0<c.indexArgs.length;var g=[],e=[],f=0,k,l,m;for(l=0;l<a;++l)e.push(["i",l,"=0"].join(""));for(m=0;m<d;++m)for(l=0;l<a;++l)k=f,f=h[l],0===l?e.push(["d",
m,"s",l,"=t",m,"p",f].join("")):e.push(["d",m,"s",l,"=(t",m,"p",f,"-s",k,"*t",m,"p",k,")"].join(""));0<e.length&&g.push("var "+e.join(","));for(l=a-1;0<=l;--l)f=h[l],g.push(["for(i",l,"=0;i",l,"<s",f,";++i",l,"){"].join(""));g.push(b);for(l=0;l<a;++l){k=f;f=h[l];for(m=0;m<d;++m)g.push(["p",m,"+=d",m,"s",l].join(""));c&&(0<l&&g.push(["index[",k,"]-=s",k].join("")),g.push(["++index[",f,"]"].join("")));g.push("}")}return g.join("\n")}function yi(h,c,b,a){for(var d=c.length,g=b.arrayArgs.length,e=b.blockSize,
f=0<b.indexArgs.length,k=[],l=0;l<g;++l)k.push(["var offset",l,"=p",l].join(""));for(l=h;l<d;++l)k.push(["for(var j"+l+"=SS[",c[l],"]|0;j",l,">0;){"].join("")),k.push(["if(j",l,"<",e,"){"].join("")),k.push(["s",c[l],"=j",l].join("")),k.push(["j",l,"=0"].join("")),k.push(["}else{s",c[l],"=",e].join("")),k.push(["j",l,"-=",e,"}"].join("")),f&&k.push(["index[",c[l],"]=j",l].join(""));for(l=0;l<g;++l){e=["offset"+l];for(f=h;f<d;++f)e.push(["j",f,"*t",l,"p",c[f]].join(""));k.push(["p",l,"=(",e.join("+"),
")"].join(""))}k.push(tg(c,b,a));for(l=h;l<d;++l)k.push("}");return k.join("\n")}function Xd(h,c,b){for(var a=h.body,d=[],g=[],e=0;e<h.args.length;++e){var f=h.args[e];if(!(0>=f.count)){var k=new RegExp(f.name,"g"),l="",m=c.arrayArgs.indexOf(e);switch(c.argTypes[e]){case "offset":var n=c.offsetArgIndex.indexOf(e),m=c.offsetArgs[n].array,l="+q"+n;case "array":var l="p"+m+l,r="l"+e,n="a"+m;if(0===c.arrayBlockIndices[m])1===f.count?"generic"===b[m]?f.lvalue?(d.push(["var ",r,"=",n,".get(",l,")"].join("")),
a=a.replace(k,r),g.push([n,".set(",l,",",r,")"].join(""))):a=a.replace(k,[n,".get(",l,")"].join("")):a=a.replace(k,[n,"[",l,"]"].join("")):"generic"===b[m]?(d.push(["var ",r,"=",n,".get(",l,")"].join("")),a=a.replace(k,r),f.lvalue&&g.push([n,".set(",l,",",r,")"].join(""))):(d.push(["var ",r,"=",n,"[",l,"]"].join("")),a=a.replace(k,r),f.lvalue&&g.push([n,"[",l,"]=",r].join("")));else{k=[f.name];f=[l];for(l=0;l<Math.abs(c.arrayBlockIndices[m]);l++)k.push("\\s*\\[([^\\]]+)\\]"),f.push("$"+(l+1)+"*t"+
m+"b"+l);k=new RegExp(k.join(""),"g");l=f.join("+");if("generic"===b[m])throw Error("cwise: Generic arrays not supported in combination with blocks!");a=a.replace(k,[n,"[",l,"]"].join(""))}break;case "scalar":a=a.replace(k,"Y"+c.scalarArgs.indexOf(e));break;case "index":a=a.replace(k,"index");break;case "shape":a=a.replace(k,"shape")}}}return[d.join("\n"),a,g.join("\n")].join("\n").trim()}function zi(h){for(var c=Array(h.length),b=!0,a=0;a<h.length;++a){var d=h[a],g=d.match(/\d+/),g=g?g[0]:"";0===
d.charAt(0)?c[a]="u"+d.charAt(1)+g:c[a]=d.charAt(0)+g;0<a&&(b=b&&c[a]===c[a-1])}return b?c[0]:c.join("")}function Ai(){this.argTypes=[];this.shimArgs=[];this.arrayArgs=[];this.arrayBlockIndices=[];this.scalarArgs=[];this.offsetArgs=[];this.offsetArgIndex=[];this.indexArgs=[];this.shapeArgs=[];this.funcName="";this.post=this.body=this.pre=null;this.debug=!1}function ug(h){var c=32;(h&=-h)&&c--;h&65535&&(c-=16);h&16711935&&(c-=8);h&252645135&&(c-=4);h&858993459&&(c-=2);h&1431655765&&--c;return c}function vg(h,
c,b){var a=h[b]|0;if(0>=a)return[];var d=Array(a),g;if(b===h.length-1)for(g=0;g<a;++g)d[g]=c;else for(g=0;g<a;++g)d[g]=vg(h,c,b+1);return d}function dd(h,c,b,a,d,g){h|=0;c|=0;b|=0;d|=0;g|=0;var e,f,k,l,m,n,r,u,p,t,y,w,x,v,A,F,C,q;e=b;f=Ba.log2(e);for(A=0;A<c;++A){l=e>>1;for(k=m=0;k<e-1;k++){k<m&&(n=a[d+k],a[d+k]=a[d+m],a[d+m]=n,n=a[g+k],a[g+k]=a[g+m],a[g+m]=n);for(n=l;n<=m;)m-=n,n>>=1;m+=n}p=-1;t=0;u=1;for(n=0;n<f;n++){r=u;u<<=1;x=1;for(m=v=0;m<r;m++){for(k=m;k<e;k+=u)l=k+r,F=a[d+l],y=a[g+l],C=a[d+
k],q=a[g+k],w=x*(F+y),F*=v-x,y*=x+v,y=w-y,w+=F,a[d+l]=C-y,a[g+l]=q-w,a[d+k]+=y,a[g+k]+=w;w=p*(x+v);F=x*(t-p);y=v*(p+t);x=w-y;v=w+F}t=Math.sqrt((1-p)/2);0>h&&(t=-t);p=Math.sqrt((1+p)/2)}if(0>h)for(m=1/e,k=0;k<e;k++)a[d+k]*=m,a[g+k]*=m;d+=b;g+=b}}var La="undefined"!==typeof Float32Array?Float32Array:Array;(function(){var h=S();return function(c,b,a,d,g,e){b||(b=3);a||(a=0);for(d=d?Math.min(d*b+a,c.length):c.length;a<d;a+=b)h[0]=c[a],h[1]=c[a+1],h[2]=c[a+2],g(h,h,e),c[a]=h[0],c[a+1]=h[1],c[a+2]=h[2];
return c}})();(function(){var h=oe();return function(c,b,a,d,g,e){b||(b=4);a||(a=0);for(d=d?Math.min(d*b+a,c.length):c.length;a<d;a+=b)h[0]=c[a],h[1]=c[a+1],h[2]=c[a+2],h[3]=c[a+3],g(h,h,e),c[a]=h[0],c[a+1]=h[1],c[a+2]=h[2],c[a+3]=h[3];return c}})();var wg=function(h,c){var b=c[0],a=c[1],d=c[2];c=c[3];var g=b*b+a*a+d*d+c*c;0<g&&(g=1/Math.sqrt(g),h[0]=b*g,h[1]=a*g,h[2]=d*g,h[3]=c*g);return h};(function(){var h=S(),c=ga(1,0,0),b=ga(0,1,0);return function(a,d,g){var e=d[0]*g[0]+d[1]*g[1]+d[2]*g[2];if(-.999999>
e){Ea(h,c,d);g=h[0];var e=h[1],f=h[2];1E-6>Math.sqrt(g*g+e*e+f*f)&&Ea(h,b,d);d=h[0];g=h[1];e=h[2];d=d*d+g*g+e*e;0<d&&(d=1/Math.sqrt(d),h[0]*=d,h[1]*=d,h[2]*=d);d=Math.PI;d*=.5;g=Math.sin(d);a[0]=g*h[0];a[1]=g*h[1];a[2]=g*h[2];a[3]=Math.cos(d);return a}if(.999999<e)return a[0]=0,a[1]=0,a[2]=0,a[3]=1,a;Ea(h,d,g);a[0]=h[0];a[1]=h[1];a[2]=h[2];a[3]=1+e;return wg(a,a)}})();(function(){var h=od(),c=od();return function(b,a,d,g,e,f){pd(h,a,e,f);pd(c,d,g,f);pd(b,h,c,2*f*(1-f));return b}})();(function(){var h=
D();return function(c,b,a,d){h[0]=a[0];h[3]=a[1];h[6]=a[2];h[1]=d[0];h[4]=d[1];h[7]=d[2];h[2]=-b[0];h[5]=-b[1];h[8]=-b[2];b=h[0]+h[4]+h[8];if(0<b)b=Math.sqrt(b+1),c[3]=.5*b,b=.5/b,c[0]=(h[5]-h[7])*b,c[1]=(h[6]-h[2])*b,c[2]=(h[1]-h[3])*b;else{a=0;h[4]>h[0]&&(a=1);h[8]>h[3*a+a]&&(a=2);d=(a+1)%3;var g=(a+2)%3;b=Math.sqrt(h[3*a+a]-h[3*d+d]-h[3*g+g]+1);c[a]=.5*b;b=.5/b;c[3]=(h[3*d+g]-h[3*g+d])*b;c[d]=(h[3*d+a]+h[3*a+d])*b;c[g]=(h[3*g+a]+h[3*a+g])*b}return wg(c,c)}})();(function(){var h=pe();return function(c,
b,a,d,g,e){b||(b=2);a||(a=0);for(d=d?Math.min(d*b+a,c.length):c.length;a<d;a+=b)h[0]=c[a],h[1]=c[a+1],g(h,h,e),c[a]=h[0],c[a+1]=h[1];return c}})();var O="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(h){return typeof h}:function(h){return h&&"function"===typeof Symbol&&h.constructor===Symbol&&h!==Symbol.prototype?"symbol":typeof h},I=function(h,c){if(!(h instanceof c))throw new TypeError("Cannot call a class as a function");},N=function(){function h(c,b){for(var a=0;a<b.length;a++){var d=
b[a];d.enumerable=d.enumerable||!1;d.configurable=!0;"value"in d&&(d.writable=!0);Object.defineProperty(c,d.key,d)}}return function(c,b,a){b&&h(c.prototype,b);a&&h(c,a);return c}}(),xg=function c(b,a,d){null===b&&(b=Function.prototype);var g=Object.getOwnPropertyDescriptor(b,a);if(void 0===g){if(b=Object.getPrototypeOf(b),null!==b)return c(b,a,d)}else{if("value"in g)return g.value;a=g.get;return void 0===a?void 0:a.call(d)}},L=function(c,b){if("function"!==typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function, not "+
typeof b);c.prototype=Object.create(b&&b.prototype,{constructor:{value:c,enumerable:!1,writable:!0,configurable:!0}});b&&(Object.setPrototypeOf?Object.setPrototypeOf(c,b):c.__proto__=b)},P=function(c,b){if(!c)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!b||"object"!==typeof b&&"function"!==typeof b?c:b},Bi=function(c){if(Array.isArray(c)){for(var b=0,a=Array(c.length);b<c.length;b++)a[b]=c[b];return a}return Array.from(c)},Yd={},Za=function(){function c(){I(this,
c)}N(c,null,[{key:"addCoreType",value:function(b){"function"===typeof b&&(Yd[b.name]=b)}},{key:"getCoreType",value:function(b){return b in Yd?Yd[b]:null}}]);return c}(),Hb="undefined"!==typeof window?window:"undefined"!==typeof global?global:"undefined"!==typeof self?self:{},da=ma(function(c,b){(function(a,d){c.exports=d()})(Hb,function(){return function(a){function d(c){if(b[c])return b[c].exports;var g=b[c]={exports:{},id:c,loaded:!1};a[c].call(g.exports,g,g.exports,d);g.loaded=!0;return g.exports}
var b={};d.m=a;d.c=b;d.p="";return d(0)}([function(a,d,b){d=b(1);a.exports=d},function(a,d,b){function c(a,d,b){d in a?Object.defineProperty(a,d,{value:b,enumerable:!0,configurable:!0,writable:!0}):a[d]=b;return a}function g(a,d){if("function"!==typeof d&&null!==d)throw new TypeError("Super expression must either be null or a function, not "+("undefined"===typeof d?"undefined":O(d)));a.prototype=Object.create(d&&d.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}});if(d)if(Object.setPrototypeOf)Object.setPrototypeOf(a,
d);else for(var b=Object.getOwnPropertyNames(d),c=0;c<b.length;c++){var g=b[c],e=Object.getOwnPropertyDescriptor(d,g);e&&e.configurable&&void 0===a[g]&&Object.defineProperty(a,g,e)}}var k=Object.assign||function(a){for(var d=1;d<arguments.length;d++){var b=arguments[d],c;for(c in b)Object.prototype.hasOwnProperty.call(b,c)&&(a[c]=b[c])}return a},l=b(2),m=b(11),n=b(16),r=b(13),u=b(29),p=b(12),t={alternatives:b(25),array:b(30),boolean:b(24),binary:b(31),date:b(17),number:b(23),object:b(26),string:b(18),
root:function(){var a=new m,d=a.clone();d.any=function(){l.assert(0===arguments.length,"Joi.any() does not allow arguments.");return a};d.alternatives=d.alt=function(){return arguments.length?t.alternatives.try.apply(t.alternatives,arguments):t.alternatives};d.array=function(){l.assert(0===arguments.length,"Joi.array() does not allow arguments.");return t.array};d.boolean=d.bool=function(){l.assert(0===arguments.length,"Joi.boolean() does not allow arguments.");return t.boolean};d.binary=function(){l.assert(0===
arguments.length,"Joi.binary() does not allow arguments.");return t.binary};d.date=function(){l.assert(0===arguments.length,"Joi.date() does not allow arguments.");return t.date};d.func=function(){l.assert(0===arguments.length,"Joi.func() does not allow arguments.");return t.object._func()};d.number=function(){l.assert(0===arguments.length,"Joi.number() does not allow arguments.");return t.number};d.object=function(){return arguments.length?t.object.keys.apply(t.object,arguments):t.object};d.string=
function(){l.assert(0===arguments.length,"Joi.string() does not allow arguments.");return t.string};d.ref=function(){return p.create.apply(null,arguments)};d.isRef=function(a){return p.isRef(a)};d.validate=function(b){var c=arguments[arguments.length-1],c="function"===typeof c?c:null,g=arguments.length-(c?1:0);if(1===g)return a.validate(b,c);g=3===g?arguments[2]:{};return d.compile(arguments[1])._validateWithOptions(b,g,c)};d.describe=function(){return(arguments.length?d.compile(arguments[0]):a).describe()};
d.compile=function(a){try{return n.schema(a)}catch(v){throw v.hasOwnProperty("path")&&(v.message=v.message+"("+v.path+")"),v;}};d.assert=function(a,b,c){d.attempt(a,b,c)};d.attempt=function(a,b,c){a=d.validate(a,b);if(b=a.error){if(!c)throw"function"===typeof b.annotate&&(b.message=b.annotate()),b;if(!(c instanceof Error))throw"function"===typeof b.annotate&&(b.message=c+" "+b.annotate()),b;throw c;}return a.value};d.reach=function(a,d){l.assert(a&&a instanceof m,"you must provide a joi schema");
l.assert("string"===typeof d,"path must be a string");if(""===d)return a;var b=d.split(".");if(a=a._inner.children)for(var b=b[0],c=0;c<a.length;++c){var g=a[c];if(g.key===b)return this.reach(g.schema,d.substr(b.length+1))}};d.lazy=function(a){return u.set(a)};d.extend=function(){var a=this,b=l.flatten(Array.prototype.slice.call(arguments));l.assert(0<b.length,"You need to provide at least one extension");this.assert(b,d.extensionsSchema);var e=Object.create(this.any());k(e,this);for(var f=function(f){var t=
b[f];"function"===typeof t&&(t=t(e));a.assert(t,d.extensionSchema);var y=(t.base||a.any()).clone(),w=y.constructor,u=function(a){function d(){if(!(this instanceof d))throw new TypeError("Cannot call a class as a function");var b;b=a.call(this);if(!this)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");b=!b||"object"!==("undefined"===typeof b?"undefined":O(b))&&"function"!==typeof b?this:b;t.base&&k(b,y);b._type=t.name;t.language&&(b._settings=b._settings||{language:{}},
b._settings.language=l.applyToDefaults(b._settings.language,c({},t.name,t.language)));return b}g(d,a);return d}(w);t.coerce&&(u.prototype._coerce=function(a,d,b){if(w.prototype._coerce){a=w.prototype._coerce.call(this,a,d,b);if(a.errors)return a;a=a.value}d=t.coerce.call(this,a,d,b);return d instanceof r.Err?{value:a,errors:d}:{value:d}});t.pre&&(u.prototype._base=function(a,d,b){if(w.prototype._base){a=w.prototype._base.call(this,a,d,b);if(a.errors)return a;a=a.value}d=t.pre.call(this,a,d,b);return d instanceof
r.Err?{value:a,errors:d}:{value:d}});if(t.rules){f=function(a){var d=t.rules[a],b=d.params?d.params instanceof m?d.params._inner.children.map(function(a){return a.key}):Object.keys(d.params):[],c=d.params?n.schema(d.params):null;u.prototype[d.name]=function(){if(arguments.length>b.length)throw Error("Unexpected number of arguments");for(var a=Array.prototype.slice.call(arguments),g=!1,f={},k=0;k<b.length;++k)f[b[k]]=a[k],!g&&p.isRef(a[k])&&(g=!0);c&&(f=e.attempt(f,c));a=void 0;a=d.validate?this._test(d.name,
f,function(a,b,c){return d.validate.call(this,f,a,b,c)},{description:d.description,hasRef:g}):this.clone();d.setup&&(g=d.setup.call(a,f),void 0!==g&&(l.assert(g instanceof m,"Setup of extension Joi."+this._type+"()."+d.name+"() must return undefined or a Joi object"),a=g));return a}};for(var x=0;x<t.rules.length;++x)f(x)}t.describe&&(u.prototype.describe=function(){var a=w.prototype.describe.call(this);return t.describe.call(this,a)});var v=new u;e[t.name]=function(){return v}},t=0;t<b.length;++t)f(t);
return e};d.extensionSchema=t.object.keys({base:t.object.type(m,"Joi object"),name:t.string.required(),coerce:t.object._func().arity(3),pre:t.object._func().arity(3),language:t.object,describe:t.object._func().arity(1),rules:t.array.items(t.object.keys({name:t.string.required(),setup:t.object._func().arity(1),validate:t.object._func().arity(4),params:[t.object.pattern(/.*/,t.object.type(m,"Joi object")),t.object.type(t.object.constructor,"Joi object")],description:[t.string,t.object._func().arity(1)]}).or("setup",
"validate"))}).strict();d.extensionsSchema=t.array.items([t.object,t.object._func().arity(1)]).strict();d.version=b(32).version;return d}};a.exports=t.root()},function(a,d,b){(function(a,c){var g="function"===typeof Symbol&&"symbol"===O(Symbol.iterator)?function(a){return"undefined"===typeof a?"undefined":O(a)}:function(a){return a&&"function"===typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":"undefined"===typeof a?"undefined":O(a)},e=b(5),f=b(6),n=b(7),r=b(10),u={};d.clone=function(b,
c){if("object"!==("undefined"===typeof b?"undefined":g(b))||null===b)return b;c=c||new Map;var e=c.get(b);if(e)return e;var f=!1;Array.isArray(b)?(e=[],f=!0):a.isBuffer(b)?e=new a(b):b instanceof Date?e=new Date(b.getTime()):b instanceof RegExp?e=new RegExp(b):(e=Object.getPrototypeOf(b))&&e.isImmutable?e=b:(e=Object.create(e),f=!0);c.set(b,e);if(f)for(var f=Object.getOwnPropertyNames(b),p=0;p<f.length;++p){var k=f[p],t=Object.getOwnPropertyDescriptor(b,k);t&&(t.get||t.set)?Object.defineProperty(e,
k,t):e[k]=d.clone(b[k],c)}return e};d.merge=function(b,c,e,f){d.assert(b&&"object"===("undefined"===typeof b?"undefined":g(b)),"Invalid target value: must be an object");d.assert(null===c||void 0===c||"object"===("undefined"===typeof c?"undefined":g(c)),"Invalid source value: must be null, undefined, or an object");if(!c)return b;if(Array.isArray(c)){d.assert(Array.isArray(b),"Cannot merge array onto an object");!1===f&&(b.length=0);for(e=0;e<c.length;++e)b.push(d.clone(c[e]));return b}for(var p=
Object.keys(c),k=0;k<p.length;++k){var t=p[k],n=c[t];n&&"object"===("undefined"===typeof n?"undefined":g(n))?!b[t]||"object"!==g(b[t])||Array.isArray(b[t])!==Array.isArray(n)||n instanceof Date||a.isBuffer(n)||n instanceof RegExp?b[t]=d.clone(n):d.merge(b[t],n,e,f):null!==n&&void 0!==n?b[t]=n:!1!==e&&(b[t]=n)}return b};d.applyToDefaults=function(a,b,c){d.assert(a&&"object"===("undefined"===typeof a?"undefined":g(a)),"Invalid defaults value: must be an object");d.assert(!b||!0===b||"object"===("undefined"===
typeof b?"undefined":g(b)),"Invalid options value: must be true, falsy or an object");if(!b)return null;a=d.clone(a);return!0===b?a:d.merge(a,b,!0===c,!1)};d.cloneWithShallow=function(a,b){if(!a||"object"!==("undefined"===typeof a?"undefined":g(a)))return a;b=u.store(a,b);var c=d.clone(a);u.restore(c,a,b);return c};u.store=function(a,b){for(var c={},g=0;g<b.length;++g){var e=b[g],f=d.reach(a,e);void 0!==f&&(c[e]=f,u.reachSet(a,e,void 0))}return c};u.restore=function(a,d,b){for(var c=Object.keys(b),
g=0;g<c.length;++g){var e=c[g];u.reachSet(a,e,b[e]);u.reachSet(d,e,b[e])}};u.reachSet=function(a,d,b){d=d.split(".");for(var c=0;c<d.length;++c){var g=d[c];c+1===d.length&&(a[g]=b);a=a[g]}};d.applyToDefaultsWithShallow=function(a,b,c){d.assert(a&&"object"===("undefined"===typeof a?"undefined":g(a)),"Invalid defaults value: must be an object");d.assert(!b||!0===b||"object"===("undefined"===typeof b?"undefined":g(b)),"Invalid options value: must be true, falsy or an object");d.assert(c&&Array.isArray(c),
"Invalid keys");if(!b)return null;a=d.cloneWithShallow(a,c);if(!0===b)return a;c=u.store(b,c);d.merge(a,b,!1,!1);u.restore(a,b,c);return a};d.deepEqual=function(b,c,e,f){e=e||{prototype:!0};var p="undefined"===typeof b?"undefined":g(b);if(p!==("undefined"===typeof c?"undefined":g(c)))return!1;if("object"!==p||null===b||null===c)return b===c?0!==b||1/b===1/c:b!==b&&c!==c;f=f||[];if(-1!==f.indexOf(b))return!0;f.push(b);if(Array.isArray(b)){if(!Array.isArray(c)||!e.part&&b.length!==c.length)return!1;
for(f=0;f<b.length;++f){if(e.part){for(var p=!1,k=0;k<c.length;++k)if(d.deepEqual(b[f],c[k],e)){p=!0;break}return p}if(!d.deepEqual(b[f],c[f],e))return!1}return!0}if(a.isBuffer(b)){if(!a.isBuffer(c)||b.length!==c.length)return!1;for(e=0;e<b.length;++e)if(b[e]!==c[e])return!1;return!0}if(b instanceof Date)return c instanceof Date&&b.getTime()===c.getTime();if(b instanceof RegExp)return c instanceof RegExp&&b.toString()===c.toString();if(e.prototype&&Object.getPrototypeOf(b)!==Object.getPrototypeOf(c))return!1;
p=Object.getOwnPropertyNames(b);if(!e.part&&p.length!==Object.getOwnPropertyNames(c).length)return!1;for(k=0;k<p.length;++k){var n=p[k],t=Object.getOwnPropertyDescriptor(b,n);if(t.get){if(!d.deepEqual(t,Object.getOwnPropertyDescriptor(c,n),e,f))return!1}else if(!d.deepEqual(b[n],c[n],e,f))return!1}return!0};d.unique=function(a,d){var b=void 0;d?function(){b=[];var c=new Set;a.forEach(function(a){var g=a[d];c.has(g)||(c.add(g),b.push(a))})}():b=Array.from(new Set(a));return b};d.mapToObject=function(a,
d){if(!a)return null;for(var b={},c=0;c<a.length;++c)d?a[c][d]&&(b[a[c][d]]=!0):b[a[c]]=!0;return b};d.intersect=function(a,b,c){if(!a||!b)return[];var g=[];a=Array.isArray(a)?d.mapToObject(a):a;for(var e={},f=0;f<b.length;++f)if(a[b[f]]&&!e[b[f]]){if(c)return b[f];g.push(b[f]);e[b[f]]=!0}return c?null:g};d.contain=function(a,b,c){var e=null;"object"!==("undefined"===typeof a?"undefined":g(a))||"object"!==("undefined"===typeof b?"undefined":g(b))||Array.isArray(a)||Array.isArray(b)?b=[].concat(b):
(e=b,b=Object.keys(b));c=c||{};d.assert(2<=arguments.length,"Insufficient arguments");d.assert("string"===typeof a||"object"===("undefined"===typeof a?"undefined":g(a)),"Reference must be string or an object");d.assert(b.length,"Values array cannot be empty");var f=void 0,k=void 0;if(c.deep)var f=d.deepEqual,p=c.hasOwnProperty("only"),k=c.hasOwnProperty("part"),k={prototype:p?c.only:k?!c.part:!1,part:p?!c.only:k?c.part:!0};else f=function(a,d){return a===d};for(var p=!1,n=Array(b.length),l=0;l<n.length;++l)n[l]=
0;if("string"===typeof a){f="(";for(p=0;p<b.length;++p)k=b[p],d.assert("string"===typeof k,"Cannot compare string reference to non-string value"),f+=(p?"|":"")+d.escapeRegex(k);p=!!a.replace(new RegExp(f+")","g"),function(a,d){a=b.indexOf(d);++n[a];return""})}else if(Array.isArray(a))for(e=0;e<a.length;++e){for(var l=!1,t=0;t<b.length&&!1===l;++t)l=f(b[t],a[e],k)&&t;!1!==l?++n[l]:p=!0}else for(l=Object.getOwnPropertyNames(a),t=0;t<l.length;++t){var m=l[t],r=b.indexOf(m);if(-1!==r){if(e&&!f(e[m],a[m],
k))return!1;++n[r]}else p=!0}f=!1;for(k=0;k<n.length;++k)if(f=f||!!n[k],c.once&&1<n[k]||!c.part&&!n[k])return!1;return c.only&&p?!1:f};d.flatten=function(a,b){b=b||[];for(var c=0;c<a.length;++c)Array.isArray(a[c])?d.flatten(a[c],b):b.push(a[c]);return b};d.reach=function(a,b,c){if(!1===b||null===b||"undefined"===typeof b)return a;c=c||{};"string"===typeof c&&(c={separator:c});for(var e=b.split(c.separator||"."),f=0;f<e.length;++f){var k=e[f];"-"===k[0]&&Array.isArray(a)&&(k=k.slice(1,k.length),k=
a.length-k);if(!a||"object"!==("undefined"===typeof a?"undefined":g(a))&&"function"!==typeof a||!(k in a)||"object"!==("undefined"===typeof a?"undefined":g(a))&&!1===c.functions){d.assert(!c.strict||f+1===e.length,"Missing segment",k,"in reach path ",b);d.assert("object"===("undefined"===typeof a?"undefined":g(a))||!0===c.functions||"function"!==typeof a,"Invalid segment",k,"in reach path ",b);a=c.default;break}a=a[k]}return a};d.reachTemplate=function(a,b,c){return b.replace(/{([^}]+)}/g,function(b,
g){b=d.reach(a,g,c);return void 0===b||null===b?"":b})};d.formatStack=function(a){for(var d=[],b=0;b<a.length;++b){var c=a[b];d.push([c.getFileName(),c.getLineNumber(),c.getColumnNumber(),c.getFunctionName(),c.isConstructor()])}return d};d.formatTrace=function(a){for(var d=[],b=0;b<a.length;++b){var c=a[b];d.push((c[4]?"new ":"")+c[3]+" ("+c[0]+":"+c[1]+":"+c[2]+")")}return d};d.callStack=function(a){var b=Error.prepareStackTrace;Error.prepareStackTrace=function(a,d){return d};var c={};Error.captureStackTrace(c,
this);c=c.stack;Error.prepareStackTrace=b;return d.formatStack(c).slice(1+a)};d.displayStack=function(a){a=d.callStack(void 0===a?1:a+1);return d.formatTrace(a)};d.abortThrow=!1;d.abort=function(a,b){if("test"===c.env.NODE_ENV||!0===d.abortThrow)throw Error(a||"Unknown error");var g="";b||(g=d.displayStack(1).join("\n\t"));console.log("ABORT: "+a+"\n\t"+g);c.exit(1)};d.assert=function(a){if(!a){if(2===arguments.length&&arguments[1]instanceof Error)throw arguments[1];for(var b=[],c=1;c<arguments.length;++c)""!==
arguments[c]&&b.push(arguments[c]);b=b.map(function(a){return"string"===typeof a?a:a instanceof Error?a.message:d.stringify(a)});throw Error(b.join(" ")||"Unknown error");}};d.Timer=function(){this.ts=0;this.reset()};d.Timer.prototype.reset=function(){this.ts=Date.now()};d.Timer.prototype.elapsed=function(){return Date.now()-this.ts};d.Bench=function(){this.ts=0;this.reset()};d.Bench.prototype.reset=function(){this.ts=d.Bench.now()};d.Bench.prototype.elapsed=function(){return d.Bench.now()-this.ts};
d.Bench.now=function(){var a=c.hrtime();return 1E3*a[0]+a[1]/1E6};d.escapeRegex=function(a){return a.replace(/[\^\$\.\*\+\-\?\=\!\:\|\\\/\(\)\[\]\{\}\,]/g,"\\$&")};d.base64urlEncode=function(b,c){d.assert("string"===typeof b||a.isBuffer(b),"value must be string or buffer");return(a.isBuffer(b)?b:new a(b,c||"binary")).toString("base64").replace(/\+/g,"-").replace(/\//g,"_").replace(/\=/g,"")};d.base64urlDecode=function(d,b){if("string"!==typeof d)return Error("Value not a string");if(!/^[\w\-]*$/.test(d))return Error("Invalid character");
d=new a(d,"base64");return"buffer"===b?d:d.toString(b||"binary")};d.escapeHeaderAttribute=function(a){d.assert(/^[ \w\!#\$%&'\(\)\*\+,\-\.\/\:;<\=>\?@\[\]\^`\{\|\}~\"\\]*$/.test(a),"Bad attribute value ("+a+")");return a.replace(/\\/g,"\\\\").replace(/\"/g,'\\"')};d.escapeHtml=function(a){return r.escapeHtml(a)};d.escapeJavaScript=function(a){return r.escapeJavaScript(a)};d.nextTick=function(a){return function(){var d=arguments;c.nextTick(function(){a.apply(null,d)})}};d.once=function(a){if(a._hoekOnce)return a;
var d=!1,b=function(){d||(d=!0,a.apply(null,arguments))};b._hoekOnce=!0;return b};d.isInteger=Number.isSafeInteger;d.ignore=function(){};d.inherits=n.inherits;d.format=n.format;d.transform=function(a,b,c){d.assert(null===a||void 0===a||"object"===("undefined"===typeof a?"undefined":g(a))||Array.isArray(a),"Invalid source object: must be null, undefined, an object, or an array");var e="object"===("undefined"===typeof c?"undefined":g(c))&&null!==c?c.separator||".":".";if(Array.isArray(a)){for(var e=
[],f=0;f<a.length;++f)e.push(d.transform(a[f],b,c));return e}for(var f={},k=Object.keys(b),p=0;p<k.length;++p){var n=k[p],l=n.split(e),n=b[n];d.assert("string"===typeof n,'All mappings must be "." delineated strings');for(var m,t=f;1<l.length;)m=l.shift(),t[m]||(t[m]={}),t=t[m];m=l.shift();t[m]=d.reach(a,n,c)}return f};d.uniqueFilename=function(a,d){d=d?"."!==d[0]?"."+d:d:"";a=f.resolve(a);d=[Date.now(),c.pid,e.randomBytes(8).toString("hex")].join("-")+d;return f.join(a,d)};d.stringify=function(){try{return JSON.stringify.apply(null,
arguments)}catch(p){return"[Cannot display object: "+p.message+"]"}};d.shallow=function(a){for(var d={},b=Object.keys(a),c=0;c<b.length;++c){var g=b[c];d[g]=a[g]}return d}}).call(d,b(3).Buffer,b(4))},function(a,d){function b(){throw Error("Buffer is not included.");}b.isBuffer=function(){return!1};d.INSPECT_MAX_BYTES=50;d.SlowBuffer=b;d.Buffer=b},function(a,d){function b(){throw Error("setTimeout has not been defined");}function c(){throw Error("clearTimeout has not been defined");}function f(a){if(u===
setTimeout)return setTimeout(a,0);if((u===b||!u)&&setTimeout)return u=setTimeout,setTimeout(a,0);try{return u(a,0)}catch(A){try{return u.call(null,a,0)}catch(F){return u.call(this,a,0)}}}function k(a){if(p===clearTimeout)return clearTimeout(a);if((p===c||!p)&&clearTimeout)return p=clearTimeout,clearTimeout(a);try{return p(a)}catch(A){try{return p.call(null,a)}catch(F){return p.call(this,a)}}}function l(){y&&w&&(y=!1,w.length?t=w.concat(t):x=-1,t.length&&m())}function m(){if(!y){var a=f(l);y=!0;for(var d=
t.length;d;){w=t;for(t=[];++x<d;)w&&w[x].run();x=-1;d=t.length}w=null;y=!1;k(a)}}function n(a,d){this.fun=a;this.array=d}function r(){}a=a.exports={};var u,p;try{u="function"===typeof setTimeout?setTimeout:b}catch(v){u=b}try{p="function"===typeof clearTimeout?clearTimeout:c}catch(v){p=c}var t=[],y=!1,w,x=-1;a.nextTick=function(a){var d=Array(arguments.length-1);if(1<arguments.length)for(var b=1;b<arguments.length;b++)d[b-1]=arguments[b];t.push(new n(a,d));1!==t.length||y||f(m)};n.prototype.run=function(){this.fun.apply(null,
this.array)};a.title="browser";a.browser=!0;a.env={};a.argv=[];a.version="";a.versions={};a.on=r;a.addListener=r;a.once=r;a.off=r;a.removeListener=r;a.removeAllListeners=r;a.emit=r;a.binding=function(a){throw Error("process.binding is not supported");};a.cwd=function(){return"/"};a.chdir=function(a){throw Error("process.chdir is not supported");};a.umask=function(){return 0}},function(a,d){},function(a,d,b){(function(a){function b(a,d){for(var b=0,c=a.length-1;0<=c;c--){var g=a[c];"."===g?a.splice(c,
1):".."===g?(a.splice(c,1),b++):b&&(a.splice(c,1),b--)}if(d)for(;b--;b)a.unshift("..");return a}function c(a,d){if(a.filter)return a.filter(d);for(var b=[],c=0;c<a.length;c++)d(a[c],c,a)&&b.push(a[c]);return b}var g=/^(\/?|)([\s\S]*?)((?:\.{1,2}|[^\/]+?|)(\.[^.\/]*|))(?:[\/]*)$/;d.resolve=function(){for(var d="",g=!1,e=arguments.length-1;-1<=e&&!g;e--){var f=0<=e?arguments[e]:a.cwd();if("string"!==typeof f)throw new TypeError("Arguments to path.resolve must be strings");f&&(d=f+"/"+d,g="/"===f.charAt(0))}d=
b(c(d.split("/"),function(a){return!!a}),!g).join("/");return(g?"/":"")+d||"."};d.normalize=function(a){var g=d.isAbsolute(a),f="/"===e(a,-1);(a=b(c(a.split("/"),function(a){return!!a}),!g).join("/"))||g||(a=".");a&&f&&(a+="/");return(g?"/":"")+a};d.isAbsolute=function(a){return"/"===a.charAt(0)};d.join=function(){var a=Array.prototype.slice.call(arguments,0);return d.normalize(c(a,function(a,d){if("string"!==typeof a)throw new TypeError("Arguments to path.join must be strings");return a}).join("/"))};
d.relative=function(a,b){function c(a){for(var d=0;d<a.length&&""===a[d];d++);for(var b=a.length-1;0<=b&&""===a[b];b--);return d>b?[]:a.slice(d,b-d+1)}a=d.resolve(a).substr(1);b=d.resolve(b).substr(1);a=c(a.split("/"));b=c(b.split("/"));for(var g=Math.min(a.length,b.length),e=g,f=0;f<g;f++)if(a[f]!==b[f]){e=f;break}g=[];for(f=e;f<a.length;f++)g.push("..");g=g.concat(b.slice(e));return g.join("/")};d.sep="/";d.delimiter=":";d.dirname=function(a){var d=g.exec(a).slice(1);a=d[0];d=d[1];if(!a&&!d)return".";
d&&(d=d.substr(0,d.length-1));return a+d};d.basename=function(a,d){a=g.exec(a).slice(1)[2];d&&a.substr(-1*d.length)===d&&(a=a.substr(0,a.length-d.length));return a};d.extname=function(a){return g.exec(a).slice(1)[3]};var e="b"==="ab".substr(-1)?function(a,d,b){return a.substr(d,b)}:function(a,d,b){0>d&&(d=a.length+d);return a.substr(d,b)}}).call(d,b(4))},function(a,d,b){(function(a,c){function g(a,b){var c={seen:[],stylize:f};3<=arguments.length&&(c.depth=arguments[2]);4<=arguments.length&&(c.colors=
arguments[3]);v(b)?c.showHidden=b:b&&d._extend(c,b);C(c.showHidden)&&(c.showHidden=!1);C(c.depth)&&(c.depth=2);C(c.colors)&&(c.colors=!1);C(c.customInspect)&&(c.customInspect=!0);c.colors&&(c.stylize=e);return r(c,a,c.depth)}function e(a,d){return(d=g.styles[d])?"\u001b["+g.colors[d][0]+"m"+a+"\u001b["+g.colors[d][1]+"m":a}function f(a,d){return a}function n(a){var d={};a.forEach(function(a,b){d[a]=!0});return d}function r(a,b,c){if(a.customInspect&&b&&aa(b.inspect)&&b.inspect!==d.inspect&&(!b.constructor||
b.constructor.prototype!==b)){var g=b.inspect(c,a);F(g)||(g=r(a,g,c));return g}if(g=u(a,b))return g;var e=Object.keys(b),f=n(e);a.showHidden&&(e=Object.getOwnPropertyNames(b));if(M(b)&&(0<=e.indexOf("message")||0<=e.indexOf("description")))return p(b);if(0===e.length){if(aa(b))return a.stylize("[Function"+(b.name?": "+b.name:"")+"]","special");if(q(b))return a.stylize(RegExp.prototype.toString.call(b),"regexp");if(K(b))return a.stylize(Date.prototype.toString.call(b),"date");if(M(b))return p(b)}var g=
"",k=!1,l=["{","}"];x(b)&&(k=!0,l=["[","]"]);aa(b)&&(g=" [Function"+(b.name?": "+b.name:"")+"]");q(b)&&(g=" "+RegExp.prototype.toString.call(b));K(b)&&(g=" "+Date.prototype.toUTCString.call(b));M(b)&&(g=" "+p(b));if(0===e.length&&(!k||0==b.length))return l[0]+g+l[1];if(0>c)return q(b)?a.stylize(RegExp.prototype.toString.call(b),"regexp"):a.stylize("[Object]","special");a.seen.push(b);e=k?t(a,b,c,f,e):e.map(function(d){return y(a,b,c,f,d,k)});a.seen.pop();return w(e,g,l)}function u(a,d){if(C(d))return a.stylize("undefined",
"undefined");if(F(d))return d="'"+JSON.stringify(d).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'",a.stylize(d,"string");if(A(d))return a.stylize(""+d,"number");if(v(d))return a.stylize(""+d,"boolean");if(null===d)return a.stylize("null","null")}function p(a){return"["+Error.prototype.toString.call(a)+"]"}function t(a,d,b,c,g){for(var e=[],f=0,k=d.length;f<k;++f)Object.prototype.hasOwnProperty.call(d,String(f))?e.push(y(a,d,b,c,String(f),!0)):e.push("");g.forEach(function(g){g.match(/^\d+$/)||
e.push(y(a,d,b,c,g,!0))});return e}function y(a,d,b,c,g,e){var f,k;d=Object.getOwnPropertyDescriptor(d,g)||{value:d[g]};d.get?k=d.set?a.stylize("[Getter/Setter]","special"):a.stylize("[Getter]","special"):d.set&&(k=a.stylize("[Setter]","special"));Object.prototype.hasOwnProperty.call(c,g)||(f="["+g+"]");k||(0>a.seen.indexOf(d.value)?(k=null===b?r(a,d.value,null):r(a,d.value,b-1),-1<k.indexOf("\n")&&(k=e?k.split("\n").map(function(a){return"  "+a}).join("\n").substr(2):"\n"+k.split("\n").map(function(a){return"   "+
a}).join("\n"))):k=a.stylize("[Circular]","special"));if(C(f)){if(e&&g.match(/^\d+$/))return k;f=JSON.stringify(""+g);f.match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(f=f.substr(1,f.length-2),f=a.stylize(f,"name")):(f=f.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),f=a.stylize(f,"string"))}return f+": "+k}function w(a,d,b){var c=0;return 60<a.reduce(function(a,d){c++;0<=d.indexOf("\n")&&c++;return a+d.replace(/\u001b\[\d\d?m/g,"").length+1},0)?b[0]+(""===d?"":d+"\n ")+" "+a.join(",\n  ")+
" "+b[1]:b[0]+d+" "+a.join(", ")+" "+b[1]}function x(a){return Array.isArray(a)}function v(a){return"boolean"===typeof a}function A(a){return"number"===typeof a}function F(a){return"string"===typeof a}function C(a){return void 0===a}function q(a){return G(a)&&"[object RegExp]"===Object.prototype.toString.call(a)}function G(a){return"object"===("undefined"===typeof a?"undefined":O(a))&&null!==a}function K(a){return G(a)&&"[object Date]"===Object.prototype.toString.call(a)}function M(a){return G(a)&&
("[object Error]"===Object.prototype.toString.call(a)||a instanceof Error)}function aa(a){return"function"===typeof a}function J(a){return 10>a?"0"+a.toString(10):a.toString(10)}function E(){var a=new Date,d=[J(a.getHours()),J(a.getMinutes()),J(a.getSeconds())].join(":");return[a.getDate(),z[a.getMonth()],d].join(" ")}var fa=/%[sdj%]/g;d.format=function(a){if(!F(a)){for(var d=[],b=0;b<arguments.length;b++)d.push(g(arguments[b]));return d.join(" ")}for(var b=1,c=arguments,e=c.length,d=String(a).replace(fa,
function(a){if("%%"===a)return"%";if(b>=e)return a;switch(a){case "%s":return String(c[b++]);case "%d":return Number(c[b++]);case "%j":try{return JSON.stringify(c[b++])}catch(xk){return"[Circular]"}default:return a}}),f=c[b];b<e;f=c[++b])d=null!==f&&G(f)?d+(" "+g(f)):d+(" "+f);return d};d.deprecate=function(b,g){if(C(a.process))return function(){return d.deprecate(b,g).apply(this,arguments)};if(!0===c.noDeprecation)return b;var e=!1;return function(){if(!e){if(c.throwDeprecation)throw Error(g);c.traceDeprecation?
console.trace(g):console.error(g);e=!0}return b.apply(this,arguments)}};var D={},B;d.debuglog=function(a){C(B)&&(B=c.env.NODE_DEBUG||"");a=a.toUpperCase();if(!D[a])if((new RegExp("\\b"+a+"\\b","i")).test(B)){var b=c.pid;D[a]=function(){var c=d.format.apply(d,arguments);console.error("%s %d: %s",a,b,c)}}else D[a]=function(){};return D[a]};d.inspect=g;g.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],
magenta:[35,39],red:[31,39],yellow:[33,39]};g.styles={special:"cyan",number:"yellow","boolean":"yellow",undefined:"grey","null":"bold",string:"green",date:"magenta",regexp:"red"};d.isArray=x;d.isBoolean=v;d.isNull=function(a){return null===a};d.isNullOrUndefined=function(a){return null==a};d.isNumber=A;d.isString=F;d.isSymbol=function(a){return"symbol"===("undefined"===typeof a?"undefined":O(a))};d.isUndefined=C;d.isRegExp=q;d.isObject=G;d.isDate=K;d.isError=M;d.isFunction=aa;d.isPrimitive=function(a){return null===
a||"boolean"===typeof a||"number"===typeof a||"string"===typeof a||"symbol"===("undefined"===typeof a?"undefined":O(a))||"undefined"===typeof a};d.isBuffer=b(8);var z="Jan Feb Mar Apr May Jun Jul Aug Sep Oct Nov Dec".split(" ");d.log=function(){console.log("%s - %s",E(),d.format.apply(d,arguments))};d.inherits=b(9);d._extend=function(a,d){if(!d||!G(d))return a;for(var b=Object.keys(d),c=b.length;c--;)a[b[c]]=d[b[c]];return a}}).call(d,function(){return this}(),b(4))},function(a,d){a.exports=function(a){return a&&
"object"===("undefined"===typeof a?"undefined":O(a))&&"function"===typeof a.copy&&"function"===typeof a.fill&&"function"===typeof a.readUInt8}},function(a,d){a.exports="function"===typeof Object.create?function(a,d){a.super_=d;a.prototype=Object.create(d.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}})}:function(a,d){a.super_=d;var b=function(){};b.prototype=d.prototype;a.prototype=new b;a.prototype.constructor=a}},function(a,d,b){(function(a){var b={};d.escapeJavaScript=
function(a){if(!a)return"";for(var d="",c=0;c<a.length;++c)var g=a.charCodeAt(c),d=b.isSafe(g)?d+a[c]:d+b.escapeJavaScriptChar(g);return d};d.escapeHtml=function(a){if(!a)return"";for(var d="",c=0;c<a.length;++c)var g=a.charCodeAt(c),d=b.isSafe(g)?d+a[c]:d+b.escapeHtmlChar(g);return d};b.escapeJavaScriptChar=function(d){if(256<=d)return"\\u"+b.padLeft(""+d,4);d=(new a(String.fromCharCode(d),"ascii")).toString("hex");return"\\x"+b.padLeft(d,2)};b.escapeHtmlChar=function(d){var c=b.namedHtml[d];if("undefined"!==
typeof c)return c;if(256<=d)return"&#"+d+";";d=(new a(String.fromCharCode(d),"ascii")).toString("hex");return"&#x"+b.padLeft(d,2)+";"};b.padLeft=function(a,d){for(;a.length<d;)a="0"+a;return a};b.isSafe=function(a){return"undefined"!==typeof b.safeCharCodes[a]};b.namedHtml={38:"&amp;",60:"&lt;",62:"&gt;",34:"&quot;",160:"&nbsp;",162:"&cent;",163:"&pound;",164:"&curren;",169:"&copy;",174:"&reg;"};b.safeCharCodes=function(){for(var a={},d=32;123>d;++d)if(97<=d||65<=d&&90>=d||48<=d&&57>=d||32===d||46===
d||44===d||45===d||58===d||95===d)a[d]=null;return a}()}).call(d,b(3).Buffer)},function(a,d,b){var c=Object.assign||function(a){for(var d=1;d<arguments.length;d++){var b=arguments[d],c;for(c in b)Object.prototype.hasOwnProperty.call(b,c)&&(a[c]=b[c])}return a},g="function"===typeof Symbol&&"symbol"===O(Symbol.iterator)?function(a){return"undefined"===typeof a?"undefined":O(a)}:function(a){return a&&"function"===typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":"undefined"===typeof a?
"undefined":O(a)},k=b(2),l=b(12),m=b(13),n=null,r=null,u={Set:b(15),defaults:{abortEarly:!0,convert:!0,allowUnknown:!1,skipFunctions:!1,stripUnknown:!1,language:{},presence:"optional",strip:!1,noDefaults:!1}};a.exports=u.Any=function(){function a(){if(!(this instanceof a))throw new TypeError("Cannot call a class as a function");r=r||b(16);this.isJoi=!0;this._type="any";this._settings=null;this._valids=new u.Set;this._invalids=new u.Set;this._tests=[];this._refs=[];this._flags={};this._unit=this._description=
null;this._notes=[];this._tags=[];this._examples=[];this._meta=[];this._inner={}}a.prototype.createError=function(a,d,b,c){return m.create(a,d,b,c,this._flags)};a.prototype.createOverrideError=function(a,d,b,c,g,e){return m.create(a,d,b,c,this._flags,g,e)};a.prototype.checkOptions=function(a){a=b(28).options.validate(a);if(a.error)throw Error(a.error.details[0].message);};a.prototype.clone=function(){var a=Object.create(Object.getPrototypeOf(this));a.isJoi=!0;a._type=this._type;a._settings=u.concatSettings(this._settings);
a._baseType=this._baseType;a._valids=k.clone(this._valids);a._invalids=k.clone(this._invalids);a._tests=this._tests.slice();a._refs=this._refs.slice();a._flags=k.clone(this._flags);a._description=this._description;a._unit=this._unit;a._notes=this._notes.slice();a._tags=this._tags.slice();a._examples=this._examples.slice();a._meta=this._meta.slice();a._inner={};for(var d=Object.keys(this._inner),b=0;b<d.length;++b){var c=d[b];a._inner[c]=this._inner[c]?this._inner[c].slice():null}return a};a.prototype.concat=
function(a){k.assert(a instanceof u.Any,"Invalid schema object");k.assert("any"===this._type||"any"===a._type||a._type===this._type,"Cannot merge type",this._type,"with another type:",a._type);var d=this.clone();if("any"===this._type&&"any"!==a._type){for(var b=a.clone(),c="_settings _valids _invalids _tests _refs _flags _description _unit _notes _tags _examples _meta _inner".split(" "),g=0;g<c.length;++g)b[c[g]]=d[c[g]];d=b}d._settings=d._settings?u.concatSettings(d._settings,a._settings):a._settings;
d._valids.merge(a._valids,a._invalids);d._invalids.merge(a._invalids,a._valids);d._tests=d._tests.concat(a._tests);d._refs=d._refs.concat(a._refs);k.merge(d._flags,a._flags);d._description=a._description||d._description;d._unit=a._unit||d._unit;d._notes=d._notes.concat(a._notes);d._tags=d._tags.concat(a._tags);d._examples=d._examples.concat(a._examples);d._meta=d._meta.concat(a._meta);b=Object.keys(a._inner);c="object"===d._type;for(g=0;g<b.length;++g){var e=b[g],f=a._inner[e];if(f){var p=d._inner[e];
if(p)if(c&&"children"===e){for(var e={},n=0;n<p.length;++n)e[p[n].key]=n;for(n=0;n<f.length;++n){var l=f[n].key;0<=e[l]?p[e[l]]={key:l,schema:p[e[l]].schema.concat(f[n].schema)}:p.push(f[n])}}else d._inner[e]=d._inner[e].concat(f);else d._inner[e]=f.slice()}}return d};a.prototype._test=function(a,d,b,c){var g=this.clone();g._tests.push({func:b,name:a,arg:d,options:c});return g};a.prototype.options=function(a){k.assert(!a.context,"Cannot override context");this.checkOptions(a);var d=this.clone();d._settings=
u.concatSettings(d._settings,a);return d};a.prototype.strict=function(a){var d=this.clone();d._settings=d._settings||{};d._settings.convert=void 0===a?!1:!a;return d};a.prototype.raw=function(a){a=void 0===a?!0:a;if(this._flags.raw===a)return this;var d=this.clone();d._flags.raw=a;return d};a.prototype.error=function(a){k.assert(a&&(a instanceof Error||"function"===typeof a),"Must provide a valid Error object or a function");var d=this.clone();d._flags.error=a;return d};a.prototype.allow=function(){for(var a=
this.clone(),d=k.flatten(Array.prototype.slice.call(arguments)),b=0;b<d.length;++b){var c=d[b];k.assert(void 0!==c,"Cannot call allow/valid/invalid with undefined");a._invalids.remove(c);a._valids.add(c,a._refs)}return a};a.prototype.valid=function(){var a=this.allow.apply(this,arguments);a._flags.allowOnly=!0;return a};a.prototype.invalid=function(a){for(var d=this.clone(),b=k.flatten(Array.prototype.slice.call(arguments)),c=0;c<b.length;++c)a=b[c],k.assert(void 0!==a,"Cannot call allow/valid/invalid with undefined"),
d._valids.remove(a),d._invalids.add(a,this._refs);return d};a.prototype.required=function(){if("required"===this._flags.presence)return this;var a=this.clone();a._flags.presence="required";return a};a.prototype.optional=function(){if("optional"===this._flags.presence)return this;var a=this.clone();a._flags.presence="optional";return a};a.prototype.forbidden=function(){if("forbidden"===this._flags.presence)return this;var a=this.clone();a._flags.presence="forbidden";return a};a.prototype.strip=function(){if(this._flags.strip)return this;
var a=this.clone();a._flags.strip=!0;return a};a.prototype.applyFunctionToChildren=function(a,d,b,c){a=[].concat(a);if(1!==a.length||""!==a[0])throw c=c?c+".":"",a=(""===a[0]?a.slice(1):a).map(function(a){return c+a}),Error("unknown key(s) "+a.join(", "));return this[d].apply(this,b)};a.prototype.default=function(a,d){"function"!==typeof a||l.isRef(a)||(!a.description&&d&&(a.description=d),this._flags.func||k.assert("string"===typeof a.description&&0<a.description.length,"description must be provided when default value is a function"));
d=this.clone();d._flags.default=a;l.push(d._refs,a);return d};a.prototype.empty=function(a){var d=this.clone();d._flags.empty=void 0===a?void 0:r.schema(a);return d};a.prototype.when=function(a,d){k.assert(d&&"object"===("undefined"===typeof d?"undefined":g(d)),"Invalid options");k.assert(void 0!==d.then||void 0!==d.otherwise,'options must have at least one of "then" or "otherwise"');var c=d.hasOwnProperty("then")?this.concat(r.schema(d.then)):void 0,e=d.hasOwnProperty("otherwise")?this.concat(r.schema(d.otherwise)):
void 0;n=n||b(25);a=n.when(a,{is:d.is,then:c,otherwise:e});a._flags.presence="ignore";a._baseType=this;return a};a.prototype.description=function(a){k.assert(a&&"string"===typeof a,"Description must be a non-empty string");var d=this.clone();d._description=a;return d};a.prototype.notes=function(a){k.assert(a&&("string"===typeof a||Array.isArray(a)),"Notes must be a non-empty string or array");var d=this.clone();d._notes=d._notes.concat(a);return d};a.prototype.tags=function(a){k.assert(a&&("string"===
typeof a||Array.isArray(a)),"Tags must be a non-empty string or array");var d=this.clone();d._tags=d._tags.concat(a);return d};a.prototype.meta=function(a){k.assert(void 0!==a,"Meta cannot be undefined");var d=this.clone();d._meta=d._meta.concat(a);return d};a.prototype.example=function(a){k.assert(arguments.length,"Missing example");var d=this._validate(a,null,u.defaults);k.assert(!d.errors,"Bad example:",d.errors&&m.process(d.errors,a));d=this.clone();d._examples.push(a);return d};a.prototype.unit=
function(a){k.assert(a&&"string"===typeof a,"Unit name must be a non-empty string");var d=this.clone();d._unit=a;return d};a.prototype._prepareEmptyValue=function(a){return"string"===typeof a&&this._flags.trim?a.trim():a};a.prototype._validate=function(a,d,b,c){var g=this,e=a;d=d||{key:"",path:"",parent:null,reference:c};this._settings&&(b=u.concatSettings(b,this._settings));var f=[];c=function(){var c=void 0;if(void 0!==a)c=g._flags.raw?e:a;else if(b.noDefaults)c=a;else if(l.isRef(g._flags.default))c=
g._flags.default(d.parent,b);else if("function"!==typeof g._flags.default||g._flags.func&&!g._flags.default.description)c=k.clone(g._flags.default);else{c=void 0;null!==d.parent&&0<g._flags.default.length&&(c=[k.clone(d.parent),b]);var p=u._try(g._flags.default,c),c=p.value;p.error&&f.push(g.createError("any.default",p.error,d,b))}f.length&&"function"===typeof g._flags.error&&(p=g._flags.error.call(g,f),f="string"===typeof p?[g.createOverrideError("override",{reason:f},d,b,p)]:[].concat(p).map(function(a){return a instanceof
Error?a:g.createOverrideError(a.type||"override",a.context,d,b,a.message,a.template)}));return{value:g._flags.strip?void 0:c,finalValue:c,errors:f.length?f:null}};if(this._coerce){var p=this._coerce.call(this,a,d,b);if(p.errors)return a=p.value,f=f.concat(p.errors),c();a=p.value}this._flags.empty&&!this._flags.empty._validate(this._prepareEmptyValue(a),null,u.defaults).errors&&(a=void 0);p=this._flags.presence||b.presence;if("optional"===p){if(void 0===a)if(this._flags.hasOwnProperty("default")&&
void 0===this._flags.default&&"object"===this._type)a={};else return c()}else{if("required"===p&&void 0===a)return f.push(this.createError("any.required",null,d,b)),c();if("forbidden"===p){if(void 0===a)return c();f.push(this.createError("any.unknown",null,d,b));return c()}}if(this._valids.has(a,d,b,this._flags.insensitive)||this._invalids.has(a,d,b,this._flags.insensitive)&&(f.push(this.createError(""===a?"any.empty":"any.invalid",null,d,b)),b.abortEarly||void 0===a))return c();if(this._base){p=
this._base.call(this,a,d,b);if(p.errors)return a=p.value,f=f.concat(p.errors),c();if(p.value!==a&&(a=p.value,this._valids.has(a,d,b,this._flags.insensitive)||this._invalids.has(a,d,b,this._flags.insensitive)&&(f.push(this.createError(""===a?"any.empty":"any.invalid",null,d,b)),b.abortEarly)))return c()}if(this._flags.allowOnly&&(f.push(this.createError("any.allowOnly",{valids:this._valids.values({stripUndefined:!0})},d,b)),b.abortEarly))return c();for(p=0;p<this._tests.length;++p){var n=this._tests[p].func.call(this,
a,d,b);if(n instanceof m.Err){if(f.push(n),b.abortEarly)break}else a=n}return c()};a.prototype._validateWithOptions=function(a,d,b){d&&this.checkOptions(d);d=u.concatSettings(u.defaults,d);d=this._validate(a,null,d);a=m.process(d.errors,a);return b?b(a,d.value):{error:a,value:d.value}};a.prototype.validate=function(a,d,b){return"function"===typeof d?this._validateWithOptions(a,null,d):this._validateWithOptions(a,d,b)};a.prototype.describe=function(){var a=this,d={type:this._type},b=Object.keys(this._flags);
if(b.length)if(["empty","default","lazy","label"].some(function(d){return a._flags.hasOwnProperty(d)})){d.flags={};for(var c=0;c<b.length;++c){var g=b[c];"empty"===g?d.flags[g]=this._flags[g].describe():"default"===g?l.isRef(this._flags[g])?d.flags[g]=this._flags[g].toString():d.flags[g]="function"===typeof this._flags[g]?this._flags[g].description:this._flags[g]:"lazy"!==g&&"label"!==g&&(d.flags[g]=this._flags[g])}}else d.flags=this._flags;this._settings&&(d.options=k.clone(this._settings));this._baseType&&
(d.base=this._baseType.describe());this._description&&(d.description=this._description);this._notes.length&&(d.notes=this._notes);this._tags.length&&(d.tags=this._tags);this._meta.length&&(d.meta=this._meta);this._examples.length&&(d.examples=this._examples);this._unit&&(d.unit=this._unit);b=this._valids.values();b.length&&(d.valids=b.map(function(a){return l.isRef(a)?a.toString():a}));b=this._invalids.values();b.length&&(d.invalids=b.map(function(a){return l.isRef(a)?a.toString():a}));d.rules=[];
for(b=0;b<this._tests.length;++b){c=this._tests[b];g={name:c.name};void 0!==c.arg&&(g.arg=l.isRef(c.arg)?c.arg.toString():c.arg);var e=c.options;if(e){if(e.hasRef){g.arg={};for(var f=Object.keys(c.arg),p=0;p<f.length;++p){var n=f[p],m=c.arg[n];g.arg[n]=l.isRef(m)?m.toString():m}}"string"===typeof e.description?g.description=e.description:"function"===typeof e.description&&(g.description=e.description(g.arg))}d.rules.push(g)}d.rules.length||delete d.rules;if(b=this._getLabel())d.label=b;return d};
a.prototype.label=function(a){k.assert(a&&"string"===typeof a,"Label name must be a non-empty string");var d=this.clone();d._flags.label=a;return d};a.prototype._getLabel=function(a){return this._flags.label||a};return a}();u.Any.prototype.isImmutable=!0;u.Any.prototype.only=u.Any.prototype.equal=u.Any.prototype.valid;u.Any.prototype.disallow=u.Any.prototype.not=u.Any.prototype.invalid;u.Any.prototype.exist=u.Any.prototype.required;u._try=function(a,d){var b=void 0,c=void 0;try{c=a.apply(null,d)}catch(x){b=
x}return{value:c,error:b}};u.concatSettings=function(a,d){if(!a&&!d)return null;var b={};a&&c(b,a);if(d){a=Object.keys(d);for(var g=0;g<a.length;++g){var e=a[g];"language"===e&&b.hasOwnProperty(e)?b[e]=k.applyToDefaults(b[e],d[e]):b[e]=d[e]}}return b}},function(a,d,b){var c=b(2);d.create=function(a,d){c.assert("string"===typeof a,"Invalid reference key:",a);var b=c.clone(d),g=function r(a,d){return c.reach(r.isContext?d.context:a,r.key,b)};g.isContext=a[0]===(b&&b.contextPrefix||"$");g.key=g.isContext?
a.slice(1):a;g.path=g.key.split(b&&b.separator||".");g.depth=g.path.length;g.root=g.path[0];g.isJoi=!0;g.toString=function(){return(g.isContext?"context:":"ref:")+g.key};return g};d.isRef=function(a){return"function"===typeof a&&a.isJoi};d.push=function(a,b){d.isRef(b)&&!b.isContext&&a.push(b.root)}},function(a,d,b){var c="function"===typeof Symbol&&"symbol"===O(Symbol.iterator)?function(a){return"undefined"===typeof a?"undefined":O(a)}:function(a){return a&&"function"===typeof Symbol&&a.constructor===
Symbol&&a!==Symbol.prototype?"symbol":"undefined"===typeof a?"undefined":O(a)},g=b(2),k=b(14),l={annotations:Symbol("joi-annotations"),stringify:function(a,b){var g="undefined"===typeof a?"undefined":c(a);if(null===a)return"null";if("string"===g)return a;if(a instanceof d.Err||"function"===g)return a.toString();if("object"===g){if(Array.isArray(a)){for(var g="",e=0;e<a.length;++e)g=g+(g.length?", ":"")+l.stringify(a[e],b);return b?"["+g+"]":g}return a.toString()}return JSON.stringify(a)}};d.Err=function(){function a(d,
b,c,g,e,f,k){if(!(this instanceof a))throw new TypeError("Cannot call a class as a function");this.isJoi=!0;this.type=d;this.context=b||{};this.context.key=c.key;this.path=c.path;this.options=g;this.flags=e;this.message=f;this.template=k}a.prototype.toString=function(){var a=this;if(this.message)return this.message;var d=void 0;this.template&&(d=this.template);var b=this.options.language;if(this.flags.label)this.context.key=this.flags.label;else if(""===this.context.key||null===this.context.key)this.context.key=
b.root||k.errors.root;var d=d||g.reach(b,this.type)||g.reach(k.errors,this.type),c=g.reach(b,"messages.wrapArrays");"boolean"!==typeof c&&(c=k.errors.messages.wrapArrays);if(null===d)return d=l.stringify(this.context.reason,c),c?d.slice(1,-1):d;var e=/\{\{\!?key\}\}/.test(d),f=2<d.length&&"!"===d[0]&&"!"===d[1];f&&(d=d.slice(2));e||f||(d=(g.reach(b,"key")||g.reach(k.errors,"key"))+d);return d.replace(/\{\{(\!?)([^}]+)\}\}/g,function(d,b,e){d=g.reach(a.context,e);d=l.stringify(d,c);return b?g.escapeHtml(d):
d})};return a}();d.create=function(a,b,c,g,e,f,k){return new d.Err(a,b,c,g,e,f,k)};d.process=function(a,d){if(!a||!a.length)return null;var b="",c=[];if(a=function t(a,d){for(var g=0;g<a.length;++g){var e=a[g];if(e instanceof Error)return e;if(e.flags.error&&"function"!==typeof e.flags.error)return e.flags.error;var f=void 0;void 0===d&&(f=e.toString(),b=b+(b?". ":"")+f);if(e.context.reason&&e.context.reason.length){if(e=t(e.context.reason,e.path))return e}else c.push({message:f||e.toString(),path:l.getPath(e),
type:e.type,context:e.context})}}(a))return a;a=Error(b);a.isJoi=!0;a.name="ValidationError";a.details=c;a._object=d;a.annotate=l.annotate;return a};l.getPath=function(a){return a.path||a.context.key};l.safeStringify=function(a,d){return JSON.stringify(a,l.serializer(),d)};l.serializer=function(){var a=[],d=[];return function(b,g){if(0<d.length){var e=d.indexOf(this);~e?(d.length=e+1,a.length=e+1,a[e]=b):(d.push(this),a.push(b));~d.indexOf(g)&&(g=d[0]===g?"[Circular ~]":"[Circular ~."+a.slice(0,d.indexOf(g)).join(".")+
"]")}else d.push(g);if(g&&(b=g[l.annotations])){if(Array.isArray(g)){for(var e=[],f=0;f<g.length;++f)b.errors[f]&&e.push("_$idx$_"+b.errors[f].sort().join(", ")+"_$end$_"),e.push(g[f]);g=e}else{e=Object.keys(b.errors);for(f=0;f<e.length;++f){var k=e[f];g[k+"_$key$_"+b.errors[k].sort().join(", ")+"_$end$_"]=g[k];g[k]=void 0}e=Object.keys(b.missing);for(f=0;f<e.length;++f)k=e[f],g["_$miss$_"+k+"|"+b.missing[k]+"_$end$_"]="__missing__"}return g}return Infinity===g||-Infinity===g||Number.isNaN(g)||"function"===
typeof g||"symbol"===("undefined"===typeof g?"undefined":c(g))?"["+g.toString()+"]":g}};l.annotate=function(a){var d=a?"":"\u001b[31m",b=a?"":"\u001b[41m",e=a?"":"\u001b[0m";if("object"!==c(this._object))return this.details[0].message;a=g.clone(this._object||{});for(var f=this.details.length-1;0<=f;--f)for(var k=f+1,m=this.details[f].path.split("."),w=a,x=0;;++x){var v=m[x];w.isImmutable&&(w=w.clone());if(x+1<m.length&&w[v]&&"string"!==typeof w[v])w=w[v];else{m=w[l.annotations]=w[l.annotations]||
{errors:{},missing:{}};void 0!==w[v]?(m.errors[v]=m.errors[v]||[],m.errors[v].push(k)):m.missing[v]=k;break}}a=l.safeStringify(a,2).replace(/_\$key\$_([, \d]+)_\$end\$_\"/g,function(a,b){return'" '+d+"["+b+"]"+e}).replace(/\"_\$miss\$_([^\|]+)\|(\d+)_\$end\$_\"\: \"__missing__\"/g,function(a,c,g){return b+'"'+c+'"'+e+d+" ["+g+"]: -- missing --"+e}).replace(/\s*\"_\$idx\$_([, \d]+)_\$end\$_\",?\n(.*)/g,function(a,b,c){return"\n"+c+" "+d+"["+b+"]"+e}).replace(/"\[(NaN|Symbol.*|-?Infinity|function.*|\(.*)\]"/g,
function(a,d){return d});a=a+"\n"+d;for(f=0;f<this.details.length;++f)a=a+"\n["+(f+1)+"] "+this.details[f].message;return a+e}},function(a,d){d.errors={root:"value",key:'"{{!key}}" ',messages:{wrapArrays:!0},any:{unknown:"is not allowed",invalid:"contains an invalid value",empty:"is not allowed to be empty",required:"is required",allowOnly:"must be one of {{valids}}",default:"threw an error when running default method"},alternatives:{base:"not matching any of the allowed alternatives",child:null},
array:{base:"must be an array",includes:"at position {{pos}} does not match any of the allowed types",includesSingle:'single value of "{{!key}}" does not match any of the allowed types',includesOne:"at position {{pos}} fails because {{reason}}",includesOneSingle:'single value of "{{!key}}" fails because {{reason}}',includesRequiredUnknowns:"does not contain {{unknownMisses}} required value(s)",includesRequiredKnowns:"does not contain {{knownMisses}}",includesRequiredBoth:"does not contain {{knownMisses}} and {{unknownMisses}} other required value(s)",
excludes:"at position {{pos}} contains an excluded value",excludesSingle:'single value of "{{!key}}" contains an excluded value',min:"must contain at least {{limit}} items",max:"must contain less than or equal to {{limit}} items",length:"must contain {{limit}} items",ordered:"at position {{pos}} fails because {{reason}}",orderedLength:"at position {{pos}} fails because array must contain at most {{limit}} items",ref:'references "{{ref}}" which is not a positive integer',sparse:"must not be a sparse array",
unique:"position {{pos}} contains a duplicate value"},boolean:{base:"must be a boolean"},binary:{base:"must be a buffer or a string",min:"must be at least {{limit}} bytes",max:"must be less than or equal to {{limit}} bytes",length:"must be {{limit}} bytes"},date:{base:"must be a number of milliseconds or valid date string",format:"must be a string with one of the following formats {{format}}",strict:"must be a valid date",min:'must be larger than or equal to "{{limit}}"',max:'must be less than or equal to "{{limit}}"',
isoDate:"must be a valid ISO 8601 date",timestamp:{javascript:"must be a valid timestamp or number of milliseconds",unix:"must be a valid timestamp or number of seconds"},ref:'references "{{ref}}" which is not a date'},function:{base:"must be a Function",arity:"must have an arity of {{n}}",minArity:"must have an arity greater or equal to {{n}}",maxArity:"must have an arity lesser or equal to {{n}}",ref:"must be a Joi reference"},lazy:{base:"!!schema error: lazy schema must be set",schema:"!!schema error: lazy schema function must return a schema"},
object:{base:"must be an object",child:'!!child "{{!child}}" fails because {{reason}}',min:"must have at least {{limit}} children",max:"must have less than or equal to {{limit}} children",length:"must have {{limit}} children",allowUnknown:'!!"{{!child}}" is not allowed',with:'!!"{{mainWithLabel}}" missing required peer "{{peerWithLabel}}"',without:'!!"{{mainWithLabel}}" conflict with forbidden peer "{{peerWithLabel}}"',missing:"must contain at least one of {{peersWithLabels}}",xor:"contains a conflict between exclusive peers {{peersWithLabels}}",
or:"must contain at least one of {{peersWithLabels}}",and:"contains {{presentWithLabels}} without its required peers {{missingWithLabels}}",nand:'!!"{{mainWithLabel}}" must not exist simultaneously with {{peersWithLabels}}',assert:'!!"{{ref}}" validation failed because "{{ref}}" failed to {{message}}',rename:{multiple:'cannot rename child "{{from}}" because multiple renames are disabled and another key was already renamed to "{{to}}"',override:'cannot rename child "{{from}}" because override is disabled and target "{{to}}" exists'},
type:'must be an instance of "{{type}}"',schema:"must be a Joi instance"},number:{base:"must be a number",min:"must be larger than or equal to {{limit}}",max:"must be less than or equal to {{limit}}",less:"must be less than {{limit}}",greater:"must be greater than {{limit}}",float:"must be a float or double",integer:"must be an integer",negative:"must be a negative number",positive:"must be a positive number",precision:"must have no more than {{limit}} decimal places",ref:'references "{{ref}}" which is not a number',
multiple:"must be a multiple of {{multiple}}"},string:{base:"must be a string",min:"length must be at least {{limit}} characters long",max:"length must be less than or equal to {{limit}} characters long",length:"length must be {{limit}} characters long",alphanum:"must only contain alpha-numeric characters",token:"must only contain alpha-numeric and underscore characters",regex:{base:'with value "{{!value}}" fails to match the required pattern: {{pattern}}',name:'with value "{{!value}}" fails to match the {{name}} pattern',
invert:{base:'with value "{{!value}}" matches the inverted pattern: {{pattern}}',name:'with value "{{!value}}" matches the inverted {{name}} pattern'}},email:"must be a valid email",uri:"must be a valid uri",uriRelativeOnly:"must be a valid relative uri",uriCustomScheme:"must be a valid uri with a scheme matching the {{scheme}} pattern",isoDate:"must be a valid ISO 8601 date",guid:"must be a valid GUID",hex:"must only contain hexadecimal characters",base64:"must be a valid base64 string",hostname:"must be a valid hostname",
lowercase:"must only contain lowercase characters",uppercase:"must only contain uppercase characters",trim:"must not have leading or trailing whitespace",creditCard:"must be a credit card",ref:'references "{{ref}}" which is not a number',ip:"must be a valid ip address with a {{cidr}} CIDR",ipVersion:"must be a valid ip address of one of the following versions {{version}} with a {{cidr}} CIDR"}}},function(a,d,b){(function(d){var c="function"===typeof Symbol&&"symbol"===O(Symbol.iterator)?function(a){return"undefined"===
typeof a?"undefined":O(a)}:function(a){return a&&"function"===typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":"undefined"===typeof a?"undefined":O(a)},g=b(12);a.exports=function(){function a(){if(!(this instanceof a))throw new TypeError("Cannot call a class as a function");this._set=[]}a.prototype.add=function(a,d){if(g.isRef(a)||!this.has(a,null,null,!1))return void 0!==d&&g.push(d,a),this._set.push(a),this};a.prototype.merge=function(a,d){for(var b=0;b<a._set.length;++b)this.add(a._set[b]);
for(a=0;a<d._set.length;++a)this.remove(d._set[a]);return this};a.prototype.remove=function(a){this._set=this._set.filter(function(d){return a!==d});return this};a.prototype.has=function(a,b,e,f){for(var k=0;k<this._set.length;++k){var n=this._set[k];b&&g.isRef(n)&&(n=n(b.reference||b.parent,e));Array.isArray(n)||(n=[n]);for(var l=0;l<n.length;++l){var m=n[l];if(("undefined"===typeof a?"undefined":c(a))===("undefined"===typeof m?"undefined":c(m))&&(a===m||a instanceof Date&&m instanceof Date&&a.getTime()===
m.getTime()||f&&"string"===typeof a&&a.toLowerCase()===m.toLowerCase()||d.isBuffer(a)&&d.isBuffer(m)&&a.length===m.length&&a.toString("binary")===m.toString("binary")))return!0}}return!1};a.prototype.values=function(a){if(a&&a.stripUndefined){a=[];for(var d=0;d<this._set.length;++d){var b=this._set[d];void 0!==b&&a.push(b)}return a}return this._set.slice()};a.prototype.slice=function(){var d=new a;d._set=this._set.slice();return d};a.prototype.concat=function(d){var b=new a;b._set=this._set.concat(d._set);
return b};return a}()}).call(d,b(3).Buffer)},function(a,d,b){var c="function"===typeof Symbol&&"symbol"===O(Symbol.iterator)?function(a){return"undefined"===typeof a?"undefined":O(a)}:function(a){return a&&"function"===typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":"undefined"===typeof a?"undefined":O(a)},g=b(2),k=b(12),l=null,m=b(17),n=b(18),r=b(23),u=b(24),p=null,t=null;d.schema=function(a){l=l||new (b(11));p=p||b(25);t=t||b(26);if(void 0!==a&&null!==a&&"object"===("undefined"===
typeof a?"undefined":c(a)))return a.isJoi?a:Array.isArray(a)?p.try(a):a instanceof RegExp?n.regex(a):a instanceof Date?m.valid(a):t.keys(a);if("string"===typeof a)return n.valid(a);if("number"===typeof a)return r.valid(a);if("boolean"===typeof a)return u.valid(a);if(k.isRef(a))return l.valid(a);g.assert(null===a,"Invalid schema content:",a);return l.valid(null)};d.ref=function(a){return k.isRef(a)?a:k.create(a)}},function(a,d,b){function c(a,d){if("function"!==typeof d&&null!==d)throw new TypeError("Super expression must either be null or a function, not "+
("undefined"===typeof d?"undefined":O(d)));a.prototype=Object.create(d&&d.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}});if(d)if(Object.setPrototypeOf)Object.setPrototypeOf(a,d);else for(var b=Object.getOwnPropertyNames(d),c=0;c<b.length;c++){var g=b[c],e=Object.getOwnPropertyDescriptor(d,g);e&&e.configurable&&void 0===a[g]&&Object.defineProperty(a,g,e)}}d=b(11);var g=b(12),k=b(2),l={isoDate:/^(?:[-+]\d{2})?(?:\d{4}(?!\d{2}\b))(?:(-?)(?:(?:0[1-9]|1[0-2])(?:\1(?:[12]\d|0[1-9]|3[01]))?|W(?:[0-4]\d|5[0-2])(?:-?[1-7])?|(?:00[1-9]|0[1-9]\d|[12]\d{2}|3(?:[0-5]\d|6[1-6])))(?![T]$|[T][\d]+Z$)(?:[T\s](?:(?:(?:[01]\d|2[0-3])(?:(:?)[0-5]\d)?|24\:?00)(?:[.,]\d+(?!:))?)(?:\2[0-5]\d(?:[.,]\d+)?)?(?:[Z]|(?:[+-])(?:[01]\d|2[0-3])(?::?[0-5]\d)?)?)?)?$/};
l.invalidDate=new Date("");l.isIsoDate=function(){var a=l.isoDate.toString();return function(d){return d&&d.toString()===a}}();l.Date=function(a){function d(){if(!(this instanceof d))throw new TypeError("Cannot call a class as a function");var b;b=a.call(this);if(!this)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");b=!b||"object"!==("undefined"===typeof b?"undefined":O(b))&&"function"!==typeof b?this:b;b._type="date";return b}c(d,a);d.prototype._base=function(a,
d,b){a={value:b.convert&&l.Date.toDate(a,this._flags.format,this._flags.timestamp,this._flags.multiplier)||a};if(a.value instanceof Date&&!isNaN(a.value.getTime()))a.errors=null;else if(b.convert){var c;c=l.isIsoDate(this._flags.format)?"isoDate":this._flags.timestamp?"timestamp."+this._flags.timestamp:"base";a.errors=this.createError("date."+c,null,d,b)}else a.errors=this.createError("date.strict",null,d,b);return a};d.toDate=function(a,d,b,c){if(a instanceof Date)return a;if("string"===typeof a||
"number"===typeof a&&!isNaN(a)&&isFinite(a))if("string"===typeof a&&/^[+-]?\d+(\.\d+)?$/.test(a)&&(a=parseFloat(a)),a=d&&l.isIsoDate(d)?d.test(a)?new Date(a):l.invalidDate:b&&c?new Date(a*c):new Date(a),!isNaN(a.getTime()))return a;return null};d.prototype.iso=function(){if(this._flags.format===l.isoDate)return this;var a=this.clone();a._flags.format=l.isoDate;return a};d.prototype.timestamp=function(a){a=a||"javascript";var d=["javascript","unix"];k.assert(-1!==d.indexOf(a),'"type" must be one of "'+
d.join('", "')+'"');if(this._flags.timestamp===a)return this;d=this.clone();d._flags.timestamp=a;d._flags.multiplier="unix"===a?1E3:1;return d};d.prototype._isIsoDate=function(a){return l.isoDate.test(a)};return d}(d);l.compare=function(a,d){return function(b){var c="now"===b,e=g.isRef(b);c||e||(b=l.Date.toDate(b));k.assert(b,"Invalid date format");return this._test(a,b,function(g,f,k){var p;if(c)p=Date.now();else if(e){p=l.Date.toDate(b(f.reference||f.parent,k));if(!p)return this.createError("date.ref",
{ref:b.key},f,k);p=p.getTime()}else p=b.getTime();return d(g.getTime(),p)?g:this.createError("date."+a,{limit:new Date(p)},f,k)})}};l.Date.prototype.min=l.compare("min",function(a,d){return a>=d});l.Date.prototype.max=l.compare("max",function(a,d){return a<=d});a.exports=new l.Date},function(a,d,b){(function(d){function c(a,d){if("function"!==typeof d&&null!==d)throw new TypeError("Super expression must either be null or a function, not "+("undefined"===typeof d?"undefined":O(d)));a.prototype=Object.create(d&&
d.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}});if(d)if(Object.setPrototypeOf)Object.setPrototypeOf(a,d);else for(var b=Object.getOwnPropertyNames(d),c=0;c<b.length;c++){var g=b[c],e=Object.getOwnPropertyDescriptor(d,g);e&&e.configurable&&void 0===a[g]&&Object.defineProperty(a,g,e)}}var g="function"===typeof Symbol&&"symbol"===O(Symbol.iterator)?function(a){return"undefined"===typeof a?"undefined":O(a)}:function(a){return a&&"function"===typeof Symbol&&a.constructor===
Symbol&&a!==Symbol.prototype?"symbol":"undefined"===typeof a?"undefined":O(a)},e=b(5),m=b(2),n=void 0,r=b(11),u=b(12),p=b(17),t=b(19),y=b(21),w={uriRegex:t.createUriRegex(),ipRegex:y.createIpRegex(["ipv4","ipv6","ipvfuture"],"optional"),guidBrackets:{"{":"}","[":"]","(":")","":""},guidVersions:{uuidv1:"1",uuidv2:"2",uuidv3:"3",uuidv4:"4",uuidv5:"5"}};w.String=function(a){function d(){if(!(this instanceof d))throw new TypeError("Cannot call a class as a function");var b;b=a.call(this);if(!this)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
b=!b||"object"!==("undefined"===typeof b?"undefined":O(b))&&"function"!==typeof b?this:b;b._type="string";b._invalids.add("");return b}c(d,a);d.prototype._base=function(a,d,b){if("string"===typeof a&&b.convert){this._flags.case&&(a="upper"===this._flags.case?a.toLocaleUpperCase():a.toLocaleLowerCase());this._flags.trim&&(a=a.trim());if(this._inner.replacements)for(var c=0;c<this._inner.replacements.length;++c){var g=this._inner.replacements[c];a=a.replace(g.pattern,g.replacement)}if(this._flags.truncate)for(c=
0;c<this._tests.length;++c)if(g=this._tests[c],"max"===g.name){a=a.slice(0,g.arg);break}}return{value:a,errors:"string"===typeof a?null:this.createError("string.base",{value:a},d,b)}};d.prototype.insensitive=function(){if(this._flags.insensitive)return this;var a=this.clone();a._flags.insensitive=!0;return a};d.prototype.creditCard=function(){return this._test("creditCard",void 0,function(a,d,b){for(var c=a.length,g=0,e=1;c--;)var f=a.charAt(c)*e,g=g+(f-9*(9<f)),e=e^3;return 0===g%10&&0<g?a:this.createError("string.creditCard",
{value:a},d,b)})};d.prototype.regex=function(a,d){m.assert(a instanceof RegExp,"pattern must be a RegExp");var b={pattern:new RegExp(a.source,a.ignoreCase?"i":void 0)};"string"===typeof d?b.name=d:"object"===("undefined"===typeof d?"undefined":g(d))&&(b.invert=!!d.invert,d.name&&(b.name=d.name));var c=["string.regex",b.invert?".invert":"",b.name?".name":".base"].join("");return this._test("regex",b,function(a,d,g){return b.pattern.test(a)^b.invert?a:this.createError(c,{name:b.name,pattern:b.pattern,
value:a},d,g)})};d.prototype.alphanum=function(){return this._test("alphanum",void 0,function(a,d,b){return/^[a-zA-Z0-9]+$/.test(a)?a:this.createError("string.alphanum",{value:a},d,b)})};d.prototype.token=function(){return this._test("token",void 0,function(a,d,b){return/^\w+$/.test(a)?a:this.createError("string.token",{value:a},d,b)})};d.prototype.email=function(a){a&&(m.assert("object"===("undefined"===typeof a?"undefined":g(a)),"email options must be an object"),m.assert("undefined"===typeof a.checkDNS,
"checkDNS option is not supported"),m.assert("undefined"===typeof a.tldWhitelist||"object"===g(a.tldWhitelist),"tldWhitelist must be an array or object"),m.assert("undefined"===typeof a.minDomainAtoms||Number.isSafeInteger(a.minDomainAtoms)&&0<a.minDomainAtoms,"minDomainAtoms must be a positive integer"),m.assert("undefined"===typeof a.errorLevel||"boolean"===typeof a.errorLevel||Number.isSafeInteger(a.errorLevel)&&0<=a.errorLevel,"errorLevel must be a non-negative integer or boolean"));return this._test("email",
a,function(d,c,g){n=n||b(22);try{var e=n.validate(d,a);if(!0===e||0===e)return d}catch(K){}return this.createError("string.email",{value:d},c,g)})};d.prototype.ip=function(a){var d=w.ipRegex;a=a||{};m.assert("object"===("undefined"===typeof a?"undefined":g(a)),"options must be an object");a.cidr?(m.assert("string"===typeof a.cidr,"cidr must be a string"),a.cidr=a.cidr.toLowerCase(),m.assert(a.cidr in y.cidrs,"cidr must be one of "+Object.keys(y.cidrs).join(", ")),a.version||"optional"===a.cidr||(d=
y.createIpRegex(["ipv4","ipv6","ipvfuture"],a.cidr))):a.cidr="optional";var b=void 0;if(a.version){Array.isArray(a.version)||(a.version=[a.version]);m.assert(1<=a.version.length,"version must have at least 1 version specified");for(var b=[],c=0;c<a.version.length;++c){var e=a.version[c];m.assert("string"===typeof e,"version at position "+c+" must be a string");e=e.toLowerCase();m.assert(y.versions[e],"version at position "+c+" must be one of "+Object.keys(y.versions).join(", "));b.push(e)}b=m.unique(b);
d=y.createIpRegex(b,a.cidr)}return this._test("ip",a,function(c,g,e){return d.test(c)?c:b?this.createError("string.ipVersion",{value:c,cidr:a.cidr,version:b},g,e):this.createError("string.ip",{value:c,cidr:a.cidr},g,e)})};d.prototype.uri=function(a){var d="",b=!1,c=!1,e=w.uriRegex;if(a){m.assert("object"===("undefined"===typeof a?"undefined":g(a)),"options must be an object");if(a.scheme){m.assert(a.scheme instanceof RegExp||"string"===typeof a.scheme||Array.isArray(a.scheme),"scheme must be a RegExp, String, or Array");
Array.isArray(a.scheme)||(a.scheme=[a.scheme]);m.assert(1<=a.scheme.length,"scheme must have at least 1 scheme specified");for(var f=0;f<a.scheme.length;++f){var k=a.scheme[f];m.assert(k instanceof RegExp||"string"===typeof k,"scheme at position "+f+" must be a RegExp or String");d+=d?"|":"";k instanceof RegExp?d+=k.source:(m.assert(/[a-zA-Z][a-zA-Z0-9+-\.]*/.test(k),"scheme at position "+f+" must be a valid scheme"),d+=m.escapeRegex(k))}}a.allowRelative&&(b=!0);a.relativeOnly&&(c=!0)}if(d||b||c)e=
t.createUriRegex(d,b,c);return this._test("uri",a,function(a,b,g){return e.test(a)?a:c?this.createError("string.uriRelativeOnly",{value:a},b,g):d?this.createError("string.uriCustomScheme",{scheme:d,value:a},b,g):this.createError("string.uri",{value:a},b,g)})};d.prototype.isoDate=function(){return this._test("isoDate",void 0,function(a,d,b){return p._isIsoDate(a)?a:this.createError("string.isoDate",{value:a},d,b)})};d.prototype.guid=function(a){var d="";if(a&&a.version){Array.isArray(a.version)||(a.version=
[a.version]);m.assert(1<=a.version.length,"version must have at least 1 valid version specified");for(var b=new Set,c=0;c<a.version.length;++c){var g=a.version[c];m.assert("string"===typeof g,"version at position "+c+" must be a string");g=g.toLowerCase();g=w.guidVersions[g];m.assert(g,"version at position "+c+" must be one of "+Object.keys(w.guidVersions).join(", "));m.assert(!b.has(g),"version at position "+c+" must not be a duplicate.");d+=g;b.add(g)}}var e=new RegExp("^([\\[{\\(]?)[0-9A-F]{8}([:-]?)[0-9A-F]{4}\\2?["+
(d||"0-9A-F")+"][0-9A-F]{3}\\2?["+(d?"89AB":"0-9A-F")+"][0-9A-F]{3}\\2?[0-9A-F]{12}([\\]}\\)]?)$","i");return this._test("guid",a,function(a,d,b){var c=e.exec(a);return c&&w.guidBrackets[c[1]]===c[c.length-1]?a:this.createError("string.guid",{value:a},d,b)})};d.prototype.hex=function(){var a=/^[a-f0-9]+$/i;return this._test("hex",a,function(d,b,c){return a.test(d)?d:this.createError("string.hex",{value:d},b,c)})};d.prototype.base64=function(a){a=a||{};m.assert("object"===("undefined"===typeof a?"undefined":
g(a)),"base64 options must be an object");m.assert("undefined"===typeof a.paddingRequired||"boolean"===typeof a.paddingRequired,"paddingRequired must be boolean");var d=(!1===a.paddingRequired?a.paddingRequired:1)?/^(?:[A-Za-z0-9+\/]{4})*(?:[A-Za-z0-9+\/]{2}==|[A-Za-z0-9+\/]{3}=)?$/:/^(?:[A-Za-z0-9+\/]{4})*(?:[A-Za-z0-9+\/]{2}(==)?|[A-Za-z0-9+\/]{3}=?)?$/;return this._test("base64",d,function(a,b,c){return d.test(a)?a:this.createError("string.base64",{value:a},b,c)})};d.prototype.hostname=function(){var a=
/^(([a-zA-Z0-9]|[a-zA-Z0-9][a-zA-Z0-9\-]*[a-zA-Z0-9])\.)*([A-Za-z0-9]|[A-Za-z0-9][A-Za-z0-9\-]*[A-Za-z0-9])$/;return this._test("hostname",void 0,function(d,b,c){return 255>=d.length&&a.test(d)||e.isIPv6(d)?d:this.createError("string.hostname",{value:d},b,c)})};d.prototype.lowercase=function(){var a=this._test("lowercase",void 0,function(a,d,b){return b.convert||a===a.toLocaleLowerCase()?a:this.createError("string.lowercase",{value:a},d,b)});a._flags.case="lower";return a};d.prototype.uppercase=function(){var a=
this._test("uppercase",void 0,function(a,d,b){return b.convert||a===a.toLocaleUpperCase()?a:this.createError("string.uppercase",{value:a},d,b)});a._flags.case="upper";return a};d.prototype.trim=function(){var a=this._test("trim",void 0,function(a,d,b){return b.convert||a===a.trim()?a:this.createError("string.trim",{value:a},d,b)});a._flags.trim=!0;return a};d.prototype.replace=function(a,d){"string"===typeof a&&(a=new RegExp(m.escapeRegex(a),"g"));m.assert(a instanceof RegExp,"pattern must be a RegExp");
m.assert("string"===typeof d,"replacement must be a String");var b=this.clone();b._inner.replacements||(b._inner.replacements=[]);b._inner.replacements.push({pattern:a,replacement:d});return b};d.prototype.truncate=function(a){a=void 0===a?!0:!!a;if(this._flags.truncate===a)return this;var d=this.clone();d._flags.truncate=a;return d};return d}(r);w.compare=function(a,b){return function(c,g){var e=u.isRef(c);m.assert(Number.isSafeInteger(c)&&0<=c||e,"limit must be a positive integer or reference");
m.assert(!g||d.isEncoding(g),"Invalid encoding:",g);return this._test(a,c,function(d,f,k){var p;if(e){if(p=c(f.reference||f.parent,k),!Number.isSafeInteger(p))return this.createError("string.ref",{ref:c.key},f,k)}else p=c;return b(d,p,g)?d:this.createError("string."+a,{limit:p,value:d,encoding:g},f,k)})}};w.String.prototype.min=w.compare("min",function(a,b,c){return(c?d.byteLength(a,c):a.length)>=b});w.String.prototype.max=w.compare("max",function(a,b,c){return(c?d.byteLength(a,c):a.length)<=b});
w.String.prototype.length=w.compare("length",function(a,b,c){return(c?d.byteLength(a,c):a.length)===b});w.String.prototype.uuid=w.String.prototype.guid;a.exports=new w.String}).call(d,b(3).Buffer)},function(a,d,b){var c=b(20);a.exports={createUriRegex:function(a,d,b){var g=c.scheme;b?d="(?:"+c.relativeRef+")":(a&&(g="(?:"+a+")"),a="(?:"+g+":"+c.hierPart+")",d=d?"(?:"+a+"|"+c.relativeRef+")":a);return new RegExp("^"+d+"(?:\\?"+c.query+")?(?:#"+c.fragment+")?$")}}},function(a,d){var b={rfc3986:{},generate:function(){b.rfc3986.cidr=
"[0-9]|[1-2][0-9]|3[0-2]";var a="[a-zA-Z0-9-\\._~%0-9A-Fa-f!\\$&'\\(\\)\\*\\+,;=:@]";b.rfc3986.IPv4address="(?:(?:0?0?[0-9]|0?[1-9][0-9]|1[0-9][0-9]|2[0-4][0-9]|25[0-5])\\.){3}(?:0?0?[0-9]|0?[1-9][0-9]|1[0-9][0-9]|2[0-4][0-9]|25[0-5])";var d="(?:[0-9A-Fa-f]{1,4}:[0-9A-Fa-f]{1,4}|"+b.rfc3986.IPv4address+")";b.rfc3986.IPv6address="(?:(?:[0-9A-Fa-f]{1,4}:){6}"+d+"|"+("::(?:[0-9A-Fa-f]{1,4}:){5}"+d)+"|"+("(?:[0-9A-Fa-f]{1,4})?::(?:[0-9A-Fa-f]{1,4}:){4}"+d)+"|"+("(?:(?:[0-9A-Fa-f]{1,4}:){0,1}[0-9A-Fa-f]{1,4})?::(?:[0-9A-Fa-f]{1,4}:){3}"+
d)+"|"+("(?:(?:[0-9A-Fa-f]{1,4}:){0,2}[0-9A-Fa-f]{1,4})?::(?:[0-9A-Fa-f]{1,4}:){2}"+d)+"|"+("(?:(?:[0-9A-Fa-f]{1,4}:){0,3}[0-9A-Fa-f]{1,4})?::[0-9A-Fa-f]{1,4}:"+d)+"|"+("(?:(?:[0-9A-Fa-f]{1,4}:){0,4}[0-9A-Fa-f]{1,4})?::"+d)+"|(?:(?:[0-9A-Fa-f]{1,4}:){0,5}[0-9A-Fa-f]{1,4})?::[0-9A-Fa-f]{1,4}|(?:(?:[0-9A-Fa-f]{1,4}:){0,6}[0-9A-Fa-f]{1,4})?::)";b.rfc3986.IPvFuture="v[0-9A-Fa-f]+\\.[a-zA-Z0-9-\\._~!\\$&'\\(\\)\\*\\+,;=:]+";b.rfc3986.scheme="[a-zA-Z][a-zA-Z0-9+-\\.]*";var d="(?:[a-zA-Z0-9-\\._~%0-9A-Fa-f!\\$&'\\(\\)\\*\\+,;=:]*@)?"+
("(?:"+("\\[(?:"+b.rfc3986.IPv6address+"|"+b.rfc3986.IPvFuture+")\\]")+"|"+b.rfc3986.IPv4address+"|[a-zA-Z0-9-\\._~%0-9A-Fa-f!\\$&'\\(\\)\\*\\+,;=]{0,255})")+"(?::[0-9]*)?",c=a+"+",a="(?:\\/"+(a+"*")+")*",g="\\/(?:"+c+a+")?";b.rfc3986.hierPart="(?:(?:\\/\\/"+d+a+")|"+g+"|"+(c+a)+")";b.rfc3986.relativeRef="(?:(?:\\/\\/"+d+a+")|"+g+"|"+("[a-zA-Z0-9-\\._~%0-9A-Fa-f!\\$&'\\(\\)\\*\\+,;=@]+"+a)+"|)";b.rfc3986.query="[a-zA-Z0-9-\\._~%0-9A-Fa-f!\\$&'\\(\\)\\*\\+,;=:@\\/\\?]*(?=#|$)";b.rfc3986.fragment="[a-zA-Z0-9-\\._~%0-9A-Fa-f!\\$&'\\(\\)\\*\\+,;=:@\\/\\?]*"}};
b.generate();a.exports=b.rfc3986},function(a,d,b){d=b(20);var c={cidrs:{required:"\\/(?:"+d.cidr+")",optional:"(?:\\/(?:"+d.cidr+"))?",forbidden:""},versions:{ipv4:d.IPv4address,ipv6:d.IPv6address,ipvfuture:d.IPvFuture},createIpRegex:function(a,d){for(var b=void 0,g=0;g<a.length;++g){var e=a[g];b||(b="^(?:"+c.versions[e]);b=b+"|"+c.versions[e]}return new RegExp(b+")"+c.cidrs[d]+"$")}};a.exports=c},function(a,d,b){(function(a){var c="function"===typeof Symbol&&"symbol"===O(Symbol.iterator)?function(a){return"undefined"===
typeof a?"undefined":O(a)}:function(a){return a&&"function"===typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":"undefined"===typeof a?"undefined":O(a)},g=b(5),e={hasOwn:Object.prototype.hasOwnProperty,indexOf:Array.prototype.indexOf,defaultThreshold:16,maxIPv6Groups:8,categories:{valid:1,dnsWarn:7,rfc5321:15,cfws:31,deprecated:63,rfc5322:127,error:255},diagnoses:{valid:0,dnsWarnNoMXRecord:5,dnsWarnNoRecord:6,rfc5321TLD:9,rfc5321TLDNumeric:10,rfc5321QuotedString:11,rfc5321AddressLiteral:12,
cfwsComment:17,cfwsFWS:18,deprecatedLocalPart:33,deprecatedFWS:34,deprecatedQTEXT:35,deprecatedQP:36,deprecatedComment:37,deprecatedCTEXT:38,deprecatedIPv6:39,deprecatedCFWSNearAt:49,rfc5322Domain:65,rfc5322TooLong:66,rfc5322LocalTooLong:67,rfc5322DomainTooLong:68,rfc5322LabelTooLong:69,rfc5322DomainLiteral:70,rfc5322DomainLiteralOBSDText:71,rfc5322IPv6GroupCount:72,rfc5322IPv62x2xColon:73,rfc5322IPv6BadCharacter:74,rfc5322IPv6MaxGroups:75,rfc5322IPv6ColonStart:76,rfc5322IPv6ColonEnd:77,errExpectingDTEXT:129,
errNoLocalPart:130,errNoDomain:131,errConsecutiveDots:132,errATEXTAfterCFWS:133,errATEXTAfterQS:134,errATEXTAfterDomainLiteral:135,errExpectingQPair:136,errExpectingATEXT:137,errExpectingQTEXT:138,errExpectingCTEXT:139,errBackslashEnd:140,errDotStart:141,errDotEnd:142,errDomainHyphenStart:143,errDomainHyphenEnd:144,errUnclosedQuotedString:145,errUnclosedComment:146,errUnclosedDomainLiteral:147,errFWSCRLFx2:148,errFWSCRLFEnd:149,errCRNoLF:150,errUnknownTLD:160,errDomainTooShort:161},components:{localpart:0,
domain:1,literal:2,contextComment:3,contextFWS:4,contextQuotedString:5,contextQuotedPair:6}};e.defer="undefined"!==typeof a&&a&&"function"===typeof a.nextTick?a.nextTick.bind(a):function(a){return setTimeout(a,0)};e.specials=function(){for(var a=Array(256),d=255;0<=d;--d)a[d]=!1;for(d=0;13>d;++d)a['()<>[]:;@\\,."'.charCodeAt(d)]=!0;return function(d){return a[d]}}();e.regex={ipV4:/\b(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?)$/,ipV6:/^[a-fA-F\d]{0,4}$/};e.checkIpV6=function(a){return a.every(function(a){return e.regex.ipV6.test(a)})};
e.validDomain=function(a,d){return d.tldBlacklist?Array.isArray(d.tldBlacklist)?-1===e.indexOf.call(d.tldBlacklist,a):!e.hasOwn.call(d.tldBlacklist,a):Array.isArray(d.tldWhitelist)?-1!==e.indexOf.call(d.tldWhitelist,a):e.hasOwn.call(d.tldWhitelist,a)};d.validate=e.validate=function(a,d,b){d=d||{};"function"===typeof d&&(b=d,d={});if("function"!==typeof b){if(d.checkDNS)throw new TypeError("expected callback function for checkDNS option");b=null}var f=void 0,k=void 0;"number"===typeof d.errorLevel?
(f=!0,k=d.errorLevel):(f=!!d.errorLevel,k=e.diagnoses.valid);if(d.tldWhitelist)if("string"===typeof d.tldWhitelist)d.tldWhitelist=[d.tldWhitelist];else if("object"!==c(d.tldWhitelist))throw new TypeError("expected array or object tldWhitelist");if(d.tldBlacklist)if("string"===typeof d.tldBlacklist)d.tldBlacklist=[d.tldBlacklist];else if("object"!==c(d.tldBlacklist))throw new TypeError("expected array or object tldBlacklist");if(d.minDomainAtoms&&(d.minDomainAtoms!==(+d.minDomainAtoms|0)||0>d.minDomainAtoms))throw new TypeError("expected positive integer minDomainAtoms");
for(var n=e.diagnoses.valid,m=function(a){a>n&&(n=a)},l=e.components.localpart,r=e.components.localpart,v=[e.components.localpart],A="",F="",C="",q,G=[""],K=0,M=0,aa=0,J=void 0,E=!1,fa=!1,D=a.length,B=void 0,z=0;z<D;++z){B=a[z];switch(l){case e.components.localpart:switch(B){case "(":0===M?m(0===K?e.diagnoses.cfwsComment:e.diagnoses.deprecatedComment):(m(e.diagnoses.cfwsComment),fa=!0);v.push(l);l=e.components.contextComment;break;case ".":0===M?m(0===K?e.diagnoses.errDotStart:e.diagnoses.errConsecutiveDots):
(fa&&m(e.diagnoses.deprecatedLocalPart),fa=!1,M=0,++K,F+=B);break;case '"':0===M?(m(0===K?e.diagnoses.rfc5321QuotedString:e.diagnoses.deprecatedLocalPart),F+=B,++M,fa=!0,v.push(l),l=e.components.contextQuotedString):m(e.diagnoses.errExpectingATEXT);break;case "\r":if(D===++z||"\n"!==a[z]){m(e.diagnoses.errCRNoLF);break}case " ":case "\t":0===M?m(0===K?e.diagnoses.cfwsFWS:e.diagnoses.deprecatedFWS):fa=!0;v.push(l);l=e.components.contextFWS;A=B;break;case "@":if(1!==v.length)throw Error("unexpected item on context stack");
0===F.length?m(e.diagnoses.errNoLocalPart):0===M?m(e.diagnoses.errDotEnd):64<F.length?m(e.diagnoses.rfc5322LocalTooLong):r!==e.components.contextComment&&r!==e.components.contextFWS||m(e.diagnoses.deprecatedCFWSNearAt);l=e.components.domain;v[0]=e.components.domain;M=K=0;fa=!1;break;default:if(fa)switch(r){case e.components.contextComment:case e.components.contextFWS:m(e.diagnoses.errATEXTAfterCFWS);break;case e.components.contextQuotedString:m(e.diagnoses.errATEXTAfterQS);break;default:throw Error("more atext found where none is allowed, but unrecognized prev context: "+
r);}else r=l,J=B.charCodeAt(0),(33>J||126<J||e.specials(J))&&m(e.diagnoses.errExpectingATEXT),F+=B,++M}break;case e.components.domain:switch(B){case "(":0===M?m(0===K?e.diagnoses.deprecatedCFWSNearAt:e.diagnoses.deprecatedComment):(fa=!0,m(e.diagnoses.cfwsComment));v.push(l);l=e.components.contextComment;break;case ".":0===M?m(0===K?e.diagnoses.errDotStart:e.diagnoses.errConsecutiveDots):E?m(e.diagnoses.errDomainHyphenEnd):63<M&&m(e.diagnoses.rfc5322LabelTooLong);fa=!1;M=0;++K;G[K]="";C+=B;break;
case "[":0===C.length?(fa=!0,++M,v.push(l),l=e.components.literal,C+=B,G[K]+=B,q=""):m(e.diagnoses.errExpectingATEXT);break;case "\r":if(D===++z||"\n"!==a[z]){m(e.diagnoses.errCRNoLF);break}case " ":case "\t":0===M?m(0===K?e.diagnoses.deprecatedCFWSNearAt:e.diagnoses.deprecatedFWS):(m(e.diagnoses.cfwsFWS),fa=!0);v.push(l);l=e.components.contextFWS;A=B;break;default:if(fa)switch(r){case e.components.contextComment:case e.components.contextFWS:m(e.diagnoses.errATEXTAfterCFWS);break;case e.components.literal:m(e.diagnoses.errATEXTAfterDomainLiteral);
break;default:throw Error("more atext found where none is allowed, but unrecognized prev context: "+r);}J=B.charCodeAt(0);E=!1;33>J||126<J||e.specials(J)?m(e.diagnoses.errExpectingATEXT):"-"===B?(0===M&&m(e.diagnoses.errDomainHyphenStart),E=!0):(48>J||122<J||57<J&&65>J||90<J&&97>J)&&m(e.diagnoses.rfc5322Domain);C+=B;G[K]+=B;++M}break;case e.components.literal:switch(B){case "]":if(n<e.categories.deprecated){var r=-1,J=q,H=e.regex.ipV4.exec(J);H&&(r=H.index,0!==r&&(J=J.slice(0,r)+"0:0"));if(0===r)m(e.diagnoses.rfc5321AddressLiteral);
else if("ipv6:"!==J.slice(0,5).toLowerCase())m(e.diagnoses.rfc5322DomainLiteral);else{var J=J.slice(5),H=e.maxIPv6Groups,I=J.split(":"),r=J.indexOf("::");~r?r!==J.lastIndexOf("::")?m(e.diagnoses.rfc5322IPv62x2xColon):(0!==r&&r!==J.length-2||++H,I.length>H?m(e.diagnoses.rfc5322IPv6MaxGroups):I.length===H&&m(e.diagnoses.deprecatedIPv6)):I.length!==H&&m(e.diagnoses.rfc5322IPv6GroupCount);":"===J[0]&&":"!==J[1]?m(e.diagnoses.rfc5322IPv6ColonStart):":"===J[J.length-1]&&":"!==J[J.length-2]?m(e.diagnoses.rfc5322IPv6ColonEnd):
e.checkIpV6(I)?m(e.diagnoses.rfc5321AddressLiteral):m(e.diagnoses.rfc5322IPv6BadCharacter)}}else m(e.diagnoses.rfc5322DomainLiteral);C+=B;G[K]+=B;++M;r=l;l=v.pop();break;case "\\":m(e.diagnoses.rfc5322DomainLiteralOBSDText);v.push(l);l=e.components.contextQuotedPair;break;case "\r":if(D===++z||"\n"!==a[z]){m(e.diagnoses.errCRNoLF);break}case " ":case "\t":m(e.diagnoses.cfwsFWS);v.push(l);l=e.components.contextFWS;A=B;break;default:J=B.charCodeAt(0),127<J||0===J||"["===B?m(e.diagnoses.errExpectingDTEXT):
((33>J||127===J)&&m(e.diagnoses.rfc5322DomainLiteralOBSDText),q+=B,C+=B,G[K]+=B,++M)}break;case e.components.contextQuotedString:switch(B){case "\\":v.push(l);l=e.components.contextQuotedPair;break;case "\r":if(D===++z||"\n"!==a[z]){m(e.diagnoses.errCRNoLF);break}case "\t":F+=" ";++M;m(e.diagnoses.cfwsFWS);v.push(l);l=e.components.contextFWS;A=B;break;case '"':F+=B;++M;r=l;l=v.pop();break;default:J=B.charCodeAt(0),127<J||0===J||10===J?m(e.diagnoses.errExpectingQTEXT):(32>J||127===J)&&m(e.diagnoses.deprecatedQTEXT),
F+=B,++M}break;case e.components.contextQuotedPair:J=B.charCodeAt(0);127<J?m(e.diagnoses.errExpectingQPair):(31>J&&9!==J||127===J)&&m(e.diagnoses.deprecatedQP);r=l;l=v.pop();B="\\"+B;switch(l){case e.components.contextComment:break;case e.components.contextQuotedString:F+=B;M+=2;break;case e.components.literal:C+=B;G[K]+=B;M+=2;break;default:throw Error("quoted pair logic invoked in an invalid context: "+l);}break;case e.components.contextComment:switch(B){case "(":v.push(l);l=e.components.contextComment;
break;case ")":r=l;l=v.pop();break;case "\\":v.push(l);l=e.components.contextQuotedPair;break;case "\r":if(D===++z||"\n"!==a[z]){m(e.diagnoses.errCRNoLF);break}case " ":case "\t":m(e.diagnoses.cfwsFWS);v.push(l);l=e.components.contextFWS;A=B;break;default:J=B.charCodeAt(0),127<J||0===J||10===J?m(e.diagnoses.errExpectingCTEXT):(32>J||127===J)&&m(e.diagnoses.deprecatedCTEXT)}break;case e.components.contextFWS:if("\r"===A){if("\r"===B){m(e.diagnoses.errFWSCRLFx2);break}1<++aa?m(e.diagnoses.deprecatedFWS):
aa=1}switch(B){case "\r":D!==++z&&"\n"===a[z]||m(e.diagnoses.errCRNoLF);break;case " ":case "\t":break;default:"\r"===A&&m(e.diagnoses.errFWSCRLFEnd),aa=0,r=l,l=v.pop(),--z}A=B;break;default:throw Error("unknown context: "+l);}if(n>e.categories.rfc5322)break}if(n<e.categories.rfc5322)if(l===e.components.contextQuotedString)m(e.diagnoses.errUnclosedQuotedString);else if(l===e.components.contextQuotedPair)m(e.diagnoses.errBackslashEnd);else if(l===e.components.contextComment)m(e.diagnoses.errUnclosedComment);
else if(l===e.components.literal)m(e.diagnoses.errUnclosedDomainLiteral);else if("\r"===B)m(e.diagnoses.errFWSCRLFEnd);else if(0===C.length)m(e.diagnoses.errNoDomain);else if(0===M)m(e.diagnoses.errDotEnd);else if(E)m(e.diagnoses.errDomainHyphenEnd);else if(255<C.length)m(e.diagnoses.rfc5322DomainTooLong);else if(254<F.length+C.length+1)m(e.diagnoses.rfc5322TooLong);else if(63<M)m(e.diagnoses.rfc5322LabelTooLong);else if(d.minDomainAtoms&&G.length<d.minDomainAtoms)m(e.diagnoses.errDomainTooShort);
else if(d.tldWhitelist||d.tldBlacklist)e.validDomain(G[K],d)||m(e.diagnoses.errUnknownTLD);var O=!1,N=!1,L=function(){!O&&n<e.categories.dnsWarn&&(57>=G[K].charCodeAt(0)?m(e.diagnoses.rfc5321TLDNumeric):0===K&&m(e.diagnoses.rfc5321TLD));n<k&&(n=e.diagnoses.valid);var a=f?n:n<e.defaultThreshold;b&&(N?b(a):e.defer(b.bind(null,a)));return a};if(d.checkDNS&&n<e.categories.dnsWarn)(function(){0===K&&(C+=".");var a=C;g.resolveMx(a,function(d,b){if(d&&d.code!==g.NODATA)return m(e.diagnoses.dnsWarnNoRecord),
L();if(b&&b.length)return O=!0,L();var c=3,f=!1;m(e.diagnoses.dnsWarnNoMXRecord);d=function(a,d){if(!f){--c;if(d&&d.length)return f=!0,L();0===c&&(m(e.diagnoses.dnsWarnNoRecord),f=!0,L())}};g.resolveCname(a,d);g.resolve4(a,d);g.resolve6(a,d)});N=!0})();else return a=L(),N=!0,a};d.diagnoses=e.validate.diagnoses=function(){for(var a={},d=Object.keys(e.diagnoses),b=0;b<d.length;++b){var c=d[b];a[c]=e.diagnoses[c]}return a}()}).call(d,b(4))},function(a,d,b){function c(a,d){if("function"!==typeof d&&null!==
d)throw new TypeError("Super expression must either be null or a function, not "+("undefined"===typeof d?"undefined":O(d)));a.prototype=Object.create(d&&d.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}});if(d)if(Object.setPrototypeOf)Object.setPrototypeOf(a,d);else for(var b=Object.getOwnPropertyNames(d),c=0;c<b.length;c++){var g=b[c],e=Object.getOwnPropertyDescriptor(d,g);e&&e.configurable&&void 0===a[g]&&Object.defineProperty(a,g,e)}}d=b(11);var g=b(12),k=b(2),l={precisionRx:/(?:\.(\d+))?(?:[eE]([+-]?\d+))?$/};
l.Number=function(a){function d(){if(!(this instanceof d))throw new TypeError("Cannot call a class as a function");var b;b=a.call(this);if(!this)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");b=!b||"object"!==("undefined"===typeof b?"undefined":O(b))&&"function"!==typeof b?this:b;b._type="number";b._invalids.add(Infinity);b._invalids.add(-Infinity);return b}c(d,a);d.prototype._base=function(a,d,b){var c={errors:null,value:a};if("string"===typeof a&&b.convert){var g=
parseFloat(a);c.value=isNaN(g)||!isFinite(a)?NaN:g}a="number"===typeof c.value&&!isNaN(c.value);b.convert&&"precision"in this._flags&&a&&(g=Math.pow(10,this._flags.precision),c.value=Math.round(c.value*g)/g);c.errors=a?null:this.createError("number.base",null,d,b);return c};d.prototype.multiple=function(a){var d=g.isRef(a);d||(k.assert("number"===typeof a&&isFinite(a),"multiple must be a number"),k.assert(0<a,"multiple must be greater than 0"));return this._test("multiple",a,function(b,c,g){var e=
d?a(c.reference||c.parent,g):a;return!d||"number"===typeof e&&isFinite(e)?0===b%e?b:this.createError("number.multiple",{multiple:a,value:b},c,g):this.createError("number.ref",{ref:a.key},c,g)})};d.prototype.integer=function(){return this._test("integer",void 0,function(a,d,b){return Number.isSafeInteger(a)?a:this.createError("number.integer",{value:a},d,b)})};d.prototype.negative=function(){return this._test("negative",void 0,function(a,d,b){return 0>a?a:this.createError("number.negative",{value:a},
d,b)})};d.prototype.positive=function(){return this._test("positive",void 0,function(a,d,b){return 0<a?a:this.createError("number.positive",{value:a},d,b)})};d.prototype.precision=function(a){k.assert(Number.isSafeInteger(a),"limit must be an integer");k.assert(!("precision"in this._flags),"precision already set");var d=this._test("precision",a,function(d,b,c){var g=d.toString().match(l.precisionRx);return Math.max((g[1]?g[1].length:0)-(g[2]?parseInt(g[2],10):0),0)<=a?d:this.createError("number.precision",
{limit:a,value:d},b,c)});d._flags.precision=a;return d};return d}(d);l.compare=function(a,d){return function(b){var c=g.isRef(b),e="number"===typeof b&&!isNaN(b);k.assert(e||c,"limit must be a number or reference");return this._test(a,b,function(g,e,f){var k;if(c){if(k=b(e.reference||e.parent,f),"number"!==typeof k||isNaN(k))return this.createError("number.ref",{ref:b.key},e,f)}else k=b;return d(g,k)?g:this.createError("number."+a,{limit:k,value:g},e,f)})}};l.Number.prototype.min=l.compare("min",
function(a,d){return a>=d});l.Number.prototype.max=l.compare("max",function(a,d){return a<=d});l.Number.prototype.greater=l.compare("greater",function(a,d){return a>d});l.Number.prototype.less=l.compare("less",function(a,d){return a<d});a.exports=new l.Number},function(a,d,b){function c(a,d){if("function"!==typeof d&&null!==d)throw new TypeError("Super expression must either be null or a function, not "+("undefined"===typeof d?"undefined":O(d)));a.prototype=Object.create(d&&d.prototype,{constructor:{value:a,
enumerable:!1,writable:!0,configurable:!0}});if(d)if(Object.setPrototypeOf)Object.setPrototypeOf(a,d);else for(var b=Object.getOwnPropertyNames(d),c=0;c<b.length;c++){var g=b[c],e=Object.getOwnPropertyDescriptor(d,g);e&&e.configurable&&void 0===a[g]&&Object.defineProperty(a,g,e)}}var g=b(11),k=b(2),l=b(15);d=function(a){function d(){if(!(this instanceof d))throw new TypeError("Cannot call a class as a function");var b;b=a.call(this);if(!this)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
b=!b||"object"!==("undefined"===typeof b?"undefined":O(b))&&"function"!==typeof b?this:b;b._type="boolean";b._flags.insensitive=!0;b._inner.truthySet=new l;b._inner.falsySet=new l;return b}c(d,a);d.prototype._base=function(a,d,b){var c={value:a};if("string"===typeof a&&b.convert){var g=this._flags.insensitive?a.toLowerCase():a;c.value="true"===g?!0:"false"===g?!1:a}"boolean"!==typeof c.value&&(c.value=this._inner.truthySet.has(a,null,null,this._flags.insensitive)?!0:this._inner.falsySet.has(a,null,
null,this._flags.insensitive)?!1:a);c.errors="boolean"===typeof c.value?null:this.createError("boolean.base",null,d,b);return c};d.prototype.truthy=function(){for(var a=this.clone(),d=k.flatten(Array.prototype.slice.call(arguments)),b=0;b<d.length;++b){var c=d[b];k.assert(void 0!==c,"Cannot call truthy with undefined");a._inner.truthySet.add(c)}return a};d.prototype.falsy=function(){for(var a=this.clone(),d=k.flatten(Array.prototype.slice.call(arguments)),b=0;b<d.length;++b){var c=d[b];k.assert(void 0!==
c,"Cannot call falsy with undefined");a._inner.falsySet.add(c)}return a};d.prototype.insensitive=function(a){a=void 0===a?!0:!!a;if(this._flags.insensitive===a)return this;var d=this.clone();d._flags.insensitive=a;return d};d.prototype.describe=function(){var a=g.prototype.describe.call(this);a.truthy=[!0].concat(this._inner.truthySet.values());a.falsy=[!1].concat(this._inner.falsySet.values());return a};return d}(g);a.exports=new d},function(a,d,b){function c(a,d){if("function"!==typeof d&&null!==
d)throw new TypeError("Super expression must either be null or a function, not "+("undefined"===typeof d?"undefined":O(d)));a.prototype=Object.create(d&&d.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}});if(d)if(Object.setPrototypeOf)Object.setPrototypeOf(a,d);else for(var b=Object.getOwnPropertyNames(d),c=0;c<b.length;c++){var g=b[c],e=Object.getOwnPropertyDescriptor(d,g);e&&e.configurable&&void 0===a[g]&&Object.defineProperty(a,g,e)}}var g="function"===typeof Symbol&&
"symbol"===O(Symbol.iterator)?function(a){return"undefined"===typeof a?"undefined":O(a)}:function(a){return a&&"function"===typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":"undefined"===typeof a?"undefined":O(a)},k=b(2),l=b(11),m=b(16),n=b(12);d=function(a){function d(){if(!(this instanceof d))throw new TypeError("Cannot call a class as a function");var b;b=a.call(this);if(!this)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");b=!b||"object"!==
("undefined"===typeof b?"undefined":O(b))&&"function"!==typeof b?this:b;b._type="alternatives";b._invalids.remove(null);b._inner.matches=[];return b}c(d,a);d.prototype._base=function(a,d,b){for(var c=[],g=this._inner.matches.length,e=this._baseType,f=0;f<g;++f){var k=this._inner.matches[f],p=k.schema;if(p){k=p._validate(a,d,b);if(!k.errors)return k;c=c.concat(k.errors)}else{if(k.is._validate(k.ref(d.reference||d.parent,b),null,b,d.parent).errors){if(k.otherwise)return k.otherwise._validate(a,d,b)}else if(k.then)return k.then._validate(a,
d,b);if(f===g-1&&e)return e._validate(a,d,b)}}return c.length?{errors:this.createError("alternatives.child",{reason:c},d,b)}:{errors:this.createError("alternatives.base",null,d,b)}};d.prototype.try=function(){var a=k.flatten(Array.prototype.slice.call(arguments));k.assert(a.length,"Cannot add other alternatives without at least one schema");for(var d=this.clone(),b=0;b<a.length;++b){var c=m.schema(a[b]);c._refs.length&&(d._refs=d._refs.concat(c._refs));d._inner.matches.push({schema:c})}return d};
d.prototype.when=function(a,d){k.assert(n.isRef(a)||"string"===typeof a,"Invalid reference:",a);k.assert(d,"Missing options");k.assert("object"===("undefined"===typeof d?"undefined":g(d)),"Invalid options");k.assert(d.hasOwnProperty("is"),'Missing "is" directive');k.assert(void 0!==d.then||void 0!==d.otherwise,'options must have at least one of "then" or "otherwise"');var b=this.clone(),c=m.schema(d.is);null!==d.is&&(n.isRef(d.is)||d.is instanceof l)||(c=c.required());a={ref:m.ref(a),is:c,then:void 0!==
d.then?m.schema(d.then):void 0,otherwise:void 0!==d.otherwise?m.schema(d.otherwise):void 0};b._baseType&&(a.then=a.then&&b._baseType.concat(a.then),a.otherwise=a.otherwise&&b._baseType.concat(a.otherwise));n.push(b._refs,a.ref);b._refs=b._refs.concat(a.is._refs);a.then&&a.then._refs&&(b._refs=b._refs.concat(a.then._refs));a.otherwise&&a.otherwise._refs&&(b._refs=b._refs.concat(a.otherwise._refs));b._inner.matches.push(a);return b};d.prototype.describe=function(){for(var a=l.prototype.describe.call(this),
d=[],b=0;b<this._inner.matches.length;++b){var c=this._inner.matches[b];if(c.schema)d.push(c.schema.describe());else{var g={ref:c.ref.toString(),is:c.is.describe()};c.then&&(g.then=c.then.describe());c.otherwise&&(g.otherwise=c.otherwise.describe());d.push(g)}}a.alternatives=d;return a};return d}(l);a.exports=new d},function(a,d,b){function c(a,d){if("function"!==typeof d&&null!==d)throw new TypeError("Super expression must either be null or a function, not "+("undefined"===typeof d?"undefined":O(d)));
a.prototype=Object.create(d&&d.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}});if(d)if(Object.setPrototypeOf)Object.setPrototypeOf(a,d);else for(var b=Object.getOwnPropertyNames(d),c=0;c<b.length;c++){var g=b[c],e=Object.getOwnPropertyDescriptor(d,g);e&&e.configurable&&void 0===a[g]&&Object.defineProperty(a,g,e)}}var g="function"===typeof Symbol&&"symbol"===O(Symbol.iterator)?function(a){return"undefined"===typeof a?"undefined":O(a)}:function(a){return a&&"function"===
typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":"undefined"===typeof a?"undefined":O(a)},k=b(2),l=b(27),m=b(11),n=b(13),r=b(16),u=b(12),p={};p.Object=function(a){function d(){if(!(this instanceof d))throw new TypeError("Cannot call a class as a function");var b;b=a.call(this);if(!this)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");b=!b||"object"!==("undefined"===typeof b?"undefined":O(b))&&"function"!==typeof b?this:b;b._type="object";b._inner.children=
null;b._inner.renames=[];b._inner.dependencies=[];b._inner.patterns=[];return b}c(d,a);d.prototype._base=function(a,d,b){var c=a,e=[],f=function(){return{value:c,errors:e.length?e:null}};"string"===typeof a&&b.convert&&(a=p.safeParse(a));var m=this._flags.func?"function":"object";if(!a||("undefined"===typeof a?"undefined":g(a))!==m||Array.isArray(a))return e.push(this.createError(m+".base",null,d,b)),f();if(!(this._inner.renames.length||this._inner.dependencies.length||this._inner.children||this._inner.patterns.length))return c=
a,f();if(c===a){"object"===m?c=Object.create(Object.getPrototypeOf(a)):(c=function(){return a.apply(this,arguments)},c.prototype=k.clone(a.prototype));for(var m=Object.keys(a),l=0;l<m.length;++l)c[m[l]]=a[m[l]]}else c=a;m={};for(l=0;l<this._inner.renames.length;++l){var r=this._inner.renames[l];if(!r.options.ignoreUndefined||void 0!==c[r.from]){if(!r.options.multiple&&m[r.to]&&(e.push(this.createError("object.rename.multiple",{from:r.from,to:r.to},d,b)),b.abortEarly)||Object.prototype.hasOwnProperty.call(c,
r.to)&&!r.options.override&&!m[r.to]&&(e.push(this.createError("object.rename.override",{from:r.from,to:r.to},d,b)),b.abortEarly))return f();void 0===c[r.from]?delete c[r.to]:c[r.to]=c[r.from];m[r.to]=!0;r.options.alias||delete c[r.from]}}if(!this._inner.children&&!this._inner.patterns.length&&!this._inner.dependencies.length)return f();m=k.mapToObject(Object.keys(c));if(this._inner.children){l=[];for(r=0;r<this._inner.children.length;++r){var u=this._inner.children[r],t=u.key,w=c[t];delete m[t];
var x={key:t,path:(d.path||"")+(d.path&&t?".":"")+t,parent:c,reference:d.reference},y=u.schema._validate(w,x,b);if(y.errors){if(e.push(this.createError("object.child",{key:t,child:u.schema._getLabel(t),reason:y.errors},x,b)),b.abortEarly)return f()}else u.schema._flags.strip||void 0===y.value&&y.value!==w?(l.push(t),c[t]=y.finalValue):void 0!==y.value&&(c[t]=y.value)}for(r=0;r<l.length;++r)delete c[l[r]]}l=Object.keys(m);if(l.length&&this._inner.patterns.length){for(r=0;r<l.length;++r)for(u=l[r],
t={key:u,path:(d.path?d.path+".":"")+u,parent:c,reference:d.reference},w=c[u],x=0;x<this._inner.patterns.length;++x)if(y=this._inner.patterns[x],y.regex.test(u)){delete m[u];var v=y.rule._validate(w,t,b);if(v.errors&&(e.push(this.createError("object.child",{key:u,child:y.rule._getLabel(u),reason:v.errors},t,b)),b.abortEarly))return f();void 0!==v.value&&(c[u]=v.value)}l=Object.keys(m)}if((this._inner.children||this._inner.patterns.length)&&l.length){if(b.stripUnknown&&!0!==this._flags.allowUnknown||
b.skipFunctions){r=b.stripUnknown?!0===b.stripUnknown?!0:!!b.stripUnknown.objects:!1;for(u=0;u<l.length;++u)t=l[u],r?(delete c[t],delete m[t]):"function"===typeof c[t]&&delete m[t];l=Object.keys(m)}if(l.length&&(void 0!==this._flags.allowUnknown?!this._flags.allowUnknown:!b.allowUnknown))for(m=0;m<l.length;++m)r=l[m],e.push(this.createError("object.allowUnknown",{child:r},{key:r,path:d.path+(d.path?".":"")+r},b))}for(m=0;m<this._inner.dependencies.length&&!(l=this._inner.dependencies[m],l=p[l.type].call(this,
null!==l.key&&c[l.key],l.peers,c,{key:l.key,path:(d.path||"")+(l.key?"."+l.key:"")},b),l instanceof n.Err&&(e.push(l),b.abortEarly));++m);return f()};d.prototype._func=function(){var a=this.clone();a._flags.func=!0;return a};d.prototype.keys=function(a){k.assert(null===a||void 0===a||"object"===("undefined"===typeof a?"undefined":g(a)),"Object schema must be a valid object");k.assert(!a||!(a instanceof m),"Object schema cannot be a joi schema");var d=this.clone();if(!a)return d._inner.children=null,
d;var b=Object.keys(a);if(!b.length)return d._inner.children=[],d;var c=new l;if(d._inner.children)for(var e=0;e<d._inner.children.length;++e){var f=d._inner.children[e];-1===b.indexOf(f.key)&&c.add(f,{after:f._refs,group:f.key})}for(e=0;e<b.length;++e){var f=b[e],p=a[f];try{var n=r.schema(p);c.add({key:f,schema:n},{after:n._refs,group:f})}catch(K){throw K.hasOwnProperty("path")?K.path=f+"."+K.path:K.path=f,K;}}d._inner.children=c.nodes;return d};d.prototype.unknown=function(a){a=!1!==a;if(this._flags.allowUnknown===
a)return this;var d=this.clone();d._flags.allowUnknown=a;return d};d.prototype.length=function(a){k.assert(Number.isSafeInteger(a)&&0<=a,"limit must be a positive integer");return this._test("length",a,function(d,b,c){return Object.keys(d).length===a?d:this.createError("object.length",{limit:a},b,c)})};d.prototype.arity=function(a){k.assert(Number.isSafeInteger(a)&&0<=a,"n must be a positive integer");return this._test("arity",a,function(d,b,c){return d.length===a?d:this.createError("function.arity",
{n:a},b,c)})};d.prototype.minArity=function(a){k.assert(Number.isSafeInteger(a)&&0<a,"n must be a strict positive integer");return this._test("minArity",a,function(d,b,c){return d.length>=a?d:this.createError("function.minArity",{n:a},b,c)})};d.prototype.maxArity=function(a){k.assert(Number.isSafeInteger(a)&&0<=a,"n must be a positive integer");return this._test("maxArity",a,function(d,b,c){return d.length<=a?d:this.createError("function.maxArity",{n:a},b,c)})};d.prototype.min=function(a){k.assert(Number.isSafeInteger(a)&&
0<=a,"limit must be a positive integer");return this._test("min",a,function(d,b,c){return Object.keys(d).length>=a?d:this.createError("object.min",{limit:a},b,c)})};d.prototype.max=function(a){k.assert(Number.isSafeInteger(a)&&0<=a,"limit must be a positive integer");return this._test("max",a,function(d,b,c){return Object.keys(d).length<=a?d:this.createError("object.max",{limit:a},b,c)})};d.prototype.pattern=function(a,d){k.assert(a instanceof RegExp,"Invalid regular expression");k.assert(void 0!==
d,"Invalid rule");a=new RegExp(a.source,a.ignoreCase?"i":void 0);try{d=r.schema(d)}catch(A){throw A.hasOwnProperty("path")&&(A.message=A.message+"("+A.path+")"),A;}var b=this.clone();b._inner.patterns.push({regex:a,rule:d});return b};d.prototype.schema=function(){return this._test("schema",null,function(a,d,b){return a instanceof m?a:this.createError("object.schema",null,d,b)})};d.prototype.with=function(a,d){return this._dependency("with",a,d)};d.prototype.without=function(a,d){return this._dependency("without",
a,d)};d.prototype.xor=function(){var a=k.flatten(Array.prototype.slice.call(arguments));return this._dependency("xor",null,a)};d.prototype.or=function(){var a=k.flatten(Array.prototype.slice.call(arguments));return this._dependency("or",null,a)};d.prototype.and=function(){var a=k.flatten(Array.prototype.slice.call(arguments));return this._dependency("and",null,a)};d.prototype.nand=function(){var a=k.flatten(Array.prototype.slice.call(arguments));return this._dependency("nand",null,a)};d.prototype.requiredKeys=
function(a){a=k.flatten(Array.prototype.slice.call(arguments));return this.applyFunctionToChildren(a,"required")};d.prototype.optionalKeys=function(a){a=k.flatten(Array.prototype.slice.call(arguments));return this.applyFunctionToChildren(a,"optional")};d.prototype.forbiddenKeys=function(a){a=k.flatten(Array.prototype.slice.call(arguments));return this.applyFunctionToChildren(a,"forbidden")};d.prototype.rename=function(a,d,b){k.assert("string"===typeof a,"Rename missing the from argument");k.assert("string"===
typeof d,"Rename missing the to argument");k.assert(d!==a,"Cannot rename key to same name:",a);for(var c=0;c<this._inner.renames.length;++c)k.assert(this._inner.renames[c].from!==a,"Cannot rename the same key multiple times");c=this.clone();c._inner.renames.push({from:a,to:d,options:k.applyToDefaults(p.renameDefaults,b||{})});return c};d.prototype.applyFunctionToChildren=function(a,d,b,c){a=[].concat(a);k.assert(0<a.length,"expected at least one children");var g=p.groupChildren(a);""in g?(a=this[d].apply(this,
b),delete g[""]):a=this.clone();if(a._inner.children){c=c?c+".":"";for(var e=0;e<a._inner.children.length;++e){var f=a._inner.children[e],l=g[f.key];l&&(a._inner.children[e]={key:f.key,_refs:f._refs,schema:f.schema.applyFunctionToChildren(l,d,b,c+f.key)},delete g[f.key])}}d=Object.keys(g);k.assert(0===d.length,"unknown key(s)",d.join(", "));return a};d.prototype._dependency=function(a,d,b){b=[].concat(b);for(var c=0;c<b.length;++c)k.assert("string"===typeof b[c],a,"peers must be a string or array of strings");
c=this.clone();c._inner.dependencies.push({type:a,key:d,peers:b});return c};d.prototype.describe=function(a){var d=m.prototype.describe.call(this);if(d.rules)for(var b=0;b<d.rules.length;++b){var c=d.rules[b];c.arg&&"object"===g(c.arg)&&c.arg.schema&&c.arg.ref&&(c.arg={schema:c.arg.schema.describe(),ref:c.arg.ref.toString()})}if(this._inner.children&&!a)for(d.children={},a=0;a<this._inner.children.length;++a)b=this._inner.children[a],d.children[b.key]=b.schema.describe();this._inner.dependencies.length&&
(d.dependencies=k.clone(this._inner.dependencies));if(this._inner.patterns.length)for(d.patterns=[],a=0;a<this._inner.patterns.length;++a)b=this._inner.patterns[a],d.patterns.push({regex:b.regex.toString(),rule:b.rule.describe()});0<this._inner.renames.length&&(d.renames=k.clone(this._inner.renames));return d};d.prototype.assert=function(a,d,b){a=r.ref(a);k.assert(a.isContext||1<a.depth,"Cannot use assertions for root level references - use direct key rules instead");b=b||"pass the assertion test";
try{d=r.schema(d)}catch(C){throw C.hasOwnProperty("path")&&(C.message=C.message+"("+C.path+")"),C;}var c=a.path[a.path.length-1],g=a.path.join(".");return this._test("assert",{schema:d,ref:a},function(e,f,p){if(!d._validate(a(e),null,p,e).errors)return e;e=k.merge({},f);e.key=c;e.path=g;return this.createError("object.assert",{ref:e.path,message:b},e,p)})};d.prototype.type=function(a,d){k.assert("function"===typeof a,"type must be a constructor function");var b={name:d||a.name,ctor:a};return this._test("type",
b,function(d,c,g){return d instanceof a?d:this.createError("object.type",{type:b.name},c,g)})};d.prototype.ref=function(){return this._test("ref",null,function(a,d,b){return u.isRef(a)?a:this.createError("function.ref",null,d,b)})};return d}(m);p.safeParse=function(a){try{return JSON.parse(a)}catch(y){}return a};p.renameDefaults={alias:!1,multiple:!1,override:!1};p.groupChildren=function(a){a.sort();for(var d={},b=0;b<a.length;++b){var c=a[b];k.assert("string"===typeof c,"children must be strings");
var g=c.split(".")[0];(d[g]=d[g]||[]).push(c.substring(g.length+1))}return d};p.keysToLabels=function(a,d){var b=a._inner.children;if(!b)return d;a=function(a){var d=b.find(function(d){return d.key===a});return d?d.schema._getLabel(a):a};return Array.isArray(d)?d.map(a):a(d)};p.with=function(a,d,b,c,g){if(void 0===a)return a;for(var e=0;e<d.length;++e){var f=d[e];if(!Object.prototype.hasOwnProperty.call(b,f)||void 0===b[f])return this.createError("object.with",{main:c.key,mainWithLabel:p.keysToLabels(this,
c.key),peer:f,peerWithLabel:p.keysToLabels(this,f)},c,g)}return a};p.without=function(a,d,b,c,g){if(void 0===a)return a;for(var e=0;e<d.length;++e){var f=d[e];if(Object.prototype.hasOwnProperty.call(b,f)&&void 0!==b[f])return this.createError("object.without",{main:c.key,mainWithLabel:p.keysToLabels(this,c.key),peer:f,peerWithLabel:p.keysToLabels(this,f)},c,g)}return a};p.xor=function(a,d,b,c,g){for(var e=[],f=0;f<d.length;++f){var k=d[f];Object.prototype.hasOwnProperty.call(b,k)&&void 0!==b[k]&&
e.push(k)}if(1===e.length)return a;a={peers:d,peersWithLabels:p.keysToLabels(this,d)};return 0===e.length?this.createError("object.missing",a,c,g):this.createError("object.xor",a,c,g)};p.or=function(a,d,b,c,g){for(var e=0;e<d.length;++e){var f=d[e];if(Object.prototype.hasOwnProperty.call(b,f)&&void 0!==b[f])return a}return this.createError("object.missing",{peers:d,peersWithLabels:p.keysToLabels(this,d)},c,g)};p.and=function(a,d,b,c,g){a=[];for(var e=[],f=d.length,k=0;k<f;++k){var l=d[k];Object.prototype.hasOwnProperty.call(b,
l)&&void 0!==b[l]?e.push(l):a.push(l)}if(a.length!==f&&e.length!==f)return this.createError("object.and",{present:e,presentWithLabels:p.keysToLabels(this,e),missing:a,missingWithLabels:p.keysToLabels(this,a)},c,g)};p.nand=function(a,d,b,c,g){a=[];for(var e=0;e<d.length;++e){var f=d[e];Object.prototype.hasOwnProperty.call(b,f)&&void 0!==b[f]&&a.push(f)}b=k.clone(d);e=b.splice(0,1)[0];return a.length===d.length?this.createError("object.nand",{main:e,mainWithLabel:p.keysToLabels(this,e),peers:b,peersWithLabels:p.keysToLabels(this,
b)},c,g):null};a.exports=new p.Object},function(a,d,b){var c=b(2),g={};a.exports=g.Topo=function(){this._items=[];this.nodes=[]};g.Topo.prototype.add=function(a,d){var b=this;d=d||{};var g=[].concat(d.before||[]),e=[].concat(d.after||[]),f=d.group||"?",k=d.sort||0;c.assert(-1===g.indexOf(f),"Item cannot come before itself:",f);c.assert(-1===g.indexOf("?"),"Item cannot come before unassociated items");c.assert(-1===e.indexOf(f),"Item cannot come after itself:",f);c.assert(-1===e.indexOf("?"),"Item cannot come after unassociated items");
[].concat(a).forEach(function(a,d){b._items.push({seq:b._items.length,sort:k,before:g,after:e,group:f,node:a})});a=this._sort();c.assert(!a,"item","?"!==f?"added into group "+f:"","created a dependencies error");return this.nodes};g.Topo.prototype.merge=function(a){a=[].concat(a);for(var d=0;d<a.length;++d){var b=a[d];if(b)for(var e=0;e<b._items.length;++e){var f=c.shallow(b._items[e]);this._items.push(f)}}this._items.sort(g.mergeSort);for(a=0;a<this._items.length;++a)this._items[a].seq=a;a=this._sort();
c.assert(!a,"merge created a dependencies error");return this.nodes};g.mergeSort=function(a,d){return a.sort===d.sort?0:a.sort<d.sort?-1:1};g.Topo.prototype._sort=function(){for(var a={},d=Object.create(null),b=Object.create(null),c=0;c<this._items.length;++c){var g=this._items[c],e=g.seq,f=g.group;b[f]=b[f]||[];b[f].push(e);a[e]=g.before;g=g.after;for(f=0;f<g.length;++f)d[g[f]]=(d[g[f]]||[]).concat(e)}c=Object.keys(a);for(e=0;e<c.length;++e){for(var g=c[e],f=[],t=Object.keys(a[g]),y=0;y<t.length;++y){var w=
a[g][t[y]];b[w]=b[w]||[];for(var x=0;x<b[w].length;++x)f.push(b[w][x])}a[g]=f}c=Object.keys(d);for(e=0;e<c.length;++e)if(g=c[e],b[g])for(f=0;f<b[g].length;++f)t=b[g][f],a[t]=a[t].concat(d[g]);b=void 0;d={};c=Object.keys(a);for(e=0;e<c.length;++e)for(g=c[e],b=a[g],f=0;f<b.length;++f)d[b[f]]=(d[b[f]]||[]).concat(g);b={};a=[];for(c=0;c<this._items.length;++c){e=c;if(d[c])for(e=null,g=0;g<this._items.length;++g)if(!0!==b[g]){d[g]||(d[g]=[]);f=d[g].length;for(y=t=0;y<f;++y)0<=a.indexOf(d[g][y])&&++t;if(t===
f){e=g;break}}null!==e&&(e=e.toString(),b[e]=!0,a.push(e))}if(a.length!==this._items.length)return Error("Invalid dependencies");for(var v={},d=0;d<this._items.length;++d)b=this._items[d],v[b.seq]=b;var A=[];this._items=a.map(function(a){a=v[a];A.push(a.node);return a});this.nodes=A}},function(a,d,b){a=b(1);d.options=a.object({abortEarly:a.boolean(),convert:a.boolean(),allowUnknown:a.boolean(),skipFunctions:a.boolean(),stripUnknown:[a.boolean(),a.object({arrays:a.boolean(),objects:a.boolean()}).or("arrays",
"objects")],language:a.object(),presence:a.string().only("required","optional","forbidden","ignore"),raw:a.boolean(),context:a.object(),strip:a.boolean(),noDefaults:a.boolean()}).strict()},function(a,d,b){function c(a,d){if("function"!==typeof d&&null!==d)throw new TypeError("Super expression must either be null or a function, not "+("undefined"===typeof d?"undefined":O(d)));a.prototype=Object.create(d&&d.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}});if(d)if(Object.setPrototypeOf)Object.setPrototypeOf(a,
d);else for(var b=Object.getOwnPropertyNames(d),c=0;c<b.length;c++){var g=b[c],e=Object.getOwnPropertyDescriptor(d,g);e&&e.configurable&&void 0===a[g]&&Object.defineProperty(a,g,e)}}var g=b(11),k=b(2);d=function(a){function d(){if(!(this instanceof d))throw new TypeError("Cannot call a class as a function");var b;b=a.call(this);if(!this)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");b=!b||"object"!==("undefined"===typeof b?"undefined":O(b))&&"function"!==typeof b?
this:b;b._type="lazy";return b}c(d,a);d.prototype._base=function(a,d,b){var c={value:a},e=this._flags.lazy;if(!e)return c.errors=this.createError("lazy.base",null,d,b),c;e=e();return e instanceof g?e._validate(a,d,b):(c.errors=this.createError("lazy.schema",null,d,b),c)};d.prototype.set=function(a){k.assert("function"===typeof a,"You must provide a function as first argument");var d=this.clone();d._flags.lazy=a;return d};return d}(g);a.exports=new d},function(a,d,b){function c(a,d){if("function"!==
typeof d&&null!==d)throw new TypeError("Super expression must either be null or a function, not "+("undefined"===typeof d?"undefined":O(d)));a.prototype=Object.create(d&&d.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}});if(d)if(Object.setPrototypeOf)Object.setPrototypeOf(a,d);else for(var b=Object.getOwnPropertyNames(d),c=0;c<b.length;c++){var g=b[c],e=Object.getOwnPropertyDescriptor(d,g);e&&e.configurable&&void 0===a[g]&&Object.defineProperty(a,g,e)}}var g="function"===
typeof Symbol&&"symbol"===O(Symbol.iterator)?function(a){return"undefined"===typeof a?"undefined":O(a)}:function(a){return a&&"function"===typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":"undefined"===typeof a?"undefined":O(a)},k=b(11),l=b(16),m=b(12),n=b(2),r={fastSplice:function(a,d){for(;d<a.length;)a[d++]=a[d];--a.length}};r.Array=function(a){function d(){if(!(this instanceof d))throw new TypeError("Cannot call a class as a function");var b;b=a.call(this);if(!this)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
b=!b||"object"!==("undefined"===typeof b?"undefined":O(b))&&"function"!==typeof b?this:b;b._type="array";b._inner.items=[];b._inner.ordereds=[];b._inner.inclusions=[];b._inner.exclusions=[];b._inner.requireds=[];b._flags.sparse=!1;return b}c(d,a);d.prototype._base=function(a,d,b){var c={value:a};"string"===typeof a&&b.convert&&r.safeParse(a,c);var g=Array.isArray(c.value);a=g;b.convert&&this._flags.single&&!g&&(c.value=[c.value],g=!0);if(!g)return c.errors=this.createError("array.base",null,d,b),
c;if(this._inner.inclusions.length||this._inner.exclusions.length||this._inner.requireds.length||this._inner.ordereds.length||!this._flags.sparse)a&&(c.value=c.value.slice(0)),c.errors=this._checkItems.call(this,c.value,a,d,b),c.errors&&a&&b.convert&&this._flags.single&&(g=c.errors,c.value=[c.value],c.errors=this._checkItems.call(this,c.value,a,d,b),c.errors&&(c.errors=g,c.value=c.value[0]));return c};d.prototype._checkItems=function(a,d,b,c){for(var g=[],e,f=this._inner.requireds.slice(),k=this._inner.ordereds.slice(),
p=this._inner.inclusions.concat(f),l=a.length,n=0;n<l;++n){e=!1;var m=a[n],u=!1,t={key:d?n:b.key,path:d?(b.path?b.path+".":"")+n:b.path,parent:b.parent,reference:b.reference},w;if(this._flags.sparse||void 0!==m){for(var y=0;y<this._inner.exclusions.length;++y)if(w=this._inner.exclusions[y]._validate(m,t,{}),!w.errors){g.push(this.createError(d?"array.excludes":"array.excludesSingle",{pos:n,value:m},{key:b.key,path:t.path},c));e=!0;if(c.abortEarly)return g;break}if(!e){if(this._inner.ordereds.length)if(0<
k.length){e=k.shift();w=e._validate(m,t,c);if(w.errors){if(g.push(this.createError("array.ordered",{pos:n,reason:w.errors,value:m},{key:b.key,path:t.path},c)),c.abortEarly)return g}else if(e._flags.strip)r.fastSplice(a,n),--n,--l;else if(this._flags.sparse||void 0!==w.value)a[n]=w.value;else{g.push(this.createError("array.sparse",null,{key:b.key,path:t.path,pos:n},c));if(c.abortEarly)return g;continue}continue}else if(!this._inner.items.length){g.push(this.createError("array.orderedLength",{pos:n,
limit:this._inner.ordereds.length},{key:b.key,path:t.path},c));if(c.abortEarly)return g;continue}for(var y=[],x=f.length,q=0;q<x;++q)if(w=y[q]=f[q]._validate(m,t,c),!w.errors){a[n]=w.value;u=!0;r.fastSplice(f,q);if(!this._flags.sparse&&void 0===w.value&&(g.push(this.createError("array.sparse",null,{key:b.key,path:t.path,pos:n},c)),c.abortEarly))return g;break}if(!u){for(var q=c.stripUnknown?!0===c.stripUnknown?!0:!!c.stripUnknown.arrays:!1,x=p.length,B=0;B<x;++B){var D=p[B];w=f.indexOf(D);if(-1!==
w)w=y[w];else if(w=D._validate(m,t,c),!w.errors){D._flags.strip?(r.fastSplice(a,n),--n,--l):this._flags.sparse||void 0!==w.value?a[n]=w.value:(g.push(this.createError("array.sparse",null,{key:b.key,path:t.path,pos:n},c)),e=!0);u=!0;break}if(1===x){if(q){r.fastSplice(a,n);--n;--l;u=!0;break}g.push(this.createError(d?"array.includesOne":"array.includesOneSingle",{pos:n,reason:w.errors,value:m},{key:b.key,path:t.path},c));e=!0;if(c.abortEarly)return g;break}}if(!e&&this._inner.inclusions.length&&!u)if(q)r.fastSplice(a,
n),--n,--l;else if(g.push(this.createError(d?"array.includes":"array.includesSingle",{pos:n,value:m},{key:b.key,path:t.path},c)),c.abortEarly)return g}}}else if(g.push(this.createError("array.sparse",null,{key:b.key,path:t.path,pos:n},c)),c.abortEarly)return g}f.length&&this._fillMissedErrors.call(this,g,f,b,c);k.length&&this._fillOrderedErrors.call(this,g,k,b,c);return g.length?g:null};d.prototype.describe=function(){var a=k.prototype.describe.call(this);if(this._inner.ordereds.length){a.orderedItems=
[];for(var d=0;d<this._inner.ordereds.length;++d)a.orderedItems.push(this._inner.ordereds[d].describe())}if(this._inner.items.length)for(a.items=[],d=0;d<this._inner.items.length;++d)a.items.push(this._inner.items[d].describe());return a};d.prototype.items=function(){var a=this.clone();n.flatten(Array.prototype.slice.call(arguments)).forEach(function(d,b){try{d=l.schema(d)}catch(x){throw x.hasOwnProperty("path")?x.path=b+"."+x.path:x.path=b,x.message=x.message+"("+x.path+")",x;}a._inner.items.push(d);
"required"===d._flags.presence?a._inner.requireds.push(d):"forbidden"===d._flags.presence?a._inner.exclusions.push(d.optional()):a._inner.inclusions.push(d)});return a};d.prototype.ordered=function(){var a=this.clone();n.flatten(Array.prototype.slice.call(arguments)).forEach(function(d,b){try{d=l.schema(d)}catch(x){throw x.hasOwnProperty("path")?x.path=b+"."+x.path:x.path=b,x.message=x.message+"("+x.path+")",x;}a._inner.ordereds.push(d)});return a};d.prototype.min=function(a){var d=m.isRef(a);n.assert(Number.isSafeInteger(a)&&
0<=a||d,"limit must be a positive integer or reference");return this._test("min",a,function(b,c,g){var e;if(d){if(e=a(c.reference||c.parent,g),!(Number.isSafeInteger(e)&&0<=e))return this.createError("array.ref",{ref:a.key},c,g)}else e=a;return b.length>=e?b:this.createError("array.min",{limit:a,value:b},c,g)})};d.prototype.max=function(a){var d=m.isRef(a);n.assert(Number.isSafeInteger(a)&&0<=a||d,"limit must be a positive integer or reference");return this._test("max",a,function(b,c,g){var e;if(d){if(e=
a(c.reference||c.parent,g),!(Number.isSafeInteger(e)&&0<=e))return this.createError("array.ref",{ref:a.key},c,g)}else e=a;return b.length<=e?b:this.createError("array.max",{limit:a,value:b},c,g)})};d.prototype.length=function(a){var d=m.isRef(a);n.assert(Number.isSafeInteger(a)&&0<=a||d,"limit must be a positive integer or reference");return this._test("length",a,function(b,c,g){var e;if(d){if(e=a(c.reference||c.parent,g),!(Number.isSafeInteger(e)&&0<=e))return this.createError("array.ref",{ref:a.key},
c,g)}else e=a;return b.length===e?b:this.createError("array.length",{limit:a,value:b},c,g)})};d.prototype.unique=function(a){n.assert(void 0===a||"function"===typeof a||"string"===typeof a,"comparator must be a function or a string");var d={};"string"===typeof a?d.path=a:"function"===typeof a&&(d.comparator=a);return this._test("unique",d,function(a,b,c){for(var e={string:{},number:{},undefined:{},boolean:{},object:new Map,function:new Map,custom:new Map},f=d.comparator||n.deepEqual,k=0;k<a.length;++k){var p=
d.path?n.reach(a[k],d.path):a[k],l=d.comparator?e.custom:e["undefined"===typeof p?"undefined":g(p)];if(l)if(l instanceof Map){for(var m=l.entries(),r;!(r=m.next()).done;)if(f(r.value[0],p))return p={key:b.key,path:(b.path?b.path+".":"")+k,parent:b.parent,reference:b.reference},a={pos:k,value:a[k],dupePos:r.value[1],dupeValue:a[r.value[1]]},d.path&&(a.path=d.path),this.createError("array.unique",a,p,c);l.set(p,k)}else{if(void 0!==l[p])return r={key:b.key,path:(b.path?b.path+".":"")+k,parent:b.parent,
reference:b.reference},a={pos:k,value:a[k],dupePos:l[p],dupeValue:a[l[p]]},d.path&&(a.path=d.path),this.createError("array.unique",a,r,c);l[p]=k}}return a})};d.prototype.sparse=function(a){a=void 0===a?!0:!!a;if(this._flags.sparse===a)return this;var d=this.clone();d._flags.sparse=a;return d};d.prototype.single=function(a){a=void 0===a?!0:!!a;if(this._flags.single===a)return this;var d=this.clone();d._flags.single=a;return d};d.prototype._fillMissedErrors=function(a,d,b,c){for(var g=[],e=0,f=0;f<
d.length;++f){var k=d[f]._getLabel();k?g.push(k):++e}g.length?e?a.push(this.createError("array.includesRequiredBoth",{knownMisses:g,unknownMisses:e},{key:b.key,path:b.path},c)):a.push(this.createError("array.includesRequiredKnowns",{knownMisses:g},{key:b.key,path:b.path},c)):a.push(this.createError("array.includesRequiredUnknowns",{unknownMisses:e},{key:b.key,path:b.path},c))};d.prototype._fillOrderedErrors=function(a,d,b,c){for(var g=[],e=0;e<d.length;++e)"required"===n.reach(d[e],"_flags.presence")&&
g.push(d[e]);g.length&&this._fillMissedErrors.call(this,a,g,b,c)};return d}(k);r.safeParse=function(a,d){try{var b=JSON.parse(a);Array.isArray(b)&&(d.value=b)}catch(y){}};a.exports=new r.Array},function(a,d,b){(function(d){function c(a,d){if("function"!==typeof d&&null!==d)throw new TypeError("Super expression must either be null or a function, not "+("undefined"===typeof d?"undefined":O(d)));a.prototype=Object.create(d&&d.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}});
if(d)if(Object.setPrototypeOf)Object.setPrototypeOf(a,d);else for(var b=Object.getOwnPropertyNames(d),c=0;c<b.length;c++){var g=b[c],e=Object.getOwnPropertyDescriptor(d,g);e&&e.configurable&&void 0===a[g]&&Object.defineProperty(a,g,e)}}var g=b(11),e=b(2),g=function(a){function b(){if(!(this instanceof b))throw new TypeError("Cannot call a class as a function");var d;d=a.call(this);if(!this)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");d=!d||"object"!==("undefined"===
typeof d?"undefined":O(d))&&"function"!==typeof d?this:d;d._type="binary";return d}c(b,a);b.prototype._base=function(a,b,c){var g={value:a};if("string"===typeof a&&c.convert)try{g.value=new d(a,this._flags.encoding)}catch(y){}g.errors=d.isBuffer(g.value)?null:this.createError("binary.base",null,b,c);return g};b.prototype.encoding=function(a){e.assert(d.isEncoding(a),"Invalid encoding:",a);if(this._flags.encoding===a)return this;var b=this.clone();b._flags.encoding=a;return b};b.prototype.min=function(a){e.assert(Number.isSafeInteger(a)&&
0<=a,"limit must be a positive integer");return this._test("min",a,function(d,b,c){return d.length>=a?d:this.createError("binary.min",{limit:a,value:d},b,c)})};b.prototype.max=function(a){e.assert(Number.isSafeInteger(a)&&0<=a,"limit must be a positive integer");return this._test("max",a,function(d,b,c){return d.length<=a?d:this.createError("binary.max",{limit:a,value:d},b,c)})};b.prototype.length=function(a){e.assert(Number.isSafeInteger(a)&&0<=a,"limit must be a positive integer");return this._test("length",
a,function(d,b,c){return d.length===a?d:this.createError("binary.length",{limit:a,value:d},b,c)})};return b}(g);a.exports=new g}).call(d,b(3).Buffer)},function(a,d){a.exports={_args:[[{raw:"joi@10.6.0",scope:null,escapedName:"joi",name:"joi",rawSpec:"10.6.0",spec:"10.6.0",type:"version"},"/Users/jeff/projects/joi-browser"]],_from:"joi@10.6.0",_id:"joi@10.6.0",_inCache:!0,_location:"/joi",_nodeVersion:"6.11.0",_npmOperationalInternal:{host:"s3://npm-registry-packages",tmp:"tmp/joi-10.6.0.tgz_1497548465053_0.7665833418723196"},
_npmUser:{name:"marsup",email:"nicolas@morel.io"},_npmVersion:"5.0.3",_phantomChildren:{},_requested:{raw:"joi@10.6.0",scope:null,escapedName:"joi",name:"joi",rawSpec:"10.6.0",spec:"10.6.0",type:"version"},_requiredBy:["#DEV:/"],_resolved:"https://registry.npmjs.org/joi/-/joi-10.6.0.tgz",_shasum:"52587f02d52b8b75cdb0c74f0b164a191a0e1fc2",_shrinkwrap:null,_spec:"joi@10.6.0",_where:"/Users/jeff/projects/joi-browser",bugs:{url:"https://github.com/hapijs/joi/issues"},dependencies:{hoek:"4.x.x",isemail:"2.x.x",
items:"2.x.x",topo:"2.x.x"},description:"Object schema validation",devDependencies:{code:"4.x.x",hapitoc:"1.x.x",lab:"13.x.x"},directories:{},dist:{integrity:"sha512-hBF3LcqyAid+9X/pwg+eXjD2QBZI5eXnBFJYaAkH4SK3mp9QSRiiQnDYlmlz5pccMvnLcJRS4whhDOTCkmsAdQ==",shasum:"52587f02d52b8b75cdb0c74f0b164a191a0e1fc2",tarball:"https://registry.npmjs.org/joi/-/joi-10.6.0.tgz"},engines:{node:">=4.0.0"},gitHead:"069bb6c04063cba202544dacf9da3bbe21fa3074",homepage:"https://github.com/hapijs/joi",keywords:["hapi","schema",
"validation"],license:"BSD-3-Clause",main:"lib/index.js",maintainers:[{name:"hueniverse",email:"eran@hammer.io"},{name:"marsup",email:"nicolas@morel.io"},{name:"nlf",email:"quitlahok@gmail.com"},{name:"wyatt",email:"wpreul@gmail.com"}],name:"joi",optionalDependencies:{},readme:"ERROR: No README data found!",repository:{type:"git",url:"git://github.com/hapijs/joi.git"},scripts:{test:"lab -t 100 -a code -L","test-cov-html":"lab -r html -o coverage.html -a code","test-debug":"lab -a code",toc:"hapitoc",
version:"npm run toc && git add API.md README.md"},version:"10.6.0"}}])})}),ed=function(){function c(){I(this,c);this._uuid="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(b){var a=16*Math.random()|0;return("x"==b?a:a&3|8).toString(16)});this._metadata={};this._metadataSchema=this._buildMetadataSchema();this._type=c.TYPE();this._timer={}}N(c,[{key:"isOfType",value:function(b){return!this._type.localeCompare(b)}},{key:"getType",value:function(){this._type}},{key:"getUuid",value:function(){return this._uuid.slice()}},
{key:"setMetadata",value:function(b,a){"string"===typeof b||b instanceof String?this._metadata[b]=a:console.warn("The given key must be a String Object.")}},{key:"getMetadata",value:function(b){if(b in this._metadata)return this._metadata[b];console.warn("The metadata with key: "+b+" doe not exist.");return null}},{key:"hasMetadata",value:function(b){return b in this._metadata}},{key:"getMetadataKeys",value:function(){return Object.keys(this._metadata)}},{key:"copyMetadataFrom",value:function(b){var a=
this;b.getMetadataKeys().forEach(function(d){try{var c=JSON.parse(JSON.stringify(b.getMetadata(d)));a.setMetadata(d,c)}catch(e){console.error(e)}})}},{key:"getMetadataCopy",value:function(){return JSON.parse(JSON.stringify(this._metadata))}},{key:"setRawMetadata",value:function(b){this._metadata=b;this._metadataRawCopied()}},{key:"_metadataRawCopied",value:function(){}},{key:"_getOption",value:function(b,a,d){return b?b[a]||d:d}},{key:"isMetadataCyclic",value:function(){try{JSON.stringify(this._metadata)}catch(b){return!0}return!1}},
{key:"addTimeRecord",value:function(b){this._timer[b]=performance.now()}},{key:"getTime",value:function(b,a){var d=2<arguments.length&&void 0!==arguments[2]?arguments[2]:!1;if(b in this._timer&&a in this._timer){var c=Math.abs(this._timer[a]-this._timer[b]);d&&console.log("> Time: ["+b+" , "+a+"] is "+c+" millisec.");return c}console.warn("The two given record name must exist in the time record table.");return-1}},{key:"_buildMetadataSchema",value:function(){return null}},{key:"metadataIntegrityCheck",
value:function(){var b=0<arguments.length&&void 0!==arguments[0]?arguments[0]:null;null==b&&(b=this._metadata);if(b){if(b=da.validate(b,this._metadataSchema),b.error)return console.warn("SCHEMA VALIDATION: "+b.error),!1}else console.warn("Validation schema not available. Metadata considered to be valid.");return!0}},{key:"getMetadataClone",value:function(){return this.metadataIntegrityCheck()?JSON.parse(JSON.stringify(this._metadata)):null}},{key:"metadataToString",value:function(){var b="__metadata__\n",
a;for(a in this._metadata)b+="\t["+a+"]\n\t"+JSON.stringify(this._metadata[a])+"\n\n";return b}}],[{key:"TYPE",value:function(){return"GENERIC"}}]);return c}(),W=function(c){function b(){I(this,b);var a=P(this,(b.__proto__||Object.getPrototypeOf(b)).call(this));a._type=b.TYPE();a._events={};a._inputValidator={};a._allValidator=null;a._input={};a._output={};a._isOutputReady=!1;a.setMetadata("time",!0);return a}L(b,c);N(b,[{key:"addInput",value:function(a){var d=1<arguments.length&&void 0!==arguments[1]?
arguments[1]:0;a?(d in this._input||(this._input[d]=null),this._input[d]=a,this._isOutputReady=!1):console.warn("A null input cannot be added.")}},{key:"getOutput",value:function(){var a=0<arguments.length&&void 0!==arguments[0]?arguments[0]:0;return a in this._output?this._output[a]:null}},{key:"forEachOutput",value:function(a){if(a)for(var d=this.getOutputCategories(),b=0;b<d.length;b++)a.call(this,d[b],this.getOutput(d[b]));else console.warn("forEachOutput requires a callback.")}},{key:"_forEachInput",
value:function(a){if(a)for(var d=this.getInputCategories(),b=0;b<d.length;b++)a.call(this,d[b],this._getInput(d[b]));else console.warn("forEachOutput requires a callback.")}},{key:"_addOutput",value:function(a){var d=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,b=null;d in this._output?console.warn("An output of category "+d+" was already defined. Nothing to be done."):(b=new a,this._output[d]=b,console.log("filter "+this.constructor.name+" creates a new output."));return b}},{key:"_getInput",
value:function(){var a=0<arguments.length&&void 0!==arguments[0]?arguments[0]:0;return a in this._input?this._input[a]:null}},{key:"hasInputOfCategory",value:function(a){return a in this._input}},{key:"getInputCategories",value:function(){return Object.keys(this._input)}},{key:"getOutputCategories",value:function(){return Object.keys(this._output)}},{key:"setMetadata",value:function(a,d){xg(b.prototype.__proto__||Object.getPrototypeOf(b.prototype),"setMetadata",this).call(this,a,d);this._isOutputReady=
!1}},{key:"hasOutputReady",value:function(){return this._isOutputReady}},{key:"setOutputAsReady",value:function(){this._isOutputReady=!0}},{key:"addInputValidator",value:function(a,d){"TYPE"in d?"ALL"===a?this._allValidator=d.TYPE():this._inputValidator[a]=d.TYPE():"ALL"===a?this._allValidator=d:this._inputValidator[a]=d}},{key:"hasValidInput",value:function(){var a=this,d=this.getInputCategories(),b=!0;0===d.length&&(b=!1,console.warn("No input validator was added. Filter cannot run. Use addInputValidator(...) to specify input types."));
d.forEach(function(d){var c=a._getInput(d);if(c)if("isOfType"in c)a._inputValidator[d]&&(b=b&&c.isOfType(a._inputValidator[d])),a._allValidator&&(b=b&&c.isOfType(a._allValidator));else try{a._inputValidator[d]&&(b=b&&c instanceof a._inputValidator[d]),a._allValidator&&(b=b&&c instanceof a._allValidator)}catch(k){b=!1}else b=!1});b||console.warn("The input is not valid.");return b}},{key:"update",value:function(){this._output={};this._metadata.time?(this.addTimeRecord("begin"),this._run(),this.addTimeRecord("end"),
console.log("Running time for filter "+this.constructor.name+": "+this.getTime("begin","end")+"ms.")):this._run();this.getNumberOfOutputs()&&this.setOutputAsReady()}},{key:"_run",value:function(){console.error("The update() method has not been written, this filter is not valid.")}},{key:"on",value:function(a,d){this._events[a]=d}},{key:"triggerEvent",value:function(a){var d=null;if(this.hasEvent(a))if(1<arguments.length){for(var d=[],b=1;b<arguments.length;b++)d.push(arguments[b]);d=this._events[a].apply(this,
d)}else d=this._events[a].call(this);else console.warn("The event "+a+" does not exist.");return d}},{key:"hasEvent",value:function(a){return a in this._events}},{key:"getNumberOfInputs",value:function(){return Object.keys(this._input).length}},{key:"getNumberOfOutputs",value:function(){return Object.keys(this._output).length}},{key:"clearAllInputs",value:function(){this._input={}}}],[{key:"TYPE",value:function(){return"FILTER"}}]);return b}(ed),Yb=function(c){function b(){I(this,b);var a=P(this,
(b.__proto__||Object.getPrototypeOf(b)).call(this));a._data=null;return a}L(b,c);N(b,[{key:"setRawData",value:function(a){this._data=a}}]);return b}(ed),ua=function(c){function b(){I(this,b);var a=P(this,(b.__proto__||Object.getPrototypeOf(b)).call(this));a._type=b.TYPE();a.setMetadata("length",0);a.setMetadata("min",Infinity);a.setMetadata("max",-Infinity);a.setMetadata("samplingFrequency",100);return a}L(b,c);N(b,[{key:"getData",value:function(){return this._data}},{key:"setData",value:function(a){this._data=
1<arguments.length&&void 0!==arguments[1]&&arguments[1]?new a.constructor(a):a;this.setMetadata("length",a.length);this._computeStatistics()}},{key:"clone",value:function(){var a=new b;a.copyMetadataFrom(this);this._data&&a.setData(this._data,!0);return a}},{key:"hollowClone",value:function(){var a=new b;a.copyMetadataFrom(this);var d=this.getMetadata("length");a.setData((new this._data.constructor(d)).fill(0));return a}},{key:"dataToString",value:function(){var a=this._data.slice(0,Math.min(10,this._data.length)),
d;d="__data__\n"+("\t"+this._data.constructor.name+"["+this._data.length+"] ");return d+=a.toString()+" "+(10<this._data.length?" ...":"")}},{key:"toString",value:function(){var a=this.constructor.name+"\n",a=a+this.metadataToString();return a+=this.dataToString()}},{key:"_computeStatistics",value:function(){for(var a=Infinity,d=-Infinity,b=0;b<this._data.length;b++)a=Math.min(a,this._data[b]),d=Math.max(d,this._data[b]);this.setMetadata("min",a);this.setMetadata("max",d)}}],[{key:"TYPE",value:function(){return"SIGNAL1D"}}]);
return b}(Yb);Za.addCoreType(ua);var Q=function(c){function b(){var a=0<arguments.length&&void 0!==arguments[0]?arguments[0]:null;I(this,b);var d=P(this,(b.__proto__||Object.getPrototypeOf(b)).call(this));d._type=b.TYPE();d.setMetadata("ncpp",4);if(a&&"width"in a&&"height"in a&&0<a.width&&0<a.height){d.setMetadata("width",a.width);d.setMetadata("height",a.height);"color"in a&&d.setMetadata("ncpp",a.color.length);d._data=new Float32Array(a.width*a.height*d.getMetadata("ncpp"));var c=d.getMetadata("ncpp");
if("color"in a)for(var a=a.color,e=0;e<d._data.length;e++)d._data[e]=a[e%c];else d._data.fill(0)}return d}L(b,c);N(b,[{key:"clone",value:function(){var a=new b;a.setData(this._data,this.getMetadata("width"),this.getMetadata("height"),this.getMetadata("ncpp"),!0);a.copyMetadataFrom(this);return a}},{key:"hollowClone",value:function(){var a=new b,d=this.getMetadata("ncpp"),c=this.getMetadata("width"),e=this.getMetadata("height");a.setData((new Float32Array(c*e*d)).fill(0),c,e,d);return a}},{key:"float32Clone",
value:function(){var a=new b,d=this.getMetadata("ncpp"),c=this.getMetadata("width"),e=this.getMetadata("height");a.copyMetadataFrom(this);a.setData(new Float32Array(this._data),c,e,d);return a}},{key:"setData",value:function(a,d,b){var c=3<arguments.length&&void 0!==arguments[3]?arguments[3]:4,g=4<arguments.length&&void 0!==arguments[4]?arguments[4]:!1;this.setMetadata("ncpp",c);a.length!=d*b*c?console.warn("The array size does not match the width and height. Cannot init the Image2D."):(this._data=
g?new a.constructor(a):a,this.setMetadata("width",d),this.setMetadata("height",b),this.computeSimpleStat())}},{key:"setPixel",value:function(a,d){var b=2<arguments.length&&void 0!==arguments[2]?arguments[2]:!1;if(this._data){var c=this._metadata.ncpp;if("x"in a&&0<=a.x&&a.x<this._metadata.width&&"y"in a&&0<=a.y&&a.y<this._metadata.height){if(d.length==c){var f=this.get1dIndexFrom2dPosition(a);if(1==c)this._data[f]=d[0];else for(var f=f*c,k=0;k<c;k++)this._data[f+k]=d[k]}else if(3==d.length&&4==c)for(f=
this.get1dIndexFrom2dPosition(a),f*=c,k=0;k<d.length;k++)this._data[f+k]=d[k];b&&this.computeSimpleStat()}}else console.warn("The image is empty")}},{key:"getPixel",value:function(a){if(this._data){if("x"in a&&0<=a.x&&a.x<this._metadata.width&&"y"in a&&0<=a.y&&a.y<this._metadata.height){var d=this._metadata.ncpp;a=this.get1dIndexFrom2dPosition(a);1==d?d=[this._data[a]]:(a*=d,d=this._data.slice(a,a+d));return d}console.warn("The requested position is outside the image.");return null}console.warn("The image is empty")}},
{key:"getWidth",value:function(){return this._metadata.width}},{key:"getHeight",value:function(){return this._metadata.height}},{key:"getComponentsPerPixel",value:function(){return this._metadata.ncpp}},{key:"getNcpp",value:function(){return this.getComponentsPerPixel()}},{key:"getData",value:function(){return this._data}},{key:"getDataCopy",value:function(){return new this._data.constructor(this._data)}},{key:"getDataAsUInt8Array",value:function(){if(this._data){for(var a=this.getMin(),d=this.getMax(),
b=new Uint8Array(this._data.length),c=0;c<this._data.length;c++)b[c]=(this._data[c]-a)/d*256;return b}console.warn("No data, cannot make a copy of it.")}},{key:"getDataAsFloat32Array",value:function(){if(this._data)return new Float32Array(this._data);console.warn("No data, cannot make a copy of it.")}},{key:"get2dPositionFrom1dIndex",value:function(a){return{x:a%this._metadata.width,y:Math.floor(a/this._metadata.width)}}},{key:"get1dIndexFrom2dPosition",value:function(a){return a.x+a.y*this._metadata.width}},
{key:"computeSimpleStat",value:function(){if(this._data){for(var a=Infinity,d=-Infinity,b=0,c=0;c<this._data.length;c++)a=Math.min(a,this._data[c]),d=Math.max(a,this._data[c]),b+=this._data[c];this.setMetadata("min",a);this.setMetadata("max",d);this.setMetadata("avg",b/this._data.length)}else console.warn("The image is empty")}},{key:"getMin",value:function(){this.hasMetadata("min")||this.computeSimpleStat();return this.getMetadata("min")}},{key:"getMax",value:function(){this.hasMetadata("max")||
this.computeSimpleStat();return this.getMetadata("max")}},{key:"getAvg",value:function(){this.hasMetadata("avg")||this.computeSimpleStat();return this.getMetadata("avg")}},{key:"isInside",value:function(a){return 0<=a.x&&a.x<this._metadata.width&&0<=a.y&&a.y<this._metadata.height}},{key:"getSegmentSample",value:function(a,d){if(!this.isInside(a)||!this.isInside(d))return null;var b=d.x-a.x,c=d.y-a.y,f=Math.sqrt(Math.pow(b,2)+Math.pow(c,2));d=Math.floor(f+1);for(var b=b/f,c=c/f,f=this._metadata.ncpp,
k=Array(d).fill(0),l=Array(f).fill(0),m=Array(d).fill(0),n=0;n<f;n++)l[n]=Array(d).fill(0);for(var r=0;r<d;r++){n={x:Math.round(a.x+r*b),y:Math.round(a.y+r*c)};k[r]=n;m[r]="("+n.x+", "+n.y+")";for(var u=this.getPixel(n),n=0;n<f;n++)l[n][r]=u[n]}return{positions:k,labels:m,colors:l}}}],[{key:"TYPE",value:function(){return"IMAGE2D"}}]);return b}(Yb);Za.addCoreType(Q);var Ac=function(c){function b(){var a=0<arguments.length&&void 0!==arguments[0]?arguments[0]:null;I(this,b);var d=P(this,(b.__proto__||
Object.getPrototypeOf(b)).call(this));d._type=b.TYPE();d.setMetadata("ncpp",1);a&&"order"in a?d.setMetadata("order",a.order):d.setMetadata("order",["zspace","yspace","xspace"]);var c={offset:1,step:1},e={step:1},f={step:1};d.setMetadata("xspace",c);d.setMetadata("yspace",e);d.setMetadata("zspace",f);d.setMetadata("time",{offset:0,space_length:1});a&&"ncpp"in a&&d.setMetadata("ncpp",a.ncpp);a&&"xSize"in a&&"ySize"in a&&"zSize"in a&&0<a.xSize&&0<a.ySize&&0<a.zSize&&(c.space_length=a.xSize,e.space_length=
a.ySize,f.space_length=a.zSize,e.offset=c.space_length,f.offset=c.space_length*e.space_length,d._data=new Float32Array(a.xSize*a.ySize*a.zSize*d.getMetadata("ncpp")),d._data.fill(0),d._scanDataRange(),d._finishHeader());return d}L(b,c);N(b,[{key:"clone",value:function(){var a=new b;a.setData(this._data,this.getMetadata("xspace").space_length,this.getMetadata("yspace").space_length,this.getMetadata("zspace").space_length,{ncpp:this.getMetadata("ncpp"),order:this.getMetadata("order").slice(),deepCopy:!0});
a.copyMetadataFrom(this);return a}},{key:"setData",value:function(a,d,b,c,f){var g=1;f&&"ncpp"in f&&(g=f.ncpp);a.length!=d*b*c*g?console.warn("The array size does not match the width and height. Cannot init the Image3D."):(f&&"ncpp"in f&&this.setMetadata("ncpp",f.ncpp),f&&"order"in f&&this.setMetadata("order",f.order),this._data=f&&"deepCopy"in f&&f.deepCopy?new a.constructor(a):a,a=this.getMetadata("xspace"),f=this.getMetadata("yspace"),g=this.getMetadata("zspace"),a.space_length=d,f.space_length=
b,g.space_length=c,f.offset=a.space_length,g.offset=a.space_length*f.space_length,this._scanDataRange(),this._finishHeader())}},{key:"_finishHeader",value:function(){var a=this.getMetadata("xspace"),d=this.getMetadata("yspace"),b=this.getMetadata("zspace");a.name="xspace";d.name="yspace";b.name="zspace";a.width_space=JSON.parse(JSON.stringify(d));a.width=d.space_length;a.height_space=JSON.parse(JSON.stringify(b));a.height=b.space_length;d.width_space=JSON.parse(JSON.stringify(a));d.width=a.space_length;
d.height_space=JSON.parse(JSON.stringify(b));d.height=b.space_length;b.width_space=JSON.parse(JSON.stringify(a));b.width=a.space_length;b.height_space=JSON.parse(JSON.stringify(d));b.height=d.space_length}},{key:"_scanDataRange",value:function(){for(var a=Infinity,d=-Infinity,b=0;b<this._data.length;b++)a=Math.min(a,this._data[b]),d=Math.max(d,this._data[b]);this.setMetadata("voxel_min",a);this.setMetadata("voxel_max",d)}},{key:"setPixel",value:function(a,d){}},{key:"getPixel",value:function(a){return this.getIntensity_xyz(a.x,
a.y,a.z)}},{key:"getSize",value:function(a){if(this.hasMetadata(a))return this.getMetadata(a).space_length;console.warn('The space must be "xspace", "yspace" or "zspace".');return null}},{key:"getData",value:function(){return this._data}},{key:"getDataCopy",value:function(){return new this._data.constructor(this._data)}},{key:"get1dIndexFrom3dPosition",value:function(a){}},{key:"getSlice",value:function(a){var d=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,b=2<arguments.length&&void 0!==
arguments[2]?arguments[2]:0;if(!this.hasMetadata(a))return console.warn("The axis "+a+" does not exist."),null;var c=this.hasMetadata("time")?b*this.getMetadata("time").offset:0,f=this.getMetadata(a),k=f.width_space,l=f.height_space,b=f.width,m=f.height,n=f.offset,r=k.offset,u=l.offset,p=new this._data.constructor(b*m),t,k=0<k.step,y=0<l.step;t=0<f.step;var w=l=0,x=Infinity,v=-Infinity;this.getMetadata("voxel_max");d=t?d:f.space_length-d-1;if(0<=d&&d<f.space_length)for(c+=d*n,d=m-1;0<=d;d--)for(f=
y?d:m-d-1,n=c+f*u,f=0;f<b;f++)t=k?f:b-f-1,t=n+t*r,t=this._data[t],x=Math.min(x,t),v=Math.max(v,t),w+=t,p[l++]=t;r=new Q;r.setData(p,b,m,1);r.setMetadata("min",x);r.setMetadata("max",v);r.setMetadata("avg",w/(l-1));return r}},{key:"getIntensity_ijk",value:function(a,d,b){var c=3<arguments.length&&void 0!==arguments[3]?arguments[3]:0,g=this.getMetadata("order");if(0>a||a>=this.getMetadata(g[0]).space_length||0>d||d>=this.getMetadata(g[1]).space_length||0>b||b>=this.getMetadata(g[2]).space_length)return console.warn("getIntensity_ijk position is out of range."),
0;c*=this._metadata.time.offset;g=a*this.getMetadata(g[0]).offset+d*this.getMetadata(g[1]).offset+b*this.getMetadata(g[2]).offset+c;return this._data[g]}},{key:"getIntensity_xyz",value:function(a,d,b){var c=3<arguments.length&&void 0!==arguments[3]?arguments[3]:0;return 0>a||a>=this._metadata.xspace.space_length||0>d||d>=this._metadata.yspace.space_length||0>b||b>=this._metadata.zspace.space_length?(console.warn("getIntensity_xyz position is out of range."),0):this._data[a*this._metadata.xspace.offset+
d*this._metadata.yspace.offset+b*this._metadata.zspace.offset+this._metadata.time.offset*c]}},{key:"getIntensity_xyzOrientation",value:function(a,d,b){var c=3<arguments.length&&void 0!==arguments[3]?arguments[3]:0,c=this.hasMetadata("time")?c*this.getMetadata("time").offset:0;10==a&&30==d&&20==b&&console.log("stop");var g=this.getMetadata("xspace"),k=this.getMetadata("yspace"),l=this.getMetadata("zspace"),m=0<g.step?a:g.space_length-a-1,n=0<k.step?d:k.space_length-d-1,r=0<l.step?b:l.space_length-
b-1;return 0<=a&&a<g.space_length&&0<=d&&d<k.space_length&&0<=b&&b<l.space_length?this._data[c+m*g.offset+n*k.offset+r*l.offset]:null}},{key:"getTimeLength",value:function(){return this.hasMetadata("time")?this.getMetadata("time").space_length:1}},{key:"isInside",value:function(a){return!(0>a.x||a.x>=this._metadata.xspace.space_length||0>a.y||a.y>=this._metadata.yspace.space_length||0>a.z||a.z>=this._metadata.zspace.space_length)}},{key:"getSegmentSample",value:function(a,d){if(!this.isInside(a)||
!this.isInside(d))return null;var b=d.x-a.x,c=d.y-a.y,f=d.z-a.z,k=Math.sqrt(Math.pow(b,2)+Math.pow(c,2)+Math.pow(f,2));d=Math.floor(k+1);for(var b=b/k,c=c/k,f=f/k,k=this._metadata.ncpp,l=Array(d).fill(0),m=Array(k).fill(0),n=Array(d).fill(0),r=0;r<k;r++)m[r]=Array(d).fill(0);for(var u=0;u<d;u++){r={x:Math.round(a.x+u*b),y:Math.round(a.y+u*c),z:Math.round(a.z+u*f)};l[u]=r;n[u]="("+r.x+", "+r.y+", "+r.z+")";for(var p=[this.getIntensity_xyz(r.x,r.y,r.z)],r=0;r<k;r++)m[r][u]=p[r]}return{positions:l,labels:n,
colors:m}}}],[{key:"TYPE",value:function(){return"IMAGE3D"}}]);return b}(Yb);Za.addCoreType(Ac);var qa=function(c){function b(){I(this,b);return P(this,(b.__proto__||Object.getPrototypeOf(b)).call(this))}L(b,c);N(b,[{key:"hasSameSizeInput",value:function(){var a=this,d=!0,b=[],c=[];Object.keys(this._input).forEach(function(d){b.push(a._getInput(d).getWidth());c.push(a._getInput(d).getHeight())});b.length&&(b.sort(),c.sort(),(d=b[0]==b[b.length-1]&&c[0]==c[c.length-1])||console.warn("Input image do not all have the same size. Filter not valid"));
return d}},{key:"hasSameNcppInput",value:function(){var a=Object.keys(this._input);if(!a.length)return!1;for(var d=this._getInput(a[0]).getComponentsPerPixel(),b=0;b<a.length;b++)if(d!=this._getInput(a[b]).getComponentsPerPixel())return console.warn("Input image do not all have the same number of components per pixel. Filter not valid"),!1;return!0}}]);return b}(W),Ia=function(c){function b(){I(this,b);return P(this,(b.__proto__||Object.getPrototypeOf(b)).call(this))}L(b,c);N(b,[{key:"setData",value:function(a,
d){var b=this;this._data=a;this.setMetadata("position",{});this.setMetadata("current_time",0);Object.keys(d).forEach(function(a){b.setMetadata(a,d[a])});this._scanDataRange();this._saveOriginAndTransform();this._finishHeader();console.log(this)}},{key:"_saveOriginAndTransform",value:function(){var a=this.getMetadata("xspace"),d=this.getMetadata("yspace"),b=this.getMetadata("zspace"),c=a.start,f=d.start,k=b.start,l=a.direction_cosines,m=d.direction_cosines,n=b.direction_cosines,a=a.step,d=d.step,b=
b.step,c={x:c*l[0]+f*m[0]+k*n[0],y:c*l[1]+f*m[1]+k*n[1],z:c*l[2]+f*m[2]+k*n[2]};this.setMetadata("voxel_origin",c);this.setMetadata("w2v",[[l[0]/a,l[1]/a,l[2]/a,(-c.x*l[0]-c.y*l[1]-c.z*l[2])/a],[m[0]/d,m[1]/d,m[2]/d,(-c.x*m[0]-c.y*m[1]-c.z*m[2])/d],[n[0]/b,n[1]/b,n[2]/b,(-c.x*n[0]-c.y*n[1]-c.z*n[2])/b]])}}],[{key:"transformToMinc",value:function(a,d){function b(a){a=a[0]*a[0]+a[1]*a[1]+a[2]*a[2];0>=a&&(a=1);return Math.sqrt(a)}function c(a,d,b){return a[0]*(d[1]*b[2]-d[2]*b[1])-a[1]*(d[0]*b[2]-d[2]*
b[0])+a[2]*(d[0]*b[1]-d[1]*b[0])}for(var f=[],k=[],l=[],m=b(a[0]),n=b(a[1]),r=b(a[2]),m=0>a[0][0]?-m:m,n=0>a[1][1]?-n:n,r=0>a[2][2]?-r:r,u=0;3>u;u++)f[u]=a[u][0]/m,k[u]=a[u][1]/n,l[u]=a[u][2]/r;d.xspace.step=m;d.yspace.step=n;d.zspace.step=r;n=[a[0][3],a[1][3],a[2][3]];a=c(f,k,l);m=c(n,k,l);r=c(f,n,l);n=c(f,k,n);d.xspace.start=m/a;d.yspace.start=r/a;d.zspace.start=n/a;d.xspace.direction_cosines=f;d.yspace.direction_cosines=k;d.zspace.direction_cosines=l}},{key:"swapn",value:function(a,d){for(var b=
0;b<a.length;b+=d)for(var c=d-1,f=0;c>f;){var k=a[b+c];a[b+c]=a[b+f];a[b+f]=k;c--;f++}}}]);return b}(Ac);Za.addCoreType(Ia);var Bc=function(c){function b(){I(this,b);var a=P(this,(b.__proto__||Object.getPrototypeOf(b)).call(this));a.setMetadata("closed",!1);a.setMetadata("defaultNod",2);a.setMetadata("nod",2);a._type=b.TYPE();a._lastPoint=null;return a}L(b,c);N(b,[{key:"setData",value:function(a){var d=1<arguments.length&&void 0!==arguments[1]?arguments[1]:-1,b=2<arguments.length&&void 0!==arguments[2]?
arguments[2]:!1;-1!=d&&this.setMetadata("nod",d);0!=a.length%this.getMetadata("nod")?console.warn("The number of points is not compatible with the number of dimensions (nod)."):(this._data=b?new a.constructor(a):a,this._setLastPoint())}},{key:"setNod",value:function(a){this._data&&this._data.length?this.setMetadata("nod",a):console.warn("The number of dimension can be set only when this LineString is empty.")}},{key:"getNod",value:function(){return this.getMetadata("nod")}},{key:"getData",value:function(){return this._data}},
{key:"getDataCopy",value:function(){return new this._data.constructor(this._data)}},{key:"getNumberOfPoints",value:function(){return this._data?this._data.length/this.getMetadata("nod"):0}},{key:"getPoint",value:function(a){if(0<=a&&a<getNumberOfPoints){var d=this._metadata.nod;return this._data.slice(a*d,a*d+d)}console.warn("Index of point is out of range.");return null}},{key:"close",value:function(){this.setMetadata("closed",!0)}},{key:"open",value:function(){this.setMetadata("closed",!1)}},{key:"addPoint",
value:function(a){if(a.length!=this._metadata.nod)console.warn("Cannot add the point becase it has a diferent number of dimensions.");else{this._data||(this._data=[]);for(var d=0;d<a.length;d++)this._data.push(a[d]);this._lastPoint=a}}},{key:"peekPoint",value:function(){if(!this._data)return null;if(this._lastPoint)return this._lastPoint;this._setLastPoint();return this._lastPoint}},{key:"_setLastPoint",value:function(){this._lastPoint=this._data.slice(-this._metadata.nod);0==this._lastPoint.length&&
(this._lastPoint=null)}},{key:"popPoint",value:function(){if(!this._data)return console.warn("This LineString was not added any point."),null;if(!this._data.length)return console.warn("No more point in this LineString."),null;this._lastPoint.length-=this._metadata.nod;this._setLastPoint()}},{key:"hasPoint",value:function(a){var d=this.getMetadata("nod");if(a.length!=d)return console.warn("The given point does not have the same number of dimensions as the LineString."),!1;for(d=0;d<this._data.length-
1;d+=2)if(this._data[d]==a[0]&&this._data[d+1]==a[1])return!0;return!1}}],[{key:"TYPE",value:function(){return"LINESTRING"}}]);return b}(Yb);Za.addCoreType(Bc);var Ib=function(){function c(){I(this,c)}N(c,null,[{key:"setValueMatrix44",value:function(b,a,d,g){c.setValueSquareMatrix(b,4,a,d,g)}},{key:"setValueMatrix33",value:function(b,a,d,g){c.setValueSquareMatrix(b,3,a,d,g)}},{key:"setValueSquareMatrix",value:function(b,a,d,c,e){b[d*a+c]=e}},{key:"getValueMatrix44",value:function(b,a,d){return c.getValueSquareMatrix(b,
4,a,d)}},{key:"getValueMatrix33",value:function(b,a,d){return c.getValueSquareMatrix(b,3,a,d)}},{key:"getValueSquareMatrix",value:function(b,a,d,c){return b[d*a+c]}},{key:"getHorizontalFlipMatrix44",value:function(b){return c.getHorizontalFlipSquareMatrix(b,4)}},{key:"getHorizontalFlipMatrix33",value:function(b){return c.getHorizontalFlipSquareMatrix(b,3)}},{key:"getHorizontalFlipSquareMatrix",value:function(b,a){for(var d=Array(a*a).fill(0),g=0;g<a;g++)for(var e=0;e<a;e++){var f=c.getValueSquareMatrix(b,
a,e,g);c.setValueSquareMatrix(d,a,a-1-e,g,f)}return d}},{key:"getExpandedMatrix3x3To4x4",value:function(b){for(var a="RIGHT"===(1<arguments.length&&void 0!==arguments[1]?arguments[1]:"LEFT")?1:0,d="BOTTOM"===(2<arguments.length&&void 0!==arguments[2]?arguments[2]:"TOP")?1:0,g=Array(16).fill(0),e=0;3>e;e++)for(var f=0;3>f;f++){var k=c.getValueMatrix33(b,f,e);c.setValueMatrix44(g,a+f,d+e,k)}return g}}]);return c}(),Ta=function(c){function b(){var a=0<arguments.length&&void 0!==arguments[0]?arguments[0]:
null;I(this,b);var d=P(this,(b.__proto__||Object.getPrototypeOf(b)).call(this));d._type=b.TYPE();d._initMetadata();d._dimensionsWorldLUT={};d._dimensionsVoxelLUT={};d._initData(a);return d}L(b,c);N(b,[{key:"_buildMetadataSchema",value:function(){return da.object({ncpp:da.number().integer().min(1).required(),dimensions:da.array().min(3).max(4).items(da.object({length:da.number().integer().min(1).required(),widthDimension:da.number().integer().min(-1).max(2).required(),heightDimension:da.number().integer().min(-1).max(2).required(),
nameVoxelSpace:da.string().regex(/(i|j|k|t)/).required(),nameWorldSpace:da.string().regex(/(x|y|z|t)/).required(),worldUnitSize:da.number().required(),stride:da.number().integer().min(1).required(),step:da.number().required()}).unknown()),statistics:da.object({upToDate:da.boolean().required(),min:da.number().required(),max:da.number().required()}).required().unknown(),transformations:da.object().unknown().pattern(/.+/,da.array().length(16).items(da.number())).required(),description:da.string().allow(""),
spatialUnit:da.string().allow(""),temporalUnit:da.string().allow(""),format:da.string().allow(""),formatSpecific:da.object().unknown()}).unknown()}},{key:"_metadataRawCopied",value:function(){this._buildDimensionsLUT()}},{key:"_buildDimensionsLUT",value:function(){this._dimensionsWorldLUT={};this._dimensionsVoxelLUT={};var a=["x","y","z"],d=this._metadata.dimensions;this._worldPositionIndex=Array(3);this._worldPositionOrder=Array(3);var b=[0,1,2];this._hasNativeCorrectOrder=!0;for(var c=0;c<d.length;c++){this._dimensionsWorldLUT[d[c].nameWorldSpace]=
c;this._dimensionsVoxelLUT[d[c].nameVoxelSpace]=c;var f=a[c];this._worldPositionIndex[c]=d[0].nameWorldSpace===f?0:d[1].nameWorldSpace===f?1:d[2].nameWorldSpace===f?2:-1;this._worldPositionOrder[c]=a.indexOf(d[c].nameWorldSpace);this._hasNativeCorrectOrder=this._hasNativeCorrectOrder&&this._worldPositionIndex[c]===b[c]}}},{key:"getDimensionIndexFromName",value:function(a){return a in this._dimensionsWorldLUT?this._dimensionsWorldLUT[a]:a in this._dimensionsVoxelLUT?this._dimensionsVoxelLUT[a]:-1}},
{key:"_initMetadata",value:function(){this.setMetadata("description","");this.setMetadata("statistics",{upToDate:!0,min:NaN,max:NaN});this.setMetadata("ncpp",1);this.setMetadata("spatialUnit","Voxel");this.setMetadata("temporalUnit","Time");this.setMetadata("format","generic");this.setMetadata("formatSpecific",{});this.setMetadata("transformations",{})}},{key:"clone",value:function(){var a=new b;a.setRawData(new this._data.constructor(this._data));a.copyMetadataFrom(this);return a}},{key:"setData",
value:function(a,d){this._initData(d,a);this.scanDataRange()}},{key:"_get4x4IdentityMatrix",value:function(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}},{key:"_initData",value:function(a){var d=1<arguments.length&&void 0!==arguments[1]?arguments[1]:null;if(a){"ncpp"in a&&this.setMetadata("ncpp",a.ncpp);if("xSize"in a&&"ySize"in a&&"zSize"in a){var b=[{length:a.xSize,widthDimension:1,heightDimension:2,nameVoxelSpace:"k",nameWorldSpace:"x",worldUnitSize:1,stride:1,step:1},{length:a.ySize,widthDimension:0,
heightDimension:2,nameVoxelSpace:"j",nameWorldSpace:"y",worldUnitSize:1,stride:a.xSize,step:1},{length:a.zSize,widthDimension:0,heightDimension:1,nameVoxelSpace:"i",nameWorldSpace:"z",worldUnitSize:1,stride:a.xSize*a.ySize,step:1}],c=a.xSize*a.ySize*a.zSize*this.getMetadata("ncpp");if("tSize"in a){var f={length:a.tSize,widthDimension:-1,heightDimension:-1,nameVoxelSpace:"t",nameWorldSpace:"t",worldUnitSize:1,stride:a.xSize*a.ySize*a.zSize,step:1},c=c*a.tSize;b.push(f);this.setMetadata("dimensions",
b)}b={v2w:this._get4x4IdentityMatrix(),w2v:this._get4x4IdentityMatrix()};this.setMetadata("transformations",b);if(d)if(d.length==c)this._data="deepCopy"in a&&a.deepCopy?new d.constructor(d):d;else return console.warn("The buffer provided has a wrong size."),!1;else this._data=new Float32Array(c),d=this.getMetadata("statistics"),d.min=0,d.max=0;this._buildDimensionsLUT();return this.metadataIntegrityCheck()}console.warn("The necessary options xSize, ySize and zSize were not provided.")}return!1}},
{key:"resetData",value:function(){var a=0<arguments.length&&void 0!==arguments[0]?arguments[0]:0;this._data&&"number"===typeof a&&this._data.fill(a)}},{key:"scanDataRange",value:function(){for(var a=Infinity,d=-Infinity,b=0;b<this._data.length;b++)a=Math.min(a,this._data[b]),d=Math.max(d,this._data[b]);b=this.getMetadata("statistics");b||(this.setMetadata("statistics",{}),b=this.getMetadata("statistics"));b.min=a;b.max=d;b.upToDate=!0}},{key:"getMinValue",value:function(){this._metadata.statistics.upToDate||
this.scanDataRange();return this._metadata.statistics.min}},{key:"getMaxValue",value:function(){this._metadata.statistics.upToDate||this.scanDataRange();return this._metadata.statistics.max}},{key:"getVoxel",value:function(a){var d=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,b=this._metadata.dimensions,c=a.i,f=a.j,k=a.k;return 0>c||0>f||0>k||0>d||c>=b[2].length||f>=b[1].length||k>=b[0].length||3<b.length&&d>=b[3].length?(console.warn("Voxel {i:"+a.i+", j:"+a.j+", k:"+a.k+"} is out of bound."),
null):this._data[((3<b.length?d*b[3].stride*d:0)+c*b[2].stride+f*b[1].stride+k*b[0].stride)*this._metadata.ncpp]}},{key:"setVoxel",value:function(a,d){var b=2<arguments.length&&void 0!==arguments[2]?arguments[2]:0,c=this._metadata.dimensions,f=a.i,k=a.j,l=a.k;if(0>f||0>k||0>l||0>b||f>=c[2].length||k>=c[1].length||l>=c[0].length||3<c.length&&b>=c[3].length)return console.warn("Voxel query is out of bound."),null;this._data[((3<c.length?b*c[3].stride*b:0)+f*c[2].stride+k*c[1].stride+l*c[0].stride)*
this._metadata.ncpp]=d;d>this._metadata.statistics.max?this._metadata.statistics.max=d:d<this._metadata.statistics.min&&(this._metadata.statistics.min=d)}},{key:"getVoxelSafe",value:function(a){var d=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,b=this._metadata.dimensions,c=a.i,f=a.j,k=a.k;return 0>c||0>f||0>k||0>d||c>=b[0].length||f>=b[1].length||k>=b[2].length||3<b.length&&d>=b[3].length?(console.warn("Voxel query is out of bound."),null):this._data[(3<b.length?d*b[3].stride*d:0)+(0>
b[2].step?b[2].length-c-1:c)*b[2].stride+(0>b[1].step?b[1].length-f-1:f)*b[1].stride+(0>b[0].step?b[0].length-k-1:k)*b[0].stride]}},{key:"getDimensionSize",value:function(a){if("string"===typeof a&&(a=this.getDimensionIndexFromName(a),-1==a)){console.warn("dimensions "+a+" does not exist.");return}var d=this._metadata.dimensions;if(a<d.length)return d[a].length;console.warn("A dimensions of such index does not exist.");return null}},{key:"getData",value:function(){return this._data}},{key:"getDataCopy",
value:function(){return new this._data.constructor(this._data)}},{key:"getDataUint8",value:function(){for(var a=this._data,d=this.getMinValue(),b=this.getMaxValue()-d,c=new Uint8Array(a.length),f=0;f<c.length;f++)c[f]=Math.round((a[f]-d)/b*256);return c}},{key:"hasTransform",value:function(a){return a in this._metadata.transformations}},{key:"_getTransformedPosition",value:function(a,d){var b=this._metadata.transformations;if(!(d in b))return console.warn("No transform named "+d),null;d=b[d];var b=
a[0],c=a[1],f=a[2];a=new La(4);a[0]=b;a[1]=c;a[2]=f;a[3]=1;var b=oe(),c=a[0],f=a[1],k=a[2];a=a[3];b[0]=d[0]*c+d[4]*f+d[8]*k+d[12]*a;b[1]=d[1]*c+d[5]*f+d[9]*k+d[13]*a;b[2]=d[2]*c+d[6]*f+d[10]*k+d[14]*a;b[3]=d[3]*c+d[7]*f+d[11]*k+d[15]*a;return b}},{key:"getPositionFromVoxelSpaceToTransfoSpace",value:function(a,d){a=[a.i,a.j,a.k];d=this._getTransformedPosition([a[this._worldPositionOrder[2]],a[this._worldPositionOrder[1]],a[this._worldPositionOrder[0]]],d);return{x:d[0],y:d[1],z:d[2]}}},{key:"getPositionFromTransfoSpaceToVoxelSpace",
value:function(a,d){var b=2<arguments.length&&void 0!==arguments[2]?arguments[2]:!0,c=this._getTransformedPosition([a.x,a.y,a.z],d),c={i:c[this._worldPositionOrder[2]],j:c[this._worldPositionOrder[1]],k:c[this._worldPositionOrder[0]]};b&&(c.i=Math.round(c.i),c.j=Math.round(c.j),c.k=Math.round(c.k));return c}},{key:"getVoxelCoordinatesSwapMatrix",value:function(){var a=0<arguments.length&&void 0!==arguments[0]?arguments[0]:!0,d=1<arguments.length&&void 0!==arguments[1]?arguments[1]:!1,b=Array(9).fill(0);
Ib.setValueMatrix33(b,0,this._worldPositionOrder[0],1);Ib.setValueMatrix33(b,1,this._worldPositionOrder[1],1);Ib.setValueMatrix33(b,2,this._worldPositionOrder[2],1);var c=b;if(a)var f=Ib.getHorizontalFlipMatrix33(b),c=f;d&&(c=Ib.getExpandedMatrix3x3To4x4(f),Ib.setValueMatrix33(c,3,3,1));return c}},{key:"getVoxelTransfoSpace",value:function(a,d){var b=2<arguments.length&&void 0!==arguments[2]?arguments[2]:0,c=this.getPositionFromTransfoSpaceToVoxelSpace(d,a);return this.getVoxel(c,b)}},{key:"setVoxelTransfoSpace",
value:function(a,d,b){var c=3<arguments.length&&void 0!==arguments[3]?arguments[3]:0,g=this.getPositionFromTransfoSpaceToVoxelSpace(d,a);this.setVoxel(g,b,c)}},{key:"addTransformation",value:function(a,d){var b=this._metadata.transformations,c=da.array().length(16).items(da.number()),c=da.validate(a,c);c.error?console.warn("Invalid transformation: "+c.error):b[d]=a}},{key:"getSlice",value:function(a){var d=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,b=2<arguments.length&&void 0!==arguments[2]?
arguments[2]:0;if("string"===typeof a&&(a=this.getDimensionIndexFromName(a),-1==a)){console.warn("dimensions "+a+" does not exist.");return}var c=this._metadata.dimensions;if(2<a)return console.warn("The dimension of a slice should be lower than 3."),null;var f=c[a],k=c[f.widthDimension],l=c[f.heightDimension];if(0>d||d>=f.length)return console.warn("The slice required is out of bound."),null;for(var m=new this._data.constructor(k.length*l.length),b=3<c.length?c[3].stride*b:0,d=(0>f.step?f.length-
d-1:d)*f.stride,f=0,c=l.length-1;0<=c;c--)for(var n=(0>l.step?l.length-c-1:c)*l.stride,r=0;r<k.length;r++)m[f]=this._data[d+b+n+(0>k.step?k.length-r-1:r)*k.stride],f++;b=new Q;b.setData(m,k.length,l.length,1);return b}},{key:"getSliceSize",value:function(a){if("string"===typeof a&&(a=this.getDimensionIndexFromName(a),-1==a)){console.warn("dimensions "+a+" does not exist.");return}var d=this._metadata.dimensions;if(2<a)return console.warn("The dimension of a slice should be lower than 3."),null;a=
d[a];return{w:d[a.widthDimension].length,h:d[a.heightDimension].length}}},{key:"getNumberOfSlices",value:function(a){if("string"===typeof a&&(a=this.getDimensionIndexFromName(a),-1==a)){console.warn("dimensions "+a+" does not exist.");return}var d=this._metadata.dimensions;return 2<a?(console.warn("The dimension of a slice should be lower than 3."),null):d[a].length}},{key:"getTimeLength",value:function(){var a=this._metadata.dimensions;return 4==a.length?a[3].length:1}},{key:"isInsideVoxelSpace",
value:function(a){var d=this._metadata.dimensions,b=!1;try{b=!(0>a.i||a.i>=d[2].length||0>a.j||a.j>=d[1].length||0>a.k||a.k>=d[0].length)}catch(e){console.warn(e)}return b}},{key:"isInsideTransfoSpace",value:function(a,d){a=this.getPositionFromTransfoSpaceToVoxelSpace(a,d);return this.isInsideVoxelSpace(a)}},{key:"getSegmentSampleVoxelSpace",value:function(a,d){for(var b=2<arguments.length&&void 0!==arguments[2]?arguments[2]:0,c=d.i-a.i,f=d.j-a.j,k=d.k-a.k,l=Math.sqrt(Math.pow(c,2)+Math.pow(f,2)+
Math.pow(k,2)),m=Math.floor(l+1),c=c/l,f=f/l,k=k/l,l=this._metadata.ncpp,n=Array(m).fill(0),r=Array(l).fill(0),u=Array(m).fill(0),p=0;p<l;p++)r[p]=Array(m).fill(0);for(var t=0;t<m;t++){p={i:Math.round(a.i+t*c),j:Math.round(a.j+t*f),k:Math.round(a.k+t*k)};n[t]=p;u[t]="("+p.i+", "+p.j+", "+p.k+")";for(var y=[this.getVoxel(p,b)],p=0;p<l;p++)r[p][t]=y[p]}return{positions:n,labels:u,colors:r}}},{key:"getSegmentSampleTransfoSpace",value:function(a,d,b,c){var g=4<arguments.length&&void 0!==arguments[4]?
arguments[4]:0;if(!this.hasTransform(a))return console.warn("The transform "+a+" is not available."),null;var e=this.getPositionFromTransfoSpaceToVoxelSpace(b,a,!1),l=this.getPositionFromTransfoSpaceToVoxelSpace(c,a,!1);console.log("voxelFrom {"+e.i+", "+e.j+", "+e.k+"} voxelTo {"+l.i+", "+l.j+", "+l.k+"}");g=this.getSegmentSampleVoxelSpace(e,l,g);if(!g)return null;for(e=0;e<g.positions.length;e++)l=this.getPositionFromVoxelSpaceToTransfoSpace(g.positions[e],d),g.positions[e]=l,g.labels[e]="("+Math.round(100*
l.x)/100+", "+Math.round(100*l.y)/100+", "+Math.round(100*l.z)/100+")";return g}},{key:"getVoxelBox",value:function(){return{min:{i:0,j:0,k:0,t:0},max:{i:this.getDimensionSize("i"),j:this.getDimensionSize("j"),k:this.getDimensionSize("k"),t:this.getDimensionSize("t")}}}},{key:"getTransfoVolumeCorners",value:function(a){return this.hasTransform(a)?[this.getPositionFromVoxelSpaceToTransfoSpace({i:0,j:0,k:0},a),this.getPositionFromVoxelSpaceToTransfoSpace({i:this.getDimensionSize("i")-1,j:0,k:0},a),
this.getPositionFromVoxelSpaceToTransfoSpace({i:this.getDimensionSize("i")-1,j:this.getDimensionSize("j")-1,k:0},a),this.getPositionFromVoxelSpaceToTransfoSpace({i:0,j:this.getDimensionSize("j")-1,k:0},a),this.getPositionFromVoxelSpaceToTransfoSpace({i:0,j:0,k:this.getDimensionSize("j")-1},a),this.getPositionFromVoxelSpaceToTransfoSpace({i:this.getDimensionSize("i")-1,j:0,k:this.getDimensionSize("k")-1},a),this.getPositionFromVoxelSpaceToTransfoSpace({i:this.getDimensionSize("i")-1,j:this.getDimensionSize("j")-
1,k:this.getDimensionSize("k")-1},a),this.getPositionFromVoxelSpaceToTransfoSpace({i:0,j:this.getDimensionSize("j")-1,k:this.getDimensionSize("k")-1},a)]:(console.warn("The transform "+a+" is not available."),null)}},{key:"getTransfoBox",value:function(a){if(!this.hasTransform(space2voxelTransformName))return console.warn("The transform "+a+" is not available."),null;a=this.getTransfoVolumeCorners();for(var d=Infinity,b=Infinity,c=Infinity,f=-Infinity,k=-Infinity,l=-Infinity,m=0;m<a.length;m++)d=
Math.min(d,a[m].x),b=Math.min(b,a[m].y),c=Math.min(c,a[m].z),f=Math.max(f,a[m].x),k=Math.max(k,a[m].y),l=Math.max(l,a[m].z);return{min:{x:d,y:b,z:c,t:0},max:{x:f,y:k,z:l,t:this.getDimensionSize("t")}}}}],[{key:"TYPE",value:function(){return"IMAGE3DALT"}}]);return b}(Yb);Za.addCoreType(Ta);var Ci=ma(function(c){var b=b||{};b.EPSILON=1E-6;b.BVHVector3=function(a,d,b){this.x=a||0;this.y=d||0;this.z=b||0};b.BVHVector3.prototype={constructor:b.BVHVector3,copy:function(a){this.x=a.x;this.y=a.y;this.z=a.z;
return this},set:function(a,d,b){this.x=a;this.y=d;this.z=b;return this},setFromArray:function(a,d){this.x=a[d];this.y=a[d+1];this.z=a[d+2]},add:function(a){this.x+=a.x;this.y+=a.y;this.z+=a.z;return this},multiplyScalar:function(a){this.x*=a;this.y*=a;this.z*=a;return this},subVectors:function(a,d){this.x=a.x-d.x;this.y=a.y-d.y;this.z=a.z-d.z;return this},dot:function(a){return this.x*a.x+this.y*a.y+this.z*a.z},cross:function(a){var d=this.x,b=this.y,c=this.z;this.x=b*a.z-c*a.y;this.y=c*a.x-d*a.z;
this.z=d*a.y-b*a.x;return this},crossVectors:function(a,d){var b=a.x,c=a.y;a=a.z;var f=d.x,k=d.y;d=d.z;this.x=c*d-a*k;this.y=a*f-b*d;this.z=b*k-c*f;return this},clone:function(){return new b.BVHVector3(this.x,this.y,this.z)}};b.BVH=function(a,d){this._trianglesArray=a;this._maxTrianglesPerNode=d||10;this._bboxArray=this.calcBoundingBoxes(a);this._bboxHelper=new Float32Array(this._bboxArray);a=a.length/9;d=this.calcExtents(0,a,b.EPSILON);this._rootNode=new b.BVHNode(d[0],d[1],0,a,0);for(this._nodesToSplit=
[this._rootNode];0<this._nodesToSplit.length;)a=this._nodesToSplit.pop(),this.splitNode(a)};b.BVH.prototype.isInside=function(a){return(a=this.intersectRay({x:a[0],y:a[1],z:a[2]},{x:1,y:0,z:0},!1))?1===a.length%2:!1};b.BVH.prototype.intersectBox=function(a){return this._intersectShape(a,a,b.BVH._isTriangleInsideBox)};b.BVH.prototype.intersectSphere=function(a){return this._intersectShape(a,{min:[a.center[0]-a.radius,a.center[1]-a.radius,a.center[2]-a.radius],max:[a.center[0]+a.radius,a.center[1]+
a.radius,a.center[2]+a.radius]},b.BVH.isTriangleInsideSphere)};b.BVH.prototype._intersectShape=function(a,d,c){for(var g=[this._rootNode],f=[],k=[];0<g.length;){var l=g.pop();if(b.BVH._nodeIntersectBox(l,d))for(l._node0&&g.push(l._node0),l._node1&&g.push(l._node1),m=l._startIndex;m<l._endIndex;m++)f.push(this._bboxArray[7*m])}for(var m=0;m<f.length;m++)d=f[m],g=9*d,g=this._trianglesArray.subarray(g,g+9),c(g,a)&&k.push({triangle:new Float32Array(g),triangleIndex:d});return k};b.BVH._nodeIntersectBox=
function(a,d){var b=[a._extentsMin.x,a._extentsMin.y,a._extentsMin.z];a=[a._extentsMax.x,a._extentsMax.y,a._extentsMax.z];var c=d.min;d=d.max;for(var f=[!1,!1,!1],k=0;3>k;k++){var l=c[k]<b[k]&&d[k]>a[k]||b[k]<c[k]&&a[k]>d[k];f[k]=c[k]<a[k]&&d[k]>b[k]||l}return f[0]&&f[1]&&f[2]};b.BVH._isTriangleInsideBox=function(a,d){var b=d.min;d=d.max;for(var c=[!1,!1,!1],f=0;3>f;f++){var k=a[0+f],l=a[3+f],m=a[6+f];c[f]=k>b[f]&&k<d[f]&&l>b[f]&&l<d[f]&&m>b[f]&&m<d[f]}return c[0]&&c[1]&&c[2]};b.BVH.isTriangleInsideSphere=
function(a,d){for(var b=!0,c=0;3>c;c++)var f=a[3*c]-d.center[0],k=a[3*c+1]-d.center[1],l=a[3*c+2]-d.center[2],f=Math.sqrt(f*f+k*k+l*l),b=b&&f<d.radius;return b};b.BVH.prototype.intersectRay=function(a,d,c){for(var g=[this._rootNode],f=[],k=[],l,m=new b.BVHVector3(1/d.x,1/d.y,1/d.z);0<g.length;){var n=g.pop();if(b.BVH.intersectNodeBox(a,m,n))for(n._node0&&g.push(n._node0),n._node1&&g.push(n._node1),l=n._startIndex;l<n._endIndex;l++)f.push(this._bboxArray[7*l])}g=new b.BVHVector3;m=new b.BVHVector3;
n=new b.BVHVector3;a=new b.BVHVector3(a.x,a.y,a.z);d=new b.BVHVector3(d.x,d.y,d.z);for(l=0;l<f.length;l++){var r=f[l],u=9*r;g.setFromArray(this._trianglesArray,u);m.setFromArray(this._trianglesArray,u+3);n.setFromArray(this._trianglesArray,u+6);var p=b.BVH.intersectRayTriangle(g,m,n,a,d,c);p&&k.push({triangle:this._trianglesArray.slice(u,u+9),triangleIndex:r,intersectionPoint:p})}return k};b.BVH.prototype.calcBoundingBoxes=function(a){for(var d,c,e,f,k,l,m=a.length/9,n=new Float32Array(7*m),r=0;r<
m;r++)d=Math.min(a[9*r],a[9*r+3],a[9*r+6]),c=Math.min(a[9*r+1],a[9*r+4],a[9*r+7]),e=Math.min(a[9*r+2],a[9*r+5],a[9*r+8]),f=Math.max(a[9*r],a[9*r+3],a[9*r+6]),k=Math.max(a[9*r+1],a[9*r+4],a[9*r+7]),l=Math.max(a[9*r+2],a[9*r+5],a[9*r+8]),b.BVH.setBox(n,r,r,d,c,e,f,k,l);return n};b.BVH.prototype.calcExtents=function(a,d,b){b=b||0;if(a>=d)return[{x:0,y:0,z:0},{x:0,y:0,z:0}];for(var c=Infinity,g=Infinity,k=Infinity,l=-Infinity,m=-Infinity,n=-Infinity;a<d;a++)c=Math.min(this._bboxArray[7*a+1],c),g=Math.min(this._bboxArray[7*
a+2],g),k=Math.min(this._bboxArray[7*a+3],k),l=Math.max(this._bboxArray[7*a+4],l),m=Math.max(this._bboxArray[7*a+5],m),n=Math.max(this._bboxArray[7*a+6],n);return[{x:c-b,y:g-b,z:k-b},{x:l+b,y:m+b,z:n+b}]};b.BVH.prototype.splitNode=function(a){if(!(a.elementCount()<=this._maxTrianglesPerNode||0===a.elementCount())){var d=a._startIndex,c=a._endIndex,e=[[],[],[]],f=[[],[],[]],k=[a.centerX(),a.centerY(),a.centerZ()],l=[a._extentsMax.x-a._extentsMin.x,a._extentsMax.y-a._extentsMin.y,a._extentsMax.z-a._extentsMin.z],
m=[];m.length=3;for(var n=d;n<c;n++){m[0]=.5*(this._bboxArray[7*n+1]+this._bboxArray[7*n+4]);m[1]=.5*(this._bboxArray[7*n+2]+this._bboxArray[7*n+5]);m[2]=.5*(this._bboxArray[7*n+3]+this._bboxArray[7*n+6]);for(var r=0;3>r;r++)m[r]<k[r]?e[r].push(n):f[r].push(n)}n=[];n.length=3;n[0]=0===e[0].length||0===f[0].length;n[1]=0===e[1].length||0===f[1].length;n[2]=0===e[2].length||0===f[2].length;if(!(n[0]&&n[1]&&n[2])){k=[0,1,2];k.sort(function(a,d){return l[d]-l[a]});for(var u,p,r=0;3>r;r++)if(m=k[r],!n[m]){u=
e[m];p=f[m];break}e=d+u.length;f=a._startIndex;p=u.concat(p);for(n=0;n<p.length;n++)u=p[n],b.BVH.copyBox(this._bboxArray,u,this._bboxHelper,f),f++;u=this._bboxHelper.subarray(7*a._startIndex,7*a._endIndex);this._bboxArray.set(u,7*a._startIndex);p=this.calcExtents(d,e,b.EPSILON);u=this.calcExtents(e,c,b.EPSILON);d=new b.BVHNode(p[0],p[1],d,e,a._level+1);c=new b.BVHNode(u[0],u[1],e,c,a._level+1);a._node0=d;a._node1=c;a.clearShapes();this._nodesToSplit.push(d);this._nodesToSplit.push(c)}}};b.BVH._calcTValues=
function(a,d,b,c){var g={min:0,max:0};0<=c?(g.min=(a-b)*c,g.max=(d-b)*c):(g.min=(d-b)*c,g.max=(a-b)*c);return g};b.BVH.intersectNodeBox=function(a,d,c){var g=b.BVH._calcTValues(c._extentsMin.x,c._extentsMax.x,a.x,d.x),f=b.BVH._calcTValues(c._extentsMin.y,c._extentsMax.y,a.y,d.y);if(g.min>f.max||f.min>g.max)return!1;if(f.min>g.min||g.min!==g.min)g.min=f.min;if(f.max<g.max||g.max!==g.max)g.max=f.max;a=b.BVH._calcTValues(c._extentsMin.z,c._extentsMax.z,a.z,d.z);if(g.min>a.max||a.min>g.max)return!1;if(a.min>
g.min||g.min!==g.min)g.min=a.min;if(a.max<g.max||g.max!==g.max)g.max=a.max;return 0>g.max?!1:!0};b.BVH.intersectRayTriangle=function(){var a=new b.BVHVector3,d=new b.BVHVector3,c=new b.BVHVector3,e=new b.BVHVector3;return function(g,k,l,m,n,r){d.subVectors(k,g);c.subVectors(l,g);e.crossVectors(d,c);k=n.dot(e);if(0<k){if(r)return null;r=1}else if(0>k)r=-1,k=-k;else return null;a.subVectors(m,g);g=r*n.dot(c.crossVectors(a,c));if(0>g)return null;l=r*n.dot(d.cross(a));if(0>l||g+l>k)return null;g=-r*a.dot(e);
if(0>g)return null;k=g/k;return(new b.BVHVector3).copy(n).multiplyScalar(k).add(m)}}();b.BVH.setBox=function(a,d,b,c,f,k,l,m,n){a[7*d]=b;a[7*d+1]=c;a[7*d+2]=f;a[7*d+3]=k;a[7*d+4]=l;a[7*d+5]=m;a[7*d+6]=n};b.BVH.copyBox=function(a,d,b,c){b[7*c]=a[7*d];b[7*c+1]=a[7*d+1];b[7*c+2]=a[7*d+2];b[7*c+3]=a[7*d+3];b[7*c+4]=a[7*d+4];b[7*c+5]=a[7*d+5];b[7*c+6]=a[7*d+6]};b.BVH.getBox=function(a,d,b){b.triangleId=a[7*d];b.minX=a[7*d+1];b.minY=a[7*d+2];b.minZ=a[7*d+3];b.maxX=a[7*d+4];b.maxY=a[7*d+5];b.maxZ=a[7*d+
6]};b.BVHNode=function(a,d,b,c,f){this._extentsMin=a;this._extentsMax=d;this._startIndex=b;this._endIndex=c;this._level=f;this._node1=this._node0=null};b.BVHNode.prototype.elementCount=function(){return this._endIndex-this._startIndex};b.BVHNode.prototype.centerX=function(){return.5*(this._extentsMin.x+this._extentsMax.x)};b.BVHNode.prototype.centerY=function(){return.5*(this._extentsMin.y+this._extentsMax.y)};b.BVHNode.prototype.centerZ=function(){return.5*(this._extentsMin.z+this._extentsMax.z)};
b.BVHNode.prototype.clearShapes=function(){this._endIndex=this._startIndex=-1};b.BVHNode.calcBoundingSphereRadius=function(a,d){var b=.5*(a.x+d.x),c=.5*(a.y+d.y),f=.5*(a.z+d.z);return Math.sqrt(Math.max((b-a.x)*(b-a.x)+(c-a.y)*(c-a.y)+(f-a.z)*(f-a.z),(b-d.x)*(b-d.x)+(c-d.y)*(c-d.y)+(f-d.z)*(f-d.z)))};c.exports&&(c.exports.BVH=b.BVH,c.exports.intersectRay=b.intersectRay)}),Cc=function(c){function b(){I(this,b);var a=P(this,(b.__proto__||Object.getPrototypeOf(b)).call(this));a._type=b.TYPE();a.setMetadata("verticesPerShapes",
3);a.setMetadata("componentsPerColor",4);var d=a.getMetadata("mandatoryDataset");a._datasetNames={vertexPositions:"vertexPositions",polygonFaces:"polygonFaces",polygonNormals:"polygonNormals",vertexColors:"vertexColors"};d.push(a._datasetNames.vertexPositions);d.push(a._datasetNames.polygonFaces);d.push(a._datasetNames.polygonNormals);a._aabb=null;a._bvhTree=null;a._triangleList=null;return a}L(b,c);N(b,[{key:"setVertexPositions",value:function(a){0!==a.length%3?console.warn("The array of vertex positions has a non-multiple-of-three size."):
this.setData(a,this._datasetNames.vertexPositions)}},{key:"getVertexPositions",value:function(){return this.getData(this._datasetNames.vertexPositions)}},{key:"getVertexPositionCopy",value:function(){return this.getDataCopy(this._datasetNames.vertexPositions)}},{key:"setPolygonFacesOrder",value:function(a){0!==a.length%this.getMetadata("verticesPerShapes")?console.warn("The array of vertext positions must have a size that is a multiple of the metadata 'verticesPerShapes'."):this.setData(a,this._datasetNames.polygonFaces)}},
{key:"getPolygonFacesOrder",value:function(){return this.getData(this._datasetNames.polygonFaces)}},{key:"getPolygonFacesOrderCopy",value:function(){return this.getDataCopy(this._datasetNames.polygonFaces)}},{key:"setPolygonFacesNormals",value:function(a){0!==a.length%3?console.warn("The array of vertext positions must have a size that is a multiple of 3."):this.setData(a,this._datasetNames.polygonNormals)}},{key:"getPolygonFacesNormals",value:function(){return this.getData(this._datasetNames.polygonNormals)}},
{key:"getPolygonFacesNormalsCopy",value:function(){return this.getDataCopy(this._datasetNames.polygonNormals)}},{key:"setVertexColors",value:function(a){0!==a.length%this.getMetadata("componentsPerColor")?console.warn("The array of vertext positions must have a size that is a multiple of the metadata 'componentsPerColor'."):this.setData(a,this._datasetNames.vertexColors)}},{key:"getVertexColors",value:function(){return this.getData(this._datasetNames.vertexColors)}},{key:"getVertexColorsCopy",value:function(){return this.getDataCopy(this._datasetNames.vertexColors)}},
{key:"getNumberOfVerticesPerShapes",value:function(){return this.getMetadata("verticesPerShapes")}},{key:"setNumberOfVerticesPerShapes",value:function(a){0>a&&console.warn("The number of vertice per shapes should be positive.");this.setMetadata("verticesPerShapes",a)}},{key:"getNumberOfComponentsPerColor",value:function(){return this.getMetadata("componentsPerColor")}},{key:"setNumberOfComponentsPerColor",value:function(a){0>a&&console.warn("The number of components per pixel should be positive.");
this.setMetadata("componentsPerColor",a)}},{key:"getNumberOfVertices",value:function(){var a=this.getVertexPositions();return a?a.length/3:null}},{key:"generateUniformVertexColor",value:function(a){}},{key:"generateFacesNormalsVectors",value:function(){}},{key:"buildBox",value:function(){var a=this.getVertexPositions();if(a){for(var d=new Float32Array([Infinity,Infinity,Infinity]),b=new Float32Array([-Infinity,-Infinity,-Infinity]),c=0;c<a.length;c+=3)d[0]=Math.min(d[0],a[c]),b[0]=Math.max(b[0],a[c]),
d[1]=Math.min(d[1],a[c+1]),b[1]=Math.max(b[1],a[c+1]),d[2]=Math.min(d[2],a[c+2]),b[2]=Math.max(b[2],a[c+2]);this._aabb={min:d,max:b}}}},{key:"getBox",value:function(){this._aabb||this.buildBox();return this._aabb}},{key:"getBoxCenter",value:function(){this._aabb||this.buildBox();return this._aabb?new Float32Array([(this._aabb.min[0]+this._aabb.max[0])/2,(this._aabb.min[1]+this._aabb.max[1])/2,(this._aabb.min[2]+this._aabb.max[2])/2]):null}},{key:"buildTriangleList",value:function(){var a=this.getVertexPositions(),
d=this.getPolygonFacesOrder();this._triangleList=new Float32Array(3*d.length);for(var b=0;b<d.length;b+=3)this._triangleList[3*b]=a[3*d[b]],this._triangleList[3*b+1]=a[3*d[b]+1],this._triangleList[3*b+2]=a[3*d[b]+2],this._triangleList[3*b+3]=a[3*d[b+1]],this._triangleList[3*b+4]=a[3*d[b+1]+1],this._triangleList[3*b+5]=a[3*d[b+1]+2],this._triangleList[3*b+6]=a[3*d[b+2]],this._triangleList[3*b+7]=a[3*d[b+2]+1],this._triangleList[3*b+8]=a[3*d[b+2]+2]}},{key:"updateColorTriangle",value:function(a,d){var b=
this._metadata.componentsPerColor;if(b!=d.length)console.warn("The given color array must have the same number of component than the mesh (="+b+")");else{var c=this.getVertexColors(),f=this.getPolygonFacesOrder();if(0>a||a>=f.length/3)console.warn("The triangle index is out of bounds.");else{a*=3;for(var k=0;k<b;k++)c[f[a]*b+k]=d[k],c[f[a+1]*b+k]=d[k],c[f[a+2]*b+k]=d[k]}}}},{key:"buildBvhTree",value:function(){this._triangleList||this.buildTriangleList();this._bvhTree=new Ci.BVH(this._triangleList,
4)}},{key:"isInside",value:function(a){this._aabb||this.buildBox();return a[0]>this._aabb.min[0]&&a[0]<this._aabb.max[0]&&a[1]>this._aabb.min[1]&&a[1]<this._aabb.max[1]&&a[2]>this._aabb.min[2]&&a[2]<this._aabb.max[2]?this._bvhTree.isInside(a):!1}},{key:"intersectRay",value:function(a,d){var b=2<arguments.length&&void 0!==arguments[2]?arguments[2]:!1;this._bvhTree||this.buildBvhTree();return this._bvhTree.intersectRay({x:a[0],y:a[1],z:a[2]},{x:d[0],y:d[1],z:d[2]},b)}},{key:"intersectBox",value:function(a){this._bvhTree||
this.buildBvhTree();return this._bvhTree.intersectBox(a)}},{key:"intersectSphere",value:function(a){this._bvhTree||this.buildBvhTree();return this._bvhTree.intersectSphere(a)}}],[{key:"TYPE",value:function(){return"MESH3D"}}]);return b}(function(c){function b(){I(this,b);var a=P(this,(b.__proto__||Object.getPrototypeOf(b)).call(this));a._data=[];a.setMetadata("dataIndex",{});a.setMetadata("mandatoryDataset",[]);return a}L(b,c);N(b,[{key:"getData",value:function(a){a=this.getDataIndex(a);return-1!==
a?this._data[a]:null}},{key:"getDataCopy",value:function(a){return(a=this.getData(a))?new a.constructor(a):null}},{key:"getDataIndex",value:function(a){var d=-1,b=this._metadata.dataIndex;a in b&&(d=b[a]);return d}},{key:"doesDataExist",value:function(a){return-1!==this.getDataIndex(a)}},{key:"setData",value:function(a){var d=1<arguments.length&&void 0!==arguments[1]?arguments[1]:null;if(a){var b=this.getDataIndex(d),c=this._metadata.dataIndex;-1!==b?this._data[b]=a:(b=this._data.length,this._data.push(a),
c[d]=b)}else console.warn("Cannot add null as a dataset.")}},{key:"checkIntegrity",value:function(){for(var a=!0,d=this.getMetadata("mandatoryDataset"),b=0;b<d.length;b++){var c=this.doesDataExist(d[b]),a=a&&c;c||console.warn("The sub-data of name: "+d[b]+" is missing")}return a}},{key:"clone",value:function(){var a=this.getMetadataClone();if(!a)return console.warn("The metadata object is invalid, cloning is impossible."),null;var d=this._metadata.dataIndex,b=new this.constructor;b.setRawMetadata(a);
for(var c in d)b.setData(this.getDataCopy(c),c);return b}}]);return b}(Yb));Za.addCoreType(Cc);var fd=function(c,b){return b={exports:{}},c(b,b.exports),b.exports}(function(c){function b(a){this.value=a}function a(a,b,c){var g=[],e=[],n=!0;return function x(a){function p(){if("object"===O(q.node)&&null!==q.node){q.keys&&q.node_===q.node||(q.keys=f(q.node));q.isLeaf=0==q.keys.length;for(var d=0;d<e.length;d++)if(e[d].node_===a){q.circular=e[d];break}}else q.isLeaf=!0,q.keys=null;q.notLeaf=!q.isLeaf;
q.notRoot=!q.isRoot}var r,u,t,y,v=!0,q={node:c?d(a):a,node_:a,path:[].concat(g),parent:e[e.length-1],parents:e,key:g.slice(-1)[0],isRoot:0===g.length,level:g.length,circular:null,update:function(a,d){q.isRoot||(q.parent.node[q.key]=a);q.node=a;d&&(v=!1)},"delete":function(a){delete q.parent.node[q.key];a&&(v=!1)},remove:function(a){k(q.parent.node)?q.parent.node.splice(q.key,1):delete q.parent.node[q.key];a&&(v=!1)},keys:null,before:function(a){r=a},after:function(a){u=a},pre:function(a){t=a},post:function(a){y=
a},stop:function(){n=!1},block:function(){v=!1}};if(!n)return q;p();var B=b.call(q,q.node);void 0!==B&&q.update&&q.update(B);r&&r.call(q,q.node);if(!v)return q;"object"!=O(q.node)||null===q.node||q.circular||(e.push(q),p(),l(q.keys,function(a,d){g.push(a);t&&t.call(q,q.node[a],a);var b=x(q.node[a]);c&&m.call(q.node,a)&&(q.node[a]=b.node);b.isLast=d==q.keys.length-1;b.isFirst=0==d;y&&y.call(q,b);g.pop()}),e.pop());u&&u.call(q,q.node);return q}(a).node}function d(a){if("object"===("undefined"===typeof a?
"undefined":O(a))&&null!==a){var d;if(k(a))d=[];else if("[object Date]"===g(a))d=new Date(a.getTime?a.getTime():a);else if("[object RegExp]"===g(a))d=new RegExp(a);else if("[object Error]"===g(a))d={message:a.message};else if("[object Boolean]"===g(a))d=new Boolean(a);else if("[object Number]"===g(a))d=new Number(a);else if("[object String]"===g(a))d=new String(a);else if(Object.create&&Object.getPrototypeOf)d=Object.create(Object.getPrototypeOf(a));else if(a.constructor===Object)d={};else{var b=
function(){};b.prototype=a.constructor&&a.constructor.prototype||a.__proto__||{};d=new b}l(f(a),function(b){d[b]=a[b]});return d}return a}function g(a){return Object.prototype.toString.call(a)}var e=c.exports=function(a){return new b(a)};b.prototype.get=function(a){for(var d=this.value,b=0;b<a.length;b++){var c=a[b];if(!d||!m.call(d,c)){d=void 0;break}d=d[c]}return d};b.prototype.has=function(a){for(var d=this.value,b=0;b<a.length;b++){var c=a[b];if(!d||!m.call(d,c))return!1;d=d[c]}return!0};b.prototype.set=
function(a,d){for(var b=this.value,c=0;c<a.length-1;c++){var g=a[c];m.call(b,g)||(b[g]={});b=b[g]}return b[a[c]]=d};b.prototype.map=function(d){return a(this.value,d,!0)};b.prototype.forEach=function(d){return this.value=a(this.value,d,!1)};b.prototype.reduce=function(a,d){var b=1===arguments.length,c=b?this.value:d;this.forEach(function(d){this.isRoot&&b||(c=a.call(this,c,d))});return c};b.prototype.paths=function(){var a=[];this.forEach(function(d){a.push(this.path)});return a};b.prototype.nodes=
function(){var a=[];this.forEach(function(d){a.push(this.node)});return a};b.prototype.clone=function(){var a=[],b=[];return function p(c){for(var g=0;g<a.length;g++)if(a[g]===c)return b[g];if("object"===("undefined"===typeof c?"undefined":O(c))&&null!==c){var e=d(c);a.push(c);b.push(e);l(f(c),function(a){e[a]=p(c[a])});a.pop();b.pop();return e}return c}(this.value)};var f=Object.keys||function(a){var d=[],b;for(b in a)d.push(b);return d},k=Array.isArray||function(a){return"[object Array]"===Object.prototype.toString.call(a)},
l=function(a,d){if(a.forEach)return a.forEach(d);for(var b=0;b<a.length;b++)d(a[b],b,a)};l(f(b.prototype),function(a){e[a]=function(d){var c=[].slice.call(arguments,1),g=new b(d);return g[a].apply(g,c)}});var m=Object.hasOwnProperty||function(a,d){return d in a}}),Di=function(){function c(b,a){for(var d=0;d<a.length;d++){var c=a[d];c.enumerable=c.enumerable||!1;c.configurable=!0;"value"in c&&(c.writable=!0);Object.defineProperty(b,c.key,c)}}return function(b,a,d){a&&c(b.prototype,a);d&&c(b,d);return b}}(),
Jb=function(){function c(){if(!(this instanceof c))throw new TypeError("Cannot call a class as a function");}Di(c,null,[{key:"isPlatformLittleEndian",value:function(){var b=new Uint32Array([305419896]);return 18!=(new Uint8Array(b.buffer,b.byteOffset,b.byteLength))[0]}},{key:"arrayBufferToUnicode",value:function(b){b=new Uint8Array(b);for(var a=[],d=0,c=0;d<b.length;){var e=b[d++];if(128>e){if(32>e&&10!=e&&13!=e&&9!=e||127==e)return console.warn("Invalid string: non-printable characters"),null;a[c++]=
String.fromCharCode(e)}else if(191<e&&224>e){var f=b[d++];a[c++]=String.fromCharCode((e&31)<<6|f&63)}else if(239<e&&365>e){var f=b[d++],k=b[d++],l=b[d++],e=((e&7)<<18|(f&63)<<12|(k&63)<<6|l&63)-65536;a[c++]=String.fromCharCode(55296+(e>>10));a[c++]=String.fromCharCode(56320+(e&1023))}else{f=b[d++];k=b[d++];e=(e&15)<<12|(f&63)<<6|k&63;if(65533===e)return console.warn("Invalid string: a REPLACEMENT CHARACTER was spotted"),null;a[c++]=String.fromCharCode(e)}}return a.join("")}},{key:"unicodeToArrayBuffer",
value:function(b){for(var a=[],d=0,c=0;c<b.length;c++){var e=b.charCodeAt(c);128>e?a[d++]=e:(2048>e?a[d++]=e>>6|192:(55296==(e&64512)&&c+1<b.length&&56320==(b.charCodeAt(c+1)&64512)?(e=65536+((e&1023)<<10)+(b.charCodeAt(++c)&1023),a[d++]=e>>18|240,a[d++]=e>>12&63|128):a[d++]=e>>12|224,a[d++]=e>>6&63|128),a[d++]=e&63|128)}return(new Uint8Array(a)).buffer}},{key:"arrayBufferToString8",value:function(b){return String.fromCharCode.apply(null,new Uint8Array(b))}},{key:"string8ToArrayBuffer",value:function(b){for(var a=
new ArrayBuffer(b.length),d=new Uint8Array(a),c=0;c<b.length;c++)d[c]=b.charCodeAt(c);return a}},{key:"setString8InBuffer",value:function(b,a){var d=2<arguments.length&&void 0!==arguments[2]?arguments[2]:0;if(0>d)console.warn("The byte offset cannot be negative.");else if(a&&a instanceof ArrayBuffer)if(b.length+d>a.byteLength)console.warn("The string is too long to be writen in this buffer.");else for(var c=new Uint8Array(a),e=0;e<b.length;e++)c[e+d]=b.charCodeAt(e);else console.warn("The buffer must be a valid ArrayBuffer.")}},
{key:"getString8FromBuffer",value:function(b,a){var d=2<arguments.length&&void 0!==arguments[2]?arguments[2]:0;return 0>d?(console.warn("The byte offset cannot be negative."),null):b&&b instanceof ArrayBuffer?a+d>b.byteLength?(console.warn("The string is too long to be writen in this buffer."),null):String.fromCharCode.apply(null,new Uint8Array(b,d,a)):(console.warn("The buffer must be a valid ArrayBuffer."),null)}},{key:"objectToArrayBuffer",value:function(b){var a=null;b=c.makeSerializeFriendly(b);
try{var d=JSON.stringify(b),a=c.unicodeToArrayBuffer(d)}catch(g){console.warn(g)}return a}},{key:"ArrayBufferToObject",value:function(b){var a=null;try{var d=c.arrayBufferToUnicode(b),a=JSON.parse(d)}catch(g){console.warn(g)}return a}},{key:"isTypedArray",value:function(b){return b instanceof Int8Array||b instanceof Uint8Array||b instanceof Uint8ClampedArray||b instanceof Int16Array||b instanceof Uint16Array||b instanceof Int32Array||b instanceof Uint32Array||b instanceof Float32Array||b instanceof
Float64Array}},{key:"mergeBuffers",value:function(b){for(var a=0,d=0;d<b.length;d++)a+=b[d].byteLength;for(var a=new Uint8Array(a),c=0,d=0;d<b.length;d++)a.set(new Uint8Array(b[d]),c),c+=b[d].byteLength;return a.buffer}},{key:"getGlobalObject",value:function(){var b=null;try{b=window}catch(a){try{b=GLOBAL}catch(d){return console.warn("You are not in a Javascript environment?? Weird."),null}}return b}},{key:"extractTypedArray",value:function(b,a,d,c){if(!b)return console.warn("Input Buffer is null."),
null;if(!(b instanceof ArrayBuffer))return console.warn("Buffer must be of type ArrayBuffer"),null;if(0>=c)return console.warn("The number of elements to fetch must be greater than 0"),null;if(0>a)return console.warn("The byte offset must be possitive or 0"),null;if(a>=b.byteLength)return console.warn("The offset cannot be larger than the size of the buffer."),null;if(d instanceof Function&&!("BYTES_PER_ELEMENT"in d))return console.warn("ArrayType must be a typed array constructor function."),null;
if(d.BYTES_PER_ELEMENT*c+a>b.byteLength)console.warn("The requested number of elements is too large for this buffer");else return b=b.slice(a,a+c*d.BYTES_PER_ELEMENT),new d(b)}},{key:"getTypedArrayInfo",value:function(b){var a=null,d=!1;b instanceof Int8Array?(a="int",d=!1):b instanceof Uint8Array?(a="int",d=!0):b instanceof Uint8ClampedArray?(a="int",d=!0):b instanceof Int16Array?(a="int",d=!1):b instanceof Uint16Array?(a="int",d=!0):b instanceof Int32Array?(a="int",d=!1):b instanceof Uint32Array?
(a="int",d=!0):b instanceof Float32Array?(a="float",d=!1):b instanceof Float64Array&&(a="float",d=!1);return{type:a,signed:d,bytesPerElements:b.BYTES_PER_ELEMENT,byteLength:b.byteLength,length:b.length}}},{key:"howManyTypedArrayAttributes",value:function(b){var a=0;fd(b).forEach(function(d){a+=c.isTypedArray(d)});return a}},{key:"hasCircularReference",value:function(b){var a=!1;fd(b).forEach(function(d){this.circular&&(a=!0)});return a}},{key:"removeCircularReference",value:function(b){var a=!1;b=
fd(b).map(function(d){this.circular&&(this.remove(),a=!0)});return a?b:null}},{key:"replaceTypedArrayAttributesByArrays",value:function(b){var a=!1;b=fd(b).map(function(d){if(c.isTypedArray(d)){for(var b=Object.keys(d).length,e=Array(b),f=0;f<b;f++)e[f]=d[f];this.update(e);a=!0}});return a?b:null}},{key:"makeSerializeFriendly",value:function(b){var a=c.removeCircularReference(b);a&&(b=a);(a=c.replaceTypedArrayAttributesByArrays(b))&&(b=a);return b}},{key:"isValidString",value:function(b){for(var a=
b.length,a=1<arguments.length&&void 0!==arguments[1]&&arguments[1]?a:Math.min(1E3,a),d=0,c=0;c<a;c++){var e=b.charCodeAt(Math.floor(Math.random()*a));(65533===e||32>e&&10!=e&&13!=e&&9!=e||127==e)&&d++}return!(0<d)}}]);return c}(),ra=function(c){function b(){I(this,b);var a=P(this,(b.__proto__||Object.getPrototypeOf(b)).call(this));a.setMetadata("targetType",null);return a}L(b,c);N(b,null,[{key:"isBinary",value:function(){return!0}}]);N(b,[{key:"_isBinary",value:function(){return this.constructor.isBinary()}},
{key:"_getInput",value:function(){var a=0<arguments.length&&void 0!==arguments[0]?arguments[0]:0,a=xg(b.prototype.__proto__||Object.getPrototypeOf(b.prototype),"_getInput",this).call(this,a),d=this._isBinary();if(d&&a instanceof ArrayBuffer||!d&&"string"===typeof a)return a;if(!d&&a instanceof ArrayBuffer){if(a=Jb.arrayBufferToUnicode(a))return a;console.warn("The binary buffer could not be converted into a a valid string.");return null}d&&"string"===typeof a&&console.warn("A binary buffer is expected and a string buffer is given. Unable to continue.");
return null}}]);return b}(W),Ei=function(c){function b(){I(this,b);var a=P(this,(b.__proto__||Object.getPrototypeOf(b)).call(this));a.addInputValidator(0,Q);a.setMetadata("alpha",!1);a.setMetadata("min",0);a.setMetadata("max",255);a.setMetadata("reset",!0);a._canvas=null;a._ctx=null;return a}L(b,c);N(b,[{key:"getCanvas",value:function(){return this._canvas}},{key:"_init",value:function(){var a=document.getElementById(this.getMetadata("parentDivID"));if(!a)return!1;if(this.getMetadata("reset"))for(;a.firstChild;)a.removeChild(a.firstChild);
this._canvas=document.createElement("canvas");this._canvas.style="image-rendering: pixelated;";this._ctx=this._canvas.getContext("2d");this._ctx.imageSmoothingEnabled=!1;this._ctx.mozImageSmoothingEnabled=!1;this._ctx.webkitImageSmoothingEnabled=!1;this._ctx.ctxmsImageSmoothingEnabled=!1;document.getElementById(this.getMetadata("parentDivID")).appendChild(this._canvas);return!0}},{key:"_run",value:function(){if(this.hasValidInput()){var a=this._input[0],d=a.getComponentsPerPixel();if(1!=d&&3!=d&&
4!=d)console.warn("Cannot write Image in canvas if contains other than 1, 3 or 4 bands.");else if(this.getMetadata("parentDivID"))if(this._init()){var b=this.getMetadata("alpha");this._canvas.width=a.getWidth();this._canvas.height=a.getHeight();var c=this._ctx.getImageData(0,0,this._canvas.width,this._canvas.height),f=c.data,a=a.getData();if(4==d)for(d=0;d<a.length;d++)f[d]=b||3!=d%4?this._stretchMinMax(a[d]):255;else if(1==d)for(d=0;d<a.length;d++){var b=4*d,k=this._stretchMinMax(a[d]);f[b]=k;f[b+
1]=k;f[b+2]=k;f[b+3]=255}else if(3==d)for(d=b=0;d<f.length;d++)3==d%4?f[d]=255:(f[d]=this._stretchMinMax(a[b]),b++);this._ctx.putImageData(c,0,0)}else console.warn("The parent div was not specified or does not exist.");else console.error("The parent DIV ID to place the canvas element was not specified. Unable to display anything.")}}},{key:"_stretchMinMax",value:function(a){var d=this._metadata.min,b=this._metadata.max;return 0==d&&255==b?a:(a-d)/(b-d)*255}}]);return b}(W),Fi=function(c){function b(a){I(this,
b);a=P(this,(b.__proto__||Object.getPrototypeOf(b)).call(this));a._loadedCounter=0;a._addOutput(Q,0);return a}L(b,c);N(b,[{key:"_run",value:function(){var a=this;this.getInputCategories().forEach(function(d){a._addOutput(Q,d);a._loadImage(d)})}},{key:"_loadImage",value:function(a){var d=this,b=new Image;b.src=this._getInput(a);b.onload=function(){var c=document.createElement("canvas");c.width=b.width;c.height=b.height;var g=c.getContext("2d");g.drawImage(b,0,0);try{var k=g.getImageData(0,0,c.width,
c.height),l=new Float32Array(k.data);d.getOutput(a).setData(l,b.width,b.height);d._loadedCounter++;d._loadedCounter==d.getNumberOfInputs()&&d.triggerEvent("ready")}catch(m){console.error(m)}}}}]);return b}(W),Gi=function(c){function b(){I(this,b);var a=P(this,(b.__proto__||Object.getPrototypeOf(b)).call(this));a._allowedTypes=/image.*/;return a}L(b,c);N(b,[{key:"hasValidInput",value:function(){var a=!1,d=this._getInput();d&&d.type.match(this._allowedTypes)?a=!0:console.error("The file must be an image (jpg/png). The type "+
d.type+" is not compatible with FileImageReader.");return a}},{key:"_run",value:function(){if(this.hasValidInput()){var a=this,d=this._getInput(),b=new FileReader;b.onload=function(d){var c=new Image;c.onload=function(){var d=document.createElement("canvas");d.width=c.width;d.height=c.height;d=d.getContext("2d");d.drawImage(c,0,0);d=d.getImageData(0,0,c.width,c.height).data;a._addOutput(Q,0).setData(d,c.width,c.height);a.triggerEvent("ready")};c.src=b.result};b.readAsDataURL(d)}}}]);return b}(W),
$a="undefined"!==typeof global?global:"undefined"!==typeof self?self:"undefined"!==typeof window?window:{},eb=qe,fb=re;"function"===typeof $a.setTimeout&&(eb=setTimeout);"function"===typeof $a.clearTimeout&&(fb=clearTimeout);var Va=[],Kb=!1,sb,Mc=-1;ue.prototype.run=function(){this.fun.apply(null,this.array)};var Zb=$a.performance||{},Hi=Zb.now||Zb.mozNow||Zb.msNow||Zb.oNow||Zb.webkitNow||function(){return(new Date).getTime()},Ii=new Date,$b={nextTick:function(c){var b=Array(arguments.length-1);if(1<
arguments.length)for(var a=1;a<arguments.length;a++)b[a-1]=arguments[a];Va.push(new ue(c,b));1!==Va.length||Kb||se(te)},title:"browser",browser:!0,env:{},argv:[],version:"",versions:{},on:tb,addListener:tb,once:tb,off:tb,removeListener:tb,removeAllListeners:tb,emit:tb,binding:function(c){throw Error("process.binding is not supported");},cwd:function(){return"/"},chdir:function(c){throw Error("process.chdir is not supported");},umask:function(){return 0},hrtime:function(c){var b=.001*Hi.call(Zb),a=
Math.floor(b),b=Math.floor(b%1*1E9);c&&(a-=c[0],b-=c[1],0>b&&(a--,b+=1E9));return[a,b]},platform:"browser",release:{},config:{},uptime:function(){return(new Date-Ii)/1E3}},yg={},zg=Object.freeze({default:yg}),Ma=[],Fa=[],Ph="undefined"!==typeof Uint8Array?Uint8Array:Array,qd=!1,Ji={}.toString,Be=Array.isArray||function(c){return"[object Array]"==Ji.call(c)};z.TYPED_ARRAY_SUPPORT=void 0!==$a.TYPED_ARRAY_SUPPORT?$a.TYPED_ARRAY_SUPPORT:!0;var Ki=z.TYPED_ARRAY_SUPPORT?2147483647:1073741823;z.poolSize=
8192;z._augment=function(c){c.__proto__=z.prototype;return c};z.from=function(c,b,a){return ye(null,c,b,a)};z.TYPED_ARRAY_SUPPORT&&(z.prototype.__proto__=Uint8Array.prototype,z.__proto__=Uint8Array);z.alloc=function(c,b,a){Ae(c);c=0>=c?Wa(null,c):void 0!==b?"string"===typeof a?Wa(null,c).fill(b,a):Wa(null,c).fill(b):Wa(null,c);return c};z.allocUnsafe=function(c){return rd(null,c)};z.allocUnsafeSlow=function(c){return rd(null,c)};z.isBuffer=ud;z.compare=function(c,b){if(!Na(c)||!Na(b))throw new TypeError("Arguments must be Buffers");
if(c===b)return 0;for(var a=c.length,d=b.length,g=0,e=Math.min(a,d);g<e;++g)if(c[g]!==b[g]){a=c[g];d=b[g];break}return a<d?-1:d<a?1:0};z.isEncoding=function(c){switch(String(c).toLowerCase()){case "hex":case "utf8":case "utf-8":case "ascii":case "latin1":case "binary":case "base64":case "ucs2":case "ucs-2":case "utf16le":case "utf-16le":return!0;default:return!1}};z.concat=function(c,b){if(!Be(c))throw new TypeError('"list" argument must be an Array of Buffers');if(0===c.length)return z.alloc(0);
var a;if(void 0===b)for(a=b=0;a<c.length;++a)b+=c[a].length;b=z.allocUnsafe(b);var d=0;for(a=0;a<c.length;++a){var g=c[a];if(!Na(g))throw new TypeError('"list" argument must be an Array of Buffers');g.copy(b,d);d+=g.length}return b};z.byteLength=ze;z.prototype._isBuffer=!0;z.prototype.swap16=function(){var c=this.length;if(0!==c%2)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var b=0;b<c;b+=2)ub(this,b,b+1);return this};z.prototype.swap32=function(){var c=this.length;if(0!==
c%4)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var b=0;b<c;b+=4)ub(this,b,b+3),ub(this,b+1,b+2);return this};z.prototype.swap64=function(){var c=this.length;if(0!==c%8)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var b=0;b<c;b+=8)ub(this,b,b+7),ub(this,b+1,b+6),ub(this,b+2,b+5),ub(this,b+3,b+4);return this};z.prototype.toString=function(){var c=this.length|0;return 0===c?"":0===arguments.length?De(this,0,c):Nh.apply(this,arguments)};z.prototype.equals=
function(c){if(!Na(c))throw new TypeError("Argument must be a Buffer");return this===c?!0:0===z.compare(this,c)};z.prototype.inspect=function(){var c="";0<this.length&&(c=this.toString("hex",0,50).match(/.{2}/g).join(" "),50<this.length&&(c+=" ... "));return"<Buffer "+c+">"};z.prototype.compare=function(c,b,a,d,g){if(!Na(c))throw new TypeError("Argument must be a Buffer");void 0===b&&(b=0);void 0===a&&(a=c?c.length:0);void 0===d&&(d=0);void 0===g&&(g=this.length);if(0>b||a>c.length||0>d||g>this.length)throw new RangeError("out of range index");
if(d>=g&&b>=a)return 0;if(d>=g)return-1;if(b>=a)return 1;b>>>=0;a>>>=0;d>>>=0;g>>>=0;if(this===c)return 0;var e=g-d,f=a-b,k=Math.min(e,f);d=this.slice(d,g);c=c.slice(b,a);for(b=0;b<k;++b)if(d[b]!==c[b]){e=d[b];f=c[b];break}return e<f?-1:f<e?1:0};z.prototype.includes=function(c,b,a){return-1!==this.indexOf(c,b,a)};z.prototype.indexOf=function(c,b,a){return Ee(this,c,b,a,!0)};z.prototype.lastIndexOf=function(c,b,a){return Ee(this,c,b,a,!1)};z.prototype.write=function(c,b,a,d){if(void 0===b)d="utf8",
a=this.length,b=0;else if(void 0===a&&"string"===typeof b)d=b,a=this.length,b=0;else if(isFinite(b))b|=0,isFinite(a)?(a|=0,void 0===d&&(d="utf8")):(d=a,a=void 0);else throw Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");var g=this.length-b;if(void 0===a||a>g)a=g;if(0<c.length&&(0>a||0>b)||b>this.length)throw new RangeError("Attempt to write outside buffer bounds");d||(d="utf8");for(g=!1;;)switch(d){case "hex":a:{b=Number(b)||0;d=this.length-b;a?(a=Number(a),a>d&&
(a=d)):a=d;d=c.length;if(0!==d%2)throw new TypeError("Invalid hex string");a>d/2&&(a=d/2);for(d=0;d<a;++d){g=parseInt(c.substr(2*d,2),16);if(isNaN(g)){c=d;break a}this[b+d]=g}c=d}return c;case "utf8":case "utf-8":return ec(Oc(c,this.length-b),this,b,a);case "ascii":return ec(Ke(c),this,b,a);case "latin1":case "binary":return ec(Ke(c),this,b,a);case "base64":return ec(Ce(c),this,b,a);case "ucs2":case "ucs-2":case "utf16le":case "utf-16le":var e;d=c;for(var g=this.length-b,f=[],k=0;k<d.length&&!(0>
(g-=2));++k)e=d.charCodeAt(k),c=e>>8,e%=256,f.push(e),f.push(c);return ec(f,this,b,a);default:if(g)throw new TypeError("Unknown encoding: "+d);d=(""+d).toLowerCase();g=!0}};z.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var Ge=4096;z.prototype.slice=function(c,b){var a=this.length;c=~~c;b=void 0===b?a:~~b;0>c?(c+=a,0>c&&(c=0)):c>a&&(c=a);0>b?(b+=a,0>b&&(b=0)):b>a&&(b=a);b<c&&(b=c);if(z.TYPED_ARRAY_SUPPORT)b=this.subarray(c,b),b.__proto__=z.prototype;
else{a=b-c;b=new z(a,void 0);for(var d=0;d<a;++d)b[d]=this[d+c]}return b};z.prototype.readUIntLE=function(c,b,a){c|=0;b|=0;a||ia(c,b,this.length);a=this[c];for(var d=1,g=0;++g<b&&(d*=256);)a+=this[c+g]*d;return a};z.prototype.readUIntBE=function(c,b,a){c|=0;b|=0;a||ia(c,b,this.length);a=this[c+--b];for(var d=1;0<b&&(d*=256);)a+=this[c+--b]*d;return a};z.prototype.readUInt8=function(c,b){b||ia(c,1,this.length);return this[c]};z.prototype.readUInt16LE=function(c,b){b||ia(c,2,this.length);return this[c]|
this[c+1]<<8};z.prototype.readUInt16BE=function(c,b){b||ia(c,2,this.length);return this[c]<<8|this[c+1]};z.prototype.readUInt32LE=function(c,b){b||ia(c,4,this.length);return(this[c]|this[c+1]<<8|this[c+2]<<16)+16777216*this[c+3]};z.prototype.readUInt32BE=function(c,b){b||ia(c,4,this.length);return 16777216*this[c]+(this[c+1]<<16|this[c+2]<<8|this[c+3])};z.prototype.readIntLE=function(c,b,a){c|=0;b|=0;a||ia(c,b,this.length);a=this[c];for(var d=1,g=0;++g<b&&(d*=256);)a+=this[c+g]*d;a>=128*d&&(a-=Math.pow(2,
8*b));return a};z.prototype.readIntBE=function(c,b,a){c|=0;b|=0;a||ia(c,b,this.length);a=b;for(var d=1,g=this[c+--a];0<a&&(d*=256);)g+=this[c+--a]*d;g>=128*d&&(g-=Math.pow(2,8*b));return g};z.prototype.readInt8=function(c,b){b||ia(c,1,this.length);return this[c]&128?-1*(255-this[c]+1):this[c]};z.prototype.readInt16LE=function(c,b){b||ia(c,2,this.length);c=this[c]|this[c+1]<<8;return c&32768?c|4294901760:c};z.prototype.readInt16BE=function(c,b){b||ia(c,2,this.length);c=this[c+1]|this[c]<<8;return c&
32768?c|4294901760:c};z.prototype.readInt32LE=function(c,b){b||ia(c,4,this.length);return this[c]|this[c+1]<<8|this[c+2]<<16|this[c+3]<<24};z.prototype.readInt32BE=function(c,b){b||ia(c,4,this.length);return this[c]<<24|this[c+1]<<16|this[c+2]<<8|this[c+3]};z.prototype.readFloatLE=function(c,b){b||ia(c,4,this.length);return Nc(this,c,!0,23,4)};z.prototype.readFloatBE=function(c,b){b||ia(c,4,this.length);return Nc(this,c,!1,23,4)};z.prototype.readDoubleLE=function(c,b){b||ia(c,8,this.length);return Nc(this,
c,!0,52,8)};z.prototype.readDoubleBE=function(c,b){b||ia(c,8,this.length);return Nc(this,c,!1,52,8)};z.prototype.writeUIntLE=function(c,b,a,d){c=+c;b|=0;a|=0;d||va(this,c,b,a,Math.pow(2,8*a)-1,0);d=1;var g=0;for(this[b]=c&255;++g<a&&(d*=256);)this[b+g]=c/d&255;return b+a};z.prototype.writeUIntBE=function(c,b,a,d){c=+c;b|=0;a|=0;d||va(this,c,b,a,Math.pow(2,8*a)-1,0);d=a-1;var g=1;for(this[b+d]=c&255;0<=--d&&(g*=256);)this[b+d]=c/g&255;return b+a};z.prototype.writeUInt8=function(c,b,a){c=+c;b|=0;a||
va(this,c,b,1,255,0);z.TYPED_ARRAY_SUPPORT||(c=Math.floor(c));this[b]=c&255;return b+1};z.prototype.writeUInt16LE=function(c,b,a){c=+c;b|=0;a||va(this,c,b,2,65535,0);z.TYPED_ARRAY_SUPPORT?(this[b]=c&255,this[b+1]=c>>>8):Pc(this,c,b,!0);return b+2};z.prototype.writeUInt16BE=function(c,b,a){c=+c;b|=0;a||va(this,c,b,2,65535,0);z.TYPED_ARRAY_SUPPORT?(this[b]=c>>>8,this[b+1]=c&255):Pc(this,c,b,!1);return b+2};z.prototype.writeUInt32LE=function(c,b,a){c=+c;b|=0;a||va(this,c,b,4,4294967295,0);z.TYPED_ARRAY_SUPPORT?
(this[b+3]=c>>>24,this[b+2]=c>>>16,this[b+1]=c>>>8,this[b]=c&255):Qc(this,c,b,!0);return b+4};z.prototype.writeUInt32BE=function(c,b,a){c=+c;b|=0;a||va(this,c,b,4,4294967295,0);z.TYPED_ARRAY_SUPPORT?(this[b]=c>>>24,this[b+1]=c>>>16,this[b+2]=c>>>8,this[b+3]=c&255):Qc(this,c,b,!1);return b+4};z.prototype.writeIntLE=function(c,b,a,d){c=+c;b|=0;d||(d=Math.pow(2,8*a-1),va(this,c,b,a,d-1,-d));d=0;var g=1,e=0;for(this[b]=c&255;++d<a&&(g*=256);)0>c&&0===e&&0!==this[b+d-1]&&(e=1),this[b+d]=(c/g>>0)-e&255;
return b+a};z.prototype.writeIntBE=function(c,b,a,d){c=+c;b|=0;d||(d=Math.pow(2,8*a-1),va(this,c,b,a,d-1,-d));d=a-1;var g=1,e=0;for(this[b+d]=c&255;0<=--d&&(g*=256);)0>c&&0===e&&0!==this[b+d+1]&&(e=1),this[b+d]=(c/g>>0)-e&255;return b+a};z.prototype.writeInt8=function(c,b,a){c=+c;b|=0;a||va(this,c,b,1,127,-128);z.TYPED_ARRAY_SUPPORT||(c=Math.floor(c));0>c&&(c=255+c+1);this[b]=c&255;return b+1};z.prototype.writeInt16LE=function(c,b,a){c=+c;b|=0;a||va(this,c,b,2,32767,-32768);z.TYPED_ARRAY_SUPPORT?
(this[b]=c&255,this[b+1]=c>>>8):Pc(this,c,b,!0);return b+2};z.prototype.writeInt16BE=function(c,b,a){c=+c;b|=0;a||va(this,c,b,2,32767,-32768);z.TYPED_ARRAY_SUPPORT?(this[b]=c>>>8,this[b+1]=c&255):Pc(this,c,b,!1);return b+2};z.prototype.writeInt32LE=function(c,b,a){c=+c;b|=0;a||va(this,c,b,4,2147483647,-2147483648);z.TYPED_ARRAY_SUPPORT?(this[b]=c&255,this[b+1]=c>>>8,this[b+2]=c>>>16,this[b+3]=c>>>24):Qc(this,c,b,!0);return b+4};z.prototype.writeInt32BE=function(c,b,a){c=+c;b|=0;a||va(this,c,b,4,2147483647,
-2147483648);0>c&&(c=4294967295+c+1);z.TYPED_ARRAY_SUPPORT?(this[b]=c>>>24,this[b+1]=c>>>16,this[b+2]=c>>>8,this[b+3]=c&255):Qc(this,c,b,!1);return b+4};z.prototype.writeFloatLE=function(c,b,a){return Ie(this,c,b,!0,a)};z.prototype.writeFloatBE=function(c,b,a){return Ie(this,c,b,!1,a)};z.prototype.writeDoubleLE=function(c,b,a){return Je(this,c,b,!0,a)};z.prototype.writeDoubleBE=function(c,b,a){return Je(this,c,b,!1,a)};z.prototype.copy=function(c,b,a,d){a||(a=0);d||0===d||(d=this.length);b>=c.length&&
(b=c.length);b||(b=0);0<d&&d<a&&(d=a);if(d===a||0===c.length||0===this.length)return 0;if(0>b)throw new RangeError("targetStart out of bounds");if(0>a||a>=this.length)throw new RangeError("sourceStart out of bounds");if(0>d)throw new RangeError("sourceEnd out of bounds");d>this.length&&(d=this.length);c.length-b<d-a&&(d=c.length-b+a);var g=d-a;if(this===c&&a<b&&b<d)for(d=g-1;0<=d;--d)c[d+b]=this[d+a];else if(1E3>g||!z.TYPED_ARRAY_SUPPORT)for(d=0;d<g;++d)c[d+b]=this[d+a];else Uint8Array.prototype.set.call(c,
this.subarray(a,a+g),b);return g};z.prototype.fill=function(c,b,a,d){if("string"===typeof c){"string"===typeof b?(d=b,b=0,a=this.length):"string"===typeof a&&(d=a,a=this.length);if(1===c.length){var g=c.charCodeAt(0);256>g&&(c=g)}if(void 0!==d&&"string"!==typeof d)throw new TypeError("encoding must be a string");if("string"===typeof d&&!z.isEncoding(d))throw new TypeError("Unknown encoding: "+d);}else"number"===typeof c&&(c&=255);if(0>b||this.length<b||this.length<a)throw new RangeError("Out of range index");
if(a<=b)return this;b>>>=0;a=void 0===a?this.length:a>>>0;c||(c=0);if("number"===typeof c)for(d=b;d<a;++d)this[d]=c;else for(c=Na(c)?c:Oc((new z(c,d)).toString()),g=c.length,d=0;d<a-b;++d)this[d+b]=c[d%g];return this};var Oh=/[^+\/0-9A-Za-z-_]/g,Li=Object.freeze({INSPECT_MAX_BYTES:50,kMaxLength:Ki,Buffer:z,SlowBuffer:function(c){+c!=c&&(c=0);return z.alloc(+c)},isBuffer:ud}),Ag=zg&&yg||zg,gd=ma(function(c){(function(){function b(a){a?(n[0]=n[16]=n[1]=n[2]=n[3]=n[4]=n[5]=n[6]=n[7]=n[8]=n[9]=n[10]=
n[11]=n[12]=n[13]=n[14]=n[15]=0,this.blocks=n,this.buffer8=r):e?(a=new ArrayBuffer(68),this.buffer8=new Uint8Array(a),this.blocks=new Uint32Array(a)):this.blocks=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];this.h0=this.h1=this.h2=this.h3=this.start=this.bytes=0;this.finalized=this.hashed=!1;this.first=!0}var a="object"===("undefined"===typeof window?"undefined":O(window))?window:{},d=!a.JS_MD5_NO_NODE_JS&&"object"===("undefined"===typeof $b?"undefined":O($b))&&$b.versions&&$b.versions.node;d&&(a=Hb);var g=
!a.JS_MD5_NO_COMMON_JS&&!0&&c.exports,e=!a.JS_MD5_NO_ARRAY_BUFFER&&"undefined"!==typeof ArrayBuffer,f="0123456789abcdef".split(""),k=[128,32768,8388608,-2147483648],l=[0,8,16,24],m=["hex","array","digest","buffer","arrayBuffer"],n=[],r;if(e){var u=new ArrayBuffer(68);r=new Uint8Array(u);n=new Uint32Array(u)}var p=function(a){return function(d){return(new b(!0)).update(d)[a]()}},t=function(a){var d=Li.Buffer;return function(b){if("string"===typeof b)return Ag.createHash("md5").update(b,"utf8").digest("hex");
if(b.constructor===ArrayBuffer)b=new Uint8Array(b);else if(void 0===b.length)return a(b);return Ag.createHash("md5").update(new d(b)).digest("hex")}};b.prototype.update=function(d){if(!this.finalized){var b="string"!=typeof d;b&&d.constructor==a.ArrayBuffer&&(d=new Uint8Array(d));for(var c,g=0,f,k=d.length||0,p=this.blocks,m=this.buffer8;g<k;){this.hashed&&(this.hashed=!1,p[0]=p[16],p[16]=p[1]=p[2]=p[3]=p[4]=p[5]=p[6]=p[7]=p[8]=p[9]=p[10]=p[11]=p[12]=p[13]=p[14]=p[15]=0);if(b)if(e)for(f=this.start;g<
k&&64>f;++g)m[f++]=d[g];else for(f=this.start;g<k&&64>f;++g)p[f>>2]|=d[g]<<l[f++&3];else if(e)for(f=this.start;g<k&&64>f;++g)c=d.charCodeAt(g),128>c?m[f++]=c:(2048>c?m[f++]=192|c>>6:(55296>c||57344<=c?m[f++]=224|c>>12:(c=65536+((c&1023)<<10|d.charCodeAt(++g)&1023),m[f++]=240|c>>18,m[f++]=128|c>>12&63),m[f++]=128|c>>6&63),m[f++]=128|c&63);else for(f=this.start;g<k&&64>f;++g)c=d.charCodeAt(g),128>c?p[f>>2]|=c<<l[f++&3]:(2048>c?p[f>>2]|=(192|c>>6)<<l[f++&3]:(55296>c||57344<=c?p[f>>2]|=(224|c>>12)<<l[f++&
3]:(c=65536+((c&1023)<<10|d.charCodeAt(++g)&1023),p[f>>2]|=(240|c>>18)<<l[f++&3],p[f>>2]|=(128|c>>12&63)<<l[f++&3]),p[f>>2]|=(128|c>>6&63)<<l[f++&3]),p[f>>2]|=(128|c&63)<<l[f++&3]);this.lastByteIndex=f;this.bytes+=f-this.start;64<=f?(this.start=f-64,this.hash(),this.hashed=!0):this.start=f}return this}};b.prototype.finalize=function(){if(!this.finalized){this.finalized=!0;var a=this.blocks,d=this.lastByteIndex;a[d>>2]|=k[d&3];56<=d&&(this.hashed||this.hash(),a[0]=a[16],a[16]=a[1]=a[2]=a[3]=a[4]=a[5]=
a[6]=a[7]=a[8]=a[9]=a[10]=a[11]=a[12]=a[13]=a[14]=a[15]=0);a[14]=this.bytes<<3;this.hash()}};b.prototype.hash=function(){var a,d,b,c,g,e=this.blocks;this.first?(a=e[0]-680876937,a=(a<<7|a>>>25)-271733879<<0,c=(-1732584194^a&2004318071)+e[1]-117830708,c=(c<<12|c>>>20)+a<<0,b=(-271733879^c&(a^-271733879))+e[2]-1126478375,b=(b<<17|b>>>15)+c<<0,d=(a^b&(c^a))+e[3]-1316259209):(a=this.h0,d=this.h1,b=this.h2,c=this.h3,a+=(c^d&(b^c))+e[0]-680876936,a=(a<<7|a>>>25)+d<<0,c+=(b^a&(d^b))+e[1]-389564586,c=(c<<
12|c>>>20)+a<<0,b+=(d^c&(a^d))+e[2]+606105819,b=(b<<17|b>>>15)+c<<0,d+=(a^b&(c^a))+e[3]-1044525330);d=(d<<22|d>>>10)+b<<0;a+=(c^d&(b^c))+e[4]-176418897;a=(a<<7|a>>>25)+d<<0;c+=(b^a&(d^b))+e[5]+1200080426;c=(c<<12|c>>>20)+a<<0;b+=(d^c&(a^d))+e[6]-1473231341;b=(b<<17|b>>>15)+c<<0;d+=(a^b&(c^a))+e[7]-45705983;d=(d<<22|d>>>10)+b<<0;a+=(c^d&(b^c))+e[8]+1770035416;a=(a<<7|a>>>25)+d<<0;c+=(b^a&(d^b))+e[9]-1958414417;c=(c<<12|c>>>20)+a<<0;b+=(d^c&(a^d))+e[10]-42063;b=(b<<17|b>>>15)+c<<0;d+=(a^b&(c^a))+e[11]-
1990404162;d=(d<<22|d>>>10)+b<<0;a+=(c^d&(b^c))+e[12]+1804603682;a=(a<<7|a>>>25)+d<<0;c+=(b^a&(d^b))+e[13]-40341101;c=(c<<12|c>>>20)+a<<0;b+=(d^c&(a^d))+e[14]-1502002290;b=(b<<17|b>>>15)+c<<0;d+=(a^b&(c^a))+e[15]+1236535329;d=(d<<22|d>>>10)+b<<0;a+=(b^c&(d^b))+e[1]-165796510;a=(a<<5|a>>>27)+d<<0;c+=(d^b&(a^d))+e[6]-1069501632;c=(c<<9|c>>>23)+a<<0;b+=(a^d&(c^a))+e[11]+643717713;b=(b<<14|b>>>18)+c<<0;d+=(c^a&(b^c))+e[0]-373897302;d=(d<<20|d>>>12)+b<<0;a+=(b^c&(d^b))+e[5]-701558691;a=(a<<5|a>>>27)+d<<
0;c+=(d^b&(a^d))+e[10]+38016083;c=(c<<9|c>>>23)+a<<0;b+=(a^d&(c^a))+e[15]-660478335;b=(b<<14|b>>>18)+c<<0;d+=(c^a&(b^c))+e[4]-405537848;d=(d<<20|d>>>12)+b<<0;a+=(b^c&(d^b))+e[9]+568446438;a=(a<<5|a>>>27)+d<<0;c+=(d^b&(a^d))+e[14]-1019803690;c=(c<<9|c>>>23)+a<<0;b+=(a^d&(c^a))+e[3]-187363961;b=(b<<14|b>>>18)+c<<0;d+=(c^a&(b^c))+e[8]+1163531501;d=(d<<20|d>>>12)+b<<0;a+=(b^c&(d^b))+e[13]-1444681467;a=(a<<5|a>>>27)+d<<0;c+=(d^b&(a^d))+e[2]-51403784;c=(c<<9|c>>>23)+a<<0;b+=(a^d&(c^a))+e[7]+1735328473;
b=(b<<14|b>>>18)+c<<0;d+=(c^a&(b^c))+e[12]-1926607734;d=(d<<20|d>>>12)+b<<0;g=d^b;a+=(g^c)+e[5]-378558;a=(a<<4|a>>>28)+d<<0;c+=(g^a)+e[8]-2022574463;c=(c<<11|c>>>21)+a<<0;g=c^a;b+=(g^d)+e[11]+1839030562;b=(b<<16|b>>>16)+c<<0;d+=(g^b)+e[14]-35309556;d=(d<<23|d>>>9)+b<<0;g=d^b;a+=(g^c)+e[1]-1530992060;a=(a<<4|a>>>28)+d<<0;c+=(g^a)+e[4]+1272893353;c=(c<<11|c>>>21)+a<<0;g=c^a;b+=(g^d)+e[7]-155497632;b=(b<<16|b>>>16)+c<<0;d+=(g^b)+e[10]-1094730640;d=(d<<23|d>>>9)+b<<0;g=d^b;a+=(g^c)+e[13]+681279174;a=
(a<<4|a>>>28)+d<<0;c+=(g^a)+e[0]-358537222;c=(c<<11|c>>>21)+a<<0;g=c^a;b+=(g^d)+e[3]-722521979;b=(b<<16|b>>>16)+c<<0;d+=(g^b)+e[6]+76029189;d=(d<<23|d>>>9)+b<<0;g=d^b;a+=(g^c)+e[9]-640364487;a=(a<<4|a>>>28)+d<<0;c+=(g^a)+e[12]-421815835;c=(c<<11|c>>>21)+a<<0;g=c^a;b+=(g^d)+e[15]+530742520;b=(b<<16|b>>>16)+c<<0;d+=(g^b)+e[2]-995338651;d=(d<<23|d>>>9)+b<<0;a+=(b^(d|~c))+e[0]-198630844;a=(a<<6|a>>>26)+d<<0;c+=(d^(a|~b))+e[7]+1126891415;c=(c<<10|c>>>22)+a<<0;b+=(a^(c|~d))+e[14]-1416354905;b=(b<<15|b>>>
17)+c<<0;d+=(c^(b|~a))+e[5]-57434055;d=(d<<21|d>>>11)+b<<0;a+=(b^(d|~c))+e[12]+1700485571;a=(a<<6|a>>>26)+d<<0;c+=(d^(a|~b))+e[3]-1894986606;c=(c<<10|c>>>22)+a<<0;b+=(a^(c|~d))+e[10]-1051523;b=(b<<15|b>>>17)+c<<0;d+=(c^(b|~a))+e[1]-2054922799;d=(d<<21|d>>>11)+b<<0;a+=(b^(d|~c))+e[8]+1873313359;a=(a<<6|a>>>26)+d<<0;c+=(d^(a|~b))+e[15]-30611744;c=(c<<10|c>>>22)+a<<0;b+=(a^(c|~d))+e[6]-1560198380;b=(b<<15|b>>>17)+c<<0;d+=(c^(b|~a))+e[13]+1309151649;d=(d<<21|d>>>11)+b<<0;a+=(b^(d|~c))+e[4]-145523070;
a=(a<<6|a>>>26)+d<<0;c+=(d^(a|~b))+e[11]-1120210379;c=(c<<10|c>>>22)+a<<0;b+=(a^(c|~d))+e[2]+718787259;b=(b<<15|b>>>17)+c<<0;d+=(c^(b|~a))+e[9]-343485551;d=(d<<21|d>>>11)+b<<0;this.first?(this.h0=a+1732584193<<0,this.h1=d-271733879<<0,this.h2=b-1732584194<<0,this.h3=c+271733878<<0,this.first=!1):(this.h0=this.h0+a<<0,this.h1=this.h1+d<<0,this.h2=this.h2+b<<0,this.h3=this.h3+c<<0)};b.prototype.hex=function(){this.finalize();var a=this.h0,d=this.h1,b=this.h2,c=this.h3;return f[a>>4&15]+f[a&15]+f[a>>
12&15]+f[a>>8&15]+f[a>>20&15]+f[a>>16&15]+f[a>>28&15]+f[a>>24&15]+f[d>>4&15]+f[d&15]+f[d>>12&15]+f[d>>8&15]+f[d>>20&15]+f[d>>16&15]+f[d>>28&15]+f[d>>24&15]+f[b>>4&15]+f[b&15]+f[b>>12&15]+f[b>>8&15]+f[b>>20&15]+f[b>>16&15]+f[b>>28&15]+f[b>>24&15]+f[c>>4&15]+f[c&15]+f[c>>12&15]+f[c>>8&15]+f[c>>20&15]+f[c>>16&15]+f[c>>28&15]+f[c>>24&15]};b.prototype.toString=b.prototype.hex;b.prototype.digest=function(){this.finalize();var a=this.h0,d=this.h1,b=this.h2,c=this.h3;return[a&255,a>>8&255,a>>16&255,a>>24&
255,d&255,d>>8&255,d>>16&255,d>>24&255,b&255,b>>8&255,b>>16&255,b>>24&255,c&255,c>>8&255,c>>16&255,c>>24&255]};b.prototype.array=b.prototype.digest;b.prototype.arrayBuffer=function(){this.finalize();var a=new ArrayBuffer(16),d=new Uint32Array(a);d[0]=this.h0;d[1]=this.h1;d[2]=this.h2;d[3]=this.h3;return a};b.prototype.buffer=b.prototype.arrayBuffer;u=function(){var a=p("hex");d&&(a=t(a));a.create=function(){return new b};a.update=function(d){return a.create().update(d)};for(var c=0;c<m.length;++c){var e=
m[c];a[e]=p(e)}return a}();g?c.exports=u:a.md5=u})()}),U=ma(function(c,b){c="undefined"!==typeof Uint8Array&&"undefined"!==typeof Uint16Array&&"undefined"!==typeof Int32Array;b.assign=function(a){for(var d=Array.prototype.slice.call(arguments,1);d.length;){var b=d.shift();if(b){if("object"!==("undefined"===typeof b?"undefined":O(b)))throw new TypeError(b+"must be non-object");for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])}}return a};b.shrinkBuf=function(a,d){if(a.length===d)return a;if(a.subarray)return a.subarray(0,
d);a.length=d;return a};var a={arraySet:function(a,d,b,c,l){if(d.subarray&&a.subarray)a.set(d.subarray(b,b+c),l);else for(var e=0;e<c;e++)a[l+e]=d[b+e]},flattenChunks:function(a){var d,b,c,g,m;d=c=0;for(b=a.length;d<b;d++)c+=a[d].length;m=new Uint8Array(c);d=c=0;for(b=a.length;d<b;d++)g=a[d],m.set(g,c),c+=g.length;return m}},d={arraySet:function(a,d,b,c,l){for(var e=0;e<c;e++)a[l+e]=d[b+e]},flattenChunks:function(a){return[].concat.apply([],a)}};b.setTyped=function(c){c?(b.Buf8=Uint8Array,b.Buf16=
Uint16Array,b.Buf32=Int32Array,b.assign(b,a)):(b.Buf8=Array,b.Buf16=Array,b.Buf32=Array,b.assign(b,d))};b.setTyped(c)}),yd=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],Rc=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],Mi=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],Bg=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],ab=Array(576);Lb(ab);var Dc=Array(60);Lb(Dc);var vb=Array(512);Lb(vb);var gc=Array(256);Lb(gc);var zd=Array(29);Lb(zd);var Sc=Array(30);Lb(Sc);var Cg,
Dg,Eg,Fg=!1,Ga={_tr_init:function(c){if(!Fg){var b,a,d,g=Array(16);for(d=a=0;28>d;d++)for(zd[d]=a,b=0;b<1<<yd[d];b++)gc[a++]=d;gc[a-1]=d;for(d=a=0;16>d;d++)for(Sc[d]=a,b=0;b<1<<Rc[d];b++)vb[a++]=d;for(a>>=7;30>d;d++)for(Sc[d]=a<<7,b=0;b<1<<Rc[d]-7;b++)vb[256+a++]=d;for(b=0;15>=b;b++)g[b]=0;for(b=0;143>=b;)ab[2*b+1]=8,b++,g[8]++;for(;255>=b;)ab[2*b+1]=9,b++,g[9]++;for(;279>=b;)ab[2*b+1]=7,b++,g[7]++;for(;287>=b;)ab[2*b+1]=8,b++,g[8]++;Ne(ab,287,g);for(b=0;30>b;b++)Dc[2*b+1]=5,Dc[2*b]=Me(b,5);Cg=new vd(ab,
yd,257,286,15);Dg=new vd(Dc,Rc,0,30,15);Eg=new vd([],Mi,0,19,7);Fg=!0}c.l_desc=new wd(c.dyn_ltree,Cg);c.d_desc=new wd(c.dyn_dtree,Dg);c.bl_desc=new wd(c.bl_tree,Eg);c.bi_buf=0;c.bi_valid=0;Oe(c)},_tr_stored_block:Ue,_tr_flush_block:function(c,b,a,d){var g,e,f=0;if(0<c.level){2===c.strm.data_type&&(c.strm.data_type=Qh(c));Ad(c,c.l_desc);Ad(c,c.d_desc);Se(c,c.dyn_ltree,c.l_desc.max_code);Se(c,c.dyn_dtree,c.d_desc.max_code);Ad(c,c.bl_desc);for(f=18;3<=f&&0===c.bl_tree[2*Bg[f]+1];f--);c.opt_len+=3*(f+
1)+14;g=c.opt_len+3+7>>>3;e=c.static_len+3+7>>>3;e<=g&&(g=e)}else g=e=a+5;if(a+4<=g&&-1!==b)Ue(c,b,a,d);else if(4===c.strategy||e===g)wa(c,2+(d?1:0),3),Re(c,ab,Dc);else{wa(c,4+(d?1:0),3);b=c.l_desc.max_code+1;a=c.d_desc.max_code+1;f+=1;wa(c,b-257,5);wa(c,a-1,5);wa(c,f-4,4);for(g=0;g<f;g++)wa(c,c.bl_tree[2*Bg[g]+1],3);Te(c,c.dyn_ltree,b-1);Te(c,c.dyn_dtree,a-1);Re(c,c.dyn_ltree,c.dyn_dtree)}Oe(c);d&&Pe(c)},_tr_tally:function(c,b,a){c.pending_buf[c.d_buf+2*c.last_lit]=b>>>8&255;c.pending_buf[c.d_buf+
2*c.last_lit+1]=b&255;c.pending_buf[c.l_buf+c.last_lit]=a&255;c.last_lit++;0===b?c.dyn_ltree[2*a]++:(c.matches++,b--,c.dyn_ltree[2*(gc[a]+256+1)]++,c.dyn_dtree[2*(256>b?vb[b]:vb[256+(b>>>7)])]++);return c.last_lit===c.lit_bufsize-1},_tr_align:function(c){wa(c,2,3);Oa(c,256,ab);16===c.bi_valid?(fc(c,c.bi_buf),c.bi_buf=0,c.bi_valid=0):8<=c.bi_valid&&(c.pending_buf[c.pending++]=c.bi_buf&255,c.bi_buf>>=8,c.bi_valid-=8)}},ic=function(c,b,a,d){var g=c&65535|0;c=c>>>16&65535|0;for(var e;0!==a;){e=2E3<a?
2E3:a;a-=e;do g=g+b[d++]|0,c=c+g|0;while(--e);g%=65521;c%=65521}return g|c<<16|0},Ni=function(){for(var c,b=[],a=0;256>a;a++){c=a;for(var d=0;8>d;d++)c=c&1?3988292384^c>>>1:c>>>1;b[a]=c}return b}(),na=function(c,b,a,d){a=d+a;for(c^=-1;d<a;d++)c=c>>>8^Ni[(c^b[d])&255];return c^-1},Mb={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"},Ob;Ob=[new Pa(0,0,0,0,function(c,b){var a=65535;
for(a>c.pending_buf_size-5&&(a=c.pending_buf_size-5);;){if(1>=c.lookahead){wb(c);if(0===c.lookahead&&0===b)return 1;if(0===c.lookahead)break}c.strstart+=c.lookahead;c.lookahead=0;var d=c.block_start+a;if(0===c.strstart||c.strstart>=d)if(c.lookahead=c.strstart-d,c.strstart=d,oa(c,!1),0===c.strm.avail_out)return 1;if(c.strstart-c.block_start>=c.w_size-262&&(oa(c,!1),0===c.strm.avail_out))return 1}c.insert=0;if(4===b)return oa(c,!0),0===c.strm.avail_out?3:4;c.strstart>c.block_start&&oa(c,!1);return 1}),
new Pa(4,4,8,4,Bd),new Pa(4,5,16,8,Bd),new Pa(4,6,32,32,Bd),new Pa(4,4,16,16,Nb),new Pa(8,16,32,32,Nb),new Pa(8,16,128,128,Nb),new Pa(8,32,128,256,Nb),new Pa(32,128,258,1024,Nb),new Pa(32,258,258,4096,Nb)];var jc={deflateInit:function(c,b){return Ye(c,b,8,15,8,0)},deflateInit2:Ye,deflateReset:Xe,deflateResetKeep:We,deflateSetHeader:function(c,b){if(!c||!c.state||2!==c.state.wrap)return-2;c.state.gzhead=b;return 0},deflate:function(c,b){var a,d,g,e;if(!c||!c.state||5<b||0>b)return c?gb(c,-2):-2;d=
c.state;if(!c.output||!c.input&&0!==c.avail_in||666===d.status&&4!==b)return gb(c,0===c.avail_out?-5:-2);d.strm=c;a=d.last_flush;d.last_flush=b;42===d.status&&(2===d.wrap?(c.adler=0,ba(d,31),ba(d,139),ba(d,8),d.gzhead?(ba(d,(d.gzhead.text?1:0)+(d.gzhead.hcrc?2:0)+(d.gzhead.extra?4:0)+(d.gzhead.name?8:0)+(d.gzhead.comment?16:0)),ba(d,d.gzhead.time&255),ba(d,d.gzhead.time>>8&255),ba(d,d.gzhead.time>>16&255),ba(d,d.gzhead.time>>24&255),ba(d,9===d.level?2:2<=d.strategy||2>d.level?4:0),ba(d,d.gzhead.os&
255),d.gzhead.extra&&d.gzhead.extra.length&&(ba(d,d.gzhead.extra.length&255),ba(d,d.gzhead.extra.length>>8&255)),d.gzhead.hcrc&&(c.adler=na(c.adler,d.pending_buf,d.pending,0)),d.gzindex=0,d.status=69):(ba(d,0),ba(d,0),ba(d,0),ba(d,0),ba(d,0),ba(d,9===d.level?2:2<=d.strategy||2>d.level?4:0),ba(d,3),d.status=113)):(g=8+(d.w_bits-8<<4)<<8,g|=(2<=d.strategy||2>d.level?0:6>d.level?1:6===d.level?2:3)<<6,0!==d.strstart&&(g|=32),d.status=113,hc(d,g+(31-g%31)),0!==d.strstart&&(hc(d,c.adler>>>16),hc(d,c.adler&
65535)),c.adler=1));if(69===d.status)if(d.gzhead.extra){for(g=d.pending;d.gzindex<(d.gzhead.extra.length&65535)&&(d.pending!==d.pending_buf_size||(d.gzhead.hcrc&&d.pending>g&&(c.adler=na(c.adler,d.pending_buf,d.pending-g,g)),ib(c),g=d.pending,d.pending!==d.pending_buf_size));)ba(d,d.gzhead.extra[d.gzindex]&255),d.gzindex++;d.gzhead.hcrc&&d.pending>g&&(c.adler=na(c.adler,d.pending_buf,d.pending-g,g));d.gzindex===d.gzhead.extra.length&&(d.gzindex=0,d.status=73)}else d.status=73;if(73===d.status)if(d.gzhead.name){g=
d.pending;do{if(d.pending===d.pending_buf_size&&(d.gzhead.hcrc&&d.pending>g&&(c.adler=na(c.adler,d.pending_buf,d.pending-g,g)),ib(c),g=d.pending,d.pending===d.pending_buf_size)){e=1;break}e=d.gzindex<d.gzhead.name.length?d.gzhead.name.charCodeAt(d.gzindex++)&255:0;ba(d,e)}while(0!==e);d.gzhead.hcrc&&d.pending>g&&(c.adler=na(c.adler,d.pending_buf,d.pending-g,g));0===e&&(d.gzindex=0,d.status=91)}else d.status=91;if(91===d.status)if(d.gzhead.comment){g=d.pending;do{if(d.pending===d.pending_buf_size&&
(d.gzhead.hcrc&&d.pending>g&&(c.adler=na(c.adler,d.pending_buf,d.pending-g,g)),ib(c),g=d.pending,d.pending===d.pending_buf_size)){e=1;break}e=d.gzindex<d.gzhead.comment.length?d.gzhead.comment.charCodeAt(d.gzindex++)&255:0;ba(d,e)}while(0!==e);d.gzhead.hcrc&&d.pending>g&&(c.adler=na(c.adler,d.pending_buf,d.pending-g,g));0===e&&(d.status=103)}else d.status=103;103===d.status&&(d.gzhead.hcrc?(d.pending+2>d.pending_buf_size&&ib(c),d.pending+2<=d.pending_buf_size&&(ba(d,c.adler&255),ba(d,c.adler>>8&255),
c.adler=0,d.status=113)):d.status=113);if(0!==d.pending){if(ib(c),0===c.avail_out)return d.last_flush=-1,0}else if(0===c.avail_in&&(b<<1)-(4<b?9:0)<=(a<<1)-(4<a?9:0)&&4!==b)return gb(c,-5);if(666===d.status&&0!==c.avail_in)return gb(c,-5);if(0!==c.avail_in||0!==d.lookahead||0!==b&&666!==d.status){a=2===d.strategy?Sh(d,b):3===d.strategy?Rh(d,b):Ob[d.level].func(d,b);if(3===a||4===a)d.status=666;if(1===a||3===a)return 0===c.avail_out&&(d.last_flush=-1),0;if(2===a&&(1===b?Ga._tr_align(d):5!==b&&(Ga._tr_stored_block(d,
0,0,!1),3===b&&(hb(d.head),0===d.lookahead&&(d.strstart=0,d.block_start=0,d.insert=0))),ib(c),0===c.avail_out))return d.last_flush=-1,0}if(4!==b)return 0;if(0>=d.wrap)return 1;2===d.wrap?(ba(d,c.adler&255),ba(d,c.adler>>8&255),ba(d,c.adler>>16&255),ba(d,c.adler>>24&255),ba(d,c.total_in&255),ba(d,c.total_in>>8&255),ba(d,c.total_in>>16&255),ba(d,c.total_in>>24&255)):(hc(d,c.adler>>>16),hc(d,c.adler&65535));ib(c);0<d.wrap&&(d.wrap=-d.wrap);return 0!==d.pending?0:1},deflateEnd:function(c){var b;if(!c||
!c.state)return-2;b=c.state.status;if(42!==b&&69!==b&&73!==b&&91!==b&&103!==b&&113!==b&&666!==b)return gb(c,-2);c.state=null;return 113===b?gb(c,-3):0},deflateSetDictionary:function(c,b){var a=b.length,d,g,e,f,k;if(!c||!c.state)return-2;d=c.state;g=d.wrap;if(2===g||1===g&&42!==d.status||d.lookahead)return-2;1===g&&(c.adler=ic(c.adler,b,a,0));d.wrap=0;a>=d.w_size&&(0===g&&(hb(d.head),d.strstart=0,d.block_start=0,d.insert=0),e=new U.Buf8(d.w_size),U.arraySet(e,b,a-d.w_size,d.w_size,0),b=e,a=d.w_size);
e=c.avail_in;f=c.next_in;k=c.input;c.avail_in=a;c.next_in=0;c.input=b;for(wb(d);3<=d.lookahead;){b=d.strstart;a=d.lookahead-2;do d.ins_h=(d.ins_h<<d.hash_shift^d.window[b+3-1])&d.hash_mask,d.prev[b&d.w_mask]=d.head[d.ins_h],d.head[d.ins_h]=b,b++;while(--a);d.strstart=b;d.lookahead=2;wb(d)}d.strstart+=d.lookahead;d.block_start=d.strstart;d.insert=d.lookahead;d.lookahead=0;d.match_length=d.prev_length=2;d.match_available=0;c.next_in=f;c.input=k;c.avail_in=e;d.wrap=g;return 0},deflateInfo:"pako deflate (from Nodeca project)"},
af=!0,$e=!0;try{String.fromCharCode.apply(null,[0])}catch(c){af=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch(c){$e=!1}for(var Ec=new U.Buf8(256),qb=0;256>qb;qb++)Ec[qb]=252<=qb?6:248<=qb?5:240<=qb?4:224<=qb?3:192<=qb?2:1;Ec[254]=Ec[254]=1;var yb={string2buf:function(c){var b,a,d,g,e,f=c.length,k=0;for(g=0;g<f;g++)a=c.charCodeAt(g),55296===(a&64512)&&g+1<f&&(d=c.charCodeAt(g+1),56320===(d&64512)&&(a=65536+(a-55296<<10)+(d-56320),g++)),k+=128>a?1:2048>a?2:65536>a?3:4;b=new U.Buf8(k);
for(g=e=0;e<k;g++)a=c.charCodeAt(g),55296===(a&64512)&&g+1<f&&(d=c.charCodeAt(g+1),56320===(d&64512)&&(a=65536+(a-55296<<10)+(d-56320),g++)),128>a?b[e++]=a:(2048>a?b[e++]=192|a>>>6:(65536>a?b[e++]=224|a>>>12:(b[e++]=240|a>>>18,b[e++]=128|a>>>12&63),b[e++]=128|a>>>6&63),b[e++]=128|a&63);return b},buf2binstring:function(c){return Ze(c,c.length)},binstring2buf:function(c){for(var b=new U.Buf8(c.length),a=0,d=b.length;a<d;a++)b[a]=c.charCodeAt(a);return b},buf2string:function(c,b){var a,d,g,e=b||c.length,
f=Array(2*e);for(b=a=0;b<e;)if(d=c[b++],128>d)f[a++]=d;else if(g=Ec[d],4<g)f[a++]=65533,b+=g-1;else{for(d&=2===g?31:3===g?15:7;1<g&&b<e;)d=d<<6|c[b++]&63,g--;1<g?f[a++]=65533:65536>d?f[a++]=d:(d-=65536,f[a++]=55296|d>>10&1023,f[a++]=56320|d&1023)}return Ze(f,a)},utf8border:function(c,b){var a;b=b||c.length;b>c.length&&(b=c.length);for(a=b-1;0<=a&&128===(c[a]&192);)a--;return 0>a||0===a?b:a+Ec[c[a]]>b?a:b}},bf=function(){this.input=null;this.total_in=this.avail_in=this.next_in=0;this.output=null;this.total_out=
this.avail_out=this.next_out=0;this.msg="";this.state=null;this.data_type=2;this.adler=0},cf=Object.prototype.toString;xb.prototype.push=function(c,b){var a=this.strm,d=this.options.chunkSize;if(this.ended)return!1;b=b===~~b?b:!0===b?4:0;"string"===typeof c?a.input=yb.string2buf(c):"[object ArrayBuffer]"===cf.call(c)?a.input=new Uint8Array(c):a.input=c;a.next_in=0;a.avail_in=a.input.length;do{0===a.avail_out&&(a.output=new U.Buf8(d),a.next_out=0,a.avail_out=d);c=jc.deflate(a,b);if(1!==c&&0!==c)return this.onEnd(c),
this.ended=!0,!1;if(0===a.avail_out||0===a.avail_in&&(4===b||2===b))if("string"===this.options.to)this.onData(yb.buf2binstring(U.shrinkBuf(a.output,a.next_out)));else this.onData(U.shrinkBuf(a.output,a.next_out))}while((0<a.avail_in||0===a.avail_out)&&1!==c);if(4===b)return c=jc.deflateEnd(this.strm),this.onEnd(c),this.ended=!0,0===c;2===b&&(this.onEnd(0),a.avail_out=0);return!0};xb.prototype.onData=function(c){this.chunks.push(c)};xb.prototype.onEnd=function(c){0===c&&(this.result="string"===this.options.to?
this.chunks.join(""):U.flattenChunks(this.chunks));this.chunks=[];this.err=c;this.msg=this.strm.msg};var Oi={Deflate:xb,deflate:Cd,deflateRaw:function(c,b){b=b||{};b.raw=!0;return Cd(c,b)},gzip:function(c,b){b=b||{};b.gzip=!0;return Cd(c,b)}},Pi=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],Qi=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],Ri=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,
1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],Si=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64],Fc=function(c,b,a,d,g,e,f,k){var l=k.bits,m,n,r,u,p,t,y,w,x,v,A,q,C,T=0,G,K=new U.Buf16(16);p=new U.Buf16(16);var M,B=0,J,E,fa;for(m=0;15>=m;m++)K[m]=0;for(n=0;n<d;n++)K[b[a+n]]++;u=l;for(r=15;1<=r&&0===K[r];r--);u>r&&(u=r);if(0===r)return g[e++]=20971520,g[e++]=20971520,k.bits=1,0;for(l=1;l<r&&0===K[l];l++);u<l&&(u=l);for(m=t=1;15>=m;m++)if(t<<=
1,t-=K[m],0>t)return-1;if(0<t&&(0===c||1!==r))return-1;p[1]=0;for(m=1;15>m;m++)p[m+1]=p[m]+K[m];for(n=0;n<d;n++)0!==b[a+n]&&(f[p[b[a+n]]++]=n);0===c?(C=M=f,G=19):1===c?(C=Pi,T-=257,M=Qi,B-=257,G=256):(C=Ri,M=Si,G=-1);n=w=0;m=l;q=e;d=u;p=0;v=-1;y=1<<u;A=y-1;if(1===c&&852<y||2===c&&592<y)return 1;for(;;){J=m-p;f[n]<G?(E=0,fa=f[n]):f[n]>G?(E=M[B+f[n]],fa=C[T+f[n]]):(E=96,fa=0);t=1<<m-p;l=x=1<<d;do x-=t,g[q+(w>>p)+x]=J<<24|E<<16|fa|0;while(0!==x);for(t=1<<m-1;w&t;)t>>=1;0!==t?(w&=t-1,w+=t):w=0;n++;if(0===
--K[m]){if(m===r)break;m=b[a+f[n]]}if(m>u&&(w&A)!==v){0===p&&(p=u);q+=l;d=m-p;for(t=1<<d;d+p<r;){t-=K[d+p];if(0>=t)break;d++;t<<=1}y+=1<<d;if(1===c&&852<y||2===c&&592<y)return 1;v=w&A;g[v]=u<<24|d<<16|q-e|0}}0!==w&&(g[q+w]=m-p<<24|4194304);k.bits=u;return 0},Gg=!0,Zd,$d,kc={inflateReset:ff,inflateReset2:gf,inflateResetKeep:ef,inflateInit:function(c){return hf(c,15)},inflateInit2:hf,inflate:function(c,b){var a,d,g,e,f,k,l,m,n,r,u,p,t,y,w,x,v,A,q=new U.Buf8(4),C=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,
2,14,1,15];if(!c||!c.state||!c.output||!c.input&&0!==c.avail_in)return-2;a=c.state;12===a.mode&&(a.mode=13);f=c.next_out;g=c.output;l=c.avail_out;e=c.next_in;d=c.input;k=c.avail_in;m=a.hold;n=a.bits;r=k;u=l;A=0;a:for(;;)switch(a.mode){case 1:if(0===a.wrap){a.mode=13;break}for(;16>n;){if(0===k)break a;k--;m+=d[e++]<<n;n+=8}if(a.wrap&2&&35615===m){a.check=0;q[0]=m&255;q[1]=m>>>8&255;a.check=na(a.check,q,2,0);n=m=0;a.mode=2;break}a.flags=0;a.head&&(a.head.done=!1);if(!(a.wrap&1)||(((m&255)<<8)+(m>>8))%
31){c.msg="incorrect header check";a.mode=30;break}if(8!==(m&15)){c.msg="unknown compression method";a.mode=30;break}m>>>=4;n-=4;t=(m&15)+8;if(0===a.wbits)a.wbits=t;else if(t>a.wbits){c.msg="invalid window size";a.mode=30;break}a.dmax=1<<t;c.adler=a.check=1;a.mode=m&512?10:12;n=m=0;break;case 2:for(;16>n;){if(0===k)break a;k--;m+=d[e++]<<n;n+=8}a.flags=m;if(8!==(a.flags&255)){c.msg="unknown compression method";a.mode=30;break}if(a.flags&57344){c.msg="unknown header flags set";a.mode=30;break}a.head&&
(a.head.text=m>>8&1);a.flags&512&&(q[0]=m&255,q[1]=m>>>8&255,a.check=na(a.check,q,2,0));n=m=0;a.mode=3;case 3:for(;32>n;){if(0===k)break a;k--;m+=d[e++]<<n;n+=8}a.head&&(a.head.time=m);a.flags&512&&(q[0]=m&255,q[1]=m>>>8&255,q[2]=m>>>16&255,q[3]=m>>>24&255,a.check=na(a.check,q,4,0));n=m=0;a.mode=4;case 4:for(;16>n;){if(0===k)break a;k--;m+=d[e++]<<n;n+=8}a.head&&(a.head.xflags=m&255,a.head.os=m>>8);a.flags&512&&(q[0]=m&255,q[1]=m>>>8&255,a.check=na(a.check,q,2,0));n=m=0;a.mode=5;case 5:if(a.flags&
1024){for(;16>n;){if(0===k)break a;k--;m+=d[e++]<<n;n+=8}a.length=m;a.head&&(a.head.extra_len=m);a.flags&512&&(q[0]=m&255,q[1]=m>>>8&255,a.check=na(a.check,q,2,0));n=m=0}else a.head&&(a.head.extra=null);a.mode=6;case 6:if(a.flags&1024&&(p=a.length,p>k&&(p=k),p&&(a.head&&(t=a.head.extra_len-a.length,a.head.extra||(a.head.extra=Array(a.head.extra_len)),U.arraySet(a.head.extra,d,e,p,t)),a.flags&512&&(a.check=na(a.check,d,p,e)),k-=p,e+=p,a.length-=p),a.length))break a;a.length=0;a.mode=7;case 7:if(a.flags&
2048){if(0===k)break a;p=0;do t=d[e+p++],a.head&&t&&65536>a.length&&(a.head.name+=String.fromCharCode(t));while(t&&p<k);a.flags&512&&(a.check=na(a.check,d,p,e));k-=p;e+=p;if(t)break a}else a.head&&(a.head.name=null);a.length=0;a.mode=8;case 8:if(a.flags&4096){if(0===k)break a;p=0;do t=d[e+p++],a.head&&t&&65536>a.length&&(a.head.comment+=String.fromCharCode(t));while(t&&p<k);a.flags&512&&(a.check=na(a.check,d,p,e));k-=p;e+=p;if(t)break a}else a.head&&(a.head.comment=null);a.mode=9;case 9:if(a.flags&
512){for(;16>n;){if(0===k)break a;k--;m+=d[e++]<<n;n+=8}if(m!==(a.check&65535)){c.msg="header crc mismatch";a.mode=30;break}n=m=0}a.head&&(a.head.hcrc=a.flags>>9&1,a.head.done=!0);c.adler=a.check=0;a.mode=12;break;case 10:for(;32>n;){if(0===k)break a;k--;m+=d[e++]<<n;n+=8}c.adler=a.check=df(m);n=m=0;a.mode=11;case 11:if(0===a.havedict)return c.next_out=f,c.avail_out=l,c.next_in=e,c.avail_in=k,a.hold=m,a.bits=n,2;c.adler=a.check=1;a.mode=12;case 12:if(5===b||6===b)break a;case 13:if(a.last){m>>>=n&
7;n-=n&7;a.mode=27;break}for(;3>n;){if(0===k)break a;k--;m+=d[e++]<<n;n+=8}a.last=m&1;m>>>=1;--n;switch(m&3){case 0:a.mode=14;break;case 1:t=a;if(Gg){Zd=new U.Buf32(512);$d=new U.Buf32(32);for(p=0;144>p;)t.lens[p++]=8;for(;256>p;)t.lens[p++]=9;for(;280>p;)t.lens[p++]=7;for(;288>p;)t.lens[p++]=8;Fc(1,t.lens,0,288,Zd,0,t.work,{bits:9});for(p=0;32>p;)t.lens[p++]=5;Fc(2,t.lens,0,32,$d,0,t.work,{bits:5});Gg=!1}t.lencode=Zd;t.lenbits=9;t.distcode=$d;t.distbits=5;a.mode=20;if(6===b){m>>>=2;n-=2;break a}break;
case 2:a.mode=17;break;case 3:c.msg="invalid block type",a.mode=30}m>>>=2;n-=2;break;case 14:m>>>=n&7;for(n-=n&7;32>n;){if(0===k)break a;k--;m+=d[e++]<<n;n+=8}if((m&65535)!==(m>>>16^65535)){c.msg="invalid stored block lengths";a.mode=30;break}a.length=m&65535;n=m=0;a.mode=15;if(6===b)break a;case 15:a.mode=16;case 16:if(p=a.length){p>k&&(p=k);p>l&&(p=l);if(0===p)break a;U.arraySet(g,d,e,p,f);k-=p;e+=p;l-=p;f+=p;a.length-=p;break}a.mode=12;break;case 17:for(;14>n;){if(0===k)break a;k--;m+=d[e++]<<
n;n+=8}a.nlen=(m&31)+257;m>>>=5;n-=5;a.ndist=(m&31)+1;m>>>=5;n-=5;a.ncode=(m&15)+4;m>>>=4;n-=4;if(286<a.nlen||30<a.ndist){c.msg="too many length or distance symbols";a.mode=30;break}a.have=0;a.mode=18;case 18:for(;a.have<a.ncode;){for(;3>n;){if(0===k)break a;k--;m+=d[e++]<<n;n+=8}a.lens[C[a.have++]]=m&7;m>>>=3;n-=3}for(;19>a.have;)a.lens[C[a.have++]]=0;a.lencode=a.lendyn;a.lenbits=7;p={bits:a.lenbits};A=Fc(0,a.lens,0,19,a.lencode,0,a.work,p);a.lenbits=p.bits;if(A){c.msg="invalid code lengths set";
a.mode=30;break}a.have=0;a.mode=19;case 19:for(;a.have<a.nlen+a.ndist;){for(;;){w=a.lencode[m&(1<<a.lenbits)-1];p=w>>>24;w&=65535;if(p<=n)break;if(0===k)break a;k--;m+=d[e++]<<n;n+=8}if(16>w)m>>>=p,n-=p,a.lens[a.have++]=w;else{if(16===w){for(t=p+2;n<t;){if(0===k)break a;k--;m+=d[e++]<<n;n+=8}m>>>=p;n-=p;if(0===a.have){c.msg="invalid bit length repeat";a.mode=30;break}t=a.lens[a.have-1];p=3+(m&3);m>>>=2;n-=2}else if(17===w){for(t=p+3;n<t;){if(0===k)break a;k--;m+=d[e++]<<n;n+=8}m>>>=p;n-=p;t=0;p=3+
(m&7);m>>>=3;n-=3}else{for(t=p+7;n<t;){if(0===k)break a;k--;m+=d[e++]<<n;n+=8}m>>>=p;n-=p;t=0;p=11+(m&127);m>>>=7;n-=7}if(a.have+p>a.nlen+a.ndist){c.msg="invalid bit length repeat";a.mode=30;break}for(;p--;)a.lens[a.have++]=t}}if(30===a.mode)break;if(0===a.lens[256]){c.msg="invalid code -- missing end-of-block";a.mode=30;break}a.lenbits=9;p={bits:a.lenbits};A=Fc(1,a.lens,0,a.nlen,a.lencode,0,a.work,p);a.lenbits=p.bits;if(A){c.msg="invalid literal/lengths set";a.mode=30;break}a.distbits=6;a.distcode=
a.distdyn;p={bits:a.distbits};A=Fc(2,a.lens,a.nlen,a.ndist,a.distcode,0,a.work,p);a.distbits=p.bits;if(A){c.msg="invalid distances set";a.mode=30;break}a.mode=20;if(6===b)break a;case 20:a.mode=21;case 21:if(6<=k&&258<=l){c.next_out=f;c.avail_out=l;c.next_in=e;c.avail_in=k;a.hold=m;a.bits=n;var T,G,K,M,B,J,E,fa,D,z,H=c;z=H.state;D=H.next_in;g=H.input;fa=D+(H.avail_in-5);E=H.next_out;d=H.output;J=E-(u-H.avail_out);B=E+(H.avail_out-257);M=z.dmax;w=z.wsize;v=z.whave;x=z.wnext;y=z.window;t=z.hold;p=z.bits;
n=z.lencode;m=z.distcode;l=(1<<z.lenbits)-1;k=(1<<z.distbits)-1;b:do c:for(15>p&&(t+=g[D++]<<p,p+=8,t+=g[D++]<<p,p+=8),T=n[t&l];;){f=T>>>24;t>>>=f;p-=f;f=T>>>16&255;if(0===f)d[E++]=T&65535;else if(f&16){e=T&65535;if(f&=15)p<f&&(t+=g[D++]<<p,p+=8),e+=t&(1<<f)-1,t>>>=f,p-=f;15>p&&(t+=g[D++]<<p,p+=8,t+=g[D++]<<p,p+=8);T=m[t&k];d:for(;;){f=T>>>24;t>>>=f;p-=f;f=T>>>16&255;if(f&16){K=T&65535;f&=15;p<f&&(t+=g[D++]<<p,p+=8,p<f&&(t+=g[D++]<<p,p+=8));K+=t&(1<<f)-1;if(K>M){H.msg="invalid distance too far back";
z.mode=30;break b}t>>>=f;p-=f;f=E-J;if(K>f){f=K-f;if(f>v&&z.sane){H.msg="invalid distance too far back";z.mode=30;break b}G=0;T=y;if(0===x){if(G+=w-f,f<e){e-=f;do d[E++]=y[G++];while(--f);G=E-K;T=d}}else if(x<f){if(G+=w+x-f,f-=x,f<e){e-=f;do d[E++]=y[G++];while(--f);G=0;if(x<e){f=x;e-=f;do d[E++]=y[G++];while(--f);G=E-K;T=d}}}else if(G+=x-f,f<e){e-=f;do d[E++]=y[G++];while(--f);G=E-K;T=d}for(;2<e;)d[E++]=T[G++],d[E++]=T[G++],d[E++]=T[G++],e-=3;e&&(d[E++]=T[G++],1<e&&(d[E++]=T[G++]))}else{G=E-K;do d[E++]=
d[G++],d[E++]=d[G++],d[E++]=d[G++],e-=3;while(2<e);e&&(d[E++]=d[G++],1<e&&(d[E++]=d[G++]))}}else if(0===(f&64)){T=m[(T&65535)+(t&(1<<f)-1)];continue d}else{H.msg="invalid distance code";z.mode=30;break b}break}}else if(0===(f&64)){T=n[(T&65535)+(t&(1<<f)-1)];continue c}else{f&32?z.mode=12:(H.msg="invalid literal/length code",z.mode=30);break b}break}while(D<fa&&E<B);e=p>>3;D-=e;p-=e<<3;H.next_in=D;H.next_out=E;H.avail_in=D<fa?5+(fa-D):5-(D-fa);H.avail_out=E<B?257+(B-E):257-(E-B);z.hold=t&(1<<p)-1;
z.bits=p;f=c.next_out;g=c.output;l=c.avail_out;e=c.next_in;d=c.input;k=c.avail_in;m=a.hold;n=a.bits;12===a.mode&&(a.back=-1);break}for(a.back=0;;){w=a.lencode[m&(1<<a.lenbits)-1];p=w>>>24;t=w>>>16&255;w&=65535;if(p<=n)break;if(0===k)break a;k--;m+=d[e++]<<n;n+=8}if(t&&0===(t&240)){y=p;x=t;for(v=w;;){w=a.lencode[v+((m&(1<<y+x)-1)>>y)];p=w>>>24;t=w>>>16&255;w&=65535;if(y+p<=n)break;if(0===k)break a;k--;m+=d[e++]<<n;n+=8}m>>>=y;n-=y;a.back+=y}m>>>=p;n-=p;a.back+=p;a.length=w;if(0===t){a.mode=26;break}if(t&
32){a.back=-1;a.mode=12;break}if(t&64){c.msg="invalid literal/length code";a.mode=30;break}a.extra=t&15;a.mode=22;case 22:if(a.extra){for(t=a.extra;n<t;){if(0===k)break a;k--;m+=d[e++]<<n;n+=8}a.length+=m&(1<<a.extra)-1;m>>>=a.extra;n-=a.extra;a.back+=a.extra}a.was=a.length;a.mode=23;case 23:for(;;){w=a.distcode[m&(1<<a.distbits)-1];p=w>>>24;t=w>>>16&255;w&=65535;if(p<=n)break;if(0===k)break a;k--;m+=d[e++]<<n;n+=8}if(0===(t&240)){y=p;x=t;for(v=w;;){w=a.distcode[v+((m&(1<<y+x)-1)>>y)];p=w>>>24;t=
w>>>16&255;w&=65535;if(y+p<=n)break;if(0===k)break a;k--;m+=d[e++]<<n;n+=8}m>>>=y;n-=y;a.back+=y}m>>>=p;n-=p;a.back+=p;if(t&64){c.msg="invalid distance code";a.mode=30;break}a.offset=w;a.extra=t&15;a.mode=24;case 24:if(a.extra){for(t=a.extra;n<t;){if(0===k)break a;k--;m+=d[e++]<<n;n+=8}a.offset+=m&(1<<a.extra)-1;m>>>=a.extra;n-=a.extra;a.back+=a.extra}if(a.offset>a.dmax){c.msg="invalid distance too far back";a.mode=30;break}a.mode=25;case 25:if(0===l)break a;p=u-l;if(a.offset>p){p=a.offset-p;if(p>
a.whave&&a.sane){c.msg="invalid distance too far back";a.mode=30;break}p>a.wnext?(p-=a.wnext,t=a.wsize-p):t=a.wnext-p;p>a.length&&(p=a.length);y=a.window}else y=g,t=f-a.offset,p=a.length;p>l&&(p=l);l-=p;a.length-=p;do g[f++]=y[t++];while(--p);0===a.length&&(a.mode=21);break;case 26:if(0===l)break a;g[f++]=a.length;l--;a.mode=21;break;case 27:if(a.wrap){for(;32>n;){if(0===k)break a;k--;m|=d[e++]<<n;n+=8}u-=l;c.total_out+=u;a.total+=u;u&&(c.adler=a.check=a.flags?na(a.check,g,u,f-u):ic(a.check,g,u,f-
u));u=l;if((a.flags?m:df(m))!==a.check){c.msg="incorrect data check";a.mode=30;break}n=m=0}a.mode=28;case 28:if(a.wrap&&a.flags){for(;32>n;){if(0===k)break a;k--;m+=d[e++]<<n;n+=8}if(m!==(a.total&4294967295)){c.msg="incorrect length check";a.mode=30;break}n=m=0}a.mode=29;case 29:A=1;break a;case 30:A=-3;break a;case 31:return-4;default:return-2}c.next_out=f;c.avail_out=l;c.next_in=e;c.avail_in=k;a.hold=m;a.bits=n;if((a.wsize||u!==c.avail_out&&30>a.mode&&(27>a.mode||4!==b))&&jf(c,c.output,c.next_out,
u-c.avail_out))return a.mode=31,-4;r-=c.avail_in;u-=c.avail_out;c.total_in+=r;c.total_out+=u;a.total+=u;a.wrap&&u&&(c.adler=a.check=a.flags?na(a.check,g,u,c.next_out-u):ic(a.check,g,u,c.next_out-u));c.data_type=a.bits+(a.last?64:0)+(12===a.mode?128:0)+(20===a.mode||15===a.mode?256:0);(0===r&&0===u||4===b)&&0===A&&(A=-5);return A},inflateEnd:function(c){if(!c||!c.state)return-2;var b=c.state;b.window&&(b.window=null);c.state=null;return 0},inflateGetHeader:function(c,b){if(!c||!c.state)return-2;c=
c.state;if(0===(c.wrap&2))return-2;c.head=b;b.done=!1;return 0},inflateSetDictionary:function(c,b){var a=b.length,d,g;if(!c||!c.state)return-2;d=c.state;if(0!==d.wrap&&11!==d.mode)return-2;if(11===d.mode&&(g=ic(1,b,a,0),g!==d.check))return-3;if(jf(c,b,a,a))return d.mode=31,-4;d.havedict=1;return 0},inflateInfo:"pako inflate (from Nodeca project)"},ha={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,
Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8},Vh=function(){this.os=this.xflags=this.time=this.text=0;this.extra=null;this.extra_len=0;this.comment=this.name="";this.hcrc=0;this.done=!1},Hg=Object.prototype.toString;zb.prototype.push=function(c,b){var a=this.strm,d=this.options.chunkSize,g=this.options.dictionary,e,f,k,
l=!1;if(this.ended)return!1;b=b===~~b?b:!0===b?ha.Z_FINISH:ha.Z_NO_FLUSH;"string"===typeof c?a.input=yb.binstring2buf(c):"[object ArrayBuffer]"===Hg.call(c)?a.input=new Uint8Array(c):a.input=c;a.next_in=0;a.avail_in=a.input.length;do{0===a.avail_out&&(a.output=new U.Buf8(d),a.next_out=0,a.avail_out=d);c=kc.inflate(a,ha.Z_NO_FLUSH);c===ha.Z_NEED_DICT&&g&&(c="string"===typeof g?yb.string2buf(g):"[object ArrayBuffer]"===Hg.call(g)?new Uint8Array(g):g,c=kc.inflateSetDictionary(this.strm,c));c===ha.Z_BUF_ERROR&&
!0===l&&(c=ha.Z_OK,l=!1);if(c!==ha.Z_STREAM_END&&c!==ha.Z_OK)return this.onEnd(c),this.ended=!0,!1;if(a.next_out&&(0===a.avail_out||c===ha.Z_STREAM_END||0===a.avail_in&&(b===ha.Z_FINISH||b===ha.Z_SYNC_FLUSH)))if("string"===this.options.to)e=yb.utf8border(a.output,a.next_out),f=a.next_out-e,k=yb.buf2string(a.output,e),a.next_out=f,a.avail_out=d-f,f&&U.arraySet(a.output,a.output,e,f,0),this.onData(k);else this.onData(U.shrinkBuf(a.output,a.next_out));0===a.avail_in&&0===a.avail_out&&(l=!0)}while((0<
a.avail_in||0===a.avail_out)&&c!==ha.Z_STREAM_END);c===ha.Z_STREAM_END&&(b=ha.Z_FINISH);if(b===ha.Z_FINISH)return c=kc.inflateEnd(this.strm),this.onEnd(c),this.ended=!0,c===ha.Z_OK;b===ha.Z_SYNC_FLUSH&&(this.onEnd(ha.Z_OK),a.avail_out=0);return!0};zb.prototype.onData=function(c){this.chunks.push(c)};zb.prototype.onEnd=function(c){c===ha.Z_OK&&(this.result="string"===this.options.to?this.chunks.join(""):U.flattenChunks(this.chunks));this.chunks=[];this.err=c;this.msg=this.strm.msg};var Ig={Inflate:zb,
inflate:Dd,inflateRaw:function(c,b){b=b||{};b.raw=!0;return Dd(c,b)},ungzip:Dd},Ti=U.assign,Ca={};Ti(Ca,Oi,Ig,ha);var Ui=function(c){function b(){I(this,b);var a=P(this,(b.__proto__||Object.getPrototypeOf(b)).call(this));a._outputCounter=0;a.setMetadata("filenames",{});a.setMetadata("checksums",{});a.setMetadata("readAsText",!1);return a}L(b,c);N(b,[{key:"_run",value:function(){var a=this;this._outputCounter=0;this.getInputCategories().forEach(function(d){a._loadFile(d)})}},{key:"_loadFile",value:function(a){var d=
this,b=new FileReader,c=this.getMetadata("readAsText"),f=function(c){d.addTimeRecord("startRead");c=c.target.result;if(Jb.isValidString(c)){var e=d._getInput(a).name.split(/[\\/]/).pop();e.split(".").pop();var g=gd(c);d._metadata.filenames[a]=e;d._metadata.checksums[a]=g;d.addTimeRecord("endRead");e=d.getTime("startRead","endRead");console.log("Reading file took "+e+"ms.");d._output[a]=c;d._fileLoadCount()}else b.onloadend=k,b.readAsArrayBuffer(d._getInput(a))},k=function(b){d.addTimeRecord("startRead");
b=b.target.result;var e=d._getInput(a).name.split(/[\\/]/).pop(),g=e.split(".").pop(),f=gd(b);d._metadata.filenames[a]=e;d._metadata.checksums[a]=f;if(g.localeCompare("pixp"))try{b=Ca.inflate(b).buffer,console.log("File was un-gziped successfully")}catch(u){console.log("Pako: not a gziped file ("+u+")")}if(c&&(b=Jb.arrayBufferToUnicode(b),!b)){console.warn("The content of this file is not a valid text. It could be read as a binary file if the metadata 'readAsText' is set to false.");return}d.addTimeRecord("endRead");
e=d.getTime("startRead","endRead");console.log("Reading file took "+e+"ms.");d._output[a]=b;d._fileLoadCount()};b.onerror=function(a){console.warn("ERROR");console.warn(a)};c?(b.onloadend=f,b.readAsText(this._getInput(a))):(b.onloadend=k,b.readAsArrayBuffer(this._getInput(a)))}},{key:"_fileLoadCount",value:function(){this._outputCounter++;this._outputCounter==this.getNumberOfInputs()&&this.triggerEvent("ready")}}]);return b}(W),Vi=function(c){function b(){I(this,b);var a=P(this,(b.__proto__||Object.getPrototypeOf(b)).call(this));
a._outputCounter=0;a.setMetadata("filenames",{});a.setMetadata("checksums",{});a.setMetadata("readAsText",!1);return a}L(b,c);N(b,[{key:"_run",value:function(){var a=this;this.getNumberOfInputs()?this._forEachInput(function(d,b){a._loadUrl(d,b)}):console.warn("No input was specified, cannot run this filer.")}},{key:"_loadUrl",value:function(a,d){var b=this,c=this.getMetadata("readAsText"),f=new XMLHttpRequest;f.open("GET",d,!0);var k=function(e){e=e.target.response;var g=d.split(/[\\/]/).pop(),f=
g.split(".").pop(),k=gd(e);b._metadata.filenames[a]=g;b._metadata.checksums[a]=k;if(f.localeCompare("pixp"))try{e=Ca.inflate(e).buffer,console.log("File was un-gziped successfully")}catch(p){console.log("Pako: not a gziped file ("+p+")")}if(c&&(e=Jb.arrayBufferToUnicode(e),!e||!Jb.isValidString(e))){console.warn("The content of this file is not a valid text. It could be read as a binary file if the metadata 'readAsText' is set to false.");return}b._output[a]=e;b._outputCounter++;b._outputCounter==
b.getNumberOfInputs()&&b.triggerEvent("ready")},l=function(c){console.log("ooooooooo");var e=c.target.response,g=d.split(/[\\/]/).pop();g.split(".").pop();var f=gd(e);b._metadata.filenames[a]=g;b._metadata.checksums[a]=f;Jb.isValidString(e)?(b._output[a]=e,b._outputCounter++,b._outputCounter==b.getNumberOfInputs()&&b.triggerEvent("ready")):(c.target.abort(),c=new XMLHttpRequest,c.open("GET",d,!0),c.responseType="arraybuffer",c.onload=k,c.send())};f.error=function(){console.log("here go the error")};
c?(f.responseType="text",f.onload=l):(f.responseType="arraybuffer",f.onload=k);f.send()}}]);return b}(W),Jg=ma(function(c){var b=b||function(a){if(!("undefined"===typeof a||"undefined"!==typeof navigator&&/MSIE [1-9]\./.test(navigator.userAgent))){var d=a.document.createElementNS("http://www.w3.org/1999/xhtml","a"),b="download"in d,c=/constructor/i.test(a.HTMLElement)||a.safari,f=/CriOS\/[\d]+/.test(navigator.userAgent),k=function(d){(a.setImmediate||a.setTimeout)(function(){throw d;},0)},l=function(d){setTimeout(function(){"string"===
typeof d?(a.URL||a.webkitURL||a).revokeObjectURL(d):d.remove()},4E4)},m=function(a){return/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(a.type)?new Blob([String.fromCharCode(65279),a],{type:a.type}):a},n=function(e,g,n){n||(e=m(e));var p=this,r="application/octet-stream"===e.type,u,t=function(){for(var a=["writestart","progress","write","writeend"],a=[].concat(a),d=a.length;d--;){var b=p["on"+a[d]];if("function"===typeof b)try{b.call(p,p)}catch(T){k(T)}}};p.readyState=
p.INIT;b?(u=(a.URL||a.webkitURL||a).createObjectURL(e),setTimeout(function(){d.href=u;d.download=g;var a=new MouseEvent("click");d.dispatchEvent(a);t();l(u);p.readyState=p.DONE})):function(){if((f||r&&c)&&a.FileReader){var d=new FileReader;d.onloadend=function(){var b=f?d.result:d.result.replace(/^data:[^;]*;/,"data:attachment/file;");a.open(b,"_blank")||(a.location.href=b);p.readyState=p.DONE;t()};d.readAsDataURL(e);p.readyState=p.INIT}else u||(u=(a.URL||a.webkitURL||a).createObjectURL(e)),r?a.location.href=
u:a.open(u,"_blank")||(a.location.href=u),p.readyState=p.DONE,t(),l(u)}()},r=n.prototype;if("undefined"!==typeof navigator&&navigator.msSaveOrOpenBlob)return function(a,d,b){d=d||a.name||"download";b||(a=m(a));return navigator.msSaveOrOpenBlob(a,d)};r.abort=function(){};r.readyState=r.INIT=0;r.WRITING=1;r.DONE=2;r.error=r.onwritestart=r.onprogress=r.onwrite=r.onabort=r.onerror=r.onwriteend=null;return function(a,d,b){return new n(a,d||a.name||"download",b)}}}("undefined"!==typeof self&&self||"undefined"!==
typeof window&&window||Hb.content);c.exports&&(c.exports.saveAs=b)}),Wi=function(c){function b(){I(this,b);var a=P(this,(b.__proto__||Object.getPrototypeOf(b)).call(this));a.addInputValidator(0,ArrayBuffer);a.setMetadata("filename",null);return a}L(b,c);N(b,[{key:"_run",value:function(){if(this.hasValidInput()){var a=this.getMetadata("filename");if(a){var d=new Blob([this._getInput()],{type:"application/octet-binary"});Jg.saveAs(d,a)}else console.warn("A filename must be specified. Use the method `.setMetadata('filename', 'theFile.ext')` on this filter.")}else console.warn("BrowserDownloadBuffer uses only ArrayBuffer.")}}]);
return b}(W),Xi="undefined"!==typeof window?window:"undefined"!==typeof $a?$a:"undefined"!==typeof self?self:{},V=kf(function(c,b){c="undefined"!==typeof Uint8Array&&"undefined"!==typeof Uint16Array&&"undefined"!==typeof Int32Array;b.assign=function(a){for(var d=Array.prototype.slice.call(arguments,1);d.length;){var b=d.shift();if(b){if("object"!==("undefined"===typeof b?"undefined":O(b)))throw new TypeError(b+"must be non-object");for(var c in b)Object.prototype.hasOwnProperty.call(b,c)&&(a[c]=b[c])}}return a};
b.shrinkBuf=function(a,d){if(a.length===d)return a;if(a.subarray)return a.subarray(0,d);a.length=d;return a};var a={arraySet:function(a,d,b,c,l){if(d.subarray&&a.subarray)a.set(d.subarray(b,b+c),l);else for(var e=0;e<c;e++)a[l+e]=d[b+e]},flattenChunks:function(a){var d,b,c,g,m;d=c=0;for(b=a.length;d<b;d++)c+=a[d].length;m=new Uint8Array(c);d=c=0;for(b=a.length;d<b;d++)g=a[d],m.set(g,c),c+=g.length;return m}},d={arraySet:function(a,d,b,c,l){for(var e=0;e<c;e++)a[l+e]=d[b+e]},flattenChunks:function(a){return[].concat.apply([],
a)}};b.setTyped=function(c){c?(b.Buf8=Uint8Array,b.Buf16=Uint16Array,b.Buf32=Int32Array,b.assign(b,a)):(b.Buf8=Array,b.Buf16=Array,b.Buf32=Array,b.assign(b,d))};b.setTyped(c)}),Hd=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],Tc=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],Yi=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],Kg=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],bb=Array(576);Pb(bb);var Gc=Array(60);Pb(Gc);var Ab=Array(512);Pb(Ab);var mc=Array(256);Pb(mc);
var Id=Array(29);Pb(Id);var Uc=Array(30);Pb(Uc);var Lg,Mg,Ng,Og=!1,Ha={_tr_init:function(c){if(!Og){var b,a,d,g=Array(16);for(d=a=0;28>d;d++)for(Id[d]=a,b=0;b<1<<Hd[d];b++)mc[a++]=d;mc[a-1]=d;for(d=a=0;16>d;d++)for(Uc[d]=a,b=0;b<1<<Tc[d];b++)Ab[a++]=d;for(a>>=7;30>d;d++)for(Uc[d]=a<<7,b=0;b<1<<Tc[d]-7;b++)Ab[256+a++]=d;for(b=0;15>=b;b++)g[b]=0;for(b=0;143>=b;)bb[2*b+1]=8,b++,g[8]++;for(;255>=b;)bb[2*b+1]=9,b++,g[9]++;for(;279>=b;)bb[2*b+1]=7,b++,g[7]++;for(;287>=b;)bb[2*b+1]=8,b++,g[8]++;mf(bb,287,
g);for(b=0;30>b;b++)Gc[2*b+1]=5,Gc[2*b]=lf(b,5);Lg=new Ed(bb,Hd,257,286,15);Mg=new Ed(Gc,Tc,0,30,15);Ng=new Ed([],Yi,0,19,7);Og=!0}c.l_desc=new Fd(c.dyn_ltree,Lg);c.d_desc=new Fd(c.dyn_dtree,Mg);c.bl_desc=new Fd(c.bl_tree,Ng);c.bi_buf=0;c.bi_valid=0;nf(c)},_tr_stored_block:tf,_tr_flush_block:function(c,b,a,d){var g,e,f=0;if(0<c.level){2===c.strm.data_type&&(c.strm.data_type=Wh(c));Jd(c,c.l_desc);Jd(c,c.d_desc);rf(c,c.dyn_ltree,c.l_desc.max_code);rf(c,c.dyn_dtree,c.d_desc.max_code);Jd(c,c.bl_desc);
for(f=18;3<=f&&0===c.bl_tree[2*Kg[f]+1];f--);c.opt_len+=3*(f+1)+14;g=c.opt_len+3+7>>>3;e=c.static_len+3+7>>>3;e<=g&&(g=e)}else g=e=a+5;if(a+4<=g&&-1!==b)tf(c,b,a,d);else if(4===c.strategy||e===g)xa(c,2+(d?1:0),3),qf(c,bb,Gc);else{xa(c,4+(d?1:0),3);b=c.l_desc.max_code+1;a=c.d_desc.max_code+1;f+=1;xa(c,b-257,5);xa(c,a-1,5);xa(c,f-4,4);for(g=0;g<f;g++)xa(c,c.bl_tree[2*Kg[g]+1],3);sf(c,c.dyn_ltree,b-1);sf(c,c.dyn_dtree,a-1);qf(c,c.dyn_ltree,c.dyn_dtree)}nf(c);d&&of(c)},_tr_tally:function(c,b,a){c.pending_buf[c.d_buf+
2*c.last_lit]=b>>>8&255;c.pending_buf[c.d_buf+2*c.last_lit+1]=b&255;c.pending_buf[c.l_buf+c.last_lit]=a&255;c.last_lit++;0===b?c.dyn_ltree[2*a]++:(c.matches++,b--,c.dyn_ltree[2*(mc[a]+256+1)]++,c.dyn_dtree[2*(256>b?Ab[b]:Ab[256+(b>>>7)])]++);return c.last_lit===c.lit_bufsize-1},_tr_align:function(c){xa(c,2,3);Qa(c,256,bb);16===c.bi_valid?(lc(c,c.bi_buf),c.bi_buf=0,c.bi_valid=0):8<=c.bi_valid&&(c.pending_buf[c.pending++]=c.bi_buf&255,c.bi_buf>>=8,c.bi_valid-=8)}},oc=function(c,b,a,d){var g=c&65535|
0;c=c>>>16&65535|0;for(var e;0!==a;){e=2E3<a?2E3:a;a-=e;do g=g+b[d++]|0,c=c+g|0;while(--e);g%=65521;c%=65521}return g|c<<16|0},Zi=function(){for(var c,b=[],a=0;256>a;a++){c=a;for(var d=0;8>d;d++)c=c&1?3988292384^c>>>1:c>>>1;b[a]=c}return b}(),ja=function(c,b,a,d){a=d+a;for(c^=-1;d<a;d++)c=c>>>8^Zi[(c^b[d])&255];return c^-1},Qb={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"},
Sb;Sb=[new Ra(0,0,0,0,function(c,b){var a=65535;for(a>c.pending_buf_size-5&&(a=c.pending_buf_size-5);;){if(1>=c.lookahead){Bb(c);if(0===c.lookahead&&0===b)return 1;if(0===c.lookahead)break}c.strstart+=c.lookahead;c.lookahead=0;var d=c.block_start+a;if(0===c.strstart||c.strstart>=d)if(c.lookahead=c.strstart-d,c.strstart=d,pa(c,!1),0===c.strm.avail_out)return 1;if(c.strstart-c.block_start>=c.w_size-262&&(pa(c,!1),0===c.strm.avail_out))return 1}c.insert=0;if(4===b)return pa(c,!0),0===c.strm.avail_out?
3:4;c.strstart>c.block_start&&pa(c,!1);return 1}),new Ra(4,4,8,4,Kd),new Ra(4,5,16,8,Kd),new Ra(4,6,32,32,Kd),new Ra(4,4,16,16,Rb),new Ra(8,16,32,32,Rb),new Ra(8,16,128,128,Rb),new Ra(8,32,128,256,Rb),new Ra(32,128,258,1024,Rb),new Ra(32,258,258,4096,Rb)];var pc={deflateInit:function(c,b){return xf(c,b,8,15,8,0)},deflateInit2:xf,deflateReset:wf,deflateResetKeep:vf,deflateSetHeader:function(c,b){if(!c||!c.state||2!==c.state.wrap)return-2;c.state.gzhead=b;return 0},deflate:function(c,b){var a,d,g,e;
if(!c||!c.state||5<b||0>b)return c?jb(c,-2):-2;d=c.state;if(!c.output||!c.input&&0!==c.avail_in||666===d.status&&4!==b)return jb(c,0===c.avail_out?-5:-2);d.strm=c;a=d.last_flush;d.last_flush=b;42===d.status&&(2===d.wrap?(c.adler=0,ca(d,31),ca(d,139),ca(d,8),d.gzhead?(ca(d,(d.gzhead.text?1:0)+(d.gzhead.hcrc?2:0)+(d.gzhead.extra?4:0)+(d.gzhead.name?8:0)+(d.gzhead.comment?16:0)),ca(d,d.gzhead.time&255),ca(d,d.gzhead.time>>8&255),ca(d,d.gzhead.time>>16&255),ca(d,d.gzhead.time>>24&255),ca(d,9===d.level?
2:2<=d.strategy||2>d.level?4:0),ca(d,d.gzhead.os&255),d.gzhead.extra&&d.gzhead.extra.length&&(ca(d,d.gzhead.extra.length&255),ca(d,d.gzhead.extra.length>>8&255)),d.gzhead.hcrc&&(c.adler=ja(c.adler,d.pending_buf,d.pending,0)),d.gzindex=0,d.status=69):(ca(d,0),ca(d,0),ca(d,0),ca(d,0),ca(d,0),ca(d,9===d.level?2:2<=d.strategy||2>d.level?4:0),ca(d,3),d.status=113)):(g=8+(d.w_bits-8<<4)<<8,g|=(2<=d.strategy||2>d.level?0:6>d.level?1:6===d.level?2:3)<<6,0!==d.strstart&&(g|=32),d.status=113,nc(d,g+(31-g%31)),
0!==d.strstart&&(nc(d,c.adler>>>16),nc(d,c.adler&65535)),c.adler=1));if(69===d.status)if(d.gzhead.extra){for(g=d.pending;d.gzindex<(d.gzhead.extra.length&65535)&&(d.pending!==d.pending_buf_size||(d.gzhead.hcrc&&d.pending>g&&(c.adler=ja(c.adler,d.pending_buf,d.pending-g,g)),lb(c),g=d.pending,d.pending!==d.pending_buf_size));)ca(d,d.gzhead.extra[d.gzindex]&255),d.gzindex++;d.gzhead.hcrc&&d.pending>g&&(c.adler=ja(c.adler,d.pending_buf,d.pending-g,g));d.gzindex===d.gzhead.extra.length&&(d.gzindex=0,d.status=
73)}else d.status=73;if(73===d.status)if(d.gzhead.name){g=d.pending;do{if(d.pending===d.pending_buf_size&&(d.gzhead.hcrc&&d.pending>g&&(c.adler=ja(c.adler,d.pending_buf,d.pending-g,g)),lb(c),g=d.pending,d.pending===d.pending_buf_size)){e=1;break}e=d.gzindex<d.gzhead.name.length?d.gzhead.name.charCodeAt(d.gzindex++)&255:0;ca(d,e)}while(0!==e);d.gzhead.hcrc&&d.pending>g&&(c.adler=ja(c.adler,d.pending_buf,d.pending-g,g));0===e&&(d.gzindex=0,d.status=91)}else d.status=91;if(91===d.status)if(d.gzhead.comment){g=
d.pending;do{if(d.pending===d.pending_buf_size&&(d.gzhead.hcrc&&d.pending>g&&(c.adler=ja(c.adler,d.pending_buf,d.pending-g,g)),lb(c),g=d.pending,d.pending===d.pending_buf_size)){e=1;break}e=d.gzindex<d.gzhead.comment.length?d.gzhead.comment.charCodeAt(d.gzindex++)&255:0;ca(d,e)}while(0!==e);d.gzhead.hcrc&&d.pending>g&&(c.adler=ja(c.adler,d.pending_buf,d.pending-g,g));0===e&&(d.status=103)}else d.status=103;103===d.status&&(d.gzhead.hcrc?(d.pending+2>d.pending_buf_size&&lb(c),d.pending+2<=d.pending_buf_size&&
(ca(d,c.adler&255),ca(d,c.adler>>8&255),c.adler=0,d.status=113)):d.status=113);if(0!==d.pending){if(lb(c),0===c.avail_out)return d.last_flush=-1,0}else if(0===c.avail_in&&(b<<1)-(4<b?9:0)<=(a<<1)-(4<a?9:0)&&4!==b)return jb(c,-5);if(666===d.status&&0!==c.avail_in)return jb(c,-5);if(0!==c.avail_in||0!==d.lookahead||0!==b&&666!==d.status){a=2===d.strategy?Yh(d,b):3===d.strategy?Xh(d,b):Sb[d.level].func(d,b);if(3===a||4===a)d.status=666;if(1===a||3===a)return 0===c.avail_out&&(d.last_flush=-1),0;if(2===
a&&(1===b?Ha._tr_align(d):5!==b&&(Ha._tr_stored_block(d,0,0,!1),3===b&&(kb(d.head),0===d.lookahead&&(d.strstart=0,d.block_start=0,d.insert=0))),lb(c),0===c.avail_out))return d.last_flush=-1,0}if(4!==b)return 0;if(0>=d.wrap)return 1;2===d.wrap?(ca(d,c.adler&255),ca(d,c.adler>>8&255),ca(d,c.adler>>16&255),ca(d,c.adler>>24&255),ca(d,c.total_in&255),ca(d,c.total_in>>8&255),ca(d,c.total_in>>16&255),ca(d,c.total_in>>24&255)):(nc(d,c.adler>>>16),nc(d,c.adler&65535));lb(c);0<d.wrap&&(d.wrap=-d.wrap);return 0!==
d.pending?0:1},deflateEnd:function(c){var b;if(!c||!c.state)return-2;b=c.state.status;if(42!==b&&69!==b&&73!==b&&91!==b&&103!==b&&113!==b&&666!==b)return jb(c,-2);c.state=null;return 113===b?jb(c,-3):0},deflateSetDictionary:function(c,b){var a=b.length,d,g,e,f,k;if(!c||!c.state)return-2;d=c.state;g=d.wrap;if(2===g||1===g&&42!==d.status||d.lookahead)return-2;1===g&&(c.adler=oc(c.adler,b,a,0));d.wrap=0;a>=d.w_size&&(0===g&&(kb(d.head),d.strstart=0,d.block_start=0,d.insert=0),e=new V.Buf8(d.w_size),
V.arraySet(e,b,a-d.w_size,d.w_size,0),b=e,a=d.w_size);e=c.avail_in;f=c.next_in;k=c.input;c.avail_in=a;c.next_in=0;c.input=b;for(Bb(d);3<=d.lookahead;){b=d.strstart;a=d.lookahead-2;do d.ins_h=(d.ins_h<<d.hash_shift^d.window[b+3-1])&d.hash_mask,d.prev[b&d.w_mask]=d.head[d.ins_h],d.head[d.ins_h]=b,b++;while(--a);d.strstart=b;d.lookahead=2;Bb(d)}d.strstart+=d.lookahead;d.block_start=d.strstart;d.insert=d.lookahead;d.lookahead=0;d.match_length=d.prev_length=2;d.match_available=0;c.next_in=f;c.input=k;
c.avail_in=e;d.wrap=g;return 0},deflateInfo:"pako deflate (from Nodeca project)"},Af=!0,zf=!0;try{String.fromCharCode.apply(null,[0])}catch(c){Af=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch(c){zf=!1}for(var Hc=new V.Buf8(256),rb=0;256>rb;rb++)Hc[rb]=252<=rb?6:248<=rb?5:240<=rb?4:224<=rb?3:192<=rb?2:1;Hc[254]=Hc[254]=1;var Db={string2buf:function(c){var b,a,d,g,e,f=c.length,k=0;for(g=0;g<f;g++)a=c.charCodeAt(g),55296===(a&64512)&&g+1<f&&(d=c.charCodeAt(g+1),56320===(d&64512)&&(a=
65536+(a-55296<<10)+(d-56320),g++)),k+=128>a?1:2048>a?2:65536>a?3:4;b=new V.Buf8(k);for(g=e=0;e<k;g++)a=c.charCodeAt(g),55296===(a&64512)&&g+1<f&&(d=c.charCodeAt(g+1),56320===(d&64512)&&(a=65536+(a-55296<<10)+(d-56320),g++)),128>a?b[e++]=a:(2048>a?b[e++]=192|a>>>6:(65536>a?b[e++]=224|a>>>12:(b[e++]=240|a>>>18,b[e++]=128|a>>>12&63),b[e++]=128|a>>>6&63),b[e++]=128|a&63);return b},buf2binstring:function(c){return yf(c,c.length)},binstring2buf:function(c){for(var b=new V.Buf8(c.length),a=0,d=b.length;a<
d;a++)b[a]=c.charCodeAt(a);return b},buf2string:function(c,b){var a,d,g,e=b||c.length,f=Array(2*e);for(b=a=0;b<e;)if(d=c[b++],128>d)f[a++]=d;else if(g=Hc[d],4<g)f[a++]=65533,b+=g-1;else{for(d&=2===g?31:3===g?15:7;1<g&&b<e;)d=d<<6|c[b++]&63,g--;1<g?f[a++]=65533:65536>d?f[a++]=d:(d-=65536,f[a++]=55296|d>>10&1023,f[a++]=56320|d&1023)}return yf(f,a)},utf8border:function(c,b){var a;b=b||c.length;b>c.length&&(b=c.length);for(a=b-1;0<=a&&128===(c[a]&192);)a--;return 0>a||0===a?b:a+Hc[c[a]]>b?a:b}},Bf=function(){this.input=
null;this.total_in=this.avail_in=this.next_in=0;this.output=null;this.total_out=this.avail_out=this.next_out=0;this.msg="";this.state=null;this.data_type=2;this.adler=0},Cf=Object.prototype.toString;Cb.prototype.push=function(c,b){var a=this.strm,d=this.options.chunkSize;if(this.ended)return!1;b=b===~~b?b:!0===b?4:0;"string"===typeof c?a.input=Db.string2buf(c):"[object ArrayBuffer]"===Cf.call(c)?a.input=new Uint8Array(c):a.input=c;a.next_in=0;a.avail_in=a.input.length;do{0===a.avail_out&&(a.output=
new V.Buf8(d),a.next_out=0,a.avail_out=d);c=pc.deflate(a,b);if(1!==c&&0!==c)return this.onEnd(c),this.ended=!0,!1;if(0===a.avail_out||0===a.avail_in&&(4===b||2===b))if("string"===this.options.to)this.onData(Db.buf2binstring(V.shrinkBuf(a.output,a.next_out)));else this.onData(V.shrinkBuf(a.output,a.next_out))}while((0<a.avail_in||0===a.avail_out)&&1!==c);if(4===b)return c=pc.deflateEnd(this.strm),this.onEnd(c),this.ended=!0,0===c;2===b&&(this.onEnd(0),a.avail_out=0);return!0};Cb.prototype.onData=function(c){this.chunks.push(c)};
Cb.prototype.onEnd=function(c){0===c&&(this.result="string"===this.options.to?this.chunks.join(""):V.flattenChunks(this.chunks));this.chunks=[];this.err=c;this.msg=this.strm.msg};var $i={Deflate:Cb,deflate:Ld,deflateRaw:function(c,b){b=b||{};b.raw=!0;return Ld(c,b)},gzip:function(c,b){b=b||{};b.gzip=!0;return Ld(c,b)}},aj=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],bj=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,
21,16,72,78],cj=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],dj=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64],Ic=function(c,b,a,d,g,e,f,k){var l=k.bits,m,n,r,u,p,t,y,w,x,v,A,q,C,T=0,G,K=new V.Buf16(16);p=new V.Buf16(16);var M,B=0,J,E,D;for(m=0;15>=m;m++)K[m]=0;for(n=0;n<d;n++)K[b[a+n]]++;u=l;for(r=15;1<=r&&0===K[r];r--);u>r&&(u=r);if(0===r)return g[e++]=20971520,g[e++]=20971520,
k.bits=1,0;for(l=1;l<r&&0===K[l];l++);u<l&&(u=l);for(m=t=1;15>=m;m++)if(t<<=1,t-=K[m],0>t)return-1;if(0<t&&(0===c||1!==r))return-1;p[1]=0;for(m=1;15>m;m++)p[m+1]=p[m]+K[m];for(n=0;n<d;n++)0!==b[a+n]&&(f[p[b[a+n]]++]=n);0===c?(C=M=f,G=19):1===c?(C=aj,T-=257,M=bj,B-=257,G=256):(C=cj,M=dj,G=-1);n=w=0;m=l;q=e;d=u;p=0;v=-1;y=1<<u;A=y-1;if(1===c&&852<y||2===c&&592<y)return 1;for(;;){J=m-p;f[n]<G?(E=0,D=f[n]):f[n]>G?(E=M[B+f[n]],D=C[T+f[n]]):(E=96,D=0);t=1<<m-p;l=x=1<<d;do x-=t,g[q+(w>>p)+x]=J<<24|E<<16|
D|0;while(0!==x);for(t=1<<m-1;w&t;)t>>=1;0!==t?(w&=t-1,w+=t):w=0;n++;if(0===--K[m]){if(m===r)break;m=b[a+f[n]]}if(m>u&&(w&A)!==v){0===p&&(p=u);q+=l;d=m-p;for(t=1<<d;d+p<r;){t-=K[d+p];if(0>=t)break;d++;t<<=1}y+=1<<d;if(1===c&&852<y||2===c&&592<y)return 1;v=w&A;g[v]=u<<24|d<<16|q-e|0}}0!==w&&(g[q+w]=m-p<<24|4194304);k.bits=u;return 0},Pg=!0,ae,be,qc={inflateReset:Ff,inflateReset2:Gf,inflateResetKeep:Ef,inflateInit:function(c){return Hf(c,15)},inflateInit2:Hf,inflate:function(c,b){var a,d,g,e,f,k,l,
m,n,r,u,p,t,y,w,x,v,A,q=new V.Buf8(4),C=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!c||!c.state||!c.output||!c.input&&0!==c.avail_in)return-2;a=c.state;12===a.mode&&(a.mode=13);f=c.next_out;g=c.output;l=c.avail_out;e=c.next_in;d=c.input;k=c.avail_in;m=a.hold;n=a.bits;r=k;u=l;A=0;a:for(;;)switch(a.mode){case 1:if(0===a.wrap){a.mode=13;break}for(;16>n;){if(0===k)break a;k--;m+=d[e++]<<n;n+=8}if(a.wrap&2&&35615===m){a.check=0;q[0]=m&255;q[1]=m>>>8&255;a.check=ja(a.check,q,2,0);n=m=0;a.mode=
2;break}a.flags=0;a.head&&(a.head.done=!1);if(!(a.wrap&1)||(((m&255)<<8)+(m>>8))%31){c.msg="incorrect header check";a.mode=30;break}if(8!==(m&15)){c.msg="unknown compression method";a.mode=30;break}m>>>=4;n-=4;t=(m&15)+8;if(0===a.wbits)a.wbits=t;else if(t>a.wbits){c.msg="invalid window size";a.mode=30;break}a.dmax=1<<t;c.adler=a.check=1;a.mode=m&512?10:12;n=m=0;break;case 2:for(;16>n;){if(0===k)break a;k--;m+=d[e++]<<n;n+=8}a.flags=m;if(8!==(a.flags&255)){c.msg="unknown compression method";a.mode=
30;break}if(a.flags&57344){c.msg="unknown header flags set";a.mode=30;break}a.head&&(a.head.text=m>>8&1);a.flags&512&&(q[0]=m&255,q[1]=m>>>8&255,a.check=ja(a.check,q,2,0));n=m=0;a.mode=3;case 3:for(;32>n;){if(0===k)break a;k--;m+=d[e++]<<n;n+=8}a.head&&(a.head.time=m);a.flags&512&&(q[0]=m&255,q[1]=m>>>8&255,q[2]=m>>>16&255,q[3]=m>>>24&255,a.check=ja(a.check,q,4,0));n=m=0;a.mode=4;case 4:for(;16>n;){if(0===k)break a;k--;m+=d[e++]<<n;n+=8}a.head&&(a.head.xflags=m&255,a.head.os=m>>8);a.flags&512&&(q[0]=
m&255,q[1]=m>>>8&255,a.check=ja(a.check,q,2,0));n=m=0;a.mode=5;case 5:if(a.flags&1024){for(;16>n;){if(0===k)break a;k--;m+=d[e++]<<n;n+=8}a.length=m;a.head&&(a.head.extra_len=m);a.flags&512&&(q[0]=m&255,q[1]=m>>>8&255,a.check=ja(a.check,q,2,0));n=m=0}else a.head&&(a.head.extra=null);a.mode=6;case 6:if(a.flags&1024&&(p=a.length,p>k&&(p=k),p&&(a.head&&(t=a.head.extra_len-a.length,a.head.extra||(a.head.extra=Array(a.head.extra_len)),V.arraySet(a.head.extra,d,e,p,t)),a.flags&512&&(a.check=ja(a.check,
d,p,e)),k-=p,e+=p,a.length-=p),a.length))break a;a.length=0;a.mode=7;case 7:if(a.flags&2048){if(0===k)break a;p=0;do t=d[e+p++],a.head&&t&&65536>a.length&&(a.head.name+=String.fromCharCode(t));while(t&&p<k);a.flags&512&&(a.check=ja(a.check,d,p,e));k-=p;e+=p;if(t)break a}else a.head&&(a.head.name=null);a.length=0;a.mode=8;case 8:if(a.flags&4096){if(0===k)break a;p=0;do t=d[e+p++],a.head&&t&&65536>a.length&&(a.head.comment+=String.fromCharCode(t));while(t&&p<k);a.flags&512&&(a.check=ja(a.check,d,p,
e));k-=p;e+=p;if(t)break a}else a.head&&(a.head.comment=null);a.mode=9;case 9:if(a.flags&512){for(;16>n;){if(0===k)break a;k--;m+=d[e++]<<n;n+=8}if(m!==(a.check&65535)){c.msg="header crc mismatch";a.mode=30;break}n=m=0}a.head&&(a.head.hcrc=a.flags>>9&1,a.head.done=!0);c.adler=a.check=0;a.mode=12;break;case 10:for(;32>n;){if(0===k)break a;k--;m+=d[e++]<<n;n+=8}c.adler=a.check=Df(m);n=m=0;a.mode=11;case 11:if(0===a.havedict)return c.next_out=f,c.avail_out=l,c.next_in=e,c.avail_in=k,a.hold=m,a.bits=
n,2;c.adler=a.check=1;a.mode=12;case 12:if(5===b||6===b)break a;case 13:if(a.last){m>>>=n&7;n-=n&7;a.mode=27;break}for(;3>n;){if(0===k)break a;k--;m+=d[e++]<<n;n+=8}a.last=m&1;m>>>=1;--n;switch(m&3){case 0:a.mode=14;break;case 1:t=a;if(Pg){ae=new V.Buf32(512);be=new V.Buf32(32);for(p=0;144>p;)t.lens[p++]=8;for(;256>p;)t.lens[p++]=9;for(;280>p;)t.lens[p++]=7;for(;288>p;)t.lens[p++]=8;Ic(1,t.lens,0,288,ae,0,t.work,{bits:9});for(p=0;32>p;)t.lens[p++]=5;Ic(2,t.lens,0,32,be,0,t.work,{bits:5});Pg=!1}t.lencode=
ae;t.lenbits=9;t.distcode=be;t.distbits=5;a.mode=20;if(6===b){m>>>=2;n-=2;break a}break;case 2:a.mode=17;break;case 3:c.msg="invalid block type",a.mode=30}m>>>=2;n-=2;break;case 14:m>>>=n&7;for(n-=n&7;32>n;){if(0===k)break a;k--;m+=d[e++]<<n;n+=8}if((m&65535)!==(m>>>16^65535)){c.msg="invalid stored block lengths";a.mode=30;break}a.length=m&65535;n=m=0;a.mode=15;if(6===b)break a;case 15:a.mode=16;case 16:if(p=a.length){p>k&&(p=k);p>l&&(p=l);if(0===p)break a;V.arraySet(g,d,e,p,f);k-=p;e+=p;l-=p;f+=
p;a.length-=p;break}a.mode=12;break;case 17:for(;14>n;){if(0===k)break a;k--;m+=d[e++]<<n;n+=8}a.nlen=(m&31)+257;m>>>=5;n-=5;a.ndist=(m&31)+1;m>>>=5;n-=5;a.ncode=(m&15)+4;m>>>=4;n-=4;if(286<a.nlen||30<a.ndist){c.msg="too many length or distance symbols";a.mode=30;break}a.have=0;a.mode=18;case 18:for(;a.have<a.ncode;){for(;3>n;){if(0===k)break a;k--;m+=d[e++]<<n;n+=8}a.lens[C[a.have++]]=m&7;m>>>=3;n-=3}for(;19>a.have;)a.lens[C[a.have++]]=0;a.lencode=a.lendyn;a.lenbits=7;p={bits:a.lenbits};A=Ic(0,a.lens,
0,19,a.lencode,0,a.work,p);a.lenbits=p.bits;if(A){c.msg="invalid code lengths set";a.mode=30;break}a.have=0;a.mode=19;case 19:for(;a.have<a.nlen+a.ndist;){for(;;){w=a.lencode[m&(1<<a.lenbits)-1];p=w>>>24;w&=65535;if(p<=n)break;if(0===k)break a;k--;m+=d[e++]<<n;n+=8}if(16>w)m>>>=p,n-=p,a.lens[a.have++]=w;else{if(16===w){for(t=p+2;n<t;){if(0===k)break a;k--;m+=d[e++]<<n;n+=8}m>>>=p;n-=p;if(0===a.have){c.msg="invalid bit length repeat";a.mode=30;break}t=a.lens[a.have-1];p=3+(m&3);m>>>=2;n-=2}else if(17===
w){for(t=p+3;n<t;){if(0===k)break a;k--;m+=d[e++]<<n;n+=8}m>>>=p;n-=p;t=0;p=3+(m&7);m>>>=3;n-=3}else{for(t=p+7;n<t;){if(0===k)break a;k--;m+=d[e++]<<n;n+=8}m>>>=p;n-=p;t=0;p=11+(m&127);m>>>=7;n-=7}if(a.have+p>a.nlen+a.ndist){c.msg="invalid bit length repeat";a.mode=30;break}for(;p--;)a.lens[a.have++]=t}}if(30===a.mode)break;if(0===a.lens[256]){c.msg="invalid code -- missing end-of-block";a.mode=30;break}a.lenbits=9;p={bits:a.lenbits};A=Ic(1,a.lens,0,a.nlen,a.lencode,0,a.work,p);a.lenbits=p.bits;if(A){c.msg=
"invalid literal/lengths set";a.mode=30;break}a.distbits=6;a.distcode=a.distdyn;p={bits:a.distbits};A=Ic(2,a.lens,a.nlen,a.ndist,a.distcode,0,a.work,p);a.distbits=p.bits;if(A){c.msg="invalid distances set";a.mode=30;break}a.mode=20;if(6===b)break a;case 20:a.mode=21;case 21:if(6<=k&&258<=l){c.next_out=f;c.avail_out=l;c.next_in=e;c.avail_in=k;a.hold=m;a.bits=n;var T,G,K,M,B,J,E,D,z,H,I=c;H=I.state;z=I.next_in;g=I.input;D=z+(I.avail_in-5);E=I.next_out;d=I.output;J=E-(u-I.avail_out);B=E+(I.avail_out-
257);M=H.dmax;w=H.wsize;v=H.whave;x=H.wnext;y=H.window;t=H.hold;p=H.bits;n=H.lencode;m=H.distcode;l=(1<<H.lenbits)-1;k=(1<<H.distbits)-1;b:do c:for(15>p&&(t+=g[z++]<<p,p+=8,t+=g[z++]<<p,p+=8),T=n[t&l];;){f=T>>>24;t>>>=f;p-=f;f=T>>>16&255;if(0===f)d[E++]=T&65535;else if(f&16){e=T&65535;if(f&=15)p<f&&(t+=g[z++]<<p,p+=8),e+=t&(1<<f)-1,t>>>=f,p-=f;15>p&&(t+=g[z++]<<p,p+=8,t+=g[z++]<<p,p+=8);T=m[t&k];d:for(;;){f=T>>>24;t>>>=f;p-=f;f=T>>>16&255;if(f&16){K=T&65535;f&=15;p<f&&(t+=g[z++]<<p,p+=8,p<f&&(t+=
g[z++]<<p,p+=8));K+=t&(1<<f)-1;if(K>M){I.msg="invalid distance too far back";H.mode=30;break b}t>>>=f;p-=f;f=E-J;if(K>f){f=K-f;if(f>v&&H.sane){I.msg="invalid distance too far back";H.mode=30;break b}G=0;T=y;if(0===x){if(G+=w-f,f<e){e-=f;do d[E++]=y[G++];while(--f);G=E-K;T=d}}else if(x<f){if(G+=w+x-f,f-=x,f<e){e-=f;do d[E++]=y[G++];while(--f);G=0;if(x<e){f=x;e-=f;do d[E++]=y[G++];while(--f);G=E-K;T=d}}}else if(G+=x-f,f<e){e-=f;do d[E++]=y[G++];while(--f);G=E-K;T=d}for(;2<e;)d[E++]=T[G++],d[E++]=T[G++],
d[E++]=T[G++],e-=3;e&&(d[E++]=T[G++],1<e&&(d[E++]=T[G++]))}else{G=E-K;do d[E++]=d[G++],d[E++]=d[G++],d[E++]=d[G++],e-=3;while(2<e);e&&(d[E++]=d[G++],1<e&&(d[E++]=d[G++]))}}else if(0===(f&64)){T=m[(T&65535)+(t&(1<<f)-1)];continue d}else{I.msg="invalid distance code";H.mode=30;break b}break}}else if(0===(f&64)){T=n[(T&65535)+(t&(1<<f)-1)];continue c}else{f&32?H.mode=12:(I.msg="invalid literal/length code",H.mode=30);break b}break}while(z<D&&E<B);e=p>>3;z-=e;p-=e<<3;I.next_in=z;I.next_out=E;I.avail_in=
z<D?5+(D-z):5-(z-D);I.avail_out=E<B?257+(B-E):257-(E-B);H.hold=t&(1<<p)-1;H.bits=p;f=c.next_out;g=c.output;l=c.avail_out;e=c.next_in;d=c.input;k=c.avail_in;m=a.hold;n=a.bits;12===a.mode&&(a.back=-1);break}for(a.back=0;;){w=a.lencode[m&(1<<a.lenbits)-1];p=w>>>24;t=w>>>16&255;w&=65535;if(p<=n)break;if(0===k)break a;k--;m+=d[e++]<<n;n+=8}if(t&&0===(t&240)){y=p;x=t;for(v=w;;){w=a.lencode[v+((m&(1<<y+x)-1)>>y)];p=w>>>24;t=w>>>16&255;w&=65535;if(y+p<=n)break;if(0===k)break a;k--;m+=d[e++]<<n;n+=8}m>>>=
y;n-=y;a.back+=y}m>>>=p;n-=p;a.back+=p;a.length=w;if(0===t){a.mode=26;break}if(t&32){a.back=-1;a.mode=12;break}if(t&64){c.msg="invalid literal/length code";a.mode=30;break}a.extra=t&15;a.mode=22;case 22:if(a.extra){for(t=a.extra;n<t;){if(0===k)break a;k--;m+=d[e++]<<n;n+=8}a.length+=m&(1<<a.extra)-1;m>>>=a.extra;n-=a.extra;a.back+=a.extra}a.was=a.length;a.mode=23;case 23:for(;;){w=a.distcode[m&(1<<a.distbits)-1];p=w>>>24;t=w>>>16&255;w&=65535;if(p<=n)break;if(0===k)break a;k--;m+=d[e++]<<n;n+=8}if(0===
(t&240)){y=p;x=t;for(v=w;;){w=a.distcode[v+((m&(1<<y+x)-1)>>y)];p=w>>>24;t=w>>>16&255;w&=65535;if(y+p<=n)break;if(0===k)break a;k--;m+=d[e++]<<n;n+=8}m>>>=y;n-=y;a.back+=y}m>>>=p;n-=p;a.back+=p;if(t&64){c.msg="invalid distance code";a.mode=30;break}a.offset=w;a.extra=t&15;a.mode=24;case 24:if(a.extra){for(t=a.extra;n<t;){if(0===k)break a;k--;m+=d[e++]<<n;n+=8}a.offset+=m&(1<<a.extra)-1;m>>>=a.extra;n-=a.extra;a.back+=a.extra}if(a.offset>a.dmax){c.msg="invalid distance too far back";a.mode=30;break}a.mode=
25;case 25:if(0===l)break a;p=u-l;if(a.offset>p){p=a.offset-p;if(p>a.whave&&a.sane){c.msg="invalid distance too far back";a.mode=30;break}p>a.wnext?(p-=a.wnext,t=a.wsize-p):t=a.wnext-p;p>a.length&&(p=a.length);y=a.window}else y=g,t=f-a.offset,p=a.length;p>l&&(p=l);l-=p;a.length-=p;do g[f++]=y[t++];while(--p);0===a.length&&(a.mode=21);break;case 26:if(0===l)break a;g[f++]=a.length;l--;a.mode=21;break;case 27:if(a.wrap){for(;32>n;){if(0===k)break a;k--;m|=d[e++]<<n;n+=8}u-=l;c.total_out+=u;a.total+=
u;u&&(c.adler=a.check=a.flags?ja(a.check,g,u,f-u):oc(a.check,g,u,f-u));u=l;if((a.flags?m:Df(m))!==a.check){c.msg="incorrect data check";a.mode=30;break}n=m=0}a.mode=28;case 28:if(a.wrap&&a.flags){for(;32>n;){if(0===k)break a;k--;m+=d[e++]<<n;n+=8}if(m!==(a.total&4294967295)){c.msg="incorrect length check";a.mode=30;break}n=m=0}a.mode=29;case 29:A=1;break a;case 30:A=-3;break a;case 31:return-4;default:return-2}c.next_out=f;c.avail_out=l;c.next_in=e;c.avail_in=k;a.hold=m;a.bits=n;if((a.wsize||u!==
c.avail_out&&30>a.mode&&(27>a.mode||4!==b))&&If(c,c.output,c.next_out,u-c.avail_out))return a.mode=31,-4;r-=c.avail_in;u-=c.avail_out;c.total_in+=r;c.total_out+=u;a.total+=u;a.wrap&&u&&(c.adler=a.check=a.flags?ja(a.check,g,u,c.next_out-u):oc(a.check,g,u,c.next_out-u));c.data_type=a.bits+(a.last?64:0)+(12===a.mode?128:0)+(20===a.mode||15===a.mode?256:0);(0===r&&0===u||4===b)&&0===A&&(A=-5);return A},inflateEnd:function(c){if(!c||!c.state)return-2;var b=c.state;b.window&&(b.window=null);c.state=null;
return 0},inflateGetHeader:function(c,b){if(!c||!c.state)return-2;c=c.state;if(0===(c.wrap&2))return-2;c.head=b;b.done=!1;return 0},inflateSetDictionary:function(c,b){var a=b.length,d,g;if(!c||!c.state)return-2;d=c.state;if(0!==d.wrap&&11!==d.mode)return-2;if(11===d.mode&&(g=oc(1,b,a,0),g!==d.check))return-3;if(If(c,b,a,a))return d.mode=31,-4;d.havedict=1;return 0},inflateInfo:"pako inflate (from Nodeca project)"},X={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,
Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8},ai=function(){this.os=this.xflags=this.time=this.text=0;this.extra=null;this.extra_len=0;this.comment=this.name="";this.hcrc=0;this.done=!1},Qg=Object.prototype.toString;Eb.prototype.push=function(c,b){var a=
this.strm,d=this.options.chunkSize,g=this.options.dictionary,e,f,k,l=!1;if(this.ended)return!1;b=b===~~b?b:!0===b?X.Z_FINISH:X.Z_NO_FLUSH;"string"===typeof c?a.input=Db.binstring2buf(c):"[object ArrayBuffer]"===Qg.call(c)?a.input=new Uint8Array(c):a.input=c;a.next_in=0;a.avail_in=a.input.length;do{0===a.avail_out&&(a.output=new V.Buf8(d),a.next_out=0,a.avail_out=d);c=qc.inflate(a,X.Z_NO_FLUSH);c===X.Z_NEED_DICT&&g&&(c="string"===typeof g?Db.string2buf(g):"[object ArrayBuffer]"===Qg.call(g)?new Uint8Array(g):
g,c=qc.inflateSetDictionary(this.strm,c));c===X.Z_BUF_ERROR&&!0===l&&(c=X.Z_OK,l=!1);if(c!==X.Z_STREAM_END&&c!==X.Z_OK)return this.onEnd(c),this.ended=!0,!1;if(a.next_out&&(0===a.avail_out||c===X.Z_STREAM_END||0===a.avail_in&&(b===X.Z_FINISH||b===X.Z_SYNC_FLUSH)))if("string"===this.options.to)e=Db.utf8border(a.output,a.next_out),f=a.next_out-e,k=Db.buf2string(a.output,e),a.next_out=f,a.avail_out=d-f,f&&V.arraySet(a.output,a.output,e,f,0),this.onData(k);else this.onData(V.shrinkBuf(a.output,a.next_out));
0===a.avail_in&&0===a.avail_out&&(l=!0)}while((0<a.avail_in||0===a.avail_out)&&c!==X.Z_STREAM_END);c===X.Z_STREAM_END&&(b=X.Z_FINISH);if(b===X.Z_FINISH)return c=qc.inflateEnd(this.strm),this.onEnd(c),this.ended=!0,c===X.Z_OK;b===X.Z_SYNC_FLUSH&&(this.onEnd(X.Z_OK),a.avail_out=0);return!0};Eb.prototype.onData=function(c){this.chunks.push(c)};Eb.prototype.onEnd=function(c){c===X.Z_OK&&(this.result="string"===this.options.to?this.chunks.join(""):V.flattenChunks(this.chunks));this.chunks=[];this.err=
c;this.msg=this.strm.msg};var ej=V.assign,Jc={};ej(Jc,$i,{Inflate:Eb,inflate:Md,inflateRaw:function(c,b){b=b||{};b.raw=!0;return Md(c,b)},ungzip:Md},X);var hd=function(c,b){return b={exports:{}},c(b,b.exports),b.exports}(function(c){function b(a){this.value=a}function a(a,b,c){var e=[],g=[],n=!0;return function x(a){function p(){if("object"===O(q.node)&&null!==q.node){q.keys&&q.node_===q.node||(q.keys=f(q.node));q.isLeaf=0==q.keys.length;for(var d=0;d<g.length;d++)if(g[d].node_===a){q.circular=g[d];
break}}else q.isLeaf=!0,q.keys=null;q.notLeaf=!q.isLeaf;q.notRoot=!q.isRoot}var r,u,t,y,v=!0,q={node:c?d(a):a,node_:a,path:[].concat(e),parent:g[g.length-1],parents:g,key:e.slice(-1)[0],isRoot:0===e.length,level:e.length,circular:null,update:function(a,d){q.isRoot||(q.parent.node[q.key]=a);q.node=a;d&&(v=!1)},"delete":function(a){delete q.parent.node[q.key];a&&(v=!1)},remove:function(a){k(q.parent.node)?q.parent.node.splice(q.key,1):delete q.parent.node[q.key];a&&(v=!1)},keys:null,before:function(a){r=
a},after:function(a){u=a},pre:function(a){t=a},post:function(a){y=a},stop:function(){n=!1},block:function(){v=!1}};if(!n)return q;p();var B=b.call(q,q.node);void 0!==B&&q.update&&q.update(B);r&&r.call(q,q.node);if(!v)return q;"object"!=O(q.node)||null===q.node||q.circular||(g.push(q),p(),l(q.keys,function(a,d){e.push(a);t&&t.call(q,q.node[a],a);var b=x(q.node[a]);c&&m.call(q.node,a)&&(q.node[a]=b.node);b.isLast=d==q.keys.length-1;b.isFirst=0==d;y&&y.call(q,b);e.pop()}),g.pop());u&&u.call(q,q.node);
return q}(a).node}function d(a){if("object"===("undefined"===typeof a?"undefined":O(a))&&null!==a){var d;if(k(a))d=[];else if("[object Date]"===g(a))d=new Date(a.getTime?a.getTime():a);else if("[object RegExp]"===g(a))d=new RegExp(a);else if("[object Error]"===g(a))d={message:a.message};else if("[object Boolean]"===g(a))d=new Boolean(a);else if("[object Number]"===g(a))d=new Number(a);else if("[object String]"===g(a))d=new String(a);else if(Object.create&&Object.getPrototypeOf)d=Object.create(Object.getPrototypeOf(a));
else if(a.constructor===Object)d={};else{var b=function(){};b.prototype=a.constructor&&a.constructor.prototype||a.__proto__||{};d=new b}l(f(a),function(b){d[b]=a[b]});return d}return a}function g(a){return Object.prototype.toString.call(a)}var e=c.exports=function(a){return new b(a)};b.prototype.get=function(a){for(var d=this.value,b=0;b<a.length;b++){var c=a[b];if(!d||!m.call(d,c)){d=void 0;break}d=d[c]}return d};b.prototype.has=function(a){for(var d=this.value,b=0;b<a.length;b++){var c=a[b];if(!d||
!m.call(d,c))return!1;d=d[c]}return!0};b.prototype.set=function(a,d){for(var b=this.value,c=0;c<a.length-1;c++){var e=a[c];m.call(b,e)||(b[e]={});b=b[e]}return b[a[c]]=d};b.prototype.map=function(d){return a(this.value,d,!0)};b.prototype.forEach=function(d){return this.value=a(this.value,d,!1)};b.prototype.reduce=function(a,d){var b=1===arguments.length,c=b?this.value:d;this.forEach(function(d){this.isRoot&&b||(c=a.call(this,c,d))});return c};b.prototype.paths=function(){var a=[];this.forEach(function(d){a.push(this.path)});
return a};b.prototype.nodes=function(){var a=[];this.forEach(function(d){a.push(this.node)});return a};b.prototype.clone=function(){var a=[],b=[];return function p(c){for(var e=0;e<a.length;e++)if(a[e]===c)return b[e];if("object"===("undefined"===typeof c?"undefined":O(c))&&null!==c){var g=d(c);a.push(c);b.push(g);l(f(c),function(a){g[a]=p(c[a])});a.pop();b.pop();return g}return c}(this.value)};var f=Object.keys||function(a){var d=[],b;for(b in a)d.push(b);return d},k=Array.isArray||function(a){return"[object Array]"===
Object.prototype.toString.call(a)},l=function(a,d){if(a.forEach)return a.forEach(d);for(var b=0;b<a.length;b++)d(a[b],b,a)};l(f(b.prototype),function(a){e[a]=function(d){var c=[].slice.call(arguments,1),e=new b(d);return e[a].apply(e,c)}});var m=Object.hasOwnProperty||function(a,d){return d in a}}),fj=function(){function c(b,a){for(var d=0;d<a.length;d++){var c=a[d];c.enumerable=c.enumerable||!1;c.configurable=!0;"value"in c&&(c.writable=!0);Object.defineProperty(b,c.key,c)}}return function(b,a,d){a&&
c(b.prototype,a);d&&c(b,d);return b}}(),ea=function(){function c(){if(!(this instanceof c))throw new TypeError("Cannot call a class as a function");}fj(c,null,[{key:"isPlatformLittleEndian",value:function(){var b=new Uint32Array([305419896]);return 18!=(new Uint8Array(b.buffer,b.byteOffset,b.byteLength))[0]}},{key:"arrayBufferToUnicode",value:function(b){b=new Uint8Array(b);for(var a=[],d=0,c=0;d<b.length;){var e=b[d++];if(128>e)a[c++]=String.fromCharCode(e);else if(191<e&&224>e){var f=b[d++];a[c++]=
String.fromCharCode((e&31)<<6|f&63)}else if(239<e&&365>e){var f=b[d++],k=b[d++],l=b[d++],e=((e&7)<<18|(f&63)<<12|(k&63)<<6|l&63)-65536;a[c++]=String.fromCharCode(55296+(e>>10));a[c++]=String.fromCharCode(56320+(e&1023))}else f=b[d++],k=b[d++],a[c++]=String.fromCharCode((e&15)<<12|(f&63)<<6|k&63)}return a.join("")}},{key:"unicodeToArrayBuffer",value:function(b){for(var a=[],d=0,c=0;c<b.length;c++){var e=b.charCodeAt(c);128>e?a[d++]=e:(2048>e?a[d++]=e>>6|192:(55296==(e&64512)&&c+1<b.length&&56320==
(b.charCodeAt(c+1)&64512)?(e=65536+((e&1023)<<10)+(b.charCodeAt(++c)&1023),a[d++]=e>>18|240,a[d++]=e>>12&63|128):a[d++]=e>>12|224,a[d++]=e>>6&63|128),a[d++]=e&63|128)}return(new Uint8Array(a)).buffer}},{key:"arrayBufferToString8",value:function(b){return String.fromCharCode.apply(null,new Uint8Array(b))}},{key:"string8ToArrayBuffer",value:function(b){for(var a=new ArrayBuffer(b.length),d=new Uint8Array(a),c=0;c<b.length;c++)d[c]=b.charCodeAt(c);return a}},{key:"setString8InBuffer",value:function(b,
a){var d=2<arguments.length&&void 0!==arguments[2]?arguments[2]:0;if(0>d)console.warn("The byte offset cannot be negative.");else if(a&&a instanceof ArrayBuffer)if(b.length+d>a.byteLength)console.warn("The string is too long to be writen in this buffer.");else for(var c=new Uint8Array(a),e=0;e<b.length;e++)c[e+d]=b.charCodeAt(e);else console.warn("The buffer must be a valid ArrayBuffer.")}},{key:"getString8FromBuffer",value:function(b,a){var d=2<arguments.length&&void 0!==arguments[2]?arguments[2]:
0;return 0>d?(console.warn("The byte offset cannot be negative."),null):b&&b instanceof ArrayBuffer?a+d>b.byteLength?(console.warn("The string is too long to be writen in this buffer."),null):String.fromCharCode.apply(null,new Uint8Array(b,d,a)):(console.warn("The buffer must be a valid ArrayBuffer."),null)}},{key:"objectToArrayBuffer",value:function(b){var a=null;b=c.makeSerializeFriendly(b);try{var d=JSON.stringify(b),a=c.unicodeToArrayBuffer(d)}catch(g){console.warn(g)}return a}},{key:"ArrayBufferToObject",
value:function(b){var a=null;try{var d=c.arrayBufferToUnicode(b),a=JSON.parse(d)}catch(g){console.warn(g)}return a}},{key:"isTypedArray",value:function(b){return b instanceof Int8Array||b instanceof Uint8Array||b instanceof Uint8ClampedArray||b instanceof Int16Array||b instanceof Uint16Array||b instanceof Int32Array||b instanceof Uint32Array||b instanceof Float32Array||b instanceof Float64Array}},{key:"mergeBuffers",value:function(b){for(var a=0,d=0;d<b.length;d++)a+=b[d].byteLength;for(var a=new Uint8Array(a),
c=0,d=0;d<b.length;d++)a.set(new Uint8Array(b[d]),c),c+=b[d].byteLength;return a.buffer}},{key:"getGlobalObject",value:function(){var b=null;try{b=window}catch(a){try{b=GLOBAL}catch(d){return console.warn("You are not in a Javascript environment?? Weird."),null}}return b}},{key:"extractTypedArray",value:function(b,a,d,c){if(!b)return console.warn("Input Buffer is null."),null;if(!(b instanceof ArrayBuffer))return console.warn("Buffer must be of type ArrayBuffer"),null;if(0>=c)return console.warn("The number of elements to fetch must be greater than 0"),
null;if(0>a)return console.warn("The byte offset must be possitive or 0"),null;if(a>=b.byteLength)return console.warn("The offset cannot be larger than the size of the buffer."),null;if(d instanceof Function&&!("BYTES_PER_ELEMENT"in d))return console.warn("ArrayType must be a typed array constructor function."),null;if(d.BYTES_PER_ELEMENT*c+a>b.byteLength)console.warn("The requested number of elements is too large for this buffer");else return b=b.slice(a,a+c*d.BYTES_PER_ELEMENT),new d(b)}},{key:"getTypedArrayInfo",
value:function(b){var a=null,d=!1;b instanceof Int8Array?(a="int",d=!1):b instanceof Uint8Array?(a="int",d=!0):b instanceof Uint8ClampedArray?(a="int",d=!0):b instanceof Int16Array?(a="int",d=!1):b instanceof Uint16Array?(a="int",d=!0):b instanceof Int32Array?(a="int",d=!1):b instanceof Uint32Array?(a="int",d=!0):b instanceof Float32Array?(a="float",d=!1):b instanceof Float64Array&&(a="float",d=!1);return{type:a,signed:d,bytesPerElements:b.BYTES_PER_ELEMENT,byteLength:b.byteLength,length:b.length}}},
{key:"howManyTypedArrayAttributes",value:function(b){var a=0;hd(b).forEach(function(d){a+=c.isTypedArray(d)});return a}},{key:"hasCircularReference",value:function(b){var a=!1;hd(b).forEach(function(d){this.circular&&(a=!0)});return a}},{key:"removeCircularReference",value:function(b){var a=!1;b=hd(b).map(function(d){this.circular&&(this.remove(),a=!0)});return a?b:null}},{key:"replaceTypedArrayAttributesByArrays",value:function(b){var a=!1;b=hd(b).map(function(d){if(c.isTypedArray(d)){for(var b=
Object.keys(d).length,e=Array(b),f=0;f<b;f++)e[f]=d[f];this.update(e);a=!0}});return a?b:null}},{key:"makeSerializeFriendly",value:function(b){var a=c.removeCircularReference(b);a&&(b=a);(a=c.replaceTypedArrayAttributesByArrays(b))&&(b=a);return b}}]);return c}(),id=function(c,b){if(!(c instanceof b))throw new TypeError("Cannot call a class as a function");},jd=function(){function c(b,a){for(var d=0;d<a.length;d++){var c=a[d];c.enumerable=c.enumerable||!1;c.configurable=!0;"value"in c&&(c.writable=
!0);Object.defineProperty(b,c.key,c)}}return function(b,a,d){a&&c(b.prototype,a);d&&c(b,d);return b}}(),Rg=function(){function c(){id(this,c);this._compress=!1;this.reset()}jd(c,[{key:"reset",value:function(){this._output=this._inputCase=this._input=null}},{key:"enableDataCompression",value:function(b){this._compress=b}},{key:"setInput",value:function(b){if(this._inputCase=c.isGoodCandidate(b))this._input=b}},{key:"getOutput",value:function(){return this._output}},{key:"run",value:function(){var b=
this._input;if(b&&this._inputCase){var a=b._data,d,c,e=[],f=!1;switch(this._inputCase){case 1:d=a;var k=this._getDataSubsetInfo(a);k.compressedByteLength=null;this._compress&&(d=Jc.deflate(d.buffer),k.compressedByteLength=d.byteLength);e.push(k);break;case 2:f=!0;c=[];d=Array(a.length);for(var l=0;l<a.length;l++){var m=a[l],k=this._getDataSubsetInfo(m);k.isTypedArray||(m=new Uint8Array(ea.objectToArrayBuffer(m)),k.byteLength=m.byteLength);if(this._compress){var n=Jc.deflate(m.buffer);k.compressedByteLength=
n.byteLength;c.push(n)}e.push(k);d[l]=m}this._compress&&(d=c);break;case 3:k=this._getDataSubsetInfo(a);d=new Uint8Array(ea.objectToArrayBuffer(a));k.byteLength=d.byteLength;this._compress&&(d=Jc.deflate(d),k.compressedByteLength=d.byteLength);e.push(k);break;default:console.warn("A problem occured.");return}l=ea.objectToArrayBuffer(b._metadata);b=ea.objectToArrayBuffer({byteStreamInfo:e,useMultipleDataStreams:f,originalBlockType:b.constructor.name,metadataByteLength:l.byteLength});b=[(new Uint8Array([+ea.isPlatformLittleEndian()])).buffer,
(new Uint32Array([b.byteLength])).buffer,b,l];if(f)for(l=0;l<d.length;l++)b.push(d[l].buffer);else b.push(d.buffer);this._output=ea.mergeBuffers(b)}else console.warn("An input must be given to the PixBlockEncoder.")}},{key:"_getDataSubsetInfo",value:function(b){ea.isTypedArray(b)?(b=ea.getTypedArrayInfo(b),b.isTypedArray=!0,b.compressedByteLength=null):b={type:b.constructor.name,compressedByteLength:null,byteLength:null,length:null,isTypedArray:!1};return b}}],[{key:"isGoodCandidate",value:function(b){if(!b)return console.warn("Input object cannot be null."),
!1;if(!("_metadata"in b))return console.warn("Input object must contain a _metadata object."),!1;if(!("_data"in b))return console.warn("Input object must contain a _data object."),!1;b=c.determineDataCase(b._data);null===b&&console.warn("The input is invalid.");return b}},{key:"determineDataCase",value:function(b){return b instanceof Object?ea.isTypedArray(b)?1:b instanceof Array?2:3:null}}]);return c}(),gj=function(){function c(){id(this,c);this.reset()}jd(c,[{key:"reset",value:function(){this._output=
this._input=null}},{key:"setInput",value:function(b){b instanceof ArrayBuffer?this._input=b:console.warn("Input should be a valid ArrayBuffer")}},{key:"getOutput",value:function(){return this._output}},{key:"run",value:function(){var b=this._input,a=new DataView(b);a.getUint8(0);var d=0;a.getUint8(0);for(var d=d+1,c=a.getUint32(1,d),d=d+4,a=b.slice(d,d+c),a=ea.ArrayBufferToObject(a),d=d+c,c=b.slice(d,d+a.metadataByteLength),c=ea.ArrayBufferToObject(c),d=d+a.metadataByteLength,e=[],f=0;f<a.byteStreamInfo.length;f++){var k=
a.byteStreamInfo[f].compressedByteLength,l=this._getDataTypeFromByteStreamInfo(a.byteStreamInfo[f]),m=a.byteStreamInfo[f].isTypedArray;if(k){var n=new Uint8Array(b,d,k),n=Jc.inflate(n),l=m?new l(n.buffer):ea.ArrayBufferToObject(n.buffer);e.push(l);d+=k}else m?l=ea.extractTypedArray(b,d,this._getDataTypeFromByteStreamInfo(a.byteStreamInfo[f]),a.byteStreamInfo[f].length):(k=ea.extractTypedArray(b,d,Uint8Array,a.byteStreamInfo[f].byteLength),l=ea.ArrayBufferToObject(k.buffer)),e.push(l),d+=a.byteStreamInfo[f].byteLength}a.useMultipleDataStreams||
(e=e[0]);this._output={originalBlockType:a.originalBlockType,_data:e,_metadata:c}}},{key:"_getDataTypeFromByteStreamInfo",value:function(b){var a="Object",d=ea.getGlobalObject();"int"===b.type?(a=b.signed?"Uint":"Int",a+=8*b.bytesPerElements+"Array"):"float"===b.type&&(a="Float"+(8*b.bytesPerElements+"Array"),d=ea.getGlobalObject());return d[a]}}]);return c}(),ce="undefined"!==typeof $a?$a:"undefined"!==typeof self?self:"undefined"!==typeof window?window:{},mb=Jf,nb=Kf;"function"===typeof ce.setTimeout&&
(mb=setTimeout);"function"===typeof ce.clearTimeout&&(nb=clearTimeout);var Xa=[],Tb=!1,Fb,Vc=-1;Nf.prototype.run=function(){this.fun.apply(null,this.array)};var ac=ce.performance||{},hj=ac.now||ac.mozNow||ac.msNow||ac.oNow||ac.webkitNow||function(){return(new Date).getTime()},ij=new Date,kd={nextTick:function(c){var b=Array(arguments.length-1);if(1<arguments.length)for(var a=1;a<arguments.length;a++)b[a-1]=arguments[a];Xa.push(new Nf(c,b));1!==Xa.length||Tb||Lf(Mf)},title:"browser",browser:!0,env:{},
argv:[],version:"",versions:{},on:Gb,addListener:Gb,once:Gb,off:Gb,removeListener:Gb,removeAllListeners:Gb,emit:Gb,binding:function(c){throw Error("process.binding is not supported");},cwd:function(){return"/"},chdir:function(c){throw Error("process.chdir is not supported");},umask:function(){return 0},hrtime:function(c){var b=.001*hj.call(ac),a=Math.floor(b),b=Math.floor(b%1*1E9);c&&(a-=c[0],b-=c[1],0>b&&(a--,b+=1E9));return[a,b]},platform:"browser",release:{},config:{},uptime:function(){return(new Date-
ij)/1E3}},Sg=kf(function(c){(function(){function b(a){a?(r[0]=r[16]=r[1]=r[2]=r[3]=r[4]=r[5]=r[6]=r[7]=r[8]=r[9]=r[10]=r[11]=r[12]=r[13]=r[14]=r[15]=0,this.blocks=r,this.buffer8=u):e?(a=new ArrayBuffer(68),this.buffer8=new Uint8Array(a),this.blocks=new Uint32Array(a)):this.blocks=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];this.h0=this.h1=this.h2=this.h3=this.start=this.bytes=0;this.finalized=this.hashed=!1;this.first=!0}var a="object"===("undefined"===typeof window?"undefined":O(window)),d=a?window:{};d.JS_MD5_NO_WINDOW&&
(a=!1);var a=!a&&"object"===("undefined"===typeof self?"undefined":O(self)),g=!d.JS_MD5_NO_NODE_JS&&"object"===("undefined"===typeof kd?"undefined":O(kd))&&kd.versions&&kd.versions.node;g?d=Xi:a&&(d=self);var a=!d.JS_MD5_NO_COMMON_JS&&!0&&c.exports,e=!d.JS_MD5_NO_ARRAY_BUFFER&&"undefined"!==typeof ArrayBuffer,f="0123456789abcdef".split(""),k=[128,32768,8388608,-2147483648],l=[0,8,16,24],m="hex array digest buffer arrayBuffer base64".split(" "),n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".split(""),
r=[],u;if(e){var p=new ArrayBuffer(68);u=new Uint8Array(p);r=new Uint32Array(p)}if(d.JS_MD5_NO_NODE_JS||!Array.isArray)Array.isArray=function(a){return"[object Array]"===Object.prototype.toString.call(a)};!e||!d.JS_MD5_NO_ARRAY_BUFFER_IS_VIEW&&ArrayBuffer.isView||(ArrayBuffer.isView=function(a){return"object"===("undefined"===typeof a?"undefined":O(a))&&a.buffer&&a.buffer.constructor===ArrayBuffer});var t=function(a){return function(d){return(new b(!0)).update(d)[a]()}},y=function(a){var d=eval("require('crypto')"),
b=eval("require('buffer').Buffer");return function(c){if("string"===typeof c)return d.createHash("md5").update(c,"utf8").digest("hex");if(null===c||void 0===c)throw"input is invalid type";c.constructor===ArrayBuffer&&(c=new Uint8Array(c));return Array.isArray(c)||ArrayBuffer.isView(c)||c.constructor===b?d.createHash("md5").update(new b(c)).digest("hex"):a(c)}};b.prototype.update=function(a){if(!this.finalized){var d,b="undefined"===typeof a?"undefined":O(a);if("string"!==b){if("object"===b){if(null===
a)throw"input is invalid type";if(e&&a.constructor===ArrayBuffer)a=new Uint8Array(a);else if(!(Array.isArray(a)||e&&ArrayBuffer.isView(a)))throw"input is invalid type";}else throw"input is invalid type";d=!0}for(var c=0,g,f=a.length,k=this.blocks,p=this.buffer8;c<f;){this.hashed&&(this.hashed=!1,k[0]=k[16],k[16]=k[1]=k[2]=k[3]=k[4]=k[5]=k[6]=k[7]=k[8]=k[9]=k[10]=k[11]=k[12]=k[13]=k[14]=k[15]=0);if(d)if(e)for(g=this.start;c<f&&64>g;++c)p[g++]=a[c];else for(g=this.start;c<f&&64>g;++c)k[g>>2]|=a[c]<<
l[g++&3];else if(e)for(g=this.start;c<f&&64>g;++c)b=a.charCodeAt(c),128>b?p[g++]=b:(2048>b?p[g++]=192|b>>6:(55296>b||57344<=b?p[g++]=224|b>>12:(b=65536+((b&1023)<<10|a.charCodeAt(++c)&1023),p[g++]=240|b>>18,p[g++]=128|b>>12&63),p[g++]=128|b>>6&63),p[g++]=128|b&63);else for(g=this.start;c<f&&64>g;++c)b=a.charCodeAt(c),128>b?k[g>>2]|=b<<l[g++&3]:(2048>b?k[g>>2]|=(192|b>>6)<<l[g++&3]:(55296>b||57344<=b?k[g>>2]|=(224|b>>12)<<l[g++&3]:(b=65536+((b&1023)<<10|a.charCodeAt(++c)&1023),k[g>>2]|=(240|b>>18)<<
l[g++&3],k[g>>2]|=(128|b>>12&63)<<l[g++&3]),k[g>>2]|=(128|b>>6&63)<<l[g++&3]),k[g>>2]|=(128|b&63)<<l[g++&3]);this.lastByteIndex=g;this.bytes+=g-this.start;64<=g?(this.start=g-64,this.hash(),this.hashed=!0):this.start=g}return this}};b.prototype.finalize=function(){if(!this.finalized){this.finalized=!0;var a=this.blocks,d=this.lastByteIndex;a[d>>2]|=k[d&3];56<=d&&(this.hashed||this.hash(),a[0]=a[16],a[16]=a[1]=a[2]=a[3]=a[4]=a[5]=a[6]=a[7]=a[8]=a[9]=a[10]=a[11]=a[12]=a[13]=a[14]=a[15]=0);a[14]=this.bytes<<
3;this.hash()}};b.prototype.hash=function(){var a,d,b,c,e,g=this.blocks;this.first?(a=g[0]-680876937,a=(a<<7|a>>>25)-271733879<<0,c=(-1732584194^a&2004318071)+g[1]-117830708,c=(c<<12|c>>>20)+a<<0,b=(-271733879^c&(a^-271733879))+g[2]-1126478375,b=(b<<17|b>>>15)+c<<0,d=(a^b&(c^a))+g[3]-1316259209):(a=this.h0,d=this.h1,b=this.h2,c=this.h3,a+=(c^d&(b^c))+g[0]-680876936,a=(a<<7|a>>>25)+d<<0,c+=(b^a&(d^b))+g[1]-389564586,c=(c<<12|c>>>20)+a<<0,b+=(d^c&(a^d))+g[2]+606105819,b=(b<<17|b>>>15)+c<<0,d+=(a^b&
(c^a))+g[3]-1044525330);d=(d<<22|d>>>10)+b<<0;a+=(c^d&(b^c))+g[4]-176418897;a=(a<<7|a>>>25)+d<<0;c+=(b^a&(d^b))+g[5]+1200080426;c=(c<<12|c>>>20)+a<<0;b+=(d^c&(a^d))+g[6]-1473231341;b=(b<<17|b>>>15)+c<<0;d+=(a^b&(c^a))+g[7]-45705983;d=(d<<22|d>>>10)+b<<0;a+=(c^d&(b^c))+g[8]+1770035416;a=(a<<7|a>>>25)+d<<0;c+=(b^a&(d^b))+g[9]-1958414417;c=(c<<12|c>>>20)+a<<0;b+=(d^c&(a^d))+g[10]-42063;b=(b<<17|b>>>15)+c<<0;d+=(a^b&(c^a))+g[11]-1990404162;d=(d<<22|d>>>10)+b<<0;a+=(c^d&(b^c))+g[12]+1804603682;a=(a<<7|
a>>>25)+d<<0;c+=(b^a&(d^b))+g[13]-40341101;c=(c<<12|c>>>20)+a<<0;b+=(d^c&(a^d))+g[14]-1502002290;b=(b<<17|b>>>15)+c<<0;d+=(a^b&(c^a))+g[15]+1236535329;d=(d<<22|d>>>10)+b<<0;a+=(b^c&(d^b))+g[1]-165796510;a=(a<<5|a>>>27)+d<<0;c+=(d^b&(a^d))+g[6]-1069501632;c=(c<<9|c>>>23)+a<<0;b+=(a^d&(c^a))+g[11]+643717713;b=(b<<14|b>>>18)+c<<0;d+=(c^a&(b^c))+g[0]-373897302;d=(d<<20|d>>>12)+b<<0;a+=(b^c&(d^b))+g[5]-701558691;a=(a<<5|a>>>27)+d<<0;c+=(d^b&(a^d))+g[10]+38016083;c=(c<<9|c>>>23)+a<<0;b+=(a^d&(c^a))+g[15]-
660478335;b=(b<<14|b>>>18)+c<<0;d+=(c^a&(b^c))+g[4]-405537848;d=(d<<20|d>>>12)+b<<0;a+=(b^c&(d^b))+g[9]+568446438;a=(a<<5|a>>>27)+d<<0;c+=(d^b&(a^d))+g[14]-1019803690;c=(c<<9|c>>>23)+a<<0;b+=(a^d&(c^a))+g[3]-187363961;b=(b<<14|b>>>18)+c<<0;d+=(c^a&(b^c))+g[8]+1163531501;d=(d<<20|d>>>12)+b<<0;a+=(b^c&(d^b))+g[13]-1444681467;a=(a<<5|a>>>27)+d<<0;c+=(d^b&(a^d))+g[2]-51403784;c=(c<<9|c>>>23)+a<<0;b+=(a^d&(c^a))+g[7]+1735328473;b=(b<<14|b>>>18)+c<<0;d+=(c^a&(b^c))+g[12]-1926607734;d=(d<<20|d>>>12)+b<<
0;e=d^b;a+=(e^c)+g[5]-378558;a=(a<<4|a>>>28)+d<<0;c+=(e^a)+g[8]-2022574463;c=(c<<11|c>>>21)+a<<0;e=c^a;b+=(e^d)+g[11]+1839030562;b=(b<<16|b>>>16)+c<<0;d+=(e^b)+g[14]-35309556;d=(d<<23|d>>>9)+b<<0;e=d^b;a+=(e^c)+g[1]-1530992060;a=(a<<4|a>>>28)+d<<0;c+=(e^a)+g[4]+1272893353;c=(c<<11|c>>>21)+a<<0;e=c^a;b+=(e^d)+g[7]-155497632;b=(b<<16|b>>>16)+c<<0;d+=(e^b)+g[10]-1094730640;d=(d<<23|d>>>9)+b<<0;e=d^b;a+=(e^c)+g[13]+681279174;a=(a<<4|a>>>28)+d<<0;c+=(e^a)+g[0]-358537222;c=(c<<11|c>>>21)+a<<0;e=c^a;b+=
(e^d)+g[3]-722521979;b=(b<<16|b>>>16)+c<<0;d+=(e^b)+g[6]+76029189;d=(d<<23|d>>>9)+b<<0;e=d^b;a+=(e^c)+g[9]-640364487;a=(a<<4|a>>>28)+d<<0;c+=(e^a)+g[12]-421815835;c=(c<<11|c>>>21)+a<<0;e=c^a;b+=(e^d)+g[15]+530742520;b=(b<<16|b>>>16)+c<<0;d+=(e^b)+g[2]-995338651;d=(d<<23|d>>>9)+b<<0;a+=(b^(d|~c))+g[0]-198630844;a=(a<<6|a>>>26)+d<<0;c+=(d^(a|~b))+g[7]+1126891415;c=(c<<10|c>>>22)+a<<0;b+=(a^(c|~d))+g[14]-1416354905;b=(b<<15|b>>>17)+c<<0;d+=(c^(b|~a))+g[5]-57434055;d=(d<<21|d>>>11)+b<<0;a+=(b^(d|~c))+
g[12]+1700485571;a=(a<<6|a>>>26)+d<<0;c+=(d^(a|~b))+g[3]-1894986606;c=(c<<10|c>>>22)+a<<0;b+=(a^(c|~d))+g[10]-1051523;b=(b<<15|b>>>17)+c<<0;d+=(c^(b|~a))+g[1]-2054922799;d=(d<<21|d>>>11)+b<<0;a+=(b^(d|~c))+g[8]+1873313359;a=(a<<6|a>>>26)+d<<0;c+=(d^(a|~b))+g[15]-30611744;c=(c<<10|c>>>22)+a<<0;b+=(a^(c|~d))+g[6]-1560198380;b=(b<<15|b>>>17)+c<<0;d+=(c^(b|~a))+g[13]+1309151649;d=(d<<21|d>>>11)+b<<0;a+=(b^(d|~c))+g[4]-145523070;a=(a<<6|a>>>26)+d<<0;c+=(d^(a|~b))+g[11]-1120210379;c=(c<<10|c>>>22)+a<<0;
b+=(a^(c|~d))+g[2]+718787259;b=(b<<15|b>>>17)+c<<0;d+=(c^(b|~a))+g[9]-343485551;d=(d<<21|d>>>11)+b<<0;this.first?(this.h0=a+1732584193<<0,this.h1=d-271733879<<0,this.h2=b-1732584194<<0,this.h3=c+271733878<<0,this.first=!1):(this.h0=this.h0+a<<0,this.h1=this.h1+d<<0,this.h2=this.h2+b<<0,this.h3=this.h3+c<<0)};b.prototype.hex=function(){this.finalize();var a=this.h0,d=this.h1,b=this.h2,c=this.h3;return f[a>>4&15]+f[a&15]+f[a>>12&15]+f[a>>8&15]+f[a>>20&15]+f[a>>16&15]+f[a>>28&15]+f[a>>24&15]+f[d>>4&
15]+f[d&15]+f[d>>12&15]+f[d>>8&15]+f[d>>20&15]+f[d>>16&15]+f[d>>28&15]+f[d>>24&15]+f[b>>4&15]+f[b&15]+f[b>>12&15]+f[b>>8&15]+f[b>>20&15]+f[b>>16&15]+f[b>>28&15]+f[b>>24&15]+f[c>>4&15]+f[c&15]+f[c>>12&15]+f[c>>8&15]+f[c>>20&15]+f[c>>16&15]+f[c>>28&15]+f[c>>24&15]};b.prototype.toString=b.prototype.hex;b.prototype.digest=function(){this.finalize();var a=this.h0,d=this.h1,b=this.h2,c=this.h3;return[a&255,a>>8&255,a>>16&255,a>>24&255,d&255,d>>8&255,d>>16&255,d>>24&255,b&255,b>>8&255,b>>16&255,b>>24&255,
c&255,c>>8&255,c>>16&255,c>>24&255]};b.prototype.array=b.prototype.digest;b.prototype.arrayBuffer=function(){this.finalize();var a=new ArrayBuffer(16),d=new Uint32Array(a);d[0]=this.h0;d[1]=this.h1;d[2]=this.h2;d[3]=this.h3;return a};b.prototype.buffer=b.prototype.arrayBuffer;b.prototype.base64=function(){for(var a,d,b,c="",e=this.array(),g=0;15>g;)a=e[g++],d=e[g++],b=e[g++],c+=n[a>>>2]+n[(a<<4|d>>>4)&63]+n[(d<<2|b>>>6)&63]+n[b&63];a=e[g];return c+=n[a>>>2]+n[a<<4&63]+"=="};p=function(){var a=t("hex");
g&&(a=y(a));a.create=function(){return new b};a.update=function(d){return a.create().update(d)};for(var d=0;d<m.length;++d){var c=m[d];a[c]=t(c)}return a}();a?c.exports=p:d.md5=p})()}),Tg=function(){function c(){id(this,c);this._compress=!0;this.reset()}jd(c,[{key:"reset",value:function(){this._inputs=[];this._output=null;this._options={madeWith:"pixbincodec_js",userObject:null,description:null}}},{key:"enableDataCompression",value:function(b){this._compress=b}},{key:"setOption",value:function(b,
a){b in this._options&&(this._options[b]=a)}},{key:"addInput",value:function(b){Rg.isGoodCandidate(b)&&this._inputs.push(b)}},{key:"getOutput",value:function(){return this._output}},{key:"run",value:function(){if(this._inputs.length){var b=this,a=new Date,d=ea.isPlatformLittleEndian(),g=new Rg,a={date:a.toISOString(),createdWith:this._options.madeWith,description:this._options.description,userObject:this._options.userObject,pixblocksInfo:[]},e=[],f=a.pixblocksInfo;this._inputs.forEach(function(a,
d){g.setInput(a);g.enableDataCompression(b._compress);g.run();var c=g.getOutput();c?(a={type:a.constructor.name,description:"description"in a._metadata?a._metadata.description:null,byteLength:c.byteLength,checksum:Sg(c)},f.push(a),e.push(c)):console.warn("The input of index "+d+" could not be encoded as a PixBlock.")});e.length||console.warn("No input was compatible for PixBlock encoding.");var a=ea.objectToArrayBuffer(a),k=c.MAGIC_NUMBER(),l=new ArrayBuffer(k.length+5),m=new DataView(l);ea.setString8InBuffer(k,
l);m.setUint8(k.length,+d);m.setUint32(k.length+1,a.byteLength,d);d=[l,a].concat(e);this._output=ea.mergeBuffers(d)}else console.warn("The encoder must be specified at least one input.")}}],[{key:"MAGIC_NUMBER",value:function(){return"PIXPIPE_PIXBIN"}}]);return c}(),jj=function(){function c(){id(this,c);this._verifyChecksum=!1;this._binMeta=this._output=this._input=null;this._parsingInfo={offsetToReachFirstBlock:-1,isLittleEndian:-1};this._decodedBlocks={};this._isValid=!1;this.reset()}jd(c,[{key:"setInput",
value:function(b){this.reset();b instanceof ArrayBuffer&&(this._input=b,this._isValid=this._parseIndex())}},{key:"isValid",value:function(){return this._isValid}},{key:"getOutput",value:function(){return this._output}},{key:"getNumberOfBlocks",value:function(){return this._binMeta.pixblocksInfo.length}},{key:"getBinCreationDate",value:function(){return this._binMeta.date}},{key:"getBinDescription",value:function(){return this._binMeta.description}},{key:"getBinUserObject",value:function(){return this._binMeta.userObject}},
{key:"getBlockDescription",value:function(b){return 0>b||b>=this.getNumberOfBlocks()?(console.warn("The block index is out of range."),null):this._binMeta.pixblocksInfo[b].description}},{key:"getBlockType",value:function(b){return 0>b||b>=this.getNumberOfBlocks()?(console.warn("The block index is out of range."),null):this._binMeta.pixblocksInfo[b].type}},{key:"reset",value:function(){this._isValid=!1;this._binMeta=this._output=this._input=null;this._parsingInfo={offsetToReachFirstBlock:-1,isLittleEndian:-1};
this._decodedBlocks={}}},{key:"enableBlockVerification",value:function(b){this._verifyChecksum=b}},{key:"_parseIndex",value:function(){var b=this._input;if(!b)return console.warn("Input cannot be null"),!1;var a=b.byteLength,d=Tg.MAGIC_NUMBER();if(a<d.length+5)return console.warn("This buffer does not match a PixBin file."),!1;var c=new DataView(b);if(ea.getString8FromBuffer(b,d.length)!==d)return console.warn("This file is not of PixBin type. (wrong magic number)"),!1;d=d.length;a=c.getUint8(d);
if(0!=a&&1!=a)return console.warn("This file is not of PixBin type. (wrong endianess code)"),!1;d+=1;c=c.getUint32(d,a);d+=4;b=ea.ArrayBufferToObject(b.slice(d,d+c));this._parsingInfo.offsetToReachFirstBlock=d+c;this._parsingInfo.isLittleEndian=a;this._binMeta=b;return!0}},{key:"fetchBlock",value:function(b){var a=1<arguments.length&&void 0!==arguments[1]?arguments[1]:!1,d=this.getNumberOfBlocks();if(0>b||b>=d)return console.warn("The block index is out of range."),null;if(b in this._decodedBlocks&&
!a)return this._decodedBlocks[b];a=this._parsingInfo.offsetToReachFirstBlock;for(d=0;d<b;d++)a+=this._binMeta.pixblocksInfo[d].byteLength;d=this._binMeta.pixblocksInfo[b];a=this._input.slice(a,a+d.byteLength);if(this._verifyChecksum&&Sg(a)!==d.checksum)return console.warn("The block #"+b+" is corrupted."),null;d=new gj;d.setInput(a);d.run();a=d.getOutput();return a?this._decodedBlocks[b]=a:(console.warn("The block #"+b+" could not be decoded."),null)}}]);return c}(),Ug=function(c){function b(){I(this,
b);var a=P(this,(b.__proto__||Object.getPrototypeOf(b)).call(this));a.setMetadata("targetType","*");a.addInputValidator(0,ArrayBuffer);a.setMetadata("blockVerification",!1);return a}L(b,c);N(b,[{key:"_run",value:function(){if(this.hasValidInput()){var a=this._getInput(),d=new jj;d.enableBlockVerification(this.getMetadata("blockVerification"));d.setInput(a);if(d.isValid()){for(var a={creationDate:d.getBinCreationDate(),description:d.getBinDescription(),userObject:d.getBinUserObject(),numberOfBlocks:d.getNumberOfBlocks()},
b=d.getNumberOfBlocks(),c=0,f=0;f<b;f++){var k=d.getBlockType(f);if(this._shouldDecodeType(k)){var l=d.fetchBlock(f),m=null,n=Za.getCoreType(k);n?(m=new n,m.setRawData(l._data),m.setRawMetadata(l._metadata)):(n=Jb.getGlobalObject(),k in n&&(m=new n[k],m._metadata=l._metadata,m._data=l._data));this._output[c]=m;c++}}b&&(this._output.PixBinMeta=a)}else console.warn("The input buffer is invalid.")}else console.warn("PixBinDecoder can only decode ArrayBuffer.")}},{key:"_shouldDecodeType",value:function(a){var d=
this.getMetadata("targetType");return"*"===d?!0:Array.isArray(d)?-1!=d.indexOf(a):a===d?!0:!1}}]);return b}(ra),bc=function(c){function b(){I(this,b);var a=P(this,(b.__proto__||Object.getPrototypeOf(b)).call(this));a._decoders=[];a.setMetadata("enablePixBin",!1);return a}L(b,c);N(b,[{key:"_run",value:function(){if(0===this._decoders.length)console.warn("No decoder was specified. Unable to continue.");else{var a=this._getInput(0);if(a){for(var d=!1,b=[],c=0;c<this._decoders.length;c++){var f=new this._decoders[c];
f.addInput(a);f.update();var k=f.getMetadata("targetType");-1===b.indexOf(k)&&b.push(k);if(f.getNumberOfOutputs()){d=!0;this._output[0]=f.getOutput();this.setMetadata("decoderConstructor",this._decoders[c]);this.setMetadata("decoderName",this._decoders[c].name);break}}if(!d&&this.getMetadata("enablePixBin")){this.setMetadata("targetType",b);var l=this,d=new Ug;d.setMetadata("targetType",this.getMetadata("targetType"));d.addInput(a);d.update();d.forEachOutput(function(a,d){l._output[a]=d})}}else console.warn("The input buffer must not be null.")}}}]);
return b}(ra),Vg=function(c){function b(){I(this,b);var a=P(this,(b.__proto__||Object.getPrototypeOf(b)).call(this));a.setMetadata("targetType",Ia.name);a.addInputValidator(0,ArrayBuffer);a.setMetadata("debug",!1);a._type_enum={INT8:1,UINT8:2,INT16:3,UINT16:4,INT32:5,UINT32:6,FLT:7,DBL:8,STR:9};a._type_matching="int8 uint8 int16 uint16 int32 uint32 float32 float64 undef".split(" ");a.type_sizes=[0,1,1,2,2,4,4,4,8,0];a._dv_offset=0;a._align=8;a._little_endian=!0;a._continuation_queue=[];a._dv=null;
a._superblk={};a._start_offset=0;a._huge_id=0;return a}L(b,c);N(b,[{key:"createLink",value:function(){return{hdr_offset:0,data_offset:0,data_length:0,n_filled:0,chunk_size:0,sym_btree:0,sym_lheap:0,name:"",attributes:{},children:[],array:void 0,type:-1,inflate:!1,dims:[]}}},{key:"startAlignment",value:function(){this._start_offset=this._dv_offset}},{key:"checkAlignment",value:function(){var a=this._dv_offset-this._start_offset;if(0!==a%this._align){var d=this._align-a%this._align;this._dv_offset+=
d;this.getMetadata("debug")&&console.log("skipping "+d+" bytes at "+a+" for alignmnent")}}},{key:"skip",value:function(a){this._dv_offset+=a}},{key:"seek",value:function(a){this._dv_offset=a}},{key:"tell",value:function(){return this._dv_offset}},{key:"getU8",value:function(){var a=this._dv.getUint8(this._dv_offset);this._dv_offset+=1;return a}},{key:"getU16",value:function(){var a=this._dv.getUint16(this._dv_offset,this._little_endian);this._dv_offset+=2;return a}},{key:"getU32",value:function(){var a=
this._dv.getUint32(this._dv_offset,this._little_endian);this._dv_offset+=4;return a}},{key:"getU64",value:function(){var a=this._dv.getUint64(this._dv_offset,this._little_endian);this._dv_offset+=8;return a}},{key:"getF32",value:function(){var a=this._dv.getFloat32(this._dv_offset,this._little_endian);this._dv_offset+=4;return a}},{key:"getF64",value:function(){var a=this._dv.getFloat64(this._dv_offset,this._little_endian);this._dv_offset+=8;return a}},{key:"getOffset",value:function(a){var d;a=a||
this._superblk.offsz;if(4===a)d=this._dv.getUint32(this._dv_offset,this._little_endian);else if(8===a)d=this._dv.getUint64(this._dv_offset,this._little_endian);else throw Error("Unsupported value for offset size "+a);this._dv_offset+=a;return d}},{key:"getLength",value:function(){var a=this._dv.getUint64(this._dv_offset,this._little_endian);this._dv_offset+=this._superblk.lensz;return a}},{key:"getString",value:function(a){var d="",b,c;for(b=0;b<a;b+=1){c=this.getU8();if(0===c){this._dv_offset+=a-
b-1;break}d+=String.fromCharCode(c)}return d}},{key:"getArray",value:function(a,d,b){var c=this._getInput(),g=this._dv_offset;b&&(this._dv_offset=b);switch(a){case this._type_enum.INT8:a=new Int8Array(c,this._dv_offset,d);break;case this._type_enum.UINT8:a=new Uint8Array(c,this._dv_offset,d);break;case this._type_enum.INT16:if(0!==this._dv_offset%2)for(a=new ArrayBuffer(d),d/=2,a=new Int16Array(a),c=0;c<d;c+=1)a[c]=this.getU16();else a=new Int16Array(c,this._dv_offset,d/2),this._dv_offset+=d;break;
case this._type_enum.UINT16:if(0!==this._dv_offset%2)for(a=new ArrayBuffer(d),d/=2,a=new Uint16Array(a),c=0;c<d;c+=1)a[c]=this.getU16();else a=new Uint16Array(c,this._dv_offset,d/2),this._dv_offset+=d;break;case this._type_enum.INT32:if(0!==this._dv_offset%4)for(a=new ArrayBuffer(d),d/=4,a=new Int32Array(a),c=0;c<d;c+=1)a[c]=this.getU32();else a=new Int32Array(c,this._dv_offset,d/4),this._dv_offset+=d;break;case this._type_enum.UINT32:if(0!==this._dv_offset%4)for(a=new ArrayBuffer(d),d/=4,a=new Uint32Array(a),
c=0;c<d;c+=1)a[c]=this.getU32();else a=new Uint32Array(c,this._dv_offset,d/4),this._dv_offset+=d;break;case this._type_enum.FLT:if(0!==this._dv_offset%4)for(a=new ArrayBuffer(d),d/=4,a=new Float32Array(a),c=0;c<d;c+=1)a[c]=this.getF32();else a=new Float32Array(c,this._dv_offset,d/4),this._dv_offset+=d;break;case this._type_enum.DBL:if(0!==this._dv_offset%8)for(a=new ArrayBuffer(d),d/=8,a=new Float64Array(a),c=0;c<d;c+=1)a[c]=this.getF64();else a=new Float64Array(c,this._dv_offset,d/8),this._dv_offset+=
d;break;default:throw Error("Bad type in this.getArray "+a);}b&&(this._dv_offset=g);return a}},{key:"getUXX",value:function(a){var d,b;switch(a){case 1:d=this._dv.getUint8(this._dv_offset);break;case 2:d=this._dv.getUint16(this._dv_offset,this._little_endian);break;case 4:d=this._dv.getUint32(this._dv_offset,this._little_endian);break;case 8:d=this._dv.getUint64(this._dv_offset,this._little_endian);break;default:if(d=0,this._little_endian)for(b=a-1;0<=b;b--)d=(d<<8)+this._dv.getUint8(this._dv_offset+
b);else for(b=0;b<a;b++)d=(d<<8)+this._dv.getUint8(this._dv_offset+b)}this._dv_offset+=a;return d}},{key:"checkSignature",value:function(a){var d;for(d=0;d<a.length;d+=1)if(this._dv.getUint8(this._dv_offset+d)!==a.charCodeAt(d))return!1;this.skip(a.length);return!0}},{key:"hdf5Superblock",value:function(){var a={};if(!this.checkSignature("\u0089HDF\r\n\u001a\n"))throw Error("Bad magic string in HDF5");a.sbver=this.getU8();if(2<a.sbver)throw Error("Unsupported HDF5 superblock version "+a.sbver);1>=
a.sbver?(a.fsver=this.getU8(),a.rgver=this.getU8(),this.skip(1),a.shver=this.getU8(),a.offsz=this.getU8(),a.lensz=this.getU8(),this.skip(1),a.gln_k=this.getU16(),a.gin_k=this.getU16(),a.cflags=this.getU32(),1===a.sbver&&(a.isin_k=this.getU16(),this.skip(2)),a.base_addr=this.getOffset(a.offsz),a.gfsi_addr=this.getOffset(a.offsz),a.eof_addr=this.getOffset(a.offsz),a.dib_addr=this.getOffset(a.offsz),a.root_ln_offs=this.getOffset(a.offsz),a.root_addr=this.getOffset(a.offsz),a.root_cache_type=this.getU32(),
this.skip(4),this.skip(16)):(a.offsz=this.getU8(),a.lensz=this.getU8(),a.cflags=this.getU8(),a.base_addr=this.getOffset(a.offsz),a.ext_addr=this.getOffset(a.offsz),a.eof_addr=this.getOffset(a.offsz),a.root_addr=this.getOffset(a.offsz),a.checksum=this.getU32());this.getMetadata("debug")&&console.log("HDF5 SB "+a.sbver+" "+a.offsz+" "+a.lensz+" "+a.cflags);return a}},{key:"hdf5FractalHeapHeader",value:function(){var a={};if(!this.checkSignature("FRHP"))throw Error("Bad or missing FRHP signature");a.ver=
this.getU8();a.idlen=this.getU16();a.iof_el=this.getU16();a.flags=this.getU8();a.objmax=this.getU32();a.objnid=this.getLength();a.objbta=this.getOffset();a.nf_blk=this.getLength();a.af_blk=this.getOffset();a.heap_total=this.getLength();a.heap_alloc=this.getLength();a.bai_offset=this.getLength();a.heap_nobj=this.getLength();a.heap_chuge=this.getLength();a.heap_nhuge=this.getLength();a.heap_ctiny=this.getLength();a.heap_ntiny=this.getLength();a.table_width=this.getU16();a.start_blksz=this.getLength();
a.max_blksz=this.getLength();a.max_heapsz=this.getU16();a.rib_srows=this.getU16();a.root_addr=this.getOffset();a.rib_crows=this.getU16();var d=Math.log2(a.max_blksz)-Math.log2(a.start_blksz)+2;a.K=Math.min(a.rib_crows,d)*a.table_width;a.N=a.rib_crows<d?0:a.K-d*a.table_width;this.getMetadata("debug")&&(console.log("FRHP V"+a.ver+" F"+a.flags+" "+a.objbta+" Total:"+a.heap_total+" Alloc:"+a.heap_alloc+" #obj:"+a.heap_nobj+" width:"+a.table_width+" start_blksz:"+a.start_blksz+" max_blksz:"+a.max_blksz+
" "+a.max_heapsz+" srows:"+a.rib_srows+" crows:"+a.rib_crows+" "+a.heap_nhuge),console.log("   K: "+a.K+" N: "+a.N));if(0<a.iof_el)throw Error("Filters present in fractal heap.");return a}},{key:"hdf5V2BtreeHeader",value:function(){var a={};if(!this.checkSignature("BTHD"))throw Error("Bad or missing BTHD signature");a.ver=this.getU8();a.type=this.getU8();a.nodesz=this.getU32();a.recsz=this.getU16();a.depth=this.getU16();a.splitp=this.getU8();a.mergep=this.getU8();a.root_addr=this.getOffset();a.root_nrec=
this.getU16();a.total_nrec=this.getLength();a.checksum=this.getU32();this.getMetadata("debug")&&console.log("BTHD V"+a.ver+" T"+a.type+" "+a.nodesz+" "+a.recsz+" "+a.depth+" "+a.root_addr+" "+a.root_nrec+" "+a.total_nrec);return a}},{key:"hdf5V2BtreeRecords",value:function(a,d,b,c){var e,g,l;if(1===d)for(d=0;d<b;d++)g=this.getOffset(),l=this.getLength(),a=this.getLength(),this.getMetadata("debug")&&console.log("  -> "+g+" "+l+" "+a+" "+this._this._huge_id),e=this.tell(),a===this._this._huge_id&&(this.seek(g),
this.hdf5MsgAttribute(l,c)),this.seek(e);else if(8===d){var m,n;m=a.max_heapsz/8;d=Math.min(a.objmax,a.max_blksz);n=256>=d?1:65536>=d?2:4;for(d=0;d<b;d++){e=this.getU8();if(0!==(e&192))throw Error("Bad Fractal Heap ID version "+e);var r=e&48,u;if(16===r)this._this._huge_id=this.getUXX(7);else if(0===r)g=this.getUXX(m),l=this.getUXX(n);else throw Error("Can't handle this Heap ID: "+e);u=this.getU8();this.getU32();this.getU32();this.getMetadata("debug")&&console.log("  -> "+e+" "+g+" "+l+" "+u);e=this.tell();
if(16===r)if(this.seek(a.objbta),r=this.hdf5V2BtreeHeader(),1===r.type)this.seek(r.root_addr),this.hdf5V2BtreeLeafNode(a,r.root_nrec,c);else throw Error("Can only handle type-1 btrees");else r=this.hdf5FractalHeapOffset(a,g),this.seek(r),this.hdf5MsgAttribute(l,c);this.seek(e)}}else throw Error("Unhandled V2 btree type.");}},{key:"hdf5V2BtreeLeafNode",value:function(a,d,b){if(!this.checkSignature("BTLF"))throw Error("Bad or missing BTLF signature");var c=this.getU8(),g=this.getU8();this.getMetadata("debug")&&
console.log("BTLF V"+c+" T"+g+" "+this.tell());this.hdf5V2BtreeRecords(a,g,d,b)}},{key:"hdf5V2BtreeInternalNode",value:function(a,d,b,c){if(!this.checkSignature("BTIN"))throw Error("Bad or missing BTIN signature");var e=this.getU8(),g=this.getU8();this.getMetadata("debug")&&console.log("BTIN V"+e+" T"+g);this.hdf5V2BtreeRecords(a,g,d,c);for(a=0;a<=d;a++){c=this.getOffset();var e=this.getUXX(1),l;1<b&&(l=this.getUXX(1));this.getMetadata("debug")&&console.log(" child->"+c+" "+e+" "+l)}}},{key:"hdf5GetMsgName",
value:function(a){var d="NIL;Dataspace;LinkInfo;Datatype;FillValue 1;FillValue 2;Link;ExternalFiles;Layout;BOGUS;GroupInfo;FilterPipeline;Attribute;ObjectComment;ObjectModTime 1;SharedMsgTable;ObjHdrContinue;SymbolTable;ObjectModTime 2;BtreeKValue;DriverInfo;AttrInfo;ObjectRefCnt;MESSAGE23;FileSpaceInfo".split(";");if(a<d.length)return d[a];throw Error("Unknown message type "+a+" "+this.tell());}},{key:"hdf5V1BtreeNode",value:function(a){var d=this._getInput(),b,c={};if(!this.checkSignature("TREE"))throw Error("Bad TREE signature at "+
this.tell());c.keys=[];c.node_type=this.getU8();c.node_level=this.getU8();c.entries_used=this.getU16();c.left_sibling=this.getOffset();c.right_sibling=this.getOffset();this.getMetadata("debug")&&console.log("BTREE type "+c.node_type+" lvl "+c.node_level+" n_used "+c.entries_used+" "+c.left_sibling+" "+c.right_sibling);if(a){var f,k=[];for(b=0;b<c.entries_used;b+=1){c.keys[b]={};k[b]={};k[b].chunk_size=this.getU32();k[b].filter_mask=this.getU32();k[b].chunk_offsets=[];for(f=0;f<a.dims.length+1;f+=
1)k[b].chunk_offsets.push(this.getU64());c.keys[b].child_address=this.getOffset();b<c.entries_used&&this.getMetadata("debug")&&console.log("  BTREE "+b+" chunk_size "+k[b].chunk_size+" filter_mask "+k[b].filter_mask+" addr "+c.keys[b].child_address)}k[b]={};k[b].chunk_size=this.getU32();k[b].filter_mask=this.getU32();k[b].chunk_offsets=[];for(f=0;f<a.dims.length+1;f+=1)k[b].chunk_offsets.push(this.getU64());if(0===c.node_level){var l;for(b=0;b<c.entries_used;b+=1)if(f=k[b].chunk_size,l=c.keys[b].child_address,
a.inflate){f=new Uint8Array(d,l,f);l=Ca.inflate(f);switch(a.type){case this._type_enum.INT8:l=new Int8Array(l.buffer);break;case this._type_enum.UINT8:l=new Uint8Array(l.buffer);break;case this._type_enum.INT16:l=new Int16Array(l.buffer);break;case this._type_enum.UINT16:l=new Uint16Array(l.buffer);break;case this._type_enum.INT32:l=new Int32Array(l.buffer);break;case this._type_enum.UINT32:l=new Uint32Array(l.buffer);break;case this._type_enum.FLT:l=new Float32Array(l.buffer);break;case this._type_enum.DBL:l=
new Float64Array(l.buffer);break;default:throw Error("Unknown type code "+a.type);}a.array.length-a.n_filled<l.length&&(l=l.subarray(0,a.array.length-a.n_filled));a.array.set(l,a.n_filled);a.n_filled+=l.length;this.getMetadata("debug")&&console.log(a.name+" "+f.length+" "+l.length+" "+a.n_filled+"/"+a.array.length)}else l=this.getArray(a.type,f,l),a.array.set(l,a.n_filled),a.n_filled+=l.length}else for(b=0;b<c.entries_used;b+=1)this.seek(c.keys[b].child_address),this.hdf5V1BtreeNode(a)}else for(b=
0;b<c.entries_used;b+=1)c.keys[b]={},c.keys[b].key_value=this.getLength(),c.keys[b].child_address=this.getOffset(),this.getMetadata("debug")&&console.log("  BTREE "+b+" key "+c.keys[b].key_value+" adr "+c.keys[b].child_address);return c}},{key:"hdf5GroupSymbolTable",value:function(a,d){if(!this.checkSignature("SNOD"))throw Error("Bad or missing SNOD signature");var b=this.getU8();this.skip(1);var c=this.getU16();this.getMetadata("debug")&&console.log("this.hdf5GroupSymbolTable V"+b+" #"+c+" '"+d.name+
"'");for(var f,k,l,m,n,b=0;b<2*this._superblk.gln_k;b+=1)f=this.getOffset(),k=this.getOffset(),l=this.getU32(),this.skip(20),b<c&&(m=this.createLink(),m.hdr_offset=k,a&&(n=this.tell(),this.seek(a.lh_dseg_off+f),m.name=this.getString(a.lh_dseg_len),this.seek(n)),this.getMetadata("debug")&&console.log("    "+b+" O "+f+" A "+k+" T "+l+" '"+m.name+"'"),d.children.push(m))}},{key:"hdf5LocalHeap",value:function(){var a={};if(!this.checkSignature("HEAP"))throw Error("Bad or missing HEAP signature");a.lh_ver=
this.getU8();this.skip(3);a.lh_dseg_len=this.getLength();a.lh_flst_len=this.getLength();a.lh_dseg_off=this.getOffset();this.getMetadata("debug")&&console.log("LHEAP V"+a.lh_ver+" "+a.lh_dseg_len+" "+a.lh_flst_len+" "+a.lh_dseg_off);return a}},{key:"hdf5MsgDataspace",value:function(a,d){var b,c=this.getU8(),f=this.getU8(),k=this.getU8();1>=c?this.skip(5):this.skip(1);var l=1,m=[],n;for(n=0;n<f;n+=1)m[n]=this.getLength(),l*=m[n];b=f*this._superblk.lensz+(1>=c?8:4);if(0!==(k&1))for(b+=f*this._superblk.lensz,
n=0;n<f;n+=1)this.getLength();if(0!==(k&2))for(b+=f*this._superblk.lensz,n=0;n<f;n+=1)this.getLength();c="this.hdf5MsgDataspace V"+c+" N"+f+" F"+k;this.getMetadata("debug")&&(0!==f&&(c+="["+m.join(", ")+"]"),console.log(c));b<a&&this.skip(a-b);d&&(d.dims=m);return l}},{key:"hdf5MsgLinkInfo",value:function(a){var d=this,b=this.getU8(),c=this.getU8();0!==(c&1)&&this.getU64();var f=this.getOffset(),k=this.getOffset();0!==(c&2)&&this.getOffset();this.getMetadata("debug")&&console.log("this.hdf5MsgLinkInfo V"+
b+" F"+c+" FH "+f+" BT "+k);b=this.tell();if(f<this._superblk.eof_addr){this.seek(f);var l=this.hdf5FractalHeapHeader(),m=0;this.hdf5FractalHeapEnumerate(l,function(b,c,e,g){for(b=c+g;m<l.heap_nobj&&d.tell()<b;)d.hdf5MsgLink(a),m+=1;return!0})}this.seek(b)}},{key:"dt_class_name",value:function(a){var d="Fixed-Point Floating-Point Time String BitField Opaque Compound Reference Enumerated Variable-Length Array".split(" ");if(a<d.length)return d[a];throw Error("Unknown datatype class: "+a);}},{key:"hdf5MsgDatatype",
value:function(a){var d={},b=8,c,f,k,l,m,n,r,u,p=this.getU8();c=p>>4;f=p&15;l=[];for(p=0;3>p;p+=1)l[p]=this.getU8();p=this.getU32();this.getMetadata("debug")&&console.log("this.hdf5MsgDatatype V"+c+" C"+f+" "+this.dt_class_name(f)+" "+l[0]+"."+l[1]+"."+l[2]+" "+p);switch(f){case 0:f=this.getU16();k=this.getU16();switch(p){case 4:d.typ_type=l[0]&8?this._type_enum.INT32:this._type_enum.UINT32;break;case 2:d.typ_type=l[0]&8?this._type_enum.INT16:this._type_enum.UINT16;break;case 1:d.typ_type=l[0]&8?
this._type_enum.INT8:this._type_enum.UINT8;break;default:throw Error("Unknown type size "+p);}d.typ_length=p;b+=4;this.getMetadata("debug")&&console.log("  ("+f+" "+k+")");break;case 1:c="";if(this.getMetadata("debug"))switch(l[0]&65){case 0:c+="LE ";break;case 1:c+="BE ";break;case 65:c+="VX ";break;default:throw Error("Reserved fp byte order: "+l[0]);}f=this.getU16();k=this.getU16();l=this.getU8();m=this.getU8();n=this.getU8();r=this.getU8();u=this.getU32();this.getMetadata("debug")&&(c+=f+" "+
k+" "+l+" "+m+" "+n+" "+r+" "+u);if(64===k&&0===f&&52===l&&11===m&&0===n&&52===r&&1023===u&&8===p)d.typ_type=this._type_enum.DBL;else if(32===k&&0===f&&23===l&&8===m&&0===n&&23===r&&127===u&&4===p)d.typ_type=this._type_enum.FLT;else throw Error("Unsupported floating-point type");this.getMetadata("debug")&&console.log(c);d.typ_length=p;b+=12;break;case 3:d.typ_type=this._type_enum.STR;d.typ_length=p;break;default:throw Error("Unimplemented HDF5 data class "+f);}a>b&&this.skip(a-b);return d}},{key:"hdf5MsgLayout",
value:function(a){var d="",b=this.getU8(),c,f,k,l=[];k=1;if(1===b||2===b){f=this.getU8();c=this.getU8();this.skip(5);this.getMetadata("debug")&&(d+="this.hdf5MsgLayout V"+b+" N"+f+" C"+c);if(1===c||2===c)b=this.getOffset(),this.getMetadata("debug")&&(d+=" A"+b),a.data_offset=b;for(b=0;b<f;b+=1)l[b]=this.getU32(),k*=l[b];this.getMetadata("debug")&&(d+="["+l.join(", ")+"]");2===c&&(f=this.getU32(),a.chunk_size=k*f,this.getMetadata("debug")&&(d+=" E"+f));0===c?(k=this.getU32(),this.getMetadata("debug")&&
(d+="("+k+")"),a.data_offset=this.tell(),a.data_length=k):1===c&&(a.data_length=k)}else if(3===b)if(c=this.getU8(),d="this.hdf5MsgLayout V"+b+" C"+c,0===c)k=this.getU16(),this.getMetadata("debug")&&(d+="("+k+")"),a.data_offset=this.tell(),a.data_length=k;else if(1===c)c=this.getOffset(),k=this.getLength(),this.getMetadata("debug")&&(d+="("+c+", "+k+")"),a.data_offset=c,a.data_length=k;else{if(2===c){f=this.getU8();c=this.getOffset();a.data_offset=c;a.chunk_size=1;for(b=0;b<f-1;b+=1)l[b]=this.getU32(),
k*=l[b];this.getMetadata("debug")&&(d+="(N"+f+", A"+c+" ["+l.join(",")+"]");f=this.getU32();a.chunk_size=k*f;this.getMetadata("debug")&&(d+=" E"+f)}}else throw Error("Illegal layout version "+b);this.getMetadata("debug")&&console.log(d)}},{key:"hdf5MsgPipeline",value:function(a){var d=this.getU8(),b=this.getU8(),c="this.hdf5MsgPipeline V"+d+" N"+b;1===d&&this.skip(6);this.getMetadata("debug")&&console.log(c);for(var f,k,l,m,c=0;c<b;c+=1){f=this.getU16();if(1!==f)throw Error("Unimplemented HDF5 filter "+
f);if("object"!==("undefined"===typeof Ca?"undefined":O(Ca)))throw Error("Need pako to inflate data.");a.inflate=!0;k=1===d||256<f?this.getU16():0;l=this.getU16();m=this.getU16();0!==(m&1)&&(m+=1);0!==k&&this.skip(k);this.skip(4*m);this.getMetadata("debug")&&console.log("  "+c+" ID"+f+" F"+l+" "+m)}}},{key:"hdf5MsgAttribute",value:function(a,d){var b=this.getU8(),c=this.getU8(),f=this.getU16(),k=this.getU16(),l=this.getU16(),m="this.hdf5MsgAttribute V"+b+" F"+c+" "+a+": ";if(0!==(c&3))throw Error("Shared dataspaces and datatypes are not supported.");
3===b&&(c=this.getU8(),this.getMetadata("debug")&&(m+=0===c?"ASCII":"UTF-8"));this.getMetadata("debug")&&(m+="("+f+" "+k+" "+l+")");3>b&&(f=8*Math.floor((f+7)/8),k=8*Math.floor((k+7)/8),l=8*Math.floor((l+7)/8),this.getMetadata("debug")&&(m+="/("+f+" "+k+" "+l+")"));c=this.getString(f);this.getMetadata("debug")&&console.log(m+(" Name: "+c));var m=this.hdf5MsgDatatype(k),n=this.hdf5MsgDataspace(l);a=0<a?3>b?a-(8+f+k+l):a-(9+f+k+l):m.typ_length*n;this.getMetadata("debug")&&console.log("  attribute data size "+
a+" "+this.tell());a=m.typ_type===this._type_enum.STR?this.getString(a):this.getArray(m.typ_type,a);d.attributes[c]=a}},{key:"hdf5MsgGroupInfo",value:function(){var a=4,d=8,b=this.getU8(),c=this.getU8();0!==(c&1)&&(this.getU16(),this.getU16());0!==(c&2)&&(a=this.getU16(),d=this.getU16());this.getMetadata("debug")&&console.log("this.hdf5MsgGroupInfo V"+b+" F"+c+" ENT "+a+" LNL "+d)}},{key:"hdf5MsgLink",value:function(a){var d=this.getU8(),b=0;if(1!==d)throw Error("Bad link message version "+d);var c=
this.getU8();0!==(c&8)&&(b=this.getU8());0!==(c&4)&&this.getU64();0!==(c&16)&&this.getU8();var f=this.getUXX(1<<(c&3)),k=this.createLink();k.name=this.getString(f);0===(c&8)&&(k.hdr_offset=this.getOffset());this.getMetadata("debug")&&console.log("this.hdf5MsgLink V"+d+" F"+c+" T"+b+" NM "+k.name+" OF "+k.hdr_offset);a.children.push(k)}},{key:"hdf5FractalHeapDirectBlock",value:function(a,d,b,c){if(!this.checkSignature("FHDB"))throw Error("Bad or missing FHDB signature");var e=this.getU8();if(0!==e)throw Error("Bad FHDB version: "+
e);this.getOffset();var g=this.getUXX(Math.ceil(a.max_heapsz/8));0!==(a.flags&2)&&this.getU32();this.getMetadata("debug")&&console.log("FHDB V:"+e+" R:"+d+" O:"+g+" A:"+b);a=1>=d?a.start_blksz:Math.pow(2,d-1)*a.start_blksz;return c?c(d,b,g,a):!0}},{key:"hdf5FractalHeapIndirectBlock",value:function(a,d){if(!this.checkSignature("FHIB"))throw Error("Bad or missing FHIB signature");var b=this.getU8();if(0!==b)throw Error("Bad FHIB version: "+b);this.getOffset();var c=this.getUXX(Math.ceil(a.max_heapsz/
8));this.getMetadata("debug")&&console.log("FHIB V:"+b+" O:"+c);for(var f=[],b=0;b<a.K;b+=1)c=this.getOffset(),c<this._superblk.eof_addr&&(this.getMetadata("debug")&&console.log("direct block at "+c),f.push(c));for(var k=[],b=0;b<a.N;b+=1)c=this.getOffset(),c<this._superblk.eof_addr&&(this.getMetadata("debug")&&console.log("indirect block at "+c),k.push(c));this.getU32();for(b=0;b<f.length;b++)if(this.seek(f[b]),!this.hdf5FractalHeapDirectBlock(a,b/a.table_width,f[b],d))return!1;for(b=0;b<k.length;b++)if(this.seek(k[b]),
!this.hdf5FractalHeapIndirectBlock(a,d))return!1;return!0}},{key:"hdf5FractalHeapEnumerate",value:function(a,d){this.seek(a.root_addr);0===a.K?this.hdf5FractalHeapDirectBlock(a,0,a.root_addr,d):this.hdf5FractalHeapIndirectBlock(a,d)}},{key:"hdf5FractalHeapOffset",value:function(a,d){var b;this.hdf5FractalHeapEnumerate(a,function(a,c,g,l){return d>=g&&d<g+l?(b=c+(d-g),!1):!0});return b}},{key:"hdf5MsgAttrInfo",value:function(a){var d=this.getU8();if(0!==d)throw Error("Bad attribute information message version: "+
d);var b=this.getU8();0!==(b&1)&&this.getU16();var c=this.getOffset(),f=this.getOffset();0!==(b&2)&&this.getOffset();this.getMetadata("debug")&&console.log("this.hdf5MsgAttrInfo V"+d+" F"+b+" HP "+c+" AN "+f);var d=this.tell(),k;c<this._superblk.eof_addr&&(this.seek(c),k=this.hdf5FractalHeapHeader());if(f<this._superblk.eof_addr){this.seek(f);c=this.hdf5V2BtreeHeader();if(8!==c.type)throw Error("Can only handle indexed attributes.");this.seek(c.root_addr);0<c.depth?this.hdf5V2BtreeInternalNode(k,
c.root_nrec,c.depth,a):this.hdf5V2BtreeLeafNode(k,c.root_nrec,a)}this.seek(d)}},{key:"hdf5ProcessMessage",value:function(a,d){var b={};switch(a.hm_type){case 1:this.hdf5MsgDataspace(a.hm_size,d);break;case 2:this.hdf5MsgLinkInfo(d);break;case 3:a=this.hdf5MsgDatatype(a.hm_size);d&&(d.type=a.typ_type);break;case 6:this.hdf5MsgLink(d);break;case 8:this.hdf5MsgLayout(d);break;case 10:this.hdf5MsgGroupInfo();break;case 11:this.hdf5MsgPipeline(d);break;case 12:this.hdf5MsgAttribute(a.hm_size,d);break;
case 16:b.cq_off=this.getOffset();b.cq_len=this.getLength();this._continuation_queue.push(b);this.getMetadata("debug")&&console.log("hdf5MsgObjHdrContinue "+b.cq_off+" "+b.cq_len);break;case 17:d.sym_btree=this.getOffset();d.sym_lheap=this.getOffset();this.getMetadata("debug")&&console.log("hdf5MsgSymbolTable "+d.sym_btree+" "+d.sym_lheap);break;case 21:this.hdf5MsgAttrInfo(d);break;case 0:case 4:case 5:case 7:case 18:case 19:case 20:case 22:case 24:this.skip(a.hm_size);break;default:throw Error("Unknown message type: "+
a.hm_type);}}},{key:"hdf5V2ObjectHeader",value:function(a){if(!this.checkSignature("OHDR"))throw Error("Bad or missing OHDR signature");var d=this,b=this.getU8(),c=this.getU8();0!==(c&32)&&(this.getU32(),this.getU32(),this.getU32(),this.getU32());0!==(c&16)&&(this.getU16(),this.getU16());var f=this.getUXX(1<<(c&3)),k=0,l=0,m=f;for(this.getMetadata("debug")&&console.log("this.hdf5V2ObjectHeader V"+b+" F"+c+" HS"+f);;){for(;8<=m-l;)b={},b.hm_type=this.getU8(),b.hm_size=this.getU16(),b.hm_flags=this.getU8(),
this.getMetadata("debug")&&console.log("  msg"+k+" F"+b.hm_flags+" T "+b.hm_type+" S "+b.hm_size+" ("+l+"/"+m+") "+this.hdf5GetMsgName(b.hm_type)),0!==(c&4)&&(b.hm_corder=this.getU16()),f=this.tell(),this.hdf5ProcessMessage(b,a),this.seek(f+b.hm_size),l+=b.hm_size+4,k+=1;4<m-l&&this.skip(m-(l+4));this.getU32();if(0!==this._continuation_queue.length){if(b=this._continuation_queue.shift(),this.seek(b.cq_off),m=b.cq_len-4,l=0,this.getMetadata("debug")&&console.log("continuing with "+b.cq_len+" bytes at "+
this.tell()),!this.checkSignature("OCHK"))throw Error("Bad v2 object continuation");}else break}a.children.forEach(function(a,b){d.seek(a.hdr_offset);d.getMetadata("debug")&&console.log(b+" "+a.hdr_offset+" "+a.name);d.checkSignature("OHDR")?(d.seek(a.hdr_offset),d.hdf5V2ObjectHeader(a)):(d.seek(a.hdr_offset),d.hdf5V1ObjectHeader(a))})}},{key:"loadData",value:function(a){var d=this;if(0!==a.chunk_size){this.seek(a.data_offset);var b=1,c;for(c=0;c<a.dims.length;c+=1)b*=a.dims[c];b*=this.typeSize(a.type);
this.getMetadata("debug")&&console.log("allocating "+b+" bytes");b=new ArrayBuffer(b);a.n_filled=0;switch(a.type){case this._type_enum.INT8:a.array=new Int8Array(b);break;case this._type_enum.UINT8:a.array=new Uint8Array(b);break;case this._type_enum.INT16:a.array=new Int16Array(b);break;case this._type_enum.UINT16:a.array=new Uint16Array(b);break;case this._type_enum.INT32:a.array=new Int32Array(b);break;case this._type_enum.UINT32:a.array=new Uint32Array(b);break;case this._type_enum.FLT:a.array=
new Float32Array(b);break;case this._type_enum.DBL:a.array=new Float64Array(b);break;default:throw Error("Illegal type: "+a.type);}this.hdf5V1BtreeNode(a)}else 0<a.data_offset&&a.data_offset<this._superblk.eof_addr?(this.getMetadata("debug")&&console.log("loading "+a.data_length+" bytes from "+a.data_offset+" to "+a.name),a.array=this.getArray(a.type,a.data_length,a.data_offset)):this.getMetadata("debug")&&console.log("data not present for /"+a.name+"/");a.children.forEach(function(a){d.loadData(a)})}},
{key:"hdf5V1ObjectHeader",value:function(a){var d=this,b,c,f,k;this.startAlignment();b=this.getU8();this.skip(1);c=this.getU16();f=this.getU32();k=this.getU32();if(1!==b)throw Error("Bad v1 object header version: "+b);this.getMetadata("debug")&&console.log("this.hdf5V1ObjectHeader V"+b+" #M "+c+" RC "+f+" HS "+k);f=k;var l;for(b=0;b<c;b+=1){if(8>=f)if(0!==this._continuation_queue.length)f=this._continuation_queue.shift(),this.seek(f.cq_off),f=f.cq_len,this.getMetadata("debug")&&console.log("continuing with "+
f+" bytes at "+this.tell()),this.startAlignment();else break;this.checkAlignment();k={};k.hm_type=this.getU16();k.hm_size=this.getU16();k.hm_flags=this.getU8();if(0!==k.hm_size%8)throw Error("Size is not 8-byte aligned: "+k.hm_size);this.skip(3);f-=8+k.hm_size;this.getMetadata("debug")&&console.log("  msg"+b+" F "+k.hm_flags+" T "+k.hm_type+" S "+k.hm_size+"("+f+") "+this.hdf5GetMsgName(k.hm_type));l=this.tell();this.hdf5ProcessMessage(k,a);this.seek(l+k.hm_size)}if(0!==a.sym_btree&&0!==a.sym_lheap){this.seek(a.sym_btree);
c=this.hdf5V1BtreeNode();this.seek(a.sym_lheap);b=this.hdf5LocalHeap();for(f=0;f<c.entries_used;f+=1)this.seek(c.keys[f].child_address),this.checkSignature("SNOD")?(this.seek(c.keys[f].child_address),this.hdf5GroupSymbolTable(b,a)):(this.seek(c.keys[f].child_address),this.hdf5V1ObjectHeader(a));a.children.forEach(function(a){d.seek(a.hdr_offset);d.hdf5V1ObjectHeader(a)})}}},{key:"getTypeMatchMinc",value:function(a){return this._type_matching[a-1]}},{key:"defined",value:function(a){return"undefined"!==
typeof a}},{key:"typeName",value:function(a){return this.defined(a)?a.constructor.name:"undefined"}},{key:"typeSize",value:function(a){if(a>=this._type_enum.INT8&&a<this.type_sizes.length)return this.type_sizes[a];throw Error("Unknown type "+a);}},{key:"typeIsFloat",value:function(a){return a>=this._type_enum.FLT&&a<=this._type_enum.DBL}},{key:"join",value:function(a,d){var b="";if(a&&a.length){var c;for(c=0;c<a.length-1;c+=1)b+=a[c],b+=d;b+=a[c]}return b}},{key:"printStructure",value:function(a,
d){var b=this,c,f="";for(c=0;c<2*d;c+=1)f+=" ";f+=a.name+(a.children.length?"/":"");0<a.type&&(f+=" "+this.typeName(a.array),a.dims.length&&(f+="["+a.dims.join(", ")+"]"),f=a.array?f+(":"+a.array.length):f+" NULL");console.log(f);Object.keys(a.attributes).forEach(function(e){var g=a.attributes[e];f="";for(c=0;c<2*d+1;c+=1)f+=" ";f+=a.name+":"+e+" "+b.typeName(g)+"["+g.length+"] ";"string"===typeof g?f+=JSON.stringify(g):(f+="{"+b.join(g.slice(0,16),", "),16<g.length&&(f+=", ..."),f+="}");console.log(f)});
a.children.forEach(function(a){b.printStructure(a,d+1)})}},{key:"findDataset",value:function(a,d,b){var c=this,g;a&&a.name===d&&0<a.type?g=a:a.children.find(function(a){g=c.findDataset(a,d,b+1);return c.defined(g)});return g}},{key:"findAttribute",value:function(a,d,b){var c=this,g=a.attributes[d];if(g)return g;a.children.find(function(a){g=c.findAttribute(a,d,b+1);return c.defined(g)});return g}},{key:"scaleVoxels",value:function(a,d,b,c,f){var e,g;switch(this.getTypeMatchMinc(a.type)){case "int8":e=
new ArrayBuffer(a.array.length*Int8Array.BYTES_PER_ELEMENT);g=new Int8Array(e);break;case "int16":e=new ArrayBuffer(a.array.length*Int16Array.BYTES_PER_ELEMENT);g=new Int16Array(e);break;case "int32":e=new ArrayBuffer(a.array.length*Int32Array.BYTES_PER_ELEMENT);g=new Int32Array(e);break;case "float32":e=new ArrayBuffer(a.array.length*Float32Array.BYTES_PER_ELEMENT);g=new Float32Array(e);break;case "float64":e=new ArrayBuffer(a.array.length*Float64Array.BYTES_PER_ELEMENT);g=new Float64Array(e);break;
case "uint8":e=new ArrayBuffer(a.array.length*Uint8Array.BYTES_PER_ELEMENT);g=new Uint8Array(e);break;case "uint16":e=new ArrayBuffer(a.array.length*Uint16Array.BYTES_PER_ELEMENT);g=new Uint16Array(e);break;case "uint32":e=new ArrayBuffer(a.array.length*Uint32Array.BYTES_PER_ELEMENT);g=new Uint32Array(e);break;default:throw d="Unsupported data type: "+header.datatype,console.log({message:d}),Error(d);}if(1>a.dims.length-d.dims.length)throw Error("Too few slice dimensions: "+a.dims.length+" "+d.dims.length);
var m=1,n;for(n=d.dims.length;n<a.dims.length;n+=1)m*=a.dims[n];f&&console.log(m+" voxels in slice.");var r=0,u=0,p=-Number.MAX_VALUE,t=Number.MAX_VALUE,y=a.array;b=b.array;var w=d.array;f&&console.log("valid range is "+c[0]+" to "+c[1]);var q,v=c[0],A,F,C,B=this.typeIsFloat(a.type);for(n=0;n<d.array.length;n+=1)if(f&&console.log(n+" "+w[n]+" "+b[n]+" "+y[n*m]),B)for(F=0;F<m;F+=1)C=y[u],C<c[0]||C>c[1]?g[u]=0:(g[u]=C,r+=C,C>p&&(p=C),C<t&&(t=C)),u+=1;else for(a=c[1]-c[0],q=b[n]-w[n],A=w[n],F=0;F<m;F+=
1)C=(y[u]-v)/a*q+A,C=C/b[n]*c[1],g[u]=C,r+=C,u+=1,C>p&&(p=C),C<t&&(t=C);f&&(console.log("Min: "+t),console.log("Max: "+p),console.log("Sum: "+r),console.log("Mean: "+r/u));return e}},{key:"isRgbVolume",value:function(a,d){var b=a.order;return"Uint8Array"===d.array.constructor.name&&0<b.length&&"vector_dimension"===b[b.length-1]&&3===a.vector_dimension.space_length}},{key:"rgbVoxels",value:function(a){a=a.array;var d=a.length,b=new ArrayBuffer(d/3*4),c=new Uint8Array(b),f,k=0;for(f=0;f<d;f+=3)c[k+
0]=a[f+0],c[k+1]=a[f+1],c[k+2]=a[f+2],c[k+3]=255,k+=4;return b}},{key:"parseHeader",value:function(a){var d;try{d=JSON.parse(a)}catch(g){throw a="server did not respond with valid JSON\nResponse was: \n"+a,console.log({message:a}),Error(a);}4===d.order.length&&(d.order=d.order.slice(1));d.datatype=d.datatype||"uint8";d.xspace.space_length=parseFloat(d.xspace.space_length);d.yspace.space_length=parseFloat(d.yspace.space_length);d.zspace.space_length=parseFloat(d.zspace.space_length);d.xspace.start=
parseFloat(d.xspace.start);d.yspace.start=parseFloat(d.yspace.start);d.zspace.start=parseFloat(d.zspace.start);d.xspace.step=parseFloat(d.xspace.step);d.yspace.step=parseFloat(d.yspace.step);d.zspace.step=parseFloat(d.zspace.step);d.xspace.direction_cosines=d.xspace.direction_cosines||[1,0,0];d.yspace.direction_cosines=d.yspace.direction_cosines||[0,1,0];d.zspace.direction_cosines=d.zspace.direction_cosines||[0,0,1];d.xspace.direction_cosines=d.xspace.direction_cosines.map(parseFloat);d.yspace.direction_cosines=
d.yspace.direction_cosines.map(parseFloat);d.zspace.direction_cosines=d.zspace.direction_cosines.map(parseFloat);d[d.order[0]].offset=d[d.order[1]].space_length*d[d.order[2]].space_length;d[d.order[1]].offset=d[d.order[2]].space_length;d[d.order[2]].offset=1;d.time&&(d.time.space_length=parseFloat(d.time.space_length),d.time.start=parseFloat(d.time.start),d.time.step=parseFloat(d.time.step),d.time.offset=d.xspace.space_length*d.yspace.space_length*d.zspace.space_length);return d}},{key:"createMincData",
value:function(a,d){switch(a.datatype){case "int8":a=new Int8Array(d);break;case "int16":a=new Int16Array(d);break;case "int32":a=new Int32Array(d);break;case "float32":a=new Float32Array(d);break;case "float64":a=new Float64Array(d);break;case "uint8":a=new Uint8Array(d);break;case "uint16":a=new Uint16Array(d);break;case "uint32":case "rgb8":a=new Uint32Array(d);break;default:throw a="Unsupported data type: "+a.datatype,console.log({message:a}),Error(a);}return a}},{key:"_run",value:function(){var a=
this,d=this._getInput(0);if(d){this._dv=new DataView(d);this._dv.getUint64=function(d,b){var c=a._dv.getUint32(d+0,b);d=a._dv.getUint32(d+4,b);return b?(d<<32)+c:(c<<32)+d};var b=this.createLink();try{this._superblk=this.hdf5Superblock()}catch(n){console.warn("The input file is not a Minc2 file.");return}this.seek(this._superblk.root_addr);1>=this._superblk.sbver?this.hdf5V1ObjectHeader(b):this.hdf5V2ObjectHeader(b);this.loadData(b);this.getMetadata("debug")&&this.printStructure(b,0);d=this.findDataset(b,
"image");if(!this.defined(d))throw Error("Can't find image dataset.");var c=this.findAttribute(d,"valid_range",0);if(!this.defined(c)){var f,k;switch(d.type){case this._type_enum.INT8:f=-128;k=127;break;case this._type_enum.UINT8:f=0;k=255;break;case this._type_enum.INT16:f=-32768;k=32767;break;case this._type_enum.UINT16:f=0;k=65535;break;case this._type_enum.INT32:f=2147483648;k=-2147483649;break;case this._type_enum.UINT32:f=0,k=(1<<32)-1}c=Float32Array.of(f,k)}f=this.findDataset(b,"image-min");
this.defined(f)||(f={array:Float32Array.of(0),dims:[]});k=this.findDataset(b,"image-max");this.defined(k)||(k={array:Float32Array.of(1),dims:[]});var l={},m=this.findAttribute(d,"dimorder",0);if("string"!==typeof m)throw Error("Can't find dimension order.");l.order=m.split(",");l.order.forEach(function(d){var c=a.findDataset(b,d);if(!a.defined(c))throw Error("Can't find dimension variable "+d);l[d]={};m=a.findAttribute(c,"step",0);a.defined(m)||(m=Float32Array.of(1));l[d].step=m[0];m=a.findAttribute(c,
"start",0);a.defined(m)||(m=Float32Array.of(0));l[d].start=m[0];m=a.findAttribute(c,"length",0);if(!a.defined(m))throw Error("Can't find length for "+d);l[d].space_length=m[0];m=a.findAttribute(c,"direction_cosines",0);a.defined(m)?l[d].direction_cosines=Array.prototype.slice.call(m):"xspace"===d?l[d].direction_cosines=[1,0,0]:"yspace"===d?l[d].direction_cosines=[0,1,0]:"zspace"===d&&(l[d].direction_cosines=[0,0,1])});this.isRgbVolume(l,d)?(l.order.pop(),l.datatype="rgb8",c=this.rgbVoxels(d)):(l.datatype=
this.getTypeMatchMinc(d.type),c=this.scaleVoxels(d,f,k,c,this.getMetadata("debug")));d=this.parseHeader(JSON.stringify(l));c=this.createMincData(d,c);this._addOutput(Ia);f=this.getOutput();f.setData(c,d);f.setMetadata("format","minc2")}else console.warn('Minc2Decoder requires an ArrayBuffer as input "0". Unable to continue.')}}]);return b}(ra),Wg=function(c){function b(){I(this,b);var a=P(this,(b.__proto__||Object.getPrototypeOf(b)).call(this));a.setMetadata("targetType",Ia.name);a.addInputValidator(0,
ArrayBuffer);a.setMetadata("debug",!1);return a}L(b,c);N(b,[{key:"parseNifti1Header",value:function(a){var d={order:[],xspace:{},yspace:{},zspace:{}},b=null,c=new DataView(a,0,348),f=new Uint8Array(a,0,348);a=!0;var k=c.getUint32(0,!0);348===k?a=!0:1543569408===k?a=!1:b="This does not look like a NIfTI-1 file.";k=c.getUint16(40,a);if(3>k||4<k)b="Cannot handle "+k+"-dimensional images yet.";f=String.fromCharCode.apply(null,f.subarray(344,348));"n+1\x00"!==f&&(b="Bad magic number: '"+f+"'");if(b)return console.warn("The input file is not a NIfTI file."),
null;d.xspace.space_length=c.getUint16(42,a);d.yspace.space_length=c.getUint16(44,a);d.zspace.space_length=c.getUint16(46,a);var b=c.getUint16(48,a),f=c.getUint16(70,a),l=c.getUint16(72,a),m=c.getFloat32(80,a),n=c.getFloat32(84,a),r=c.getFloat32(88,a),u=c.getFloat32(92,a),k=c.getFloat32(108,a);352>k&&(k=352);var p=c.getFloat32(112,a),t=c.getFloat32(116,a),y=c.getUint16(252,a),w=c.getUint16(254,a),q=[[1,0,0,0],[0,1,0,0],[0,0,1,0],[0,0,0,1]];1<=b&&(d.time={},d.time.space_length=b,d.time.step=u,d.time.start=
0,d.time.name="time");d.bytes_per_voxel=l/8;d.must_swap_data=!a&&1<d.bytes_per_voxel;if(0<w)q[0][0]=c.getFloat32(280,a),q[0][1]=c.getFloat32(284,a),q[0][2]=c.getFloat32(288,a),q[0][3]=c.getFloat32(292,a),q[1][0]=c.getFloat32(296,a),q[1][1]=c.getFloat32(300,a),q[1][2]=c.getFloat32(304,a),q[1][3]=c.getFloat32(308,a),q[2][0]=c.getFloat32(312,a),q[2][1]=c.getFloat32(316,a),q[2][2]=c.getFloat32(320,a),q[2][3]=c.getFloat32(324,a);else if(0<y)var q=c.getFloat32(256,a),l=c.getFloat32(260,a),u=c.getFloat32(264,
a),y=c.getFloat32(268,a),w=c.getFloat32(272,a),v=c.getFloat32(276,a),A=0>c.getFloat32(76,a)?-1:1,q=this.niftiQuaternToMat44(q,l,u,y,w,v,m,n,r,A);else q[0][0]=m,q[1][1]=n,q[2][2]=r;n=[0,1,2];r=[[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,1]];for(m=0;3>m;m++)l=Math.abs(q[0][m]),u=Math.abs(q[1][m]),y=Math.abs(q[2][m]),l>u&&l>y?(d.order[2-m]="xspace",n[m]=0):u>l&&u>y?(d.order[2-m]="yspace",n[m]=1):(d.order[2-m]="zspace",n[m]=2);for(m=0;3>m;m++)for(l=0;4>l;l++)u=l,3>l&&(u=n[l]),r[m][u]=q[m][l];Ia.transformToMinc(r,
d);d[d.order[2]].space_length=c.getUint16(42,a);d[d.order[1]].space_length=c.getUint16(44,a);d[d.order[0]].space_length=c.getUint16(46,a);1<=b&&d.order.unshift("time");d.datatype=f;d.vox_offset=k;d.scl_slope=p;d.scl_inter=t;return d}},{key:"niftiQuaternToMat44",value:function(a,d,b,c,f,k,l,m,n,r){var e=[[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,1]],g;g=1-(a*a+d*d+b*b);1E-7>g?(g=1/Math.sqrt(a*a+d*d+b*b),a*=g,d*=g,b*=g,g=0):g=Math.sqrt(g);l=0<l?l:1;m=0<m?m:1;n=0<n?n:1;0>r&&(n=-n);e[0][0]=(g*g+a*a-d*d-b*
b)*l;e[0][1]=2*(a*d-g*b)*m;e[0][2]=2*(a*b+g*d)*n;e[1][0]=2*(a*d+g*b)*l;e[1][1]=(g*g+d*d-a*a-b*b)*m;e[1][2]=2*(d*b-g*a)*n;e[2][0]=2*(a*b-g*d)*l;e[2][1]=2*(d*b+g*a)*m;e[2][2]=(g*g+b*b-d*d-a*a)*n;e[0][3]=c;e[1][3]=f;e[2][3]=k;return e}},{key:"createNifti1Data",value:function(a,d){a.must_swap_data&&Ia.swapn(new Uint8Array(d,a.vox_offset),a.bytes_per_voxel);switch(a.datatype){case 2:d=new Uint8Array(d,a.vox_offset);break;case 4:d=new Int16Array(d,a.vox_offset);break;case 8:d=new Int32Array(d,a.vox_offset);
break;case 16:d=new Float32Array(d,a.vox_offset);break;case 64:d=new Float64Array(d,a.vox_offset);break;case 256:d=new Int8Array(d,a.vox_offset);break;case 512:d=new Uint16Array(d,a.vox_offset);break;case 768:d=new Uint32Array(d,a.vox_offset);break;default:throw Error("Unsupported data type: "+a.datatype);}var b,c=a.scl_slope,f=a.scl_inter;if(0!==c){var k=new Float32Array(d.length);for(b=0;b<d.length;b++)k[b]=d[b]*c+f;d=k}4===a.order.length&&(a.order=a.order.slice(1));a[a.order[0]].offset=a[a.order[1]].space_length*
a[a.order[2]].space_length;a[a.order[1]].offset=a[a.order[2]].space_length;a[a.order[2]].offset=1;a.time&&(a.time.offset=a.xspace.space_length*a.yspace.space_length*a.zspace.space_length);return d}},{key:"_run",value:function(){var a=this._getInput(0);if(a){var d=null;try{d=this.parseNifti1Header(a)}catch(e){}if(d){a=this.createNifti1Data(d,a);this._addOutput(Ia);var b=this.getOutput();b.setData(a,d);b.setMetadata("format","nifti")}else console.warn("This file is not a NIfTI file.")}else console.warn('NiftiDecoder requires an ArrayBuffer as input "0". Unable to continue.')}}]);
return b}(ra),de=ma(function(c){var b=b||{};b.Utils=b.Utils||{};b.Utils.crcTable=null;b.Utils.GUNZIP_MAGIC_COOKIE1=31;b.Utils.GUNZIP_MAGIC_COOKIE2=139;b.Utils.getStringAt=function(a,d,b){for(var c="",g;d<b;d+=1)g=a.getUint8(d),0!==g&&(c+=String.fromCharCode(g));return c};b.Utils.getByteAt=function(a,d){return a.getInt8(d)};b.Utils.getShortAt=function(a,d,b){return a.getInt16(d,b)};b.Utils.getIntAt=function(a,d,b){return a.getInt32(d,b)};b.Utils.getFloatAt=function(a,d,b){return a.getFloat32(d,b)};
b.Utils.getDoubleAt=function(a,d,b){return a.getFloat64(d,b)};b.Utils.getLongAt=function(a,d,c){var e,g=[],k=0;for(e=0;8>e;e+=1)g[e]=b.Utils.getByteAt(a,d+e,c);for(e=g.length-1;0<=e;e--)k=256*k+g[e];return k};b.Utils.toArrayBuffer=function(a){var d,b,c;d=new ArrayBuffer(a.length);b=new Uint8Array(d);for(c=0;c<a.length;c+=1)b[c]=a[c];return d};b.Utils.isString=function(a){return"string"===typeof a||a instanceof String};b.Utils.formatNumber=function(a,d){a=b.Utils.isString(a)?Number(a):a;a=d?a.toPrecision(5):
a.toPrecision(7);return parseFloat(a)};b.Utils.makeCRCTable=function(){for(var a,d=[],b=0;256>b;b++){a=b;for(var c=0;8>c;c++)a=a&1?3988292384^a>>>1:a>>>1;d[b]=a}return d};b.Utils.crc32=function(a){for(var d=b.Utils.crcTable||(b.Utils.crcTable=b.Utils.makeCRCTable()),c=-1,e=0;e<a.byteLength;e++)c=c>>>8^d[(c^a.getUint8(e))&255];return(c^-1)>>>0};c.exports&&(c.exports=b.Utils)}),Xg=ma(function(c){var b=b||{};b.Utils=b.Utils||("undefined"!==typeof db?de:null);b.NIFTI1=b.NIFTI1||function(){this.littleEndian=
!1;this.dim_info=0;this.dims=[];this.slice_code=this.slice_end=this.slice_start=this.numBitsPerVoxel=this.datatypeCode=this.intent_code=this.intent_p3=this.intent_p2=this.intent_p1=0;this.pixDims=[];this.vox_offset=0;this.scl_slope=1;this.toffset=this.slice_duration=this.cal_min=this.cal_max=this.xyzt_units=this.scl_inter=0;this.intent_name=this.aux_file=this.description="";this.qoffset_z=this.qoffset_y=this.qoffset_x=this.quatern_d=this.quatern_c=this.quatern_b=this.sform_code=this.qform_code=0;
this.affine=[[1,0,0,0],[0,1,0,0],[0,0,1,0],[0,0,0,1]];this.magic=0;this.isHDR=!1;this.extensionFlag=[0,0,0,0];this.extensionCode=this.extensionSize=0};b.NIFTI1.TYPE_NONE=0;b.NIFTI1.TYPE_BINARY=1;b.NIFTI1.TYPE_UINT8=2;b.NIFTI1.TYPE_INT16=4;b.NIFTI1.TYPE_INT32=8;b.NIFTI1.TYPE_FLOAT32=16;b.NIFTI1.TYPE_COMPLEX64=32;b.NIFTI1.TYPE_FLOAT64=64;b.NIFTI1.TYPE_RGB24=128;b.NIFTI1.TYPE_INT8=256;b.NIFTI1.TYPE_UINT16=512;b.NIFTI1.TYPE_UINT32=768;b.NIFTI1.TYPE_INT64=1024;b.NIFTI1.TYPE_UINT64=1280;b.NIFTI1.TYPE_FLOAT128=
1536;b.NIFTI1.TYPE_COMPLEX128=1792;b.NIFTI1.TYPE_COMPLEX256=2048;b.NIFTI1.XFORM_UNKNOWN=0;b.NIFTI1.XFORM_SCANNER_ANAT=1;b.NIFTI1.XFORM_ALIGNED_ANAT=2;b.NIFTI1.XFORM_TALAIRACH=3;b.NIFTI1.XFORM_MNI_152=4;b.NIFTI1.SPATIAL_UNITS_MASK=7;b.NIFTI1.TEMPORAL_UNITS_MASK=56;b.NIFTI1.UNITS_UNKNOWN=0;b.NIFTI1.UNITS_METER=1;b.NIFTI1.UNITS_MM=2;b.NIFTI1.UNITS_MICRON=3;b.NIFTI1.UNITS_SEC=8;b.NIFTI1.UNITS_MSEC=16;b.NIFTI1.UNITS_USEC=24;b.NIFTI1.UNITS_HZ=32;b.NIFTI1.UNITS_PPM=40;b.NIFTI1.UNITS_RADS=48;b.NIFTI1.MAGIC_COOKIE=
348;b.NIFTI1.STANDARD_HEADER_SIZE=348;b.NIFTI1.MAGIC_NUMBER_LOCATION=344;b.NIFTI1.MAGIC_NUMBER=[110,43,49];b.NIFTI1.MAGIC_NUMBER2=[110,105,49];b.NIFTI1.EXTENSION_HEADER_SIZE=8;b.NIFTI1.prototype.readHeader=function(a){a=new DataView(a);var d=b.Utils.getIntAt(a,0,this.littleEndian),c,e;d!==b.NIFTI1.MAGIC_COOKIE&&(this.littleEndian=!0,d=b.Utils.getIntAt(a,0,this.littleEndian));if(d!==b.NIFTI1.MAGIC_COOKIE)throw Error("This does not appear to be a NIFTI file!");this.dim_info=b.Utils.getByteAt(a,39);
for(c=0;8>c;c+=1)d=40+2*c,this.dims[c]=b.Utils.getShortAt(a,d,this.littleEndian);this.intent_p1=b.Utils.getFloatAt(a,56,this.littleEndian);this.intent_p2=b.Utils.getFloatAt(a,60,this.littleEndian);this.intent_p3=b.Utils.getFloatAt(a,64,this.littleEndian);this.intent_code=b.Utils.getShortAt(a,68,this.littleEndian);this.datatypeCode=b.Utils.getShortAt(a,70,this.littleEndian);this.numBitsPerVoxel=b.Utils.getShortAt(a,72,this.littleEndian);this.slice_start=b.Utils.getShortAt(a,74,this.littleEndian);for(c=
0;8>c;c+=1)d=76+4*c,this.pixDims[c]=b.Utils.getFloatAt(a,d,this.littleEndian);this.vox_offset=b.Utils.getFloatAt(a,108,this.littleEndian);this.scl_slope=b.Utils.getFloatAt(a,112,this.littleEndian);this.scl_inter=b.Utils.getFloatAt(a,116,this.littleEndian);this.slice_end=b.Utils.getShortAt(a,120,this.littleEndian);this.slice_code=b.Utils.getByteAt(a,122);this.xyzt_units=b.Utils.getByteAt(a,123);this.cal_max=b.Utils.getFloatAt(a,124,this.littleEndian);this.cal_min=b.Utils.getFloatAt(a,128,this.littleEndian);
this.slice_duration=b.Utils.getFloatAt(a,132,this.littleEndian);this.toffset=b.Utils.getFloatAt(a,136,this.littleEndian);this.description=b.Utils.getStringAt(a,148,228);this.aux_file=b.Utils.getStringAt(a,228,252);this.qform_code=b.Utils.getShortAt(a,252,this.littleEndian);this.sform_code=b.Utils.getShortAt(a,254,this.littleEndian);this.quatern_b=b.Utils.getFloatAt(a,256,this.littleEndian);this.quatern_c=b.Utils.getFloatAt(a,260,this.littleEndian);this.quatern_d=b.Utils.getFloatAt(a,264,this.littleEndian);
this.qoffset_x=b.Utils.getFloatAt(a,268,this.littleEndian);this.qoffset_y=b.Utils.getFloatAt(a,272,this.littleEndian);this.qoffset_z=b.Utils.getFloatAt(a,276,this.littleEndian);for(c=0;3>c;c+=1)for(e=0;4>e;e+=1)d=280+4*(4*c+e),this.affine[c][e]=b.Utils.getFloatAt(a,d,this.littleEndian);this.affine[3][0]=0;this.affine[3][1]=0;this.affine[3][2]=0;this.affine[3][3]=1;this.intent_name=b.Utils.getStringAt(a,328,344);this.magic=b.Utils.getStringAt(a,344,348);this.isHDR=this.magic===b.NIFTI1.MAGIC_NUMBER2;
a.byteLength>b.NIFTI1.MAGIC_COOKIE&&(this.extensionFlag[0]=b.Utils.getByteAt(a,348),this.extensionFlag[1]=b.Utils.getByteAt(a,349),this.extensionFlag[2]=b.Utils.getByteAt(a,350),this.extensionFlag[3]=b.Utils.getByteAt(a,351),this.extensionFlag[0]&&(this.extensionSize=this.getExtensionSize(a),this.extensionCode=this.getExtensionCode(a)))};b.NIFTI1.prototype.toFormattedString=function(){var a=b.Utils.formatNumber,d;d=""+("Dim Info = "+this.dim_info+"\n");d+="Image Dimensions (1-8): "+this.dims[0]+", "+
this.dims[1]+", "+this.dims[2]+", "+this.dims[3]+", "+this.dims[4]+", "+this.dims[5]+", "+this.dims[6]+", "+this.dims[7]+"\n";d+="Intent Parameters (1-3): "+this.intent_p1+", "+this.intent_p2+", "+this.intent_p3+"\n";d+="Intent Code = "+this.intent_code+"\n";d+="Datatype = "+this.datatypeCode+" ("+this.getDatatypeCodeString(this.datatypeCode)+")\n";d+="Bits Per Voxel = "+this.numBitsPerVoxel+"\n";d+="Slice Start = "+this.slice_start+"\n";d+="Voxel Dimensions (1-8): "+a(this.pixDims[0])+", "+a(this.pixDims[1])+
", "+a(this.pixDims[2])+", "+a(this.pixDims[3])+", "+a(this.pixDims[4])+", "+a(this.pixDims[5])+", "+a(this.pixDims[6])+", "+a(this.pixDims[7])+"\n";d+="Image Offset = "+this.vox_offset+"\n";d+="Data Scale:  Slope = "+a(this.scl_slope)+"  Intercept = "+a(this.scl_inter)+"\n";d+="Slice End = "+this.slice_end+"\n";d+="Slice Code = "+this.slice_code+"\n";d+="Units Code = "+this.xyzt_units+" ("+this.getUnitsCodeString(b.NIFTI1.SPATIAL_UNITS_MASK&this.xyzt_units)+", "+this.getUnitsCodeString(b.NIFTI1.TEMPORAL_UNITS_MASK&
this.xyzt_units)+")\n";d+="Display Range:  Max = "+a(this.cal_max)+"  Min = "+a(this.cal_min)+"\n";d+="Slice Duration = "+this.slice_duration+"\n";d+="Time Axis Shift = "+this.toffset+"\n";d+='Description: "'+this.description+'"\n';d+='Auxiliary File: "'+this.aux_file+'"\n';d+="Q-Form Code = "+this.qform_code+" ("+this.getTransformCodeString(this.qform_code)+")\n";d+="S-Form Code = "+this.sform_code+" ("+this.getTransformCodeString(this.sform_code)+")\n";d+="Quaternion Parameters:  b = "+a(this.quatern_b)+
"  c = "+a(this.quatern_c)+"  d = "+a(this.quatern_d)+"\n";d+="Quaternion Offsets:  x = "+this.qoffset_x+"  y = "+this.qoffset_y+"  z = "+this.qoffset_z+"\n";d+="S-Form Parameters X: "+a(this.affine[0][0])+", "+a(this.affine[0][1])+", "+a(this.affine[0][2])+", "+a(this.affine[0][3])+"\n";d+="S-Form Parameters Y: "+a(this.affine[1][0])+", "+a(this.affine[1][1])+", "+a(this.affine[1][2])+", "+a(this.affine[1][3])+"\n";d+="S-Form Parameters Z: "+a(this.affine[2][0])+", "+a(this.affine[2][1])+", "+a(this.affine[2][2])+
", "+a(this.affine[2][3])+"\n";d+='Intent Name: "'+this.intent_name+'"\n';this.extensionFlag[0]&&(d+="Extension: Size = "+this.extensionSize+"  Code = "+this.extensionCode+"\n");return d};b.NIFTI1.prototype.getDatatypeCodeString=function(a){return a===b.NIFTI1.TYPE_UINT8?"1-Byte Unsigned Integer":a===b.NIFTI1.TYPE_INT16?"2-Byte Signed Integer":a===b.NIFTI1.TYPE_INT32?"4-Byte Signed Integer":a===b.NIFTI1.TYPE_FLOAT32?"4-Byte Float":a===b.NIFTI1.TYPE_FLOAT64?"8-Byte Float":a===b.NIFTI1.TYPE_RGB24?"RGB":
a===b.NIFTI1.TYPE_INT8?"1-Byte Signed Integer":a===b.NIFTI1.TYPE_UINT16?"2-Byte Unsigned Integer":a===b.NIFTI1.TYPE_UINT32?"4-Byte Unsigned Integer":a===b.NIFTI1.TYPE_INT64?"8-Byte Signed Integer":a===b.NIFTI1.TYPE_UINT64?"8-Byte Unsigned Integer":"Unknown"};b.NIFTI1.prototype.getTransformCodeString=function(a){return a===b.NIFTI1.XFORM_SCANNER_ANAT?"Scanner":a===b.NIFTI1.XFORM_ALIGNED_ANAT?"Aligned":a===b.NIFTI1.XFORM_TALAIRACH?"Talairach":a===b.NIFTI1.XFORM_MNI_152?"MNI":"Unknown"};b.NIFTI1.prototype.getUnitsCodeString=
function(a){return a===b.NIFTI1.UNITS_METER?"Meters":a===b.NIFTI1.UNITS_MM?"Millimeters":a===b.NIFTI1.UNITS_MICRON?"Microns":a===b.NIFTI1.UNITS_SEC?"Seconds":a===b.NIFTI1.UNITS_MSEC?"Milliseconds":a===b.NIFTI1.UNITS_USEC?"Microseconds":a===b.NIFTI1.UNITS_HZ?"Hz":a===b.NIFTI1.UNITS_PPM?"PPM":a===b.NIFTI1.UNITS_RADS?"Rads":"Unknown"};b.NIFTI1.prototype.getQformMat=function(){return this.convertNiftiQFormToNiftiSForm(this.quatern_b,this.quatern_c,this.quatern_d,this.qoffset_x,this.qoffset_y,this.qoffset_z,
this.pixDims[1],this.pixDims[2],this.pixDims[3],this.pixDims[0])};b.NIFTI1.prototype.convertNiftiQFormToNiftiSForm=function(a,d,b,c,f,k,l,m,n,r){var e=[[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0]],g=b;e[3][0]=e[3][1]=e[3][2]=0;e[3][3]=1;b=1-(a*a+d*d+g*g);1E-7>b?(b=1/Math.sqrt(a*a+d*d+g*g),a*=b,d*=b,g*=b,b=0):b=Math.sqrt(b);l=0<l?l:1;m=0<m?m:1;n=0<n?n:1;0>r&&(n=-n);e[0][0]=(b*b+a*a-d*d-g*g)*l;e[0][1]=2*(a*d-b*g)*m;e[0][2]=2*(a*g+b*d)*n;e[1][0]=2*(a*d+b*g)*l;e[1][1]=(b*b+d*d-a*a-g*g)*m;e[1][2]=2*(d*g-b*
a)*n;e[2][0]=2*(a*g-b*d)*l;e[2][1]=2*(d*g+b*a)*m;e[2][2]=(b*b+g*g-d*d-a*a)*n;e[0][3]=c;e[1][3]=f;e[2][3]=k;return e};b.NIFTI1.prototype.convertNiftiSFormToNEMA=function(a){var d,b,c,f,k,l,m,n,r,u,p,t,y,q,x,v;x=[[0,0,0],[0,0,0],[0,0,0]];v=[[0,0,0],[0,0,0],[0,0,0]];d=a[0][0];b=a[0][1];c=a[0][2];f=a[1][0];k=a[1][1];l=a[1][2];m=a[2][0];n=a[2][1];r=a[2][2];a=Math.sqrt(d*d+f*f+m*m);if(0===a)return null;d/=a;f/=a;m/=a;a=Math.sqrt(b*b+k*k+n*n);if(0===a)return null;b/=a;k/=a;n/=a;a=d*b+f*k+m*n;if(1E-4<Math.abs(a)){b-=
a*d;k-=a*f;n-=a*m;a=Math.sqrt(b*b+k*k+n*n);if(0===a)return null;b/=a;k/=a;n/=a}a=Math.sqrt(c*c+l*l+r*r);0===a?(c=f*n-m*k,l=m*b-n*d,r=d*k-f*b):(c/=a,l/=a,r/=a);a=d*c+f*l+m*r;if(1E-4<Math.abs(a)){c-=a*d;l-=a*f;r-=a*m;a=Math.sqrt(c*c+l*l+r*r);if(0===a)return null;c/=a;l/=a;r/=a}a=b*c+k*l+n*r;if(1E-4<Math.abs(a)){c-=a*b;l-=a*k;r-=a*n;a=Math.sqrt(c*c+l*l+r*r);if(0===a)return null;c/=a;l/=a;r/=a}x[0][0]=d;x[0][1]=b;x[0][2]=c;x[1][0]=f;x[1][1]=k;x[1][2]=l;x[2][0]=m;x[2][1]=n;x[2][2]=r;m=this.nifti_mat33_determ(x);
if(0===m)return null;q=-666;d=f=k=l=1;b=2;c=3;for(n=1;3>=n;n+=1)for(r=1;3>=r;r+=1)if(n!==r)for(u=1;3>=u;u+=1)if(n!==u&&r!==u)for(v[0][0]=v[0][1]=v[0][2]=v[1][0]=v[1][1]=v[1][2]=v[2][0]=v[2][1]=v[2][2]=0,p=-1;1>=p;p+=2)for(t=-1;1>=t;t+=2)for(y=-1;1>=y;y+=2)v[0][n-1]=p,v[1][r-1]=t,v[2][u-1]=y,a=this.nifti_mat33_determ(v),0<a*m&&(a=this.nifti_mat33_mul(v,x),a=a[0][0]+a[1][1]+a[2][2],a>q&&(q=a,d=n,b=r,c=u,f=p,k=t,l=y));x=v=a=m=n=r=0;switch(d*f){case 1:x="X";m="+";break;case -1:x="X";m="-";break;case 2:x=
"Y";m="+";break;case -2:x="Y";m="-";break;case 3:x="Z";m="+";break;case -3:x="Z",m="-"}switch(b*k){case 1:v="X";n="+";break;case -1:v="X";n="-";break;case 2:v="Y";n="+";break;case -2:v="Y";n="-";break;case 3:v="Z";n="+";break;case -3:v="Z",n="-"}switch(c*l){case 1:a="X";r="+";break;case -1:a="X";r="-";break;case 2:a="Y";r="+";break;case -2:a="Y";r="-";break;case 3:a="Z";r="+";break;case -3:a="Z",r="-"}return x+v+a+m+n+r};b.NIFTI1.prototype.nifti_mat33_mul=function(a,d){var b=[[0,0,0],[0,0,0],[0,0,
0]],c,f;for(c=0;3>c;c+=1)for(f=0;3>f;f+=1)b[c][f]=a[c][0]*d[0][f]+a[c][1]*d[1][f]+a[c][2]*d[2][f];return b};b.NIFTI1.prototype.nifti_mat33_determ=function(a){var b,c,e,f,k,l,m,n;b=a[0][0];c=a[0][1];e=a[0][2];f=a[1][0];k=a[1][1];l=a[1][2];m=a[2][0];n=a[2][1];a=a[2][2];return b*k*a-b*n*l-f*c*a+f*n*e+m*c*l-m*k*e};b.NIFTI1.prototype.getExtensionLocation=function(){return b.NIFTI1.MAGIC_COOKIE+4};b.NIFTI1.prototype.getExtensionSize=function(a){return b.Utils.getIntAt(a,this.getExtensionLocation(),this.littleEndian)};
b.NIFTI1.prototype.getExtensionCode=function(a){return b.Utils.getIntAt(a,this.getExtensionLocation()+4,this.littleEndian)};c.exports&&(c.exports=b.NIFTI1)}),kj=ma(function(c){var b=b||{};b.Utils=b.Utils||("undefined"!==typeof db?de:null);b.NIFTI1=b.NIFTI1||("undefined"!==typeof db?Xg:null);b.NIFTI2=b.NIFTI2||function(){this.littleEndian=!1;this.dim_info=0;this.dims=[];this.slice_code=this.slice_end=this.slice_start=this.numBitsPerVoxel=this.datatypeCode=this.intent_code=this.intent_p3=this.intent_p2=
this.intent_p1=0;this.pixDims=[];this.vox_offset=0;this.scl_slope=1;this.toffset=this.slice_duration=this.cal_min=this.cal_max=this.xyzt_units=this.scl_inter=0;this.intent_name=this.aux_file=this.description="";this.qoffset_z=this.qoffset_y=this.qoffset_x=this.quatern_d=this.quatern_c=this.quatern_b=this.sform_code=this.qform_code=0;this.affine=[[1,0,0,0],[0,1,0,0],[0,0,1,0],[0,0,0,1]];this.magic=0;this.extensionFlag=[0,0,0,0]};b.NIFTI2.MAGIC_COOKIE=540;b.NIFTI2.MAGIC_NUMBER_LOCATION=4;b.NIFTI2.MAGIC_NUMBER=
[110,43,50,0,13,10,26,10];b.NIFTI2.prototype.readHeader=function(a){a=new DataView(a);var d=b.Utils.getIntAt(a,0,this.littleEndian),c,e;d!==b.NIFTI2.MAGIC_COOKIE&&(this.littleEndian=!0,d=b.Utils.getIntAt(a,0,this.littleEndian));if(d!==b.NIFTI2.MAGIC_COOKIE)throw Error("This does not appear to be a NIFTI file!");this.datatypeCode=b.Utils.getShortAt(a,12,this.littleEndian);this.numBitsPerVoxel=b.Utils.getShortAt(a,14,this.littleEndian);for(c=0;8>c;c+=1)d=16+8*c,this.dims[c]=b.Utils.getLongAt(a,d,this.littleEndian);
this.intent_p1=b.Utils.getDoubleAt(a,80,this.littleEndian);this.intent_p2=b.Utils.getDoubleAt(a,88,this.littleEndian);this.intent_p3=b.Utils.getDoubleAt(a,96,this.littleEndian);for(c=0;8>c;c+=1)d=104+8*c,this.pixDims[c]=b.Utils.getDoubleAt(a,d,this.littleEndian);this.vox_offset=b.Utils.getLongAt(a,168,this.littleEndian);this.scl_slope=b.Utils.getDoubleAt(a,176,this.littleEndian);this.scl_inter=b.Utils.getDoubleAt(a,184,this.littleEndian);this.cal_max=b.Utils.getDoubleAt(a,192,this.littleEndian);this.cal_min=
b.Utils.getDoubleAt(a,200,this.littleEndian);this.slice_duration=b.Utils.getDoubleAt(a,208,this.littleEndian);this.toffset=b.Utils.getDoubleAt(a,216,this.littleEndian);this.slice_start=b.Utils.getLongAt(a,224,this.littleEndian);this.slice_end=b.Utils.getLongAt(a,232,this.littleEndian);this.description=b.Utils.getStringAt(a,240,320);this.aux_file=b.Utils.getStringAt(a,320,344);this.qform_code=b.Utils.getIntAt(a,344,this.littleEndian);this.sform_code=b.Utils.getIntAt(a,348,this.littleEndian);this.quatern_b=
b.Utils.getDoubleAt(a,352,this.littleEndian);this.quatern_c=b.Utils.getDoubleAt(a,360,this.littleEndian);this.quatern_d=b.Utils.getDoubleAt(a,368,this.littleEndian);this.qoffset_x=b.Utils.getDoubleAt(a,376,this.littleEndian);this.qoffset_y=b.Utils.getDoubleAt(a,384,this.littleEndian);this.qoffset_z=b.Utils.getDoubleAt(a,392,this.littleEndian);for(c=0;3>c;c+=1)for(e=0;4>e;e+=1)d=400+8*(4*c+e),this.affine[c][e]=b.Utils.getDoubleAt(a,d,this.littleEndian);this.affine[3][0]=0;this.affine[3][1]=0;this.affine[3][2]=
0;this.affine[3][3]=1;this.slice_code=b.Utils.getIntAt(a,496,this.littleEndian);this.xyzt_units=b.Utils.getIntAt(a,500,this.littleEndian);this.intent_code=b.Utils.getIntAt(a,504,this.littleEndian);this.intent_name=b.Utils.getStringAt(a,508,524);this.dim_info=b.Utils.getByteAt(a,524);a.byteLength>b.NIFTI2.MAGIC_COOKIE&&(this.extensionFlag[0]=b.Utils.getByteAt(a,540),this.extensionFlag[1]=b.Utils.getByteAt(a,541),this.extensionFlag[2]=b.Utils.getByteAt(a,542),this.extensionFlag[3]=b.Utils.getByteAt(a,
543),this.extensionFlag[0]&&(this.extensionSize=this.getExtensionSize(a),this.extensionCode=this.getExtensionCode(a)))};b.NIFTI2.prototype.toFormattedString=function(){var a=b.Utils.formatNumber,d;d=""+("Datatype = "+ +this.datatypeCode+" ("+this.getDatatypeCodeString(this.datatypeCode)+")\n");d+="Bits Per Voxel =  = "+this.numBitsPerVoxel+"\n";d+="Image Dimensions (1-8): "+this.dims[0]+", "+this.dims[1]+", "+this.dims[2]+", "+this.dims[3]+", "+this.dims[4]+", "+this.dims[5]+", "+this.dims[6]+", "+
this.dims[7]+"\n";d+="Intent Parameters (1-3): "+this.intent_p1+", "+this.intent_p2+", "+this.intent_p3+"\n";d+="Voxel Dimensions (1-8): "+a(this.pixDims[0])+", "+a(this.pixDims[1])+", "+a(this.pixDims[2])+", "+a(this.pixDims[3])+", "+a(this.pixDims[4])+", "+a(this.pixDims[5])+", "+a(this.pixDims[6])+", "+a(this.pixDims[7])+"\n";d+="Image Offset = "+this.vox_offset+"\n";d+="Data Scale:  Slope = "+a(this.scl_slope)+"  Intercept = "+a(this.scl_inter)+"\n";d+="Display Range:  Max = "+a(this.cal_max)+
"  Min = "+a(this.cal_min)+"\n";d+="Slice Duration = "+this.slice_duration+"\n";d+="Time Axis Shift = "+this.toffset+"\n";d+="Slice Start = "+this.slice_start+"\n";d+="Slice End = "+this.slice_end+"\n";d+='Description: "'+this.description+'"\n';d+='Auxiliary File: "'+this.aux_file+'"\n';d+="Q-Form Code = "+this.qform_code+" ("+this.getTransformCodeString(this.qform_code)+")\n";d+="S-Form Code = "+this.sform_code+" ("+this.getTransformCodeString(this.sform_code)+")\n";d+="Quaternion Parameters:  b = "+
a(this.quatern_b)+"  c = "+a(this.quatern_c)+"  d = "+a(this.quatern_d)+"\n";d+="Quaternion Offsets:  x = "+this.qoffset_x+"  y = "+this.qoffset_y+"  z = "+this.qoffset_z+"\n";d+="S-Form Parameters X: "+a(this.affine[0][0])+", "+a(this.affine[0][1])+", "+a(this.affine[0][2])+", "+a(this.affine[0][3])+"\n";d+="S-Form Parameters Y: "+a(this.affine[1][0])+", "+a(this.affine[1][1])+", "+a(this.affine[1][2])+", "+a(this.affine[1][3])+"\n";d+="S-Form Parameters Z: "+a(this.affine[2][0])+", "+a(this.affine[2][1])+
", "+a(this.affine[2][2])+", "+a(this.affine[2][3])+"\n";d+="Slice Code = "+this.slice_code+"\n";d+="Units Code = "+this.xyzt_units+" ("+this.getUnitsCodeString(b.NIFTI1.SPATIAL_UNITS_MASK&this.xyzt_units)+", "+this.getUnitsCodeString(b.NIFTI1.TEMPORAL_UNITS_MASK&this.xyzt_units)+")\n";d+="Intent Code = "+this.intent_code+"\n";d+='Intent Name: "'+this.intent_name+'"\n';return d+="Dim Info = "+this.dim_info+"\n"};b.NIFTI2.prototype.getExtensionLocation=function(){return b.NIFTI2.MAGIC_COOKIE+4};b.NIFTI2.prototype.getExtensionSize=
b.NIFTI1.prototype.getExtensionSize;b.NIFTI2.prototype.getExtensionCode=b.NIFTI1.prototype.getExtensionCode;b.NIFTI2.prototype.getDatatypeCodeString=b.NIFTI1.prototype.getDatatypeCodeString;b.NIFTI2.prototype.getTransformCodeString=b.NIFTI1.prototype.getTransformCodeString;b.NIFTI2.prototype.getUnitsCodeString=b.NIFTI1.prototype.getUnitsCodeString;b.NIFTI2.prototype.getQformMat=b.NIFTI1.prototype.getQformMat;b.NIFTI2.prototype.convertNiftiQFormToNiftiSForm=b.NIFTI1.prototype.convertNiftiQFormToNiftiSForm;
b.NIFTI2.prototype.convertNiftiSFormToNEMA=b.NIFTI1.prototype.convertNiftiSFormToNEMA;b.NIFTI2.prototype.nifti_mat33_mul=b.NIFTI1.prototype.nifti_mat33_mul;b.NIFTI2.prototype.nifti_mat33_determ=b.NIFTI1.prototype.nifti_mat33_determ;c.exports&&(c.exports=b.NIFTI2)}),Y=ma(function(c){var b=b||{};b.NIFTI1=b.NIFTI1||("undefined"!==typeof db?Xg:null);b.NIFTI2=b.NIFTI2||("undefined"!==typeof db?kj:null);b.Utils=b.Utils||("undefined"!==typeof db?de:null);var a=a||("undefined"!==typeof db?Ca:null);b.isNIFTI1=
function(a){var d,c;if(a.byteLength<b.NIFTI1.STANDARD_HEADER_SIZE)return!1;d=new DataView(a);a=d.getUint8(b.NIFTI1.MAGIC_NUMBER_LOCATION);c=d.getUint8(b.NIFTI1.MAGIC_NUMBER_LOCATION+1);d=d.getUint8(b.NIFTI1.MAGIC_NUMBER_LOCATION+2);return!(a!==b.NIFTI1.MAGIC_NUMBER[0]||c!==b.NIFTI1.MAGIC_NUMBER[1]||d!==b.NIFTI1.MAGIC_NUMBER[2])};b.isNIFTI2=function(a){var d,c;if(a.byteLength<b.NIFTI1.STANDARD_HEADER_SIZE)return!1;d=new DataView(a);a=d.getUint8(b.NIFTI2.MAGIC_NUMBER_LOCATION);c=d.getUint8(b.NIFTI2.MAGIC_NUMBER_LOCATION+
1);d=d.getUint8(b.NIFTI2.MAGIC_NUMBER_LOCATION+2);return!(a!==b.NIFTI2.MAGIC_NUMBER[0]||c!==b.NIFTI2.MAGIC_NUMBER[1]||d!==b.NIFTI2.MAGIC_NUMBER[2])};b.isNIFTI=function(a){return b.isNIFTI1(a)||b.isNIFTI2(a)};b.isCompressed=function(a){var d;return a&&(d=new DataView(a),a=d.getUint8(0),d=d.getUint8(1),a===b.Utils.GUNZIP_MAGIC_COOKIE1||d===b.Utils.GUNZIP_MAGIC_COOKIE2)?!0:!1};b.decompress=function(b){return a.inflate(b).buffer};b.readHeader=function(a){var d=null;b.isCompressed(a)&&(a=b.decompress(a));
b.isNIFTI1(a)?d=new b.NIFTI1:b.isNIFTI2(a)&&(d=new b.NIFTI2);d?d.readHeader(a):console.error("That file does not appear to be NIFTI!");return d};b.hasExtension=function(a){return 0!=a.extensionFlag[0]};b.readImage=function(a,b){var d=a.vox_offset,c=1,g=1;a.dims[4]&&(c=a.dims[4]);a.dims[5]&&(g=a.dims[5]);return b.slice(d,d+a.numBitsPerVoxel/8*a.dims[2]*a.dims[3]*c*g*a.dims[1])};b.readExtension=function(a,b){var d=a.getExtensionLocation();return b.slice(d,d+a.extensionSize)};b.readExtensionData=function(a,
b){var d=a.getExtensionLocation();return b.slice(d+8,d+a.extensionSize-8)};c.exports&&(c.exports=b)}),Yg=function(c){function b(){I(this,b);var a=P(this,(b.__proto__||Object.getPrototypeOf(b)).call(this));a.setMetadata("targetType",Ta.name);a.addInputValidator(0,ArrayBuffer);return a}L(b,c);N(b,[{key:"_run",value:function(){function a(a,b){var d=Math.abs(a[0][b]),c=Math.abs(a[1][b]);a=Math.abs(a[2][b]);return d>c&&d>a?0:c>d&&c>a?1:2}function b(a){return Math.sqrt(a[0]*a[0]+a[1]*a[1]+a[2]*a[2])}function c(a){for(var b=
0;b<q.length;b++)if(q[b].nameWorldSpace===a)return q[b];return null}var e=this._getInput(0);if(e)if(Y.isNIFTI(e)){var f={},k=null,l=Y.readHeader(e),k=Y.readImage(l,e);if(k=this._fetchDataArray(l,k)){this._scaleData(k,l);var m=l.dims[0];f.formatSpecific=l;f.statistics={upToDate:!0,min:"sdfsdf",max:NaN};f.ncpp=this._fetchNcpp(l);f.description=l.description;f.format="nifti";f.spatialUnit=l.getUnitsCodeString(Y.NIFTI1.SPATIAL_UNITS_MASK&l.xyzt_units);f.temporalUnit=l.getUnitsCodeString(Y.NIFTI1.TEMPORAL_UNITS_MASK&
l.xyzt_units);var n=l.getQformMat();0==l.qform_code&&(n=l.affine);console.log(l);for(var r=["k","j","i","t"],e=["x","y","z","t"],u=[],p=0;p<m;p++){for(var t=1,y=0;y<p;y++)t*=l.dims[y+1];t={length:l.dims[p+1],widthDimension:-1,heightDimension:-1,nameVoxelSpace:r[p],nameWorldSpace:e[p],worldUnitSize:l.pixDims[p+1],stride:t,step:l.pixDims[p+1]};u.push(t)}3<=u.length&&(u[0].widthDimension=1,u[0].heightDimension=2,u[1].widthDimension=0,u[1].heightDimension=2,u[2].widthDimension=0,u[2].heightDimension=
1);var l=a(n,0),t=a(n,1),m=a(n,2),r=[l,t,m],t=[r.indexOf(0),r.indexOf(1),r.indexOf(2)],l=JSON.parse(JSON.stringify(n)),q=u;if(0!=r[0]||1!=r[1]||2!=r[2]){for(m=0;3>m;m++)for(p=0;4>p;p++)y=p,3>p&&(y=r[p]),l[m][y]=n[m][p];n=JSON.parse(JSON.stringify(u));n[0].nameVoxelSpace="k";n[1].nameVoxelSpace="j";n[2].nameVoxelSpace="i";n[t[0]].nameWorldSpace="x";n[t[1]].nameWorldSpace="y";n[t[2]].nameWorldSpace="z";n[t[0]].widthDimension=t[1];n[t[0]].heightDimension=t[2];n[t[1]].widthDimension=t[0];n[t[1]].heightDimension=
t[2];n[t[2]].widthDimension=t[0];n[t[2]].heightDimension=t[1];q=n}for(m=0;3>m;m++)n=b(l[m]),u=Math.sign(l[m][m]),t=c(e[m]),t.step=n*u;f.dimensions=q;e=H(l[0][0],l[1][0],l[2][0],l[3][0],l[0][1],l[1][1],l[2][1],l[3][1],l[0][2],l[1][2],l[2][2],l[3][2],l[0][3],l[1][3],l[2][3],l[3][3]);n=B();R(n,e);f.transformations={v2w:e,w2v:n};f.statistics={upToDate:!1,min:0,max:0};e=new Ta;e.setRawData(k);e.setRawMetadata(f);console.log(f);e.metadataIntegrityCheck()&&(e.scanDataRange(),this._output[0]=e)}else console.warn("This NIfTI file is valid but does not contain any readable data.")}else console.warn("Not a NIfTI file");
else console.warn('NiftiDecoderAlt requires an ArrayBuffer as input "0". Unable to continue.')}},{key:"_scaleData",value:function(a,b){if(b.datatypeCode!=Y.NIFTI1.TYPE_RGB24&&(1!=b.scl_slope||0!=b.scl_inter)&&b.scl_slope)for(var d=0;d<a.length;d++)a[d]=a[d]*b.scl_slope+b.scl_inter}},{key:"_fetchNcpp",value:function(a){var b=0;switch(a.datatypeCode){case Y.NIFTI1.TYPE_BINARY:console.warn("The datatype nifti.TYPE_BINARY is not compatible yet.");break;case Y.NIFTI1.TYPE_COMPLEX64:console.warn("The datatype nifti.TYPE_COMPLEX64 is not compatible yet.");
break;case Y.NIFTI1.TYPE_COMPLEX128:console.warn("The datatype nifti.TYPE_COMPLEX128 is not compatible yet.");break;case Y.NIFTI1.TYPE_COMPLEX256:console.warn("The datatype nifti.TYPE_COMPLEX256 is not compatible yet.");break;case Y.NIFTI1.TYPE_FLOAT128:console.warn("The datatype nifti.TYPE_FLOAT128 is not compatible yet.");break;case Y.NIFTI1.TYPE_INT64:console.warn("The datatype nifti.TYPE_INT64 is not compatible yet.");break;case Y.NIFTI1.TYPE_NONE:console.warn("The datatype nifti.TYPE_NONE is not compatible.");
break;case Y.NIFTI1.TYPE_UINT64:console.warn("The datatype nifti.TYPE_INT64 is not compatible yet.");break;case Y.NIFTI1.TYPE_FLOAT32:b=1;break;case Y.NIFTI1.TYPE_FLOAT64:b=1;break;case Y.NIFTI1.TYPE_INT8:b=1;break;case Y.NIFTI1.TYPE_INT16:b=1;break;case Y.NIFTI1.TYPE_INT32:b=1;break;case Y.NIFTI1.TYPE_UINT8:b=1;break;case Y.NIFTI1.TYPE_UINT16:b=1;break;case Y.NIFTI1.TYPE_UINT32:b=1;break;case Y.NIFTI1.TYPE_RGB24:b=3;break;default:console.warn("The datatype is unknown.")}return b}},{key:"_fetchDataArray",
value:function(a,b){var d=null;switch(a.datatypeCode){case Y.NIFTI1.TYPE_BINARY:console.warn("The datatype nifti.TYPE_BINARY is not compatible yet.");break;case Y.NIFTI1.TYPE_COMPLEX64:console.warn("The datatype nifti.TYPE_COMPLEX64 is not compatible yet.");break;case Y.NIFTI1.TYPE_COMPLEX128:console.warn("The datatype nifti.TYPE_COMPLEX128 is not compatible yet.");break;case Y.NIFTI1.TYPE_COMPLEX256:console.warn("The datatype nifti.TYPE_COMPLEX256 is not compatible yet.");break;case Y.NIFTI1.TYPE_FLOAT128:console.warn("The datatype nifti.TYPE_FLOAT128 is not compatible yet.");
break;case Y.NIFTI1.TYPE_INT64:console.warn("The datatype nifti.TYPE_INT64 is not compatible yet.");break;case Y.NIFTI1.TYPE_NONE:console.warn("The datatype nifti.TYPE_NONE is not compatible.");break;case Y.NIFTI1.TYPE_UINT64:console.warn("The datatype nifti.TYPE_INT64 is not compatible yet.");break;case Y.NIFTI1.TYPE_FLOAT32:d=new Float32Array(b);break;case Y.NIFTI1.TYPE_FLOAT64:d=new Float64Array(b);break;case Y.NIFTI1.TYPE_INT8:d=new Int8Array(b);break;case Y.NIFTI1.TYPE_INT16:d=new Int16Array(b);
break;case Y.NIFTI1.TYPE_INT32:d=new Int32Array(b);break;case Y.NIFTI1.TYPE_UINT8:d=new Uint8Array(b);break;case Y.NIFTI1.TYPE_UINT16:d=new Uint16Array(b);break;case Y.NIFTI1.TYPE_UINT32:d=new Uint32Array(b);break;case Y.NIFTI1.TYPE_RGB24:d=new Uint8Array(b);break;default:console.warn("The datatype is unknown.")}return d}},{key:"_computeSubjsctBasedCoord",value:function(a){}}]);return b}(ra),lj=function(c){function b(){I(this,b);var a=P(this,(b.__proto__||Object.getPrototypeOf(b)).call(this));a.setMetadata("filename",
"untitled.pixp");return a}L(b,c);N(b,[{key:"hasValidInput",value:function(){var a=this._getInput();return a&&(a.isOfType(Q.TYPE())||a.isOfType(Ac.TYPE()))}},{key:"_run",value:function(){if(this.hasValidInput()){var a=this._getInput(),a={dataType:a.getData().constructor.name,data:Array.prototype.slice.call(a.getData()),metadata:a.getMetadataCopy(),pixpipeType:a.constructor.name},a=JSON.stringify(a),b=new Ca.Deflate({level:6,gzip:!0,header:{text:!0,time:+new Date,comment:"This file was created by Pixpipe.js"}});
b.push(a,!0);this._output[0]=new Blob([b.result],{type:"application/gzip"})}else console.warn("PixpEncoder can only encode Image2D and Image3D.")}},{key:"download",value:function(){this.getOutput()?Jg.saveAs(this.getOutput(),this.getMetadata("filename")):console.warn("No output computed yet.")}}]);return b}(W),Zg=function(c){function b(){I(this,b);var a=P(this,(b.__proto__||Object.getPrototypeOf(b)).call(this));a.setMetadata("targetType","*");a.addInputValidator(0,ArrayBuffer);return a}L(b,c);N(b,
[{key:"_run",value:function(){if(this.hasValidInput()){var a=this._getInput(),b=new Ca.Inflate({level:6,to:"string"});b.push(a,!0);if(b.err)console.warn("This file is not a Pixp file.");else{a=null;try{a=JSON.parse(b.result)}catch(e){console.warn("Could not parse pixp file.");console.error(e);return}if(a.pixpipeType in pixpipe){b=null;try{b=window}catch(e){try{b=GLOBAL}catch(f){console.warn("You are not in a Javascript environment?? Weird.");return}}if(b[a.dataType]){var b=new b[a.dataType](a.data),
c=new pixpipe[a.pixpipeType];c.setRawData(b);c.setRawMetadata(a.metadata);this._output[0]=c}else console.warn("Data array from pixp file is unknown: "+a.dataType)}else console.warn("Unknown type pixpipe."+a.pixpipeType+", cannot create any output.")}}else console.warn("PixpDecoder can only decode ArrayBuffer.")}}]);return b}(ra),$g=function(c){function b(){I(this,b);var a=P(this,(b.__proto__||Object.getPrototypeOf(b)).call(this));a.setMetadata("targetType",Ia.name);a.addInputValidator(0,ArrayBuffer);
a.setMetadata("debug",!1);return a}L(b,c);N(b,[{key:"_parseMGHHeader",value:function(a,b){b={order:["xspace","yspace","zspace"],xspace:{},yspace:{},zspace:{}};var d=new DataView(a,0,284);a=d.getUint32(0,!0);if(1===a)a=!0;else if(16777216===a)a=!1;else return console.warn("This does not look like an MGH file."),null;var c,f=[0,0,0,0],k=4,l=1;for(c=0;4>c;c++){f[c]=d.getUint32(k,a);if(1>=f[c])break;l*=f[c];k+=4}if(3>c||4<c)return console.warn("Cannot handle "+c+"-dimensional images yet."),null;var m=
d.getUint32(20,a),n=[1,1,1],r,u,p=[[-1,0,0],[0,0,-1],[0,1,0],[0,0,0]];if(d.getUint16(28,a)){k=30;for(r=0;3>r;r++)n[r]=d.getFloat32(k,a),k+=4;for(r=0;4>r;r++)for(u=0;3>u;u++)p[r][u]=d.getFloat32(k,a),k+=4}if(this._metadata.debug)for(r=0;3>r;r++){d="";for(u=0;4>u;u++)d+="xyzc"[u]+"_"+"ras"[r]+" "+p[u][r]+" ";console.log(d)}d=[0,1,2];for(r=0;3>r;r++){u=0;var k=Math.abs(p[r][0]),t=Math.abs(p[r][1]),y=Math.abs(p[r][2]);b.order[r]="xspace";t>k&&t>y&&(u=1,b.order[r]="yspace");y>k&&y>t&&(u=2,b.order[r]="zspace");
d[r]=u}4===c&&(this._metadata.debug&&console.log("Creating time dimension: "+f[3]),b.time={space_length:f[3],step:1,start:0,name:"time"},b.order.push("time"));c=[[0,0,0,0],[0,0,0,0],[0,0,0,0]];for(r=0;3>r;r++)for(u=0;3>u;u++)c[r][u]=p[u][r]*n[r];for(r=0;3>r;r++){for(u=n=0;3>u;u++)n+=f[u]/2*c[r][u];c[r][3]=p[3][r]-n}p=[[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0]];for(r=0;3>r;r++)for(u=0;4>u;u++)n=u,3>u&&(n=d[u]),p[r][n]=c[r][u];Ia.transformToMinc(p,b);b.datatype=m;b.little_endian=a;b.nvoxels=l;for(r=0;3>
r;r++)b[b.order[r]].space_length=f[r];return b}},{key:"_createMGHData",value:function(a,b){var d=null,c;switch(a.datatype){case 0:c=1;break;case 1:case 3:c=4;break;case 4:c=2;break;default:return console.warn("Unsupported data type: "+a.datatype),null}var f=a.nvoxels*c;1<c&&!a.little_endian&&Ia.swapn(new Uint8Array(b,284,f),c);switch(a.datatype){case 0:d=new Uint8Array(b,284,a.nvoxels);break;case 1:d=new Int32Array(b,284,a.nvoxels);break;case 3:d=new Float32Array(b,284,a.nvoxels);break;case 4:d=new Int16Array(b,
284,a.nvoxels)}b=1;for(c=0;c<a.order.length;c++)a[a.order[c]].offset=b,b*=a[a.order[c]].space_length;return d}},{key:"_run",value:function(){var a=this._getInput(0);if(a){var b=null;try{b=this._parseMGHHeader(a)}catch(e){}if(b){a=this._createMGHData(b,a);if(!a)return null;this._addOutput(Ia);var c=this.getOutput();c.setData(a,b);c.setMetadata("format","mgh")}else console.log("The input file is not a MGH file.")}else console.warn('MghDecoder requires an ArrayBuffer as input "0". Unable to continue.')}}]);
return b}(ra),mj=function(c){function b(){I(this,b);var a=P(this,(b.__proto__||Object.getPrototypeOf(b)).call(this));a._decoders=[Vg,Wg,$g,Zg];return a}L(b,c);N(b,[{key:"_run",value:function(){var a=this._getInput(0);if(a)for(var b=0;b<this._decoders.length;b++){var c=new this._decoders[b];c.addInput(a);c.update();if(c.getNumberOfOutputs()){this._output[0]=c.getOutput();this.setMetadata("decoderConstructor",this._decoders[b]);this.setMetadata("decoderName",this._decoders[b].name);break}}else console.warn("The input buffer must not be null.")}}]);
return b}(W),Kc=function(){function c(){I(this,c)}N(c,null,[{key:"convertOld2New",value:function(b){function a(a){for(var b=0;b<d.dimensions.length;b++)if(d.dimensions[b].nameWorldSpace===a)return b;return-1}for(var d={ncpp:1,dimensions:[]},c=["k","j","i","t"],e=0;e<b.order.length;e++){var f=b[b.order[e]],k={};k.length=f.space_length;k.nameWorldSpace=b.order[e][0];k.nameVoxelSpace="";k.worldUnitSize=Math.abs(f.step);k.step=f.step;k.worldStep=f.step;k.stride=f.offset;d.dimensions.push(k)}d.dimensions.sort(function(a,
b){return a.stride>b.stride});for(e=0;e<b.order.length;e++)d.dimensions[e].nameVoxelSpace=c[e];for(e=0;e<d.dimensions.length;e++)c=d.dimensions[e].nameWorldSpace,d.dimensions[e].widthDimension=a("x"===c?"y":"y"===c?"x":"z"===c?"x":null),d.dimensions[e].heightDimension=a("x"===c?"z":"y"===c?"z":"z"===c?"y":null);d.statistics={upToDate:!1,min:0,max:0};d.description="";d.spatialUnit="";d.temporalUnit="";d.format="format"in b?b.format:"generic";b=H(b.w2v[0][0],b.w2v[1][0],b.w2v[2][0],0,b.w2v[0][1],b.w2v[1][1],
b.w2v[2][1],0,b.w2v[0][2],b.w2v[1][2],b.w2v[2][2],0,b.w2v[0][3],b.w2v[1][3],b.w2v[2][3],1);e=B();R(e,b);d.transformations={v2w:e,w2v:b};return d}},{key:"convertImage3DMetadata",value:function(b){c.completeHeader(b);return c.convertOld2New(b)}},{key:"completeHeader",value:function(b){var a=b.xspace,d=b.yspace,c=b.zspace,e=a.start,f=d.start,k=c.start,l=a.direction_cosines,m=d.direction_cosines,n=c.direction_cosines,r=a.step,u=d.step,p=c.step,e={x:e*l[0]+f*m[0]+k*n[0],y:e*l[1]+f*m[1]+k*n[1],z:e*l[2]+
f*m[2]+k*n[2]};b.voxel_origin=e;b.w2v=[[l[0]/r,l[1]/r,l[2]/r,(-e.x*l[0]-e.y*l[1]-e.z*l[2])/r],[m[0]/u,m[1]/u,m[2]/u,(-e.x*m[0]-e.y*m[1]-e.z*m[2])/u],[n[0]/p,n[1]/p,n[2]/p,(-e.x*n[0]-e.y*n[1]-e.z*n[2])/p]];a.width_space=JSON.parse(JSON.stringify(d));a.width=d.space_length;a.height_space=JSON.parse(JSON.stringify(c));a.height=c.space_length;d.width_space=JSON.parse(JSON.stringify(a));d.width=a.space_length;d.height_space=JSON.parse(JSON.stringify(c));d.height=c.space_length;c.width_space=JSON.parse(JSON.stringify(a));
c.width=a.space_length;c.height_space=JSON.parse(JSON.stringify(d));c.height=d.space_length}},{key:"transformToMinc",value:function(b,a){function d(a){a=a[0]*a[0]+a[1]*a[1]+a[2]*a[2];0>=a&&(a=1);return Math.sqrt(a)}function c(a,b,d){return a[0]*(b[1]*d[2]-b[2]*d[1])-a[1]*(b[0]*d[2]-b[2]*d[0])+a[2]*(b[0]*d[1]-b[1]*d[0])}for(var e=[],f=[],k=[],l=d(b[0]),m=d(b[1]),n=d(b[2]),l=0>b[0][0]?-l:l,m=0>b[1][1]?-m:m,n=0>b[2][2]?-n:n,r=0;3>r;r++)e[r]=b[r][0]/l,f[r]=b[r][1]/m,k[r]=b[r][2]/n;a.xspace.step=l;a.yspace.step=
m;a.zspace.step=n;m=[b[0][3],b[1][3],b[2][3]];b=c(e,f,k);l=c(m,f,k);n=c(e,m,k);m=c(e,f,m);a.xspace.start=l/b;a.yspace.start=n/b;a.zspace.start=m/b;a.xspace.direction_cosines=e;a.yspace.direction_cosines=f;a.zspace.direction_cosines=k}},{key:"swapn",value:function(b,a){for(var d=0;d<b.length;d+=a)for(var c=a-1,e=0;c>e;){var f=b[d+c];b[d+c]=b[d+e];b[d+e]=f;c--;e++}}}]);return c}(),ah=function(c){function b(){I(this,b);var a=P(this,(b.__proto__||Object.getPrototypeOf(b)).call(this));a.setMetadata("targetType",
Ta.name);a.addInputValidator(0,ArrayBuffer);a.setMetadata("debug",!1);a._type_enum={INT8:1,UINT8:2,INT16:3,UINT16:4,INT32:5,UINT32:6,FLT:7,DBL:8,STR:9};a._type_matching="int8 uint8 int16 uint16 int32 uint32 float32 float64 undef".split(" ");a.type_sizes=[0,1,1,2,2,4,4,4,8,0];a._dv_offset=0;a._align=8;a._little_endian=!0;a._continuation_queue=[];a._dv=null;a._superblk={};a._start_offset=0;a._huge_id=0;return a}L(b,c);N(b,[{key:"createLink",value:function(){return{hdr_offset:0,data_offset:0,data_length:0,
n_filled:0,chunk_size:0,sym_btree:0,sym_lheap:0,name:"",attributes:{},children:[],array:void 0,type:-1,inflate:!1,dims:[]}}},{key:"startAlignment",value:function(){this._start_offset=this._dv_offset}},{key:"checkAlignment",value:function(){var a=this._dv_offset-this._start_offset;if(0!==a%this._align){var b=this._align-a%this._align;this._dv_offset+=b;this.getMetadata("debug")&&console.log("skipping "+b+" bytes at "+a+" for alignmnent")}}},{key:"skip",value:function(a){this._dv_offset+=a}},{key:"seek",
value:function(a){this._dv_offset=a}},{key:"tell",value:function(){return this._dv_offset}},{key:"getU8",value:function(){var a=this._dv.getUint8(this._dv_offset);this._dv_offset+=1;return a}},{key:"getU16",value:function(){var a=this._dv.getUint16(this._dv_offset,this._little_endian);this._dv_offset+=2;return a}},{key:"getU32",value:function(){var a=this._dv.getUint32(this._dv_offset,this._little_endian);this._dv_offset+=4;return a}},{key:"getU64",value:function(){var a=this._dv.getUint64(this._dv_offset,
this._little_endian);this._dv_offset+=8;return a}},{key:"getF32",value:function(){var a=this._dv.getFloat32(this._dv_offset,this._little_endian);this._dv_offset+=4;return a}},{key:"getF64",value:function(){var a=this._dv.getFloat64(this._dv_offset,this._little_endian);this._dv_offset+=8;return a}},{key:"getOffset",value:function(a){var b;a=a||this._superblk.offsz;if(4===a)b=this._dv.getUint32(this._dv_offset,this._little_endian);else if(8===a)b=this._dv.getUint64(this._dv_offset,this._little_endian);
else throw Error("Unsupported value for offset size "+a);this._dv_offset+=a;return b}},{key:"getLength",value:function(){var a=this._dv.getUint64(this._dv_offset,this._little_endian);this._dv_offset+=this._superblk.lensz;return a}},{key:"getString",value:function(a){var b="",c,e;for(c=0;c<a;c+=1){e=this.getU8();if(0===e){this._dv_offset+=a-c-1;break}b+=String.fromCharCode(e)}return b}},{key:"getArray",value:function(a,b,c){var d=this._getInput(),g=this._dv_offset;c&&(this._dv_offset=c);switch(a){case this._type_enum.INT8:a=
new Int8Array(d,this._dv_offset,b);break;case this._type_enum.UINT8:a=new Uint8Array(d,this._dv_offset,b);break;case this._type_enum.INT16:if(0!==this._dv_offset%2)for(a=new ArrayBuffer(b),b/=2,a=new Int16Array(a),d=0;d<b;d+=1)a[d]=this.getU16();else a=new Int16Array(d,this._dv_offset,b/2),this._dv_offset+=b;break;case this._type_enum.UINT16:if(0!==this._dv_offset%2)for(a=new ArrayBuffer(b),b/=2,a=new Uint16Array(a),d=0;d<b;d+=1)a[d]=this.getU16();else a=new Uint16Array(d,this._dv_offset,b/2),this._dv_offset+=
b;break;case this._type_enum.INT32:if(0!==this._dv_offset%4)for(a=new ArrayBuffer(b),b/=4,a=new Int32Array(a),d=0;d<b;d+=1)a[d]=this.getU32();else a=new Int32Array(d,this._dv_offset,b/4),this._dv_offset+=b;break;case this._type_enum.UINT32:if(0!==this._dv_offset%4)for(a=new ArrayBuffer(b),b/=4,a=new Uint32Array(a),d=0;d<b;d+=1)a[d]=this.getU32();else a=new Uint32Array(d,this._dv_offset,b/4),this._dv_offset+=b;break;case this._type_enum.FLT:if(0!==this._dv_offset%4)for(a=new ArrayBuffer(b),b/=4,a=
new Float32Array(a),d=0;d<b;d+=1)a[d]=this.getF32();else a=new Float32Array(d,this._dv_offset,b/4),this._dv_offset+=b;break;case this._type_enum.DBL:if(0!==this._dv_offset%8)for(a=new ArrayBuffer(b),b/=8,a=new Float64Array(a),d=0;d<b;d+=1)a[d]=this.getF64();else a=new Float64Array(d,this._dv_offset,b/8),this._dv_offset+=b;break;default:throw Error("Bad type in this.getArray "+a);}c&&(this._dv_offset=g);return a}},{key:"getUXX",value:function(a){var b,c;switch(a){case 1:b=this._dv.getUint8(this._dv_offset);
break;case 2:b=this._dv.getUint16(this._dv_offset,this._little_endian);break;case 4:b=this._dv.getUint32(this._dv_offset,this._little_endian);break;case 8:b=this._dv.getUint64(this._dv_offset,this._little_endian);break;default:if(b=0,this._little_endian)for(c=a-1;0<=c;c--)b=(b<<8)+this._dv.getUint8(this._dv_offset+c);else for(c=0;c<a;c++)b=(b<<8)+this._dv.getUint8(this._dv_offset+c)}this._dv_offset+=a;return b}},{key:"checkSignature",value:function(a){var b;for(b=0;b<a.length;b+=1)if(this._dv.getUint8(this._dv_offset+
b)!==a.charCodeAt(b))return!1;this.skip(a.length);return!0}},{key:"hdf5Superblock",value:function(){var a={};if(!this.checkSignature("\u0089HDF\r\n\u001a\n"))throw Error("Bad magic string in HDF5");a.sbver=this.getU8();if(2<a.sbver)throw Error("Unsupported HDF5 superblock version "+a.sbver);1>=a.sbver?(a.fsver=this.getU8(),a.rgver=this.getU8(),this.skip(1),a.shver=this.getU8(),a.offsz=this.getU8(),a.lensz=this.getU8(),this.skip(1),a.gln_k=this.getU16(),a.gin_k=this.getU16(),a.cflags=this.getU32(),
1===a.sbver&&(a.isin_k=this.getU16(),this.skip(2)),a.base_addr=this.getOffset(a.offsz),a.gfsi_addr=this.getOffset(a.offsz),a.eof_addr=this.getOffset(a.offsz),a.dib_addr=this.getOffset(a.offsz),a.root_ln_offs=this.getOffset(a.offsz),a.root_addr=this.getOffset(a.offsz),a.root_cache_type=this.getU32(),this.skip(4),this.skip(16)):(a.offsz=this.getU8(),a.lensz=this.getU8(),a.cflags=this.getU8(),a.base_addr=this.getOffset(a.offsz),a.ext_addr=this.getOffset(a.offsz),a.eof_addr=this.getOffset(a.offsz),a.root_addr=
this.getOffset(a.offsz),a.checksum=this.getU32());this.getMetadata("debug")&&console.log("HDF5 SB "+a.sbver+" "+a.offsz+" "+a.lensz+" "+a.cflags);return a}},{key:"hdf5FractalHeapHeader",value:function(){var a={};if(!this.checkSignature("FRHP"))throw Error("Bad or missing FRHP signature");a.ver=this.getU8();a.idlen=this.getU16();a.iof_el=this.getU16();a.flags=this.getU8();a.objmax=this.getU32();a.objnid=this.getLength();a.objbta=this.getOffset();a.nf_blk=this.getLength();a.af_blk=this.getOffset();
a.heap_total=this.getLength();a.heap_alloc=this.getLength();a.bai_offset=this.getLength();a.heap_nobj=this.getLength();a.heap_chuge=this.getLength();a.heap_nhuge=this.getLength();a.heap_ctiny=this.getLength();a.heap_ntiny=this.getLength();a.table_width=this.getU16();a.start_blksz=this.getLength();a.max_blksz=this.getLength();a.max_heapsz=this.getU16();a.rib_srows=this.getU16();a.root_addr=this.getOffset();a.rib_crows=this.getU16();var b=Math.log2(a.max_blksz)-Math.log2(a.start_blksz)+2;a.K=Math.min(a.rib_crows,
b)*a.table_width;a.N=a.rib_crows<b?0:a.K-b*a.table_width;this.getMetadata("debug")&&(console.log("FRHP V"+a.ver+" F"+a.flags+" "+a.objbta+" Total:"+a.heap_total+" Alloc:"+a.heap_alloc+" #obj:"+a.heap_nobj+" width:"+a.table_width+" start_blksz:"+a.start_blksz+" max_blksz:"+a.max_blksz+" "+a.max_heapsz+" srows:"+a.rib_srows+" crows:"+a.rib_crows+" "+a.heap_nhuge),console.log("   K: "+a.K+" N: "+a.N));if(0<a.iof_el)throw Error("Filters present in fractal heap.");return a}},{key:"hdf5V2BtreeHeader",value:function(){var a=
{};if(!this.checkSignature("BTHD"))throw Error("Bad or missing BTHD signature");a.ver=this.getU8();a.type=this.getU8();a.nodesz=this.getU32();a.recsz=this.getU16();a.depth=this.getU16();a.splitp=this.getU8();a.mergep=this.getU8();a.root_addr=this.getOffset();a.root_nrec=this.getU16();a.total_nrec=this.getLength();a.checksum=this.getU32();this.getMetadata("debug")&&console.log("BTHD V"+a.ver+" T"+a.type+" "+a.nodesz+" "+a.recsz+" "+a.depth+" "+a.root_addr+" "+a.root_nrec+" "+a.total_nrec);return a}},
{key:"hdf5V2BtreeRecords",value:function(a,b,c,e){var d,g,l;if(1===b)for(b=0;b<c;b++)g=this.getOffset(),l=this.getLength(),a=this.getLength(),this.getMetadata("debug")&&console.log("  -> "+g+" "+l+" "+a+" "+this._this._huge_id),d=this.tell(),a===this._this._huge_id&&(this.seek(g),this.hdf5MsgAttribute(l,e)),this.seek(d);else if(8===b){var m,n;m=a.max_heapsz/8;b=Math.min(a.objmax,a.max_blksz);n=256>=b?1:65536>=b?2:4;for(b=0;b<c;b++){d=this.getU8();if(0!==(d&192))throw Error("Bad Fractal Heap ID version "+
d);var r=d&48,u;if(16===r)this._this._huge_id=this.getUXX(7);else if(0===r)g=this.getUXX(m),l=this.getUXX(n);else throw Error("Can't handle this Heap ID: "+d);u=this.getU8();this.getU32();this.getU32();this.getMetadata("debug")&&console.log("  -> "+d+" "+g+" "+l+" "+u);d=this.tell();if(16===r)if(this.seek(a.objbta),r=this.hdf5V2BtreeHeader(),1===r.type)this.seek(r.root_addr),this.hdf5V2BtreeLeafNode(a,r.root_nrec,e);else throw Error("Can only handle type-1 btrees");else r=this.hdf5FractalHeapOffset(a,
g),this.seek(r),this.hdf5MsgAttribute(l,e);this.seek(d)}}else throw Error("Unhandled V2 btree type.");}},{key:"hdf5V2BtreeLeafNode",value:function(a,b,c){if(!this.checkSignature("BTLF"))throw Error("Bad or missing BTLF signature");var d=this.getU8(),g=this.getU8();this.getMetadata("debug")&&console.log("BTLF V"+d+" T"+g+" "+this.tell());this.hdf5V2BtreeRecords(a,g,b,c)}},{key:"hdf5V2BtreeInternalNode",value:function(a,b,c,e){if(!this.checkSignature("BTIN"))throw Error("Bad or missing BTIN signature");
var d=this.getU8(),g=this.getU8();this.getMetadata("debug")&&console.log("BTIN V"+d+" T"+g);this.hdf5V2BtreeRecords(a,g,b,e);for(a=0;a<=b;a++){e=this.getOffset();var d=this.getUXX(1),l;1<c&&(l=this.getUXX(1));this.getMetadata("debug")&&console.log(" child->"+e+" "+d+" "+l)}}},{key:"hdf5GetMsgName",value:function(a){var b="NIL;Dataspace;LinkInfo;Datatype;FillValue 1;FillValue 2;Link;ExternalFiles;Layout;BOGUS;GroupInfo;FilterPipeline;Attribute;ObjectComment;ObjectModTime 1;SharedMsgTable;ObjHdrContinue;SymbolTable;ObjectModTime 2;BtreeKValue;DriverInfo;AttrInfo;ObjectRefCnt;MESSAGE23;FileSpaceInfo".split(";");
if(a<b.length)return b[a];throw Error("Unknown message type "+a+" "+this.tell());}},{key:"hdf5V1BtreeNode",value:function(a){var b=this._getInput(),c,e={};if(!this.checkSignature("TREE"))throw Error("Bad TREE signature at "+this.tell());e.keys=[];e.node_type=this.getU8();e.node_level=this.getU8();e.entries_used=this.getU16();e.left_sibling=this.getOffset();e.right_sibling=this.getOffset();this.getMetadata("debug")&&console.log("BTREE type "+e.node_type+" lvl "+e.node_level+" n_used "+e.entries_used+
" "+e.left_sibling+" "+e.right_sibling);if(a){var f,k=[];for(c=0;c<e.entries_used;c+=1){e.keys[c]={};k[c]={};k[c].chunk_size=this.getU32();k[c].filter_mask=this.getU32();k[c].chunk_offsets=[];for(f=0;f<a.dims.length+1;f+=1)k[c].chunk_offsets.push(this.getU64());e.keys[c].child_address=this.getOffset();c<e.entries_used&&this.getMetadata("debug")&&console.log("  BTREE "+c+" chunk_size "+k[c].chunk_size+" filter_mask "+k[c].filter_mask+" addr "+e.keys[c].child_address)}k[c]={};k[c].chunk_size=this.getU32();
k[c].filter_mask=this.getU32();k[c].chunk_offsets=[];for(f=0;f<a.dims.length+1;f+=1)k[c].chunk_offsets.push(this.getU64());if(0===e.node_level){var l;for(c=0;c<e.entries_used;c+=1)if(f=k[c].chunk_size,l=e.keys[c].child_address,a.inflate){f=new Uint8Array(b,l,f);l=Ca.inflate(f);switch(a.type){case this._type_enum.INT8:l=new Int8Array(l.buffer);break;case this._type_enum.UINT8:l=new Uint8Array(l.buffer);break;case this._type_enum.INT16:l=new Int16Array(l.buffer);break;case this._type_enum.UINT16:l=
new Uint16Array(l.buffer);break;case this._type_enum.INT32:l=new Int32Array(l.buffer);break;case this._type_enum.UINT32:l=new Uint32Array(l.buffer);break;case this._type_enum.FLT:l=new Float32Array(l.buffer);break;case this._type_enum.DBL:l=new Float64Array(l.buffer);break;default:throw Error("Unknown type code "+a.type);}a.array.length-a.n_filled<l.length&&(l=l.subarray(0,a.array.length-a.n_filled));a.array.set(l,a.n_filled);a.n_filled+=l.length;this.getMetadata("debug")&&console.log(a.name+" "+
f.length+" "+l.length+" "+a.n_filled+"/"+a.array.length)}else l=this.getArray(a.type,f,l),a.array.set(l,a.n_filled),a.n_filled+=l.length}else for(c=0;c<e.entries_used;c+=1)this.seek(e.keys[c].child_address),this.hdf5V1BtreeNode(a)}else for(c=0;c<e.entries_used;c+=1)e.keys[c]={},e.keys[c].key_value=this.getLength(),e.keys[c].child_address=this.getOffset(),this.getMetadata("debug")&&console.log("  BTREE "+c+" key "+e.keys[c].key_value+" adr "+e.keys[c].child_address);return e}},{key:"hdf5GroupSymbolTable",
value:function(a,b){if(!this.checkSignature("SNOD"))throw Error("Bad or missing SNOD signature");var d=this.getU8();this.skip(1);var c=this.getU16();this.getMetadata("debug")&&console.log("this.hdf5GroupSymbolTable V"+d+" #"+c+" '"+b.name+"'");for(var f,k,l,m,n,d=0;d<2*this._superblk.gln_k;d+=1)f=this.getOffset(),k=this.getOffset(),l=this.getU32(),this.skip(20),d<c&&(m=this.createLink(),m.hdr_offset=k,a&&(n=this.tell(),this.seek(a.lh_dseg_off+f),m.name=this.getString(a.lh_dseg_len),this.seek(n)),
this.getMetadata("debug")&&console.log("    "+d+" O "+f+" A "+k+" T "+l+" '"+m.name+"'"),b.children.push(m))}},{key:"hdf5LocalHeap",value:function(){var a={};if(!this.checkSignature("HEAP"))throw Error("Bad or missing HEAP signature");a.lh_ver=this.getU8();this.skip(3);a.lh_dseg_len=this.getLength();a.lh_flst_len=this.getLength();a.lh_dseg_off=this.getOffset();this.getMetadata("debug")&&console.log("LHEAP V"+a.lh_ver+" "+a.lh_dseg_len+" "+a.lh_flst_len+" "+a.lh_dseg_off);return a}},{key:"hdf5MsgDataspace",
value:function(a,b){var d,c=this.getU8(),f=this.getU8(),k=this.getU8();1>=c?this.skip(5):this.skip(1);var l=1,m=[],n;for(n=0;n<f;n+=1)m[n]=this.getLength(),l*=m[n];d=f*this._superblk.lensz+(1>=c?8:4);if(0!==(k&1))for(d+=f*this._superblk.lensz,n=0;n<f;n+=1)this.getLength();if(0!==(k&2))for(d+=f*this._superblk.lensz,n=0;n<f;n+=1)this.getLength();c="this.hdf5MsgDataspace V"+c+" N"+f+" F"+k;this.getMetadata("debug")&&(0!==f&&(c+="["+m.join(", ")+"]"),console.log(c));d<a&&this.skip(a-d);b&&(b.dims=m);
return l}},{key:"hdf5MsgLinkInfo",value:function(a){var b=this,c=this.getU8(),e=this.getU8();0!==(e&1)&&this.getU64();var f=this.getOffset(),k=this.getOffset();0!==(e&2)&&this.getOffset();this.getMetadata("debug")&&console.log("this.hdf5MsgLinkInfo V"+c+" F"+e+" FH "+f+" BT "+k);c=this.tell();if(f<this._superblk.eof_addr){this.seek(f);var l=this.hdf5FractalHeapHeader(),m=0;this.hdf5FractalHeapEnumerate(l,function(d,c,e,g){for(d=c+g;m<l.heap_nobj&&b.tell()<d;)b.hdf5MsgLink(a),m+=1;return!0})}this.seek(c)}},
{key:"dt_class_name",value:function(a){var b="Fixed-Point Floating-Point Time String BitField Opaque Compound Reference Enumerated Variable-Length Array".split(" ");if(a<b.length)return b[a];throw Error("Unknown datatype class: "+a);}},{key:"hdf5MsgDatatype",value:function(a){var b={},c=8,e,f,k,l,m,n,r,u,p=this.getU8();e=p>>4;f=p&15;l=[];for(p=0;3>p;p+=1)l[p]=this.getU8();p=this.getU32();this.getMetadata("debug")&&console.log("this.hdf5MsgDatatype V"+e+" C"+f+" "+this.dt_class_name(f)+" "+l[0]+"."+
l[1]+"."+l[2]+" "+p);switch(f){case 0:f=this.getU16();k=this.getU16();switch(p){case 4:b.typ_type=l[0]&8?this._type_enum.INT32:this._type_enum.UINT32;break;case 2:b.typ_type=l[0]&8?this._type_enum.INT16:this._type_enum.UINT16;break;case 1:b.typ_type=l[0]&8?this._type_enum.INT8:this._type_enum.UINT8;break;default:throw Error("Unknown type size "+p);}b.typ_length=p;c+=4;this.getMetadata("debug")&&console.log("  ("+f+" "+k+")");break;case 1:e="";if(this.getMetadata("debug"))switch(l[0]&65){case 0:e+=
"LE ";break;case 1:e+="BE ";break;case 65:e+="VX ";break;default:throw Error("Reserved fp byte order: "+l[0]);}f=this.getU16();k=this.getU16();l=this.getU8();m=this.getU8();n=this.getU8();r=this.getU8();u=this.getU32();this.getMetadata("debug")&&(e+=f+" "+k+" "+l+" "+m+" "+n+" "+r+" "+u);if(64===k&&0===f&&52===l&&11===m&&0===n&&52===r&&1023===u&&8===p)b.typ_type=this._type_enum.DBL;else if(32===k&&0===f&&23===l&&8===m&&0===n&&23===r&&127===u&&4===p)b.typ_type=this._type_enum.FLT;else throw Error("Unsupported floating-point type");
this.getMetadata("debug")&&console.log(e);b.typ_length=p;c+=12;break;case 3:b.typ_type=this._type_enum.STR;b.typ_length=p;break;default:throw Error("Unimplemented HDF5 data class "+f);}a>c&&this.skip(a-c);return b}},{key:"hdf5MsgLayout",value:function(a){var b="",c=this.getU8(),e,f,k,l=[];k=1;if(1===c||2===c){f=this.getU8();e=this.getU8();this.skip(5);this.getMetadata("debug")&&(b+="this.hdf5MsgLayout V"+c+" N"+f+" C"+e);if(1===e||2===e)c=this.getOffset(),this.getMetadata("debug")&&(b+=" A"+c),a.data_offset=
c;for(c=0;c<f;c+=1)l[c]=this.getU32(),k*=l[c];this.getMetadata("debug")&&(b+="["+l.join(", ")+"]");2===e&&(f=this.getU32(),a.chunk_size=k*f,this.getMetadata("debug")&&(b+=" E"+f));0===e?(k=this.getU32(),this.getMetadata("debug")&&(b+="("+k+")"),a.data_offset=this.tell(),a.data_length=k):1===e&&(a.data_length=k)}else if(3===c)if(e=this.getU8(),b="this.hdf5MsgLayout V"+c+" C"+e,0===e)k=this.getU16(),this.getMetadata("debug")&&(b+="("+k+")"),a.data_offset=this.tell(),a.data_length=k;else if(1===e)e=
this.getOffset(),k=this.getLength(),this.getMetadata("debug")&&(b+="("+e+", "+k+")"),a.data_offset=e,a.data_length=k;else{if(2===e){f=this.getU8();e=this.getOffset();a.data_offset=e;a.chunk_size=1;for(c=0;c<f-1;c+=1)l[c]=this.getU32(),k*=l[c];this.getMetadata("debug")&&(b+="(N"+f+", A"+e+" ["+l.join(",")+"]");f=this.getU32();a.chunk_size=k*f;this.getMetadata("debug")&&(b+=" E"+f)}}else throw Error("Illegal layout version "+c);this.getMetadata("debug")&&console.log(b)}},{key:"hdf5MsgPipeline",value:function(a){var b=
this.getU8(),c=this.getU8(),e="this.hdf5MsgPipeline V"+b+" N"+c;1===b&&this.skip(6);this.getMetadata("debug")&&console.log(e);for(var f,k,l,m,e=0;e<c;e+=1){f=this.getU16();if(1!==f)throw Error("Unimplemented HDF5 filter "+f);if("object"!==("undefined"===typeof Ca?"undefined":O(Ca)))throw Error("Need pako to inflate data.");a.inflate=!0;k=1===b||256<f?this.getU16():0;l=this.getU16();m=this.getU16();0!==(m&1)&&(m+=1);0!==k&&this.skip(k);this.skip(4*m);this.getMetadata("debug")&&console.log("  "+e+" ID"+
f+" F"+l+" "+m)}}},{key:"hdf5MsgAttribute",value:function(a,b){var d=this.getU8(),c=this.getU8(),f=this.getU16(),k=this.getU16(),l=this.getU16(),m="this.hdf5MsgAttribute V"+d+" F"+c+" "+a+": ";if(0!==(c&3))throw Error("Shared dataspaces and datatypes are not supported.");3===d&&(c=this.getU8(),this.getMetadata("debug")&&(m+=0===c?"ASCII":"UTF-8"));this.getMetadata("debug")&&(m+="("+f+" "+k+" "+l+")");3>d&&(f=8*Math.floor((f+7)/8),k=8*Math.floor((k+7)/8),l=8*Math.floor((l+7)/8),this.getMetadata("debug")&&
(m+="/("+f+" "+k+" "+l+")"));c=this.getString(f);this.getMetadata("debug")&&console.log(m+(" Name: "+c));var m=this.hdf5MsgDatatype(k),n=this.hdf5MsgDataspace(l);a=0<a?3>d?a-(8+f+k+l):a-(9+f+k+l):m.typ_length*n;this.getMetadata("debug")&&console.log("  attribute data size "+a+" "+this.tell());a=m.typ_type===this._type_enum.STR?this.getString(a):this.getArray(m.typ_type,a);b.attributes[c]=a}},{key:"hdf5MsgGroupInfo",value:function(){var a=4,b=8,c=this.getU8(),e=this.getU8();0!==(e&1)&&(this.getU16(),
this.getU16());0!==(e&2)&&(a=this.getU16(),b=this.getU16());this.getMetadata("debug")&&console.log("this.hdf5MsgGroupInfo V"+c+" F"+e+" ENT "+a+" LNL "+b)}},{key:"hdf5MsgLink",value:function(a){var b=this.getU8(),c=0;if(1!==b)throw Error("Bad link message version "+b);var e=this.getU8();0!==(e&8)&&(c=this.getU8());0!==(e&4)&&this.getU64();0!==(e&16)&&this.getU8();var f=this.getUXX(1<<(e&3)),k=this.createLink();k.name=this.getString(f);0===(e&8)&&(k.hdr_offset=this.getOffset());this.getMetadata("debug")&&
console.log("this.hdf5MsgLink V"+b+" F"+e+" T"+c+" NM "+k.name+" OF "+k.hdr_offset);a.children.push(k)}},{key:"hdf5FractalHeapDirectBlock",value:function(a,b,c,e){if(!this.checkSignature("FHDB"))throw Error("Bad or missing FHDB signature");var d=this.getU8();if(0!==d)throw Error("Bad FHDB version: "+d);this.getOffset();var g=this.getUXX(Math.ceil(a.max_heapsz/8));0!==(a.flags&2)&&this.getU32();this.getMetadata("debug")&&console.log("FHDB V:"+d+" R:"+b+" O:"+g+" A:"+c);a=1>=b?a.start_blksz:Math.pow(2,
b-1)*a.start_blksz;return e?e(b,c,g,a):!0}},{key:"hdf5FractalHeapIndirectBlock",value:function(a,b){if(!this.checkSignature("FHIB"))throw Error("Bad or missing FHIB signature");var d=this.getU8();if(0!==d)throw Error("Bad FHIB version: "+d);this.getOffset();var c=this.getUXX(Math.ceil(a.max_heapsz/8));this.getMetadata("debug")&&console.log("FHIB V:"+d+" O:"+c);for(var f=[],d=0;d<a.K;d+=1)c=this.getOffset(),c<this._superblk.eof_addr&&(this.getMetadata("debug")&&console.log("direct block at "+c),f.push(c));
for(var k=[],d=0;d<a.N;d+=1)c=this.getOffset(),c<this._superblk.eof_addr&&(this.getMetadata("debug")&&console.log("indirect block at "+c),k.push(c));this.getU32();for(d=0;d<f.length;d++)if(this.seek(f[d]),!this.hdf5FractalHeapDirectBlock(a,d/a.table_width,f[d],b))return!1;for(d=0;d<k.length;d++)if(this.seek(k[d]),!this.hdf5FractalHeapIndirectBlock(a,b))return!1;return!0}},{key:"hdf5FractalHeapEnumerate",value:function(a,b){this.seek(a.root_addr);0===a.K?this.hdf5FractalHeapDirectBlock(a,0,a.root_addr,
b):this.hdf5FractalHeapIndirectBlock(a,b)}},{key:"hdf5FractalHeapOffset",value:function(a,b){var d;this.hdf5FractalHeapEnumerate(a,function(a,c,g,l){return b>=g&&b<g+l?(d=c+(b-g),!1):!0});return d}},{key:"hdf5MsgAttrInfo",value:function(a){var b=this.getU8();if(0!==b)throw Error("Bad attribute information message version: "+b);var c=this.getU8();0!==(c&1)&&this.getU16();var e=this.getOffset(),f=this.getOffset();0!==(c&2)&&this.getOffset();this.getMetadata("debug")&&console.log("this.hdf5MsgAttrInfo V"+
b+" F"+c+" HP "+e+" AN "+f);var b=this.tell(),k;e<this._superblk.eof_addr&&(this.seek(e),k=this.hdf5FractalHeapHeader());if(f<this._superblk.eof_addr){this.seek(f);e=this.hdf5V2BtreeHeader();if(8!==e.type)throw Error("Can only handle indexed attributes.");this.seek(e.root_addr);0<e.depth?this.hdf5V2BtreeInternalNode(k,e.root_nrec,e.depth,a):this.hdf5V2BtreeLeafNode(k,e.root_nrec,a)}this.seek(b)}},{key:"hdf5ProcessMessage",value:function(a,b){var d={};switch(a.hm_type){case 1:this.hdf5MsgDataspace(a.hm_size,
b);break;case 2:this.hdf5MsgLinkInfo(b);break;case 3:a=this.hdf5MsgDatatype(a.hm_size);b&&(b.type=a.typ_type);break;case 6:this.hdf5MsgLink(b);break;case 8:this.hdf5MsgLayout(b);break;case 10:this.hdf5MsgGroupInfo();break;case 11:this.hdf5MsgPipeline(b);break;case 12:this.hdf5MsgAttribute(a.hm_size,b);break;case 16:d.cq_off=this.getOffset();d.cq_len=this.getLength();this._continuation_queue.push(d);this.getMetadata("debug")&&console.log("hdf5MsgObjHdrContinue "+d.cq_off+" "+d.cq_len);break;case 17:b.sym_btree=
this.getOffset();b.sym_lheap=this.getOffset();this.getMetadata("debug")&&console.log("hdf5MsgSymbolTable "+b.sym_btree+" "+b.sym_lheap);break;case 21:this.hdf5MsgAttrInfo(b);break;case 0:case 4:case 5:case 7:case 18:case 19:case 20:case 22:case 24:this.skip(a.hm_size);break;default:throw Error("Unknown message type: "+a.hm_type);}}},{key:"hdf5V2ObjectHeader",value:function(a){if(!this.checkSignature("OHDR"))throw Error("Bad or missing OHDR signature");var b=this,c=this.getU8(),e=this.getU8();0!==
(e&32)&&(this.getU32(),this.getU32(),this.getU32(),this.getU32());0!==(e&16)&&(this.getU16(),this.getU16());var f=this.getUXX(1<<(e&3)),k=0,l=0,m=f;for(this.getMetadata("debug")&&console.log("this.hdf5V2ObjectHeader V"+c+" F"+e+" HS"+f);;){for(;8<=m-l;)c={},c.hm_type=this.getU8(),c.hm_size=this.getU16(),c.hm_flags=this.getU8(),this.getMetadata("debug")&&console.log("  msg"+k+" F"+c.hm_flags+" T "+c.hm_type+" S "+c.hm_size+" ("+l+"/"+m+") "+this.hdf5GetMsgName(c.hm_type)),0!==(e&4)&&(c.hm_corder=this.getU16()),
f=this.tell(),this.hdf5ProcessMessage(c,a),this.seek(f+c.hm_size),l+=c.hm_size+4,k+=1;4<m-l&&this.skip(m-(l+4));this.getU32();if(0!==this._continuation_queue.length){if(c=this._continuation_queue.shift(),this.seek(c.cq_off),m=c.cq_len-4,l=0,this.getMetadata("debug")&&console.log("continuing with "+c.cq_len+" bytes at "+this.tell()),!this.checkSignature("OCHK"))throw Error("Bad v2 object continuation");}else break}a.children.forEach(function(a,d){b.seek(a.hdr_offset);b.getMetadata("debug")&&console.log(d+
" "+a.hdr_offset+" "+a.name);b.checkSignature("OHDR")?(b.seek(a.hdr_offset),b.hdf5V2ObjectHeader(a)):(b.seek(a.hdr_offset),b.hdf5V1ObjectHeader(a))})}},{key:"loadData",value:function(a){var b=this;if(0!==a.chunk_size){this.seek(a.data_offset);var c=1,e;for(e=0;e<a.dims.length;e+=1)c*=a.dims[e];c*=this.typeSize(a.type);this.getMetadata("debug")&&console.log("allocating "+c+" bytes");c=new ArrayBuffer(c);a.n_filled=0;switch(a.type){case this._type_enum.INT8:a.array=new Int8Array(c);break;case this._type_enum.UINT8:a.array=
new Uint8Array(c);break;case this._type_enum.INT16:a.array=new Int16Array(c);break;case this._type_enum.UINT16:a.array=new Uint16Array(c);break;case this._type_enum.INT32:a.array=new Int32Array(c);break;case this._type_enum.UINT32:a.array=new Uint32Array(c);break;case this._type_enum.FLT:a.array=new Float32Array(c);break;case this._type_enum.DBL:a.array=new Float64Array(c);break;default:throw Error("Illegal type: "+a.type);}this.hdf5V1BtreeNode(a)}else 0<a.data_offset&&a.data_offset<this._superblk.eof_addr?
(this.getMetadata("debug")&&console.log("loading "+a.data_length+" bytes from "+a.data_offset+" to "+a.name),a.array=this.getArray(a.type,a.data_length,a.data_offset)):this.getMetadata("debug")&&console.log("data not present for /"+a.name+"/");a.children.forEach(function(a){b.loadData(a)})}},{key:"hdf5V1ObjectHeader",value:function(a){var b=this,c,e,f,k;this.startAlignment();c=this.getU8();this.skip(1);e=this.getU16();f=this.getU32();k=this.getU32();if(1!==c)throw Error("Bad v1 object header version: "+
c);this.getMetadata("debug")&&console.log("this.hdf5V1ObjectHeader V"+c+" #M "+e+" RC "+f+" HS "+k);f=k;var l;for(c=0;c<e;c+=1){if(8>=f)if(0!==this._continuation_queue.length)f=this._continuation_queue.shift(),this.seek(f.cq_off),f=f.cq_len,this.getMetadata("debug")&&console.log("continuing with "+f+" bytes at "+this.tell()),this.startAlignment();else break;this.checkAlignment();k={};k.hm_type=this.getU16();k.hm_size=this.getU16();k.hm_flags=this.getU8();if(0!==k.hm_size%8)throw Error("Size is not 8-byte aligned: "+
k.hm_size);this.skip(3);f-=8+k.hm_size;this.getMetadata("debug")&&console.log("  msg"+c+" F "+k.hm_flags+" T "+k.hm_type+" S "+k.hm_size+"("+f+") "+this.hdf5GetMsgName(k.hm_type));l=this.tell();this.hdf5ProcessMessage(k,a);this.seek(l+k.hm_size)}if(0!==a.sym_btree&&0!==a.sym_lheap){this.seek(a.sym_btree);e=this.hdf5V1BtreeNode();this.seek(a.sym_lheap);c=this.hdf5LocalHeap();for(f=0;f<e.entries_used;f+=1)this.seek(e.keys[f].child_address),this.checkSignature("SNOD")?(this.seek(e.keys[f].child_address),
this.hdf5GroupSymbolTable(c,a)):(this.seek(e.keys[f].child_address),this.hdf5V1ObjectHeader(a));a.children.forEach(function(a){b.seek(a.hdr_offset);b.hdf5V1ObjectHeader(a)})}}},{key:"getTypeMatchMinc",value:function(a){return this._type_matching[a-1]}},{key:"defined",value:function(a){return"undefined"!==typeof a}},{key:"typeName",value:function(a){return this.defined(a)?a.constructor.name:"undefined"}},{key:"typeSize",value:function(a){if(a>=this._type_enum.INT8&&a<this.type_sizes.length)return this.type_sizes[a];
throw Error("Unknown type "+a);}},{key:"typeIsFloat",value:function(a){return a>=this._type_enum.FLT&&a<=this._type_enum.DBL}},{key:"join",value:function(a,b){var d="";if(a&&a.length){var c;for(c=0;c<a.length-1;c+=1)d+=a[c],d+=b;d+=a[c]}return d}},{key:"printStructure",value:function(a,b){var d=this,c,f="";for(c=0;c<2*b;c+=1)f+=" ";f+=a.name+(a.children.length?"/":"");0<a.type&&(f+=" "+this.typeName(a.array),a.dims.length&&(f+="["+a.dims.join(", ")+"]"),f=a.array?f+(":"+a.array.length):f+" NULL");
console.log(f);Object.keys(a.attributes).forEach(function(e){var g=a.attributes[e];f="";for(c=0;c<2*b+1;c+=1)f+=" ";f+=a.name+":"+e+" "+d.typeName(g)+"["+g.length+"] ";"string"===typeof g?f+=JSON.stringify(g):(f+="{"+d.join(g.slice(0,16),", "),16<g.length&&(f+=", ..."),f+="}");console.log(f)});a.children.forEach(function(a){d.printStructure(a,b+1)})}},{key:"findDataset",value:function(a,b,c){var d=this,f;a&&a.name===b&&0<a.type?f=a:a.children.find(function(a){f=d.findDataset(a,b,c+1);return d.defined(f)});
return f}},{key:"findAttribute",value:function(a,b,c){var d=this,f=a.attributes[b];if(f)return f;a.children.find(function(a){f=d.findAttribute(a,b,c+1);return d.defined(f)});return f}},{key:"scaleVoxels",value:function(a,b,c,e,f){var d,g;switch(this.getTypeMatchMinc(a.type)){case "int8":d=new ArrayBuffer(a.array.length*Int8Array.BYTES_PER_ELEMENT);g=new Int8Array(d);break;case "int16":d=new ArrayBuffer(a.array.length*Int16Array.BYTES_PER_ELEMENT);g=new Int16Array(d);break;case "int32":d=new ArrayBuffer(a.array.length*
Int32Array.BYTES_PER_ELEMENT);g=new Int32Array(d);break;case "float32":d=new ArrayBuffer(a.array.length*Float32Array.BYTES_PER_ELEMENT);g=new Float32Array(d);break;case "float64":d=new ArrayBuffer(a.array.length*Float64Array.BYTES_PER_ELEMENT);g=new Float64Array(d);break;case "uint8":d=new ArrayBuffer(a.array.length*Uint8Array.BYTES_PER_ELEMENT);g=new Uint8Array(d);break;case "uint16":d=new ArrayBuffer(a.array.length*Uint16Array.BYTES_PER_ELEMENT);g=new Uint16Array(d);break;case "uint32":d=new ArrayBuffer(a.array.length*
Uint32Array.BYTES_PER_ELEMENT);g=new Uint32Array(d);break;default:throw b="Unsupported data type: "+header.datatype,console.log({message:b}),Error(b);}if(1>a.dims.length-b.dims.length)throw Error("Too few slice dimensions: "+a.dims.length+" "+b.dims.length);var m=1,n;for(n=b.dims.length;n<a.dims.length;n+=1)m*=a.dims[n];f&&console.log(m+" voxels in slice.");var r=0,u=0,p=-Number.MAX_VALUE,t=Number.MAX_VALUE,y=a.array;c=c.array;var q=b.array;f&&console.log("valid range is "+e[0]+" to "+e[1]);var x,
v=e[0],A,F,C,B=this.typeIsFloat(a.type);for(n=0;n<b.array.length;n+=1)if(f&&console.log(n+" "+q[n]+" "+c[n]+" "+y[n*m]),B)for(F=0;F<m;F+=1)C=y[u],C<e[0]||C>e[1]?g[u]=0:(g[u]=C,r+=C,C>p&&(p=C),C<t&&(t=C)),u+=1;else for(a=e[1]-e[0],x=c[n]-q[n],A=q[n],F=0;F<m;F+=1)C=(y[u]-v)/a*x+A,C=C/c[n]*e[1],g[u]=C,r+=C,u+=1,C>p&&(p=C),C<t&&(t=C);f&&(console.log("Min: "+t),console.log("Max: "+p),console.log("Sum: "+r),console.log("Mean: "+r/u));return d}},{key:"isRgbVolume",value:function(a,b){var d=a.order;return"Uint8Array"===
b.array.constructor.name&&0<d.length&&"vector_dimension"===d[d.length-1]&&3===a.vector_dimension.space_length}},{key:"rgbVoxels",value:function(a){a=a.array;var b=a.length,c=new ArrayBuffer(b/3*4),e=new Uint8Array(c),f,k=0;for(f=0;f<b;f+=3)e[k+0]=a[f+0],e[k+1]=a[f+1],e[k+2]=a[f+2],e[k+3]=255,k+=4;return c}},{key:"parseHeader",value:function(a){var b;try{b=JSON.parse(a)}catch(g){throw a="server did not respond with valid JSON\nResponse was: \n"+a,console.log({message:a}),Error(a);}4===b.order.length&&
(b.order=b.order.slice(1));b.datatype=b.datatype||"uint8";b.xspace.space_length=parseFloat(b.xspace.space_length);b.yspace.space_length=parseFloat(b.yspace.space_length);b.zspace.space_length=parseFloat(b.zspace.space_length);b.xspace.start=parseFloat(b.xspace.start);b.yspace.start=parseFloat(b.yspace.start);b.zspace.start=parseFloat(b.zspace.start);b.xspace.step=parseFloat(b.xspace.step);b.yspace.step=parseFloat(b.yspace.step);b.zspace.step=parseFloat(b.zspace.step);b.xspace.direction_cosines=b.xspace.direction_cosines||
[1,0,0];b.yspace.direction_cosines=b.yspace.direction_cosines||[0,1,0];b.zspace.direction_cosines=b.zspace.direction_cosines||[0,0,1];b.xspace.direction_cosines=b.xspace.direction_cosines.map(parseFloat);b.yspace.direction_cosines=b.yspace.direction_cosines.map(parseFloat);b.zspace.direction_cosines=b.zspace.direction_cosines.map(parseFloat);b[b.order[0]].offset=b[b.order[1]].space_length*b[b.order[2]].space_length;b[b.order[1]].offset=b[b.order[2]].space_length;b[b.order[2]].offset=1;b.time&&(b.time.space_length=
parseFloat(b.time.space_length),b.time.start=parseFloat(b.time.start),b.time.step=parseFloat(b.time.step),b.time.offset=b.xspace.space_length*b.yspace.space_length*b.zspace.space_length);return b}},{key:"createMincData",value:function(a,b){switch(a.datatype){case "int8":a=new Int8Array(b);break;case "int16":a=new Int16Array(b);break;case "int32":a=new Int32Array(b);break;case "float32":a=new Float32Array(b);break;case "float64":a=new Float64Array(b);break;case "uint8":a=new Uint8Array(b);break;case "uint16":a=
new Uint16Array(b);break;case "uint32":case "rgb8":a=new Uint32Array(b);break;default:throw a="Unsupported data type: "+a.datatype,console.log({message:a}),Error(a);}return a}},{key:"_run",value:function(){var a=this,b=this._getInput(0);if(b){this._dv=new DataView(b);this._dv.getUint64=function(b,d){var c=a._dv.getUint32(b+0,d);b=a._dv.getUint32(b+4,d);return d?(b<<32)+c:(c<<32)+b};var c=this.createLink();try{this._superblk=this.hdf5Superblock()}catch(n){console.warn("The input file is not a Minc2 file.");
return}this.seek(this._superblk.root_addr);1>=this._superblk.sbver?this.hdf5V1ObjectHeader(c):this.hdf5V2ObjectHeader(c);this.loadData(c);this.getMetadata("debug")&&this.printStructure(c,0);b=this.findDataset(c,"image");if(!this.defined(b))throw Error("Can't find image dataset.");var e=this.findAttribute(b,"valid_range",0);if(!this.defined(e)){var f,k;switch(b.type){case this._type_enum.INT8:f=-128;k=127;break;case this._type_enum.UINT8:f=0;k=255;break;case this._type_enum.INT16:f=-32768;k=32767;
break;case this._type_enum.UINT16:f=0;k=65535;break;case this._type_enum.INT32:f=2147483648;k=-2147483649;break;case this._type_enum.UINT32:f=0,k=(1<<32)-1}e=Float32Array.of(f,k)}f=this.findDataset(c,"image-min");this.defined(f)||(f={array:Float32Array.of(0),dims:[]});k=this.findDataset(c,"image-max");this.defined(k)||(k={array:Float32Array.of(1),dims:[]});var l={},m=this.findAttribute(b,"dimorder",0);if("string"!==typeof m)throw Error("Can't find dimension order.");l.order=m.split(",");l.order.forEach(function(b){var d=
a.findDataset(c,b);if(!a.defined(d))throw Error("Can't find dimension variable "+b);l[b]={};m=a.findAttribute(d,"step",0);a.defined(m)||(m=Float32Array.of(1));l[b].step=m[0];m=a.findAttribute(d,"start",0);a.defined(m)||(m=Float32Array.of(0));l[b].start=m[0];m=a.findAttribute(d,"length",0);if(!a.defined(m))throw Error("Can't find length for "+b);l[b].space_length=m[0];m=a.findAttribute(d,"direction_cosines",0);a.defined(m)?l[b].direction_cosines=Array.prototype.slice.call(m):"xspace"===b?l[b].direction_cosines=
[1,0,0]:"yspace"===b?l[b].direction_cosines=[0,1,0]:"zspace"===b&&(l[b].direction_cosines=[0,0,1])});this.isRgbVolume(l,b)?(l.order.pop(),l.datatype="rgb8",b=this.rgbVoxels(b)):(l.datatype=this.getTypeMatchMinc(b.type),b=this.scaleVoxels(b,f,k,e,this.getMetadata("debug")));e=this.parseHeader(JSON.stringify(l));e.format="minc2";b=this.createMincData(e,b);e=Kc.convertImage3DMetadata(e);f=new Ta;f.setRawData(b);f.setRawMetadata(e);f.metadataIntegrityCheck()&&(f.scanDataRange(),this._output[0]=f)}else console.warn('Minc2DecoderAlt requires an ArrayBuffer as input "0". Unable to continue.')}}]);
return b}(ra),bh=function(c){function b(){I(this,b);var a=P(this,(b.__proto__||Object.getPrototypeOf(b)).call(this));a.setMetadata("targetType",Ta.name);a.addInputValidator(0,ArrayBuffer);a.setMetadata("debug",!1);return a}L(b,c);N(b,[{key:"_parseMGHHeader",value:function(a,b){b={order:["xspace","yspace","zspace"],xspace:{},yspace:{},zspace:{}};var d=new DataView(a,0,284);a=d.getUint32(0,!0);if(1===a)a=!0;else if(16777216===a)a=!1;else return console.warn("This does not look like an MGH file."),null;
var c,f=[0,0,0,0],k=4,l=1;for(c=0;4>c;c++){f[c]=d.getUint32(k,a);if(1>=f[c])break;l*=f[c];k+=4}if(3>c||4<c)return console.warn("Cannot handle "+c+"-dimensional images yet."),null;var m=d.getUint32(20,a),n=[1,1,1],r,u,p=[[-1,0,0],[0,0,-1],[0,1,0],[0,0,0]];if(d.getUint16(28,a)){k=30;for(r=0;3>r;r++)n[r]=d.getFloat32(k,a),k+=4;for(r=0;4>r;r++)for(u=0;3>u;u++)p[r][u]=d.getFloat32(k,a),k+=4}if(this._metadata.debug)for(r=0;3>r;r++)for(u=0;4>u;u++);d=[0,1,2];for(r=0;3>r;r++){u=0;var k=Math.abs(p[r][0]),
t=Math.abs(p[r][1]),y=Math.abs(p[r][2]);b.order[r]="xspace";t>k&&t>y&&(u=1,b.order[r]="yspace");y>k&&y>t&&(u=2,b.order[r]="zspace");d[r]=u}4===c&&(this._metadata.debug&&console.log("Creating time dimension: "+f[3]),b.time={space_length:f[3],step:1,start:0,name:"time"},b.order.push("time"));c=[[0,0,0,0],[0,0,0,0],[0,0,0,0]];for(r=0;3>r;r++)for(u=0;3>u;u++)c[r][u]=p[u][r]*n[r];for(r=0;3>r;r++){for(u=n=0;3>u;u++)n+=f[u]/2*c[r][u];c[r][3]=p[3][r]-n}p=[[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0]];for(r=0;3>
r;r++)for(u=0;4>u;u++)n=u,3>u&&(n=d[u]),p[r][n]=c[r][u];Kc.transformToMinc(p,b);b.datatype=m;b.little_endian=a;b.nvoxels=l;for(r=0;3>r;r++)b[b.order[r]].space_length=f[r];return b}},{key:"_createMGHData",value:function(a,b){var d=null,c;switch(a.datatype){case 0:c=1;break;case 1:case 3:c=4;break;case 4:c=2;break;default:return console.warn("Unsupported data type: "+a.datatype),null}var f=a.nvoxels*c;1<c&&!a.little_endian&&Kc.swapn(new Uint8Array(b,284,f),c);switch(a.datatype){case 0:d=new Uint8Array(b,
284,a.nvoxels);break;case 1:d=new Int32Array(b,284,a.nvoxels);break;case 3:d=new Float32Array(b,284,a.nvoxels);break;case 4:d=new Int16Array(b,284,a.nvoxels)}b=1;for(c=0;c<a.order.length;c++)a[a.order[c]].offset=b,b*=a[a.order[c]].space_length;return d}},{key:"_run",value:function(){function a(a){for(var b=0;b<e.length;b++)if(e[b].nameWorldSpace===a)return b;return-1}var b=this._getInput(0);if(b){var c=null;try{c=this._parseMGHHeader(b)}catch(l){}if(c){b=this._createMGHData(c,b);if(!b)return null;
var c=Kc.convertImage3DMetadata(c),e=c.dimensions;e.sort(function(a,b){return a.stride<b.stride});for(var f=0;f<e.length;f++){var k=e[f].nameWorldSpace;e[f].heightDimension=a("x"===k?"z":"y"===k?"z":"z"===k?"y":null);e[f].widthDimension=a("x"===k?"y":"y"===k?"x":"z"===k?"x":null)}f=new Ta;f.setRawData(b);f.setRawMetadata(c);f.metadataIntegrityCheck()&&(f.scanDataRange(),this._output[0]=f)}else console.log("The input file is not a MGH file.")}else console.warn('MghDecoderAlt requires an ArrayBuffer as input "0". Unable to continue.')}}]);
return b}(ra),ch=function(c){function b(){I(this,b);var a=P(this,(b.__proto__||Object.getPrototypeOf(b)).call(this));a.setMetadata("enablePixBin",!0);a._decoders=[ah,Yg,bh];return a}L(b,c);return b}(bc),ee=/[A-Z_a-z\xC0-\xD6\xD8-\xF6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]/,dh=new RegExp("[\\-\\.0-9"+ee.source.slice(1,-1)+"\\u00B7\\u0300-\\u036F\\u203F-\\u2040]"),eh=new RegExp("^"+ee.source+dh.source+"*(?::"+ee.source+dh.source+
"*)?$");Of.prototype={parse:function(c,b,a){var d=this.domBuilder;d.startDocument();Sf(b,b={});di(c,b,a,d,this.errorHandler);d.endDocument()}};Pf.prototype={setTagName:function(c){if(!eh.test(c))throw Error("invalid tagName:"+c);this.tagName=c},add:function(c,b,a){if(!eh.test(c))throw Error("invalid attribute:"+c);this[this.length++]={qName:c,value:b,offset:a}},length:0,getLocalName:function(c){return this[c].localName},getLocator:function(c){return this[c].locator},getQName:function(c){return this[c].qName},
getURI:function(c){return this[c].uri},getValue:function(c){return this[c].value}};Wc({},Wc.prototype)instanceof Wc||(Wc=function(c,b){function a(){}a.prototype=b;a=new a;for(b in c)a[b]=c[b];return a});var za={},Sa=za.ELEMENT_NODE=1,Xb=za.ATTRIBUTE_NODE=2,ad=za.TEXT_NODE=3,hg=za.CDATA_SECTION_NODE=4,lg=za.ENTITY_REFERENCE_NODE=5,nj=za.ENTITY_NODE=6,kg=za.PROCESSING_INSTRUCTION_NODE=7,ig=za.COMMENT_NODE=8,gg=za.DOCUMENT_NODE=9,jg=za.DOCUMENT_TYPE_NODE=10,Ya=za.DOCUMENT_FRAGMENT_NODE=11,oj=za.NOTATION_NODE=
12,sa={},ka={};sa.INDEX_SIZE_ERR=(ka[1]="Index size error",1);sa.DOMSTRING_SIZE_ERR=(ka[2]="DOMString size error",2);var pj=sa.HIERARCHY_REQUEST_ERR=(ka[3]="Hierarchy request error",3);sa.WRONG_DOCUMENT_ERR=(ka[4]="Wrong document",4);sa.INVALID_CHARACTER_ERR=(ka[5]="Invalid character",5);sa.NO_DATA_ALLOWED_ERR=(ka[6]="No data allowed",6);sa.NO_MODIFICATION_ALLOWED_ERR=(ka[7]="No modification allowed",7);var ji=sa.NOT_FOUND_ERR=(ka[8]="Not found",8);sa.NOT_SUPPORTED_ERR=(ka[9]="Not supported",9);var fh=
sa.INUSE_ATTRIBUTE_ERR=(ka[10]="Attribute in use",10);sa.INVALID_STATE_ERR=(ka[11]="Invalid state",11);sa.SYNTAX_ERR=(ka[12]="Syntax error",12);sa.INVALID_MODIFICATION_ERR=(ka[13]="Invalid modification",13);sa.NAMESPACE_ERR=(ka[14]="Invalid namespace",14);sa.INVALID_ACCESS_ERR=(ka[15]="Invalid access",15);Ub.prototype=Error.prototype;rc(sa,Ub);ob.prototype={length:0,item:function(c){return this[c]||null},toString:function(c,b){for(var a=[],d=0;d<this.length;d++)Wb(this[d],a,c,b);return a.join("")}};
sc.prototype.item=function(c){Nd(this);return this[c]};ya(sc,ob);Xc.prototype={length:0,item:ob.prototype.item,getNamedItem:function(c){for(var b=this.length;b--;){var a=this[b];if(a.nodeName==c)return a}},setNamedItem:function(c){var b=c.ownerElement;if(b&&b!=this._ownerElement)throw new Ub(fh);b=this.getNamedItem(c.nodeName);Vf(this._ownerElement,this,c,b);return b},setNamedItemNS:function(c){var b=c.ownerElement;if(b&&b!=this._ownerElement)throw new Ub(fh);b=this.getNamedItemNS(c.namespaceURI,
c.localName);Vf(this._ownerElement,this,c,b);return b},removeNamedItem:function(c){c=this.getNamedItem(c);Xf(this._ownerElement,this,c);return c},removeNamedItemNS:function(c,b){c=this.getNamedItemNS(c,b);Xf(this._ownerElement,this,c);return c},getNamedItemNS:function(c,b){for(var a=this.length;a--;){var d=this[a];if(d.localName==b&&d.namespaceURI==c)return d}return null}};Yf.prototype={hasFeature:function(c,b){return(c=this._features[c.toLowerCase()])&&(!b||b in c)?!0:!1},createDocument:function(c,
b,a){var d=new tc;d.implementation=this;d.childNodes=new ob;(d.doctype=a)&&d.appendChild(a);b&&(c=d.createElementNS(c,b),d.appendChild(c));return d},createDocumentType:function(c,b,a){var d=new Sd;d.name=c;d.nodeName=c;d.publicId=b;d.systemId=a;return d}};ta.prototype={firstChild:null,lastChild:null,previousSibling:null,nextSibling:null,attributes:null,parentNode:null,childNodes:null,ownerDocument:null,nodeValue:null,namespaceURI:null,prefix:null,localName:null,insertBefore:function(c,b){return ag(this,
c,b)},replaceChild:function(c,b){this.insertBefore(c,b);b&&this.removeChild(b)},removeChild:function(c){return $f(this,c)},appendChild:function(c){return this.insertBefore(c,null)},hasChildNodes:function(){return null!=this.firstChild},cloneNode:function(c){return Vd(this.ownerDocument||this,this,c)},normalize:function(){for(var c=this.firstChild;c;){var b=c.nextSibling;b&&b.nodeType==ad&&c.nodeType==ad?(this.removeChild(b),c.appendData(b.data)):(c.normalize(),c=b)}},isSupported:function(c,b){return this.ownerDocument.implementation.hasFeature(c,
b)},hasAttributes:function(){return 0<this.attributes.length},lookupPrefix:function(c){for(var b=this;b;){var a=b._nsMap;if(a)for(var d in a)if(a[d]==c)return d;b=b.nodeType==Xb?b.ownerDocument:b.parentNode}return null},lookupNamespaceURI:function(c){for(var b=this;b;){var a=b._nsMap;if(a&&c in a)return a[c];b=b.nodeType==Xb?b.ownerDocument:b.parentNode}return null},isDefaultNamespace:function(c){return null==this.lookupPrefix(c)}};rc(za,ta);rc(za,ta.prototype);tc.prototype={nodeName:"#document",
nodeType:gg,doctype:null,documentElement:null,_inc:1,insertBefore:function(c,b){if(c.nodeType==Ya){for(var a=c.firstChild;a;){var d=a.nextSibling;this.insertBefore(a,b);a=d}return c}null==this.documentElement&&c.nodeType==Sa&&(this.documentElement=c);return ag(this,c,b),c.ownerDocument=this,c},removeChild:function(c){this.documentElement==c&&(this.documentElement=null);return $f(this,c)},importNode:function(c,b){return mg(this,c,b)},getElementById:function(c){var b=null;Yc(this.documentElement,function(a){if(a.nodeType==
Sa&&a.getAttribute("id")==c)return b=a,!0});return b},createElement:function(c){var b=new Vb;b.ownerDocument=this;b.nodeName=c;b.tagName=c;b.childNodes=new ob;return(b.attributes=new Xc)._ownerElement=b},createDocumentFragment:function(){var c=new $c;c.ownerDocument=this;c.childNodes=new ob;return c},createTextNode:function(c){var b=new Pd;b.ownerDocument=this;b.appendData(c);return b},createComment:function(c){var b=new Qd;b.ownerDocument=this;b.appendData(c);return b},createCDATASection:function(c){var b=
new Rd;b.ownerDocument=this;b.appendData(c);return b},createProcessingInstruction:function(c,b){var a=new Ud;a.ownerDocument=this;a.tagName=a.target=c;a.nodeValue=a.data=b;return a},createAttribute:function(c){var b=new Zc;b.ownerDocument=this;b.name=c;b.nodeName=c;b.localName=c;b.specified=!0;return b},createEntityReference:function(c){var b=new Td;b.ownerDocument=this;b.nodeName=c;return b},createElementNS:function(c,b){var a=new Vb,d=b.split(":"),g=a.attributes=new Xc;a.childNodes=new ob;a.ownerDocument=
this;a.nodeName=b;a.tagName=b;a.namespaceURI=c;2==d.length?(a.prefix=d[0],a.localName=d[1]):a.localName=b;return g._ownerElement=a},createAttributeNS:function(c,b){var a=new Zc,d=b.split(":");a.ownerDocument=this;a.nodeName=b;a.name=b;a.namespaceURI=c;a.specified=!0;2==d.length?(a.prefix=d[0],a.localName=d[1]):a.localName=b;return a}};ya(tc,ta);Vb.prototype={nodeType:Sa,hasAttribute:function(c){return null!=this.getAttributeNode(c)},getAttribute:function(c){return(c=this.getAttributeNode(c))&&c.value||
""},getAttributeNode:function(c){return this.attributes.getNamedItem(c)},setAttribute:function(c,b){c=this.ownerDocument.createAttribute(c);c.value=c.nodeValue=""+b;this.setAttributeNode(c)},removeAttribute:function(c){(c=this.getAttributeNode(c))&&this.removeAttributeNode(c)},appendChild:function(c){if(c.nodeType===Ya)return this.insertBefore(c,null);var b=c.parentNode;b&&b.removeChild(c);b=this.lastChild;c.parentNode=this;c.previousSibling=b;c.nextSibling=null;b?b.nextSibling=c:this.firstChild=
c;this.lastChild=c;Od(this.ownerDocument,this,c);return c},setAttributeNode:function(c){return this.attributes.setNamedItem(c)},setAttributeNodeNS:function(c){return this.attributes.setNamedItemNS(c)},removeAttributeNode:function(c){return this.attributes.removeNamedItem(c.nodeName)},removeAttributeNS:function(c,b){(c=this.getAttributeNodeNS(c,b))&&this.removeAttributeNode(c)},hasAttributeNS:function(c,b){return null!=this.getAttributeNodeNS(c,b)},getAttributeNS:function(c,b){return(c=this.getAttributeNodeNS(c,
b))&&c.value||""},setAttributeNS:function(c,b,a){c=this.ownerDocument.createAttributeNS(c,b);c.value=c.nodeValue=""+a;this.setAttributeNode(c)},getAttributeNodeNS:function(c,b){return this.attributes.getNamedItemNS(c,b)},getElementsByTagName:function(c){return new sc(this,function(b){var a=[];Yc(b,function(d){d===b||d.nodeType!=Sa||"*"!==c&&d.tagName!=c||a.push(d)});return a})},getElementsByTagNameNS:function(c,b){return new sc(this,function(a){var d=[];Yc(a,function(g){g===a||g.nodeType!==Sa||"*"!==
c&&g.namespaceURI!==c||"*"!==b&&g.localName!=b||d.push(g)});return d})}};tc.prototype.getElementsByTagName=Vb.prototype.getElementsByTagName;tc.prototype.getElementsByTagNameNS=Vb.prototype.getElementsByTagNameNS;ya(Vb,ta);Zc.prototype.nodeType=Xb;ya(Zc,ta);uc.prototype={data:"",substringData:function(c,b){return this.data.substring(c,c+b)},appendData:function(c){this.nodeValue=this.data=c=this.data+c;this.length=c.length},insertData:function(c,b){this.replaceData(c,0,b)},appendChild:function(c){throw Error(ka[pj]);
},deleteData:function(c,b){this.replaceData(c,b,"")},replaceData:function(c,b,a){var d=this.data.substring(0,c);c=this.data.substring(c+b);this.nodeValue=this.data=a=d+a+c;this.length=a.length}};ya(uc,ta);Pd.prototype={nodeName:"#text",nodeType:ad,splitText:function(c){var b=this.data,a=b.substring(c);this.data=this.nodeValue=b=b.substring(0,c);this.length=b.length;c=this.ownerDocument.createTextNode(a);this.parentNode&&this.parentNode.insertBefore(c,this.nextSibling);return c}};ya(Pd,uc);Qd.prototype=
{nodeName:"#comment",nodeType:ig};ya(Qd,uc);Rd.prototype={nodeName:"#cdata-section",nodeType:hg};ya(Rd,uc);Sd.prototype.nodeType=jg;ya(Sd,ta);bg.prototype.nodeType=oj;ya(bg,ta);cg.prototype.nodeType=nj;ya(cg,ta);Td.prototype.nodeType=lg;ya(Td,ta);$c.prototype.nodeName="#document-fragment";$c.prototype.nodeType=Ya;ya($c,ta);Ud.prototype.nodeType=kg;ya(Ud,ta);dg.prototype.serializeToString=function(c,b,a){return eg.call(c,b,a)};ta.prototype.toString=eg;try{if(Object.defineProperty){var qj=function b(a){switch(a.nodeType){case Sa:case Ya:var d=
[];for(a=a.firstChild;a;)7!==a.nodeType&&8!==a.nodeType&&d.push(b(a)),a=a.nextSibling;return d.join("");default:return a.nodeValue}};Object.defineProperty(sc.prototype,"length",{get:function(){Nd(this);return this.$$length}});Object.defineProperty(ta.prototype,"textContent",{get:function(){return qj(this)},set:function(b){switch(this.nodeType){case Sa:case Ya:for(;this.firstChild;)this.removeChild(this.firstChild);(b||String(b))&&this.appendChild(this.ownerDocument.createTextNode(b));break;default:this.nodeValue=
this.value=this.data=b}}});Tf=function(b,a,d){b["$$"+a]=d}}}catch(c){}var rj=ma(function(c,b){function a(a){this.options=a||{locator:{}}}function d(a,b,d){function c(b){var c=a[b];!c&&k&&(c=2==a.length?function(d){a(b,d)}:a);e[b]=c&&function(a){c("[xmldom "+b+"]\t"+a+f(d))}||function(){}}if(!a){if(b instanceof g)return b;a=b}var e={},k=a instanceof Function;d=d||{};c("warning");c("error");c("fatalError");return e}function g(){this.cdata=!1}function e(a,b){b.lineNumber=a.lineNumber;b.columnNumber=
a.columnNumber}function f(a){if(a)return"\n@"+(a.systemId||"")+"#[line:"+a.lineNumber+",col:"+a.columnNumber+"]"}function k(a,b,d){return"string"==typeof a?a.substr(b,d):a.length>=b+d||b?new java.lang.String(a,b,d)+"":a}function l(a,b){a.currentElement?a.currentElement.appendChild(b):a.doc.appendChild(b)}a.prototype.parseFromString=function(a,b){var c=this.options,e=new m,f=c.domBuilder||new g,k=c.errorHandler,l=c.locator,n=c.xmlns||{},r={lt:"<",gt:">",amp:"&",quot:'"',apos:"'"};l&&f.setDocumentLocator(l);
e.errorHandler=d(k,f,l);e.domBuilder=c.domBuilder||f;/\/x?html?$/.test(b)&&(r.nbsp="\u00a0",r.copy="\u00a9",n[""]="http://www.w3.org/1999/xhtml");n.xml=n.xml||"http://www.w3.org/XML/1998/namespace";a?e.parse(a,n,r):e.errorHandler.error("invalid doc source");return f.doc};g.prototype={startDocument:function(){this.doc=(new n).createDocument(null,null,null);this.locator&&(this.doc.documentURI=this.locator.systemId)},startElement:function(a,b,d,c){var f=this.doc;b=f.createElementNS(a,d||b);var g=c.length;
l(this,b);this.currentElement=b;this.locator&&e(this.locator,b);for(var k=0;k<g;k++){a=c.getURI(k);var p=c.getValue(k);d=c.getQName(k);a=f.createAttributeNS(a,d);this.locator&&e(c.getLocator(k),a);a.value=a.nodeValue=p;b.setAttributeNode(a)}},endElement:function(a,b,d){this.currentElement=this.currentElement.parentNode},startPrefixMapping:function(a,b){},endPrefixMapping:function(a){},processingInstruction:function(a,b){a=this.doc.createProcessingInstruction(a,b);this.locator&&e(this.locator,a);l(this,
a)},ignorableWhitespace:function(a,b,d){},characters:function(a,b,d){if(a=k.apply(this,arguments)){var c=this.cdata?this.doc.createCDATASection(a):this.doc.createTextNode(a);this.currentElement?this.currentElement.appendChild(c):/^\s*$/.test(a)&&this.doc.appendChild(c);this.locator&&e(this.locator,c)}},skippedEntity:function(a){},endDocument:function(){this.doc.normalize()},setDocumentLocator:function(a){if(this.locator=a)a.lineNumber=0},comment:function(a,b,d){a=k.apply(this,arguments);var c=this.doc.createComment(a);
this.locator&&e(this.locator,c);l(this,c)},startCDATA:function(){this.cdata=!0},endCDATA:function(){this.cdata=!1},startDTD:function(a,b,d){var c=this.doc.implementation;c&&c.createDocumentType&&(a=c.createDocumentType(a,b,d),this.locator&&e(this.locator,a),l(this,a))},warning:function(a){console.warn("[xmldom warning]\t"+a,f(this.locator))},error:function(a){console.error("[xmldom error]\t"+a,f(this.locator))},fatalError:function(a){console.error("[xmldom fatalError]\t"+a,f(this.locator));throw a;
}};"endDTD,startEntity,endEntity,attributeDecl,elementDecl,externalEntityDecl,internalEntityDecl,resolveEntity,getExternalSubset,notationDecl,unparsedEntityDecl".replace(/\w+/g,function(a){g.prototype[a]=function(){return null}});var m=Of,n=b.DOMImplementation=Yf;b.XMLSerializer=dg;b.DOMParser=a}),fe={315:"Artist",258:"BitsPerSample",265:"CellLength",264:"CellWidth",320:"ColorMap",259:"Compression",33432:"Copyright",306:"DateTime",338:"ExtraSamples",266:"FillOrder",289:"FreeByteCounts",288:"FreeOffsets",
291:"GrayResponseCurve",290:"GrayResponseUnit",316:"HostComputer",270:"ImageDescription",257:"ImageLength",256:"ImageWidth",271:"Make",281:"MaxSampleValue",280:"MinSampleValue",272:"Model",254:"NewSubfileType",274:"Orientation",262:"PhotometricInterpretation",284:"PlanarConfiguration",296:"ResolutionUnit",278:"RowsPerStrip",277:"SamplesPerPixel",305:"Software",279:"StripByteCounts",273:"StripOffsets",255:"SubfileType",263:"Threshholding",282:"XResolution",283:"YResolution",326:"BadFaxLines",327:"CleanFaxData",
343:"ClipPath",328:"ConsecutiveBadFaxLines",433:"Decode",434:"DefaultImageColor",269:"DocumentName",336:"DotRange",321:"HalftoneHints",346:"Indexed",347:"JPEGTables",285:"PageName",297:"PageNumber",317:"Predictor",319:"PrimaryChromaticities",532:"ReferenceBlackWhite",339:"SampleFormat",340:"SMinSampleValue",341:"SMaxSampleValue",559:"StripRowCounts",330:"SubIFDs",292:"T4Options",293:"T6Options",325:"TileByteCounts",323:"TileLength",324:"TileOffsets",322:"TileWidth",301:"TransferFunction",318:"WhitePoint",
344:"XClipPathUnits",286:"XPosition",529:"YCbCrCoefficients",531:"YCbCrPositioning",530:"YCbCrSubSampling",345:"YClipPathUnits",287:"YPosition",37378:"ApertureValue",40961:"ColorSpace",36868:"DateTimeDigitized",36867:"DateTimeOriginal",34665:"Exif IFD",36864:"ExifVersion",33434:"ExposureTime",41728:"FileSource",37385:"Flash",40960:"FlashpixVersion",33437:"FNumber",42016:"ImageUniqueID",37384:"LightSource",37500:"MakerNote",37377:"ShutterSpeedValue",37510:"UserComment",33723:"IPTC",34675:"ICC Profile",
700:"XMP",42112:"GDAL_METADATA",42113:"GDAL_NODATA",34377:"Photoshop",33550:"ModelPixelScale",33922:"ModelTiepoint",34264:"ModelTransformation",34735:"GeoKeyDirectory",34736:"GeoDoubleParams",34737:"GeoAsciiParams"},cb,Ua={};for(cb in fe)Ua[fe[cb]]=parseInt(cb);var sj=[Ua.BitsPerSample,Ua.ExtraSamples,Ua.SampleFormat,Ua.StripByteCounts,Ua.StripOffsets,Ua.StripRowCounts,Ua.TileByteCounts,Ua.TileOffsets],ge={1:"BYTE",2:"ASCII",3:"SHORT",4:"LONG",5:"RATIONAL",6:"SBYTE",7:"UNDEFINED",8:"SSHORT",9:"SLONG",
10:"SRATIONAL",11:"FLOAT",12:"DOUBLE",16:"LONG8",17:"SLONG8",18:"IFD8"},gh={};for(cb in ge)gh[ge[cb]]=parseInt(cb);var he={1024:"GTModelTypeGeoKey",1025:"GTRasterTypeGeoKey",1026:"GTCitationGeoKey",2048:"GeographicTypeGeoKey",2049:"GeogCitationGeoKey",2050:"GeogGeodeticDatumGeoKey",2051:"GeogPrimeMeridianGeoKey",2052:"GeogLinearUnitsGeoKey",2053:"GeogLinearUnitSizeGeoKey",2054:"GeogAngularUnitsGeoKey",2055:"GeogAngularUnitSizeGeoKey",2056:"GeogEllipsoidGeoKey",2057:"GeogSemiMajorAxisGeoKey",2058:"GeogSemiMinorAxisGeoKey",
2059:"GeogInvFlatteningGeoKey",2060:"GeogAzimuthUnitsGeoKey",2061:"GeogPrimeMeridianLongGeoKey",2062:"GeogTOWGS84GeoKey",3072:"ProjectedCSTypeGeoKey",3073:"PCSCitationGeoKey",3074:"ProjectionGeoKey",3075:"ProjCoordTransGeoKey",3076:"ProjLinearUnitsGeoKey",3077:"ProjLinearUnitSizeGeoKey",3078:"ProjStdParallel1GeoKey",3079:"ProjStdParallel2GeoKey",3080:"ProjNatOriginLongGeoKey",3081:"ProjNatOriginLatGeoKey",3082:"ProjFalseEastingGeoKey",3083:"ProjFalseNorthingGeoKey",3084:"ProjFalseOriginLongGeoKey",
3085:"ProjFalseOriginLatGeoKey",3086:"ProjFalseOriginEastingGeoKey",3087:"ProjFalseOriginNorthingGeoKey",3088:"ProjCenterLongGeoKey",3089:"ProjCenterLatGeoKey",3090:"ProjCenterEastingGeoKey",3091:"ProjCenterNorthingGeoKey",3092:"ProjScaleAtNatOriginGeoKey",3093:"ProjScaleAtCenterGeoKey",3094:"ProjAzimuthAngleGeoKey",3095:"ProjStraightVertPoleLongGeoKey",3096:"ProjRectifiedGridAngleGeoKey",4096:"VerticalCSTypeGeoKey",4097:"VerticalCitationGeoKey",4098:"VerticalDatumGeoKey",4099:"VerticalUnitsGeoKey"},
hh={};for(cb in he)hh[he[cb]]=parseInt(cb);var ld;"undefined"===typeof window?ld=function(c){return(new rj.DOMParser).parseFromString(c,"text/xml")}:"undefined"!==typeof window.DOMParser?ld=function(c){return(new window.DOMParser).parseFromString(c,"text/xml")}:"undefined"!==typeof window.ActiveXObject&&new window.ActiveXObject("Microsoft.XMLDOM")&&(ld=function(c){var b=new window.ActiveXObject("Microsoft.XMLDOM");b.async="false";b.loadXML(c);return b});var la={fieldTags:Ua,fieldTagNames:fe,arrayFields:sj,
fieldTypes:gh,fieldTypeNames:ge,photometricInterpretations:{WhiteIsZero:0,BlackIsZero:1,RGB:2,Palette:3,TransparencyMask:4,CMYK:5,YCbCr:6,CIELab:8,ICCLab:9},geoKeys:hh,geoKeyNames:he,parseXml:ld},cc={fromWhiteIsZero:function(c,b,a,d){a=new Uint8Array(a*d*3);for(var g=0,e=0;g<c.length;++g,e+=3)d=256-c[g]/b*256,a[e]=d,a[e+1]=d,a[e+2]=d;return a},fromBlackIsZero:function(c,b,a,d){a=new Uint8Array(a*d*3);for(var g=0,e=0;g<c.length;++g,e+=3)d=c[g]/b*256,a[e]=d,a[e+1]=d,a[e+2]=d;return a},fromPalette:function(c,
b,a,d){a=new Uint8Array(a*d*3);d=b.length/3;for(var g=b.length/3*2,e=0,f=0;e<c.length;++e,f+=3){var k=c[e];a[f]=b[k]/65536*256;a[f+1]=b[k+d]/65536*256;a[f+2]=b[k+g]/65536*256}return a},fromCMYK:function(c,b,a){b=new Uint8Array(b*a*3);for(var d,g,e,f=0,k=0;f<c.length;f+=4,k+=3)a=c[f],d=c[f+1],g=c[f+2],e=c[f+3],b[k]=(255-a)/256*255*((255-e)/256),b[k+1]=(255-d)/256*255*((255-e)/256),b[k+2]=(255-g)/256*255*((255-e)/256);return b},fromYCbCr:function(c,b,a){b=new Uint8Array(b*a*3);for(var d,g,e=0,f=0;e<
c.length;e+=3,f+=3)a=c[e],d=c[e+1],g=c[e+2],b[f]=a+1.402*(g-128),b[f+1]=a-.34414*(d-128)-.71414*(g-128),b[f+2]=a+1.772*(d-128);return b},fromCIELab:function(c,b,a){var d=[3.240479,-1.53715,-.498535,-.969256,1.875992,.041556,.055648,-.204043,1.057311];b=new Uint8Array(b*a*3);for(var g,e,f,k,l,m=a=0;a<c.length;a+=3,m+=3)g=c[a],e=c[a+1],f=c[a+2],k=Math.pow((g+16)/116,3),l=.008856<k,g=k=g/903.3*(0!==l)+l*k,k=l*Math.pow(k,1/3)+(0!==l)*(7.787*k+16/116),e=e/500+k,l=.206893<e,e=l*Math.pow(e,3)+(e-16/116)/
7.787*(0!==l),f=k-f/200,k=.206893<f,f=k*Math.pow(f,3)+(f-16/116)/7.787*(0!==k),e*=.950456,f*=1.088754,b[m]=e*d[0]+g*d[1]+f*d[2],b[m+1]=e*d[3]+g*d[4]+f*d[5],b[m+2]=e*d[6]+g*d[7]+f*d[8];return b}};vc.prototype={isAsync:function(){return"undefined"===typeof this.decodeBlock}};wc.prototype=Object.create(vc.prototype);wc.prototype.constructor=wc;wc.prototype.decodeBlock=function(c){return c};var ki=wc;Wd.prototype={constructor:Wd,initDictionary:function(){this.dictionary=Array(258);this.entryLookup={};
this.byteLength=9;for(var c=0;257>=c;c++)this.dictionary[c]=[c],this._makeEntryLookup&&(this.entryLookup[c]=c)},decompress:function(c){this._makeEntryLookup=!1;this.initDictionary();this.position=0;this.result=[];c.buffer||(c=new Uint8Array(c));c=new DataView(c.buffer);for(var b=this.getNext(c),a;257!==b;){if(256===b){this.initDictionary();for(b=this.getNext(c);256===b;)b=this.getNext(c);if(256<b)throw"corrupted code at scanline "+b;if(257===b)break;else this.appendArray(this.result,this.dictionary[b]),
a=b}else{if(void 0!==this.dictionary[b])this.appendArray(this.result,this.dictionary[b]),a=this.dictionary[a].concat(this.dictionary[b][0]);else{var d=this.dictionary[a];if(!d)throw"Bogus entry. Not in dictionary, "+a+" / "+this.dictionary.length+", position: "+this.position;a=d.concat(this.dictionary[a][0]);this.appendArray(this.result,a)}this.addToDictionary(a);a=b}this.dictionary.length>=Math.pow(2,this.byteLength)-1&&this.byteLength++;b=this.getNext(c)}return new Uint8Array(this.result)},appendArray:function(c,
b){for(var a=0;a<b.length;a++)c.push(b[a]);return c},haveBytesChanged:function(){return this.dictionary.length>=Math.pow(2,this.byteLength)?(this.byteLength++,!0):!1},addToDictionary:function(c){this.dictionary.push(c);this._makeEntryLookup&&(this.entryLookup[c]=this.dictionary.length-1);this.haveBytesChanged();return this.dictionary.length-1},getNext:function(c){c=this.getByte(c,this.position,this.byteLength);this.position+=this.byteLength;return c},getByte:function(c,b,a){var d=b%8,g=Math.floor(b/
8),e=8-d,f=b+a-8*(g+1),k,l=8*(g+2)-b;k=Math.max(0,8*(g+2)-(b+a));if(g>=c.byteLength)return console.warn("ran off the end of the buffer before finding EOI_CODE (end on input code)"),257;d=(c.getUint8(g,this.littleEndian)&Math.pow(2,8-d)-1)<<a-e;g+1<c.byteLength&&(k=c.getUint8(g+1,this.littleEndian)>>>k,k<<=Math.max(0,a-l),d+=k);8<f&&g+2<c.byteLength&&(b=8*(g+3)-(b+a),c=c.getUint8(g+2,this.littleEndian)>>>b,d+=c);return d},compress:function(c){this._makeEntryLookup=!0;this.initDictionary();this.position=
0;for(var b=[],a=[],b=this.appendArray(b,this.binaryFromByte(256,this.byteLength)),d=0;d<c.length;d++){var g=[c[d]],e=a.concat(g);void 0!==this.entryLookup[e]?a=e:(a=this.binaryFromByte(this.entryLookup[a],this.byteLength),b=this.appendArray(b,a),this.addToDictionary(e),a=g,this.dictionary.length>=Math.pow(2,12)&&(b=this.appendArray(b,this.binaryFromByte(256,this.byteLength)),this.initDictionary()))}c=this.binaryFromByte(this.entryLookup[a],this.byteLength);b=this.appendArray(b,c);this.binary=b=b=
this.appendArray(b,this.binaryFromByte(257,this.byteLength));return this.result=this.binaryToUint8(b)},byteFromCode:function(c){return this.dictionary[c]},binaryFromByte:function(c){for(var b=new Uint8Array(1<arguments.length&&void 0!==arguments[1]?arguments[1]:8),a=0;a<b.length;a++)b[b.length-1-a]=0<(c&Math.pow(2,a));return b},binaryToNumber:function(c){for(var b=0,a=0;a<c.length;a++)b+=Math.pow(2,c.length-a-1)*c[a];return b},inputToBinary:function(c){for(var b=1<arguments.length&&void 0!==arguments[1]?
arguments[1]:8,a=new Uint8Array(c.length*b),d=0;d<c.length;d++){var g=this.binaryFromByte(c[d],b);a.set(g,d*b)}return a},binaryToUint8:function(c){for(var b=new Uint8Array(Math.ceil(c.length/8)),a=0,d=0;d<c.length;d+=8){for(var g=0,e=0;8>e&&d+e<c.length;e++)g+=c[d+e]*Math.pow(2,8-e-1);b[a]=g;a++}return b}};xc.prototype=Object.create(vc.prototype);xc.prototype.constructor=xc;xc.prototype.decodeBlock=function(c){return this.decompressor.decompress(c).buffer};var li=xc,tj=Ig.inflate;yc.prototype=Object.create(vc.prototype);
yc.prototype.constructor=yc;yc.prototype.decodeBlock=function(c){return tj(new Uint8Array(c)).buffer};var mi=yc;zc.prototype=Object.create(vc.prototype);zc.prototype.constructor=zc;zc.prototype.decodeBlock=function(c){var b=new DataView(c),a=[],d,g;for(d=0;d<c.byteLength;++d){var e=b.getInt8(d);if(0>e){var f=b.getUint8(d+1),e=-e;for(g=0;g<=e;++g)a.push(f);d+=1}else{for(g=0;g<=e;++g)a.push(b.getUint8(d+g+1));d+=e+1}}return(new Uint8Array(a)).buffer};var ni=zc,ih=function(c,b,a){for(var d=0;b<a;++b)d+=
c[b];return d},jh=function(c,b,a){switch(c){case 1:switch(b){case 8:return new Uint8Array(a);case 16:return new Uint16Array(a);case 32:return new Uint32Array(a)}break;case 2:switch(b){case 8:return new Int8Array(a);case 16:return new Int16Array(a);case 32:return new Int32Array(a)}break;case 3:switch(b){case 32:return new Float32Array(a);case 64:return new Float64Array(a)}}throw Error("Unsupported data format/bitsPerSample");};ng.prototype={getFileDirectory:function(){return this.fileDirectory},getGeoKeys:function(){return this.geoKeys},
getWidth:function(){return this.fileDirectory.ImageWidth},getHeight:function(){return this.fileDirectory.ImageLength},getSamplesPerPixel:function(){return this.fileDirectory.SamplesPerPixel},getTileWidth:function(){return this.isTiled?this.fileDirectory.TileWidth:this.getWidth()},getTileHeight:function(){return this.isTiled?this.fileDirectory.TileLength:this.fileDirectory.RowsPerStrip},getBytesPerPixel:function(){for(var c=0,b=0;b<this.fileDirectory.BitsPerSample.length;++b){var a=this.fileDirectory.BitsPerSample[b];
if(0!==a%8)throw Error("Sample bit-width of "+a+" is not supported.");if(a!==this.fileDirectory.BitsPerSample[0])throw Error("Differing size of samples in a pixel are not supported.");c+=a}return c/8},getSampleByteSize:function(c){if(c>=this.fileDirectory.BitsPerSample.length)throw new RangeError("Sample index "+c+" is out of range.");c=this.fileDirectory.BitsPerSample[c];if(0!==c%8)throw Error("Sample bit-width of "+c+" is not supported.");return c/8},getReaderForSample:function(c){var b=this.fileDirectory.BitsPerSample[c];
switch(this.fileDirectory.SampleFormat?this.fileDirectory.SampleFormat[c]:1){case 1:switch(b){case 8:return DataView.prototype.getUint8;case 16:return DataView.prototype.getUint16;case 32:return DataView.prototype.getUint32}break;case 2:switch(b){case 8:return DataView.prototype.getInt8;case 16:return DataView.prototype.getInt16;case 32:return DataView.prototype.getInt32}break;case 3:switch(b){case 32:return DataView.prototype.getFloat32;case 64:return DataView.prototype.getFloat64}}},getArrayForSample:function(c,
b){return jh(this.fileDirectory.SampleFormat?this.fileDirectory.SampleFormat[c]:1,this.fileDirectory.BitsPerSample[c],b)},getDecoder:function(){return this.decoder},getTileOrStrip:function(c,b,a,d){var g=Math.ceil(this.getWidth()/this.getTileWidth()),e=Math.ceil(this.getHeight()/this.getTileHeight()),f,k=this.tiles;1===this.planarConfiguration?f=b*g+c:2===this.planarConfiguration&&(f=a*g*e+b*g+c);if(null!==k&&f in k)return d?d(null,{x:c,y:b,sample:a,data:k[f]}):k[f];this.isTiled?(g=this.fileDirectory.TileOffsets[f],
e=this.fileDirectory.TileByteCounts[f]):(g=this.fileDirectory.StripOffsets[f],e=this.fileDirectory.StripByteCounts[f]);g=this.dataView.buffer.slice(g,g+e);if(d)return this.getDecoder().decodeBlockAsync(g,function(e,g){e||null===k||(k[f]=g);d(e,{x:c,y:b,sample:a,data:g})});g=this.getDecoder().decodeBlock(g);null!==k&&(k[f]=g);return g},_readRasterAsync:function(c,b,a,d,g,e){function f(){F&&0===C&&(G?e(G):g(a))}function k(e,g){if(e)G=e;else{e=new DataView(g.data);var k=g.y*m,p=g.x*l,n=(g.y+1)*m,r=(g.x+
1)*l;g=g.sample;for(var u=Math.max(0,c[1]-k);u<Math.min(m,m-(n-c[3]));++u)for(var w=Math.max(0,c[0]-p);w<Math.min(l,l-(r-c[2]));++w){var A=v[g].call(e,(u*l+w)*y+x[g],B),F;d?(1!==q&&0<w&&(F=(u+k-c[1])*t*b.length+(w+p-c[0]-1)*b.length+g,A+=a[F]),F=(u+k-c[1])*t*b.length+(w+p-c[0])*b.length+g,a[F]=A):(1!==q&&0<w&&(F=(u+k-c[1])*t+w-1+p-c[0],A+=a[g][F]),F=(u+k-c[1])*t+w+p-c[0],a[g][F]=A)}}--C;f()}var l=this.getTileWidth(),m=this.getTileHeight(),n=Math.floor(c[0]/l),r=Math.ceil(c[2]/l),u=Math.floor(c[1]/
m),p=Math.ceil(c[3]/m);this.getWidth();var t=c[2]-c[0],y=this.getBytesPerPixel();this.getWidth();for(var q=this.fileDirectory.Predictor||1,x=[],v=[],A=0;A<b.length;++A)1===this.planarConfiguration?x.push(ih(this.fileDirectory.BitsPerSample,0,b[A])/8):x.push(0),v.push(this.getReaderForSample(b[A]));for(var F=!1,C=0,B=this.littleEndian,G=null;u<=p;++u)for(A=n;A<=r;++A)for(var K=0;K<b.length;++K){var M=b[K];2===this.planarConfiguration&&(y=this.getSampleByteSize(M));C+=1;this.getTileOrStrip(A,u,M,k)}F=
!0;f()},_readRaster:function(c,b,a,d,g,e){try{var f=this.getTileWidth(),k=this.getTileHeight(),l=Math.floor(c[0]/f),m=Math.ceil(c[2]/f),n=Math.floor(c[1]/k),r=Math.ceil(c[3]/k);this.getWidth();var u=c[2]-c[0],p=this.getBytesPerPixel();this.getWidth();for(var t=this.fileDirectory.Predictor||1,y=[],q=[],x=0;x<b.length;++x)1===this.planarConfiguration?y.push(ih(this.fileDirectory.BitsPerSample,0,b[x])/8):y.push(0),q.push(this.getReaderForSample(b[x]));for(;n<r;++n)for(x=l;x<m;++x)for(var v=n*k,A=x*f,
F=(n+1)*k,C=(x+1)*f,B=0;B<b.length;++B){var G=b[B];2===this.planarConfiguration&&(p=this.getSampleByteSize(G));var K=new DataView(this.getTileOrStrip(x,n,G)),M=q[B],D=Math.min(k,k-(F-c[3])),J=Math.min(f,f-(C-c[2])),E=(D*f+J)*p,z=(new Uint8Array(K.buffer)).length;2*z!==E&&this._debugMessages&&console.warn("dimension mismatch",z,E);for(var H=Math.max(0,c[1]-v);H<D;++H)for(var I=Math.max(0,c[0]-A);I<J;++I){var E=(H*f+I)*p,L=0;E<z-1&&(L=M.call(K,E+y[B],this.littleEndian));var O;d?(1!==t&&0<I&&(O=(H+v-
c[1])*u*b.length+(I+A-c[0]-1)*b.length+B,L+=a[O]),O=(H+v-c[1])*u*b.length+(I+A-c[0])*b.length+B,a[O]=L):(1!==t&&0<I&&(O=(H+v-c[1])*u+I-1+A-c[0],L+=a[B][O]),O=(H+v-c[1])*u+I+A-c[0],a[B][O]=L)}}g(a);return a}catch(bd){return e(bd)}},readRasters:function(){var c,b,a;switch(arguments.length){case 0:break;case 1:"function"===typeof arguments[0]?b=arguments[0]:c=arguments[0];break;case 2:"function"===typeof arguments[0]?(b=arguments[0],a=arguments[1]):(c=arguments[0],b=arguments[1]);break;case 3:c=arguments[0];
b=arguments[1];a=arguments[2];break;default:throw Error("Invalid number of arguments passed.");}c=c||{};a=a||function(a){console.error(a)};var d=c.window||[0,0,this.getWidth(),this.getHeight()],g=c.samples;c=c.interleave;if(0>d[0]||0>d[1]||d[2]>this.getWidth()||d[3]>this.getHeight())throw Error("Select window is out of image bounds.");if(d[0]>d[2]||d[1]>d[3])throw Error("Invalid subsets");var e=(d[2]-d[0])*(d[3]-d[1]),f;if(g)for(f=0;f<g.length;++f){if(g[f]>=this.fileDirectory.SamplesPerPixel)throw new RangeError("Invalid sample index '"+
g[f]+"'.");}else for(g=[],f=0;f<this.fileDirectory.SamplesPerPixel;++f)g.push(f);var k;if(c)f=this.fileDirectory.SampleFormat?Math.max.apply(null,this.fileDirectory.SampleFormat):1,k=Math.max.apply(null,this.fileDirectory.BitsPerSample),k=jh(f,k,e*g.length);else for(k=[],f=0;f<g.length;++f)k.push(this.getArrayForSample(g[f],e));if(this.getDecoder().isAsync()){if(!b)throw Error("No callback specified for asynchronous raster reading.");return this._readRasterAsync(d,g,k,c,b,a)}return this._readRaster(d,
g,k,c,b||function(){},a)},readRGB:function(){var c=null,b=null,a=null;switch(arguments.length){case 0:break;case 1:"function"===typeof arguments[0]?b=arguments[0]:c=arguments[0];break;case 2:"function"===typeof arguments[0]?(b=arguments[0],a=arguments[1]):(c=arguments[0],b=arguments[1]);break;case 3:c=arguments[0];b=arguments[1];a=arguments[2];break;default:throw Error("Invalid number of arguments passed.");}var c=c||{},a=a||function(a){console.error(a)},d=c.window||[0,0,this.getWidth(),this.getHeight()];
if(0>d[0]||0>d[1]||d[2]>this.getWidth()||d[3]>this.getHeight())throw Error("Select window is out of image bounds.");if(d[0]>d[2]||d[1]>d[3])throw Error("Invalid subsets");var g=d[2]-d[0],e=d[3]-d[1],f=this.fileDirectory.PhotometricInterpretation,k=Math.pow(2,this.fileDirectory.BitsPerSample[0]);if(f===la.photometricInterpretations.RGB)return this.readRasters({window:c.window,interleave:!0},b,a);switch(f){case la.photometricInterpretations.WhiteIsZero:case la.photometricInterpretations.BlackIsZero:case la.photometricInterpretations.Palette:d=
[0];break;case la.photometricInterpretations.CMYK:d=[0,1,2,3];break;case la.photometricInterpretations.YCbCr:case la.photometricInterpretations.CIELab:d=[0,1,2];break;default:throw Error("Invalid or unsupported photometric interpretation.");}var l=this.fileDirectory;return this.readRasters({window:c.window,interleave:!0,samples:d},function(a){switch(f){case la.photometricInterpretations.WhiteIsZero:return b(cc.fromWhiteIsZero(a,k,g,e));case la.photometricInterpretations.BlackIsZero:return b(cc.fromBlackIsZero(a,
k,g,e));case la.photometricInterpretations.Palette:return b(cc.fromPalette(a,l.ColorMap,g,e));case la.photometricInterpretations.CMYK:return b(cc.fromCMYK(a,g,e));case la.photometricInterpretations.YCbCr:return b(cc.fromYCbCr(a,g,e));case la.photometricInterpretations.CIELab:return b(cc.fromCIELab(a,g,e))}},a)},getTiePoints:function(){if(!this.fileDirectory.ModelTiepoint)return[];for(var c=[],b=0;b<this.fileDirectory.ModelTiepoint.length;b+=6)c.push({i:this.fileDirectory.ModelTiepoint[b],j:this.fileDirectory.ModelTiepoint[b+
1],k:this.fileDirectory.ModelTiepoint[b+2],x:this.fileDirectory.ModelTiepoint[b+3],y:this.fileDirectory.ModelTiepoint[b+4],z:this.fileDirectory.ModelTiepoint[b+5]});return c},getGDALMetadata:function(){var c={};if(!this.fileDirectory.GDAL_METADATA)return null;for(var b=this.fileDirectory.GDAL_METADATA,b=la.parseXml(b.substring(0,b.length-1)),b=b.evaluate("GDALMetadata/Item",b,null,XPathResult.UNORDERED_NODE_SNAPSHOT_TYPE,null),a=0;a<b.snapshotLength;++a){var d=b.snapshotItem(a);c[d.getAttribute("name")]=
d.textContent}return c},getOrigin:function(){var c=this.fileDirectory.ModelTiepoint;if(!c||6!==c.length)throw Error("The image does not have an affine transformation.");return[c[3],c[4],c[5]]},getResolution:function(){if(!this.fileDirectory.ModelPixelScale)throw Error("The image does not have an affine transformation.");return[this.fileDirectory.ModelPixelScale[0],this.fileDirectory.ModelPixelScale[1],this.fileDirectory.ModelPixelScale[2]]},pixelIsArea:function(){return 1===this.geoKeys.GTRasterTypeGeoKey},
getBoundingBox:function(){var c=this.getOrigin(),b=this.getResolution(),a=c[0],c=c[1],d=a+b[0]*this.getWidth(),b=c+b[1]*this.getHeight();return[Math.min(a,d),Math.min(c,b),Math.max(a,d),Math.max(c,b)]}};var uj=function(){function c(b,a){for(var d=0;d<a.length;d++){var c=a[d];c.enumerable=c.enumerable||!1;c.configurable=!0;"value"in c&&(c.writable=!0);Object.defineProperty(b,c.key,c)}}return function(b,a,d){a&&c(b.prototype,a);d&&c(b,d);return b}}(),oi=function(){function c(b){if(!(this instanceof
c))throw new TypeError("Cannot call a class as a function");this._dataView=new DataView(b)}uj(c,[{key:"getUint64",value:function(b,a){var d=this.getUint32(b,a);b=this.getUint32(b+4,a);return a?d<<32|b:b<<32|d}},{key:"getInt64",value:function(b,a){var d;if(a)return d=this.getInt32(b,a),b=this.getUint32(b+4,a),d<<32|b;d=this.getUint32(b,a);b=this.getInt32(b+4,a);return b<<32|d}},{key:"getUint8",value:function(b,a){return this._dataView.getUint8(b,a)}},{key:"getInt8",value:function(b,a){return this._dataView.getInt8(b,
a)}},{key:"getUint16",value:function(b,a){return this._dataView.getUint16(b,a)}},{key:"getInt16",value:function(b,a){return this._dataView.getInt16(b,a)}},{key:"getUint32",value:function(b,a){return this._dataView.getUint32(b,a)}},{key:"getInt32",value:function(b,a){return this._dataView.getInt32(b,a)}},{key:"getFloat32",value:function(b,a){return this._dataView.getFloat32(b,a)}},{key:"getFloat64",value:function(b,a){return this._dataView.getFloat64(b,a)}},{key:"buffer",get:function(){return this._dataView.buffer}}]);
return c}(),Z=la.fieldTypes,kh=la.fieldTagNames,vj=la.arrayFields,wj=la.geoKeyNames;og.prototype={getOffset:function(c){return this.bigTiff?this.dataView.getUint64(c,this.littleEndian):this.dataView.getUint32(c,this.littleEndian)},getFieldTypeLength:function(c){switch(c){case Z.BYTE:case Z.ASCII:case Z.SBYTE:case Z.UNDEFINED:return 1;case Z.SHORT:case Z.SSHORT:return 2;case Z.LONG:case Z.SLONG:case Z.FLOAT:return 4;case Z.RATIONAL:case Z.SRATIONAL:case Z.DOUBLE:case Z.LONG8:case Z.SLONG8:case Z.IFD8:return 8;
default:throw new RangeError("Invalid field type: "+c);}},getValues:function(c,b,a){var d,g,e=this.getFieldTypeLength(c),f;switch(c){case Z.BYTE:case Z.ASCII:case Z.UNDEFINED:d=new Uint8Array(b);g=this.dataView.getUint8;break;case Z.SBYTE:d=new Int8Array(b);g=this.dataView.getInt8;break;case Z.SHORT:d=new Uint16Array(b);g=this.dataView.getUint16;break;case Z.SSHORT:d=new Int16Array(b);g=this.dataView.getInt16;break;case Z.LONG:d=new Uint32Array(b);g=this.dataView.getUint32;break;case Z.SLONG:d=new Int32Array(b);
g=this.dataView.getInt32;break;case Z.LONG8:case Z.IFD8:d=Array(b);g=this.dataView.getUint64;break;case Z.SLONG8:d=Array(b);g=this.dataView.getInt64;break;case Z.RATIONAL:d=new Uint32Array(2*b);g=this.dataView.getUint32;break;case Z.SRATIONAL:d=new Int32Array(2*b);g=this.dataView.getInt32;break;case Z.FLOAT:d=new Float32Array(b);g=this.dataView.getFloat32;break;case Z.DOUBLE:d=new Float64Array(b);g=this.dataView.getFloat64;break;default:throw new RangeError("Invalid field type: "+c);}if(c!==Z.RATIONAL&&
c!==Z.SRATIONAL)for(f=0;f<b;++f)d[f]=g.call(this.dataView,a+f*e,this.littleEndian);else for(f=0;f<b;f+=2)d[f]=g.call(this.dataView,a+f*e,this.littleEndian),d[f+1]=g.call(this.dataView,a+(f*e+4),this.littleEndian);return c===Z.ASCII?String.fromCharCode.apply(null,d):d},getFieldValues:function(c,b,a,d){this.getFieldTypeLength(b)*a<=(this.bigTiff?8:4)||(d=this.getOffset(d));d=this.getValues(b,a,d);return 1===a&&-1===vj.indexOf(c)&&b!==Z.RATIONAL&&b!==Z.SRATIONAL?d[0]:d},parseGeoKeyDirectory:function(c){var b=
c.GeoKeyDirectory;if(!b)return null;for(var a={},d=4;d<4*b[3];d+=4){var g=wj[b[d]],e=b[d+1]?kh[b[d+1]]:null,f=b[d+2],k=b[d+3];if(e){e=c[e];if("undefined"===typeof e||null===e)throw Error("Could not get value of geoKey '"+g+"'.");"string"===typeof e?e=e.substring(k,k+f-1):e.subarray&&(e=e.subarray(k,k+f-1))}else e=k;a[g]=e}return a},parseFileDirectories:function(c){var b=c;for(c=[];0!==b;){for(var a=this.bigTiff?this.dataView.getUint64(b,this.littleEndian):this.dataView.getUint16(b,this.littleEndian),
d={},b=b+(this.bigTiff?8:2),g=0;g<a;b+=this.bigTiff?20:12,++g){var e=this.dataView.getUint16(b,this.littleEndian),f=this.dataView.getUint16(b+2,this.littleEndian),k=this.bigTiff?this.dataView.getUint64(b+4,this.littleEndian):this.dataView.getUint32(b+4,this.littleEndian);d[kh[e]]=this.getFieldValues(e,f,k,b+(this.bigTiff?12:8))}c.push([d,this.parseGeoKeyDirectory(d)]);b=this.getOffset(b)}return c},getImage:function(c){c=this.fileDirectories[c||0];if(!c)throw new RangeError("Invalid image index");
return new ng(c[0],c[1],this.dataView,this.littleEndian,this.cache)},getImageCount:function(){return this.fileDirectories.length}};var xj=ma(function(c){var b=function(a,b){var d,c,f,k;if("string"===typeof a||a instanceof String)for(d=new ArrayBuffer(2*a.length),k=new Uint16Array(d),c=0,f=a.length;c<f;++c)k[c]=a.charCodeAt(c);else if(a instanceof ArrayBuffer)d=a;else throw Error("Invalid input data given.");return new og(d,b)};c.exports.parse=b;"undefined"!==typeof window&&(window.GeoTIFF={parse:b})}),
lh=function(c){function b(){I(this,b);var a=P(this,(b.__proto__||Object.getPrototypeOf(b)).call(this));a.setMetadata("targetType",Q.name);a.addInputValidator(0,ArrayBuffer);return a}L(b,c);N(b,[{key:"_run",value:function(){var a=this._getInput(0);if(a){var b=!1;try{var c=xj.parse(a).getImage(),e=c.readRasters({interleave:!0}),f=c.getWidth(),k=c.getHeight(),l=c.getSamplesPerPixel();l==e.length/(f*k)&&(b=!0);b?this._addOutput(Q).setData(e,f,k,l):console.warn("Tiff support is experimental and this file is not compatible.")}catch(m){console.warn("This buffer is not from a TIFF file.")}}else console.warn('TiffDecoder requires an ArrayBuffer as input "0". Unable to continue.')}}]);
return b}(ra),yj=function(){function c(){I(this,c);this._rawData=null}N(c,[{key:"setRawData",value:function(b){this._rawData=b}},{key:"parse",value:function(){var b=null;try{b=this._parseNoException()}catch(a){console.warn("This file is not compatible.")}return b}},{key:"_parseNoException",value:function(){if(!this._rawData)return console.warn("The input buffer is null. Nothing to be parsed here."),null;var b=this._rawData,a=new DataView(b),d,c,e,f,k,l,m;a.getUint16(0,!0);d=a.getUint8(2);d=new Uint8Array(b,
3,d);d=String.fromCharCode.apply(String,d);c=a.getUint16(83,!0);e=a.getUint16(85,!0);f=a.getUint16(87,!0);k=a.getUint16(89,!0);l=a.getUint16(91,!0);m=a.getUint16(93,!0);for(var n=c*e*f*k,r=n*m,u=new Float32Array(n),p=0;p<n;p++)u[p]=a.getFloat32(95+p*m,!0);l=95+r+l;m=a.getUint8(l);m=new Uint8Array(b,l+1,m);String.fromCharCode.apply(String,m);m=l+9;l=Array(8);for(p=0;8>p;p++)n={total:a.getUint16(m+6*p+4,!0),labels:null},l[p]=n;l[0].description="list of labels for measure dimension";l[1].description=
"list of labels for duration dimension";l[2].description="list of labels for first space dimension";l[3].description="list of labels for second space dimension";l[4].description="list of scales";l[5].description="list of units";l[6].description="list of transformations";l[7].description="list of contexts";m+=48;for(p=0;p<l.length-2;p++){r=l[p].total;l[p].labels=r?Array(r).fill(""):0;for(var t=0;t<r;t++){if(n=a.getUint8(m)){var y=new Uint8Array(b,m+1,n),y=String.fromCharCode.apply(String,Bi(y));l[p].labels[t]=
y.replace("\u00e6","\u00b5").replace("\u00fd","\u00b2")}m+=n+1}}p=a.getUint8(m);l[6].labels=p;m+=l[6].total*(p+1);p=l[l.length-1];p.contextsByteLength=Array(p.total);p.types=Array(p.total);p.values=Array(p.total);t=/[a-zA-Z ]*\:{1}([a-zA-Z]*)[\[]?\d*[\]]?/;p.labels=Array(p.total).fill("");for(r=0;r<p.total;r++)n=a.getUint8(m),y=new Uint8Array(b,m+1,n),y=String.fromCharCode.apply(String,y),p.labels[r]=y.split(":")[0],p.contextsByteLength[r]=a.getUint16(m+n+1,!0),y=t.exec(y),p.types[r]=y?y[1].toLowerCase():
null,m+=n+3;for(r=0;r<p.total;r++){n=null;if("single"===p.types[r])n=a.getFloat32(m,!0);else if("boolean"===p.types[r])for(n=Array(p.contextsByteLength[r]),y=0;y<n.length;y++)n[y]=!!a.getUint8(m+y);else"string"===p.types[r]&&(n=a.getUint8(m),y=new Uint8Array(b,m+1,n),n=String.fromCharCode.apply(String,y));m+=p.contextsByteLength[r];p.values[r]=n}for(p=0;p<l.length;p++)delete l[p].total;delete l[7].contextsByteLength;delete l[7].types;return{metadata:{comment:d,sizes:{measure:c,duration:e,firstSpace:f,
secondSpace:k},informationList:l},data:u}}}]);return c}();(function(){function c(){var b=0<arguments.length&&void 0!==arguments[0]?arguments[0]:null;I(this,c);this._typeCode=this._qeegModObj=null;this._typeCodeMap={"Z Electrical Tomography for Cortex and Basal Ganglia":"ZETCBG","Z Electrical Tomography for Cortex":"ZETC","Z Cross Spectrum":"ZCROSS","Z Broad Band":"ZBBSP",Phase:"PHA","Electrical Tomography for Cortex and Basal Ganglia":"ETCBG","Electrical Tomography for Cortex":"ETC","Cross Spectrum":"CROSS",
Correlation:"COR",Coherence:"COH","Broad Band":"BBSP"};this.setQeegModObj(b)}N(c,[{key:"_defineTypeCode",value:function(){var b=this.getType();b in this._typeCodeMap&&(this._typeCode=this._typeCodeMap[b])}},{key:"setQeegModObj",value:function(){var b=0<arguments.length&&void 0!==arguments[0]?arguments[0]:null;b&&(this._qeegModObj=b,this._defineTypeCode())}},{key:"getType",value:function(){return this._qeegModObj.metadata.comment}},{key:"getTypeCode",value:function(){return this._typeCode}},{key:"getMeasureNames",
value:function(){return this._qeegModObj.metadata.informationList[0].labels}},{key:"getDurationsLabels",value:function(){return this._qeegModObj.metadata.informationList[1].labels}},{key:"getFirstSpaceNames",value:function(){return this._qeegModObj.metadata.informationList[2].labels}},{key:"getSecondSpaceNames",value:function(){return this._qeegModObj.metadata.informationList[3].labels}},{key:"getUnitsLabels",value:function(){return this._qeegModObj.metadata.informationList[5].labels}},{key:"getMeasureSize",
value:function(){return this._qeegModObj.metadata.sizes.measure}},{key:"getDurationSize",value:function(){return this._qeegModObj.metadata.sizes.duration}},{key:"getFirstSpaceSize",value:function(){return this._qeegModObj.metadata.sizes.firstSpace}},{key:"getSecondSpaceSize",value:function(){return this._qeegModObj.metadata.sizes.secondSpace}},{key:"getDimensionSizes",value:function(){return[this._qeegModObj.metadata.sizes.measure,this._qeegModObj.metadata.sizes.duration,this._qeegModObj.metadata.sizes.firstSpace,
this._qeegModObj.metadata.sizes.secondSpace]}},{key:"getNumberOfDimensionsUsed",value:function(){for(var b=this.getDimensionSizes(),a=b.length-1;0<=a;a--)if(1<b[a])return a+1;return 0}},{key:"getTranformation",value:function(){return this._qeegModObj.metadata.informationList[6].labels}},{key:"getContext",value:function(b){return 0>b||b>=this._qeegModObj.metadata.informationList[7].labels.length?(console.warn("The context index is out of range"),null):{label:this._qeegModObj.metadata.informationList[7].labels[b],
value:this._qeegModObj.metadata.informationList[7].values[b]}}},{key:"getAllContexts",value:function(){var b=this._qeegModObj.metadata.informationList[7];if(b.labels.length!=b.values.length)return console.warn("The contexts is corrupted. Inequal amount of values/labels."),null;for(var a=[],d=0;d<b.labels.length;d++)a.push({label:b.labels[d],value:b.values[d]});return a}},{key:"getStartFrequency",value:function(){return"COR"===this._typeCode?-1:this._qeegModObj.metadata.informationList[7].values[0]}},
{key:"getFrequencyResolution",value:function(){return"COR"===this._typeCode?-1:this._qeegModObj.metadata.informationList[7].values[1]}},{key:"getScaleFactor",value:function(){var b=2;"COR"===this._typeCode&&(b-=2);return this._qeegModObj.metadata.informationList[7].values[b]}},{key:"getScaleIfScaleMeasures",value:function(){var b=3;"COR"===this._typeCode&&(b-=2);return this._qeegModObj.metadata.informationList[7].values[b]}},{key:"getMeasureName",value:function(){var b=4;"COR"===this._typeCode&&(b-=
2);return this._qeegModObj.metadata.informationList[7].values[b]}},{key:"getDurationName",value:function(){var b=5;"COR"===this._typeCode&&(b-=2);return this._qeegModObj.metadata.informationList[7].values[b]}},{key:"getFirstSpaceName",value:function(){var b=6;"COR"===this._typeCode&&(b-=2);return this._qeegModObj.metadata.informationList[7].values[b]}},{key:"getSecondSpaceName",value:function(){var b=7;"COR"===this._typeCode&&(b-=2);return this._qeegModObj.metadata.informationList[7].values[b]}},
{key:"getAllDimensionsNames",value:function(){return[this.getMeasureName(),this.getDurationName(),this.getFirstSpaceName(),this.getSecondSpaceName()]}},{key:"getValue",value:function(b,a,d,c){var e=this._qeegModObj.metadata.sizes;if(0>b||b>=e.measure)return console.warn("measureIndex is out of range."),null;if(0>a||a>=e.duration)return console.warn("durationIndex is out of range."),null;if(0>d||d>=e.firstSpace)return console.warn("firstSpaceIndex is out of range."),null;if(0>c||c>=e.secondSpace)return console.warn("secondSpaceIndex is out of range."),
null;b=this._getOffset(b,a,d,c);return this._qeegModObj.data[b]}},{key:"getSpectrum",value:function(){var b=0<arguments.length&&void 0!==arguments[0]?arguments[0]:-1,a=1<arguments.length&&void 0!==arguments[1]?arguments[1]:-1,d=2<arguments.length&&void 0!==arguments[2]?arguments[2]:-1,c=this._qeegModObj.metadata.sizes,e=this._qeegModObj.data;return-1==b&&-1==a&&-1==d?e.slice():0<=b&&b<c.measure&&-1==a&&-1==d?(c=this._getOffset(b,0,0,0),b=this._getOffset(b+1,0,0,0),e.slice(c,b)):0<=b&&b<c.measure&&
0<=a&&a<c.duration&&-1==d?(c=this._getOffset(b,a,0,0),b=this._getOffset(b,a+1,0,0),e.slice(c,b)):0<=b&&b<c.measure&&0<=a&&a<c.duration&&0<=d&&d<c.firstSpace?(c=this._getOffset(b,a,d,0),b=this._getOffset(b,a,d+1,0),e.slice(c,b)):null}},{key:"getSpectrumByLabels",value:function(){var b=0<arguments.length&&void 0!==arguments[0]?arguments[0]:null,a=1<arguments.length&&void 0!==arguments[1]?arguments[1]:null,d=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null,c=this._qeegModObj.metadata.informationList,
e=c[0].labels.indexOf(b),f=c[1].labels.indexOf(a),c=c[2].labels.indexOf(d);return b&&-1==e?(console.warn("The measure label "+b+" could not be found."),null):a&&-1==f?(console.warn("The duration label "+a+" could not be found."),null):d&&-1==c?(console.warn("The first-space label "+d+" could not be found."),null):this.getSpectrum(e,f,c)}},{key:"getSpectrumLabelsByLabels",value:function(){var b=0<arguments.length&&void 0!==arguments[0]?arguments[0]:null,a=1<arguments.length&&void 0!==arguments[1]?
arguments[1]:null,d=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null,c=this._qeegModObj.metadata.informationList,e=c[0].labels.indexOf(b),f=c[1].labels.indexOf(a),c=c[2].labels.indexOf(d);return b&&-1==e?(console.warn("The measure label "+b+" could not be found."),null):a&&-1==f?(console.warn("The duration label "+a+" could not be found."),null):d&&-1==c?(console.warn("The first-space label "+d+" could not be found."),null):this.getSpectrumLabels(e,f,c)}},{key:"getSpectrumLabels",value:function(){var b=
0<arguments.length&&void 0!==arguments[0]?arguments[0]:-1,a=1<arguments.length&&void 0!==arguments[1]?arguments[1]:-1,d=2<arguments.length&&void 0!==arguments[2]?arguments[2]:-1,c=this._qeegModObj.metadata.sizes,e=this._qeegModObj.metadata.informationList,f=[];return-1==b&&-1==a&&-1==d?(e[0].labels&&f.push(e[0].labels.slice()),e[1].labels&&f.push(e[1].labels.slice()),e[2].labels&&f.push(e[2].labels.slice()),e[3].labels&&f.push(e[3].labels.slice()),f):0<=b&&b<c.measure&&-1==a&&-1==d?(this._getOffset(b,
0,0,0),this._getOffset(b+1,0,0,0),e[0].labels&&e[0].labels.length>b&&f.push(e[0].labels[b]),e[1].labels&&f.push(e[1].labels.slice()),e[2].labels&&f.push(e[2].labels.slice()),e[3].labels&&f.push(e[3].labels.slice()),f):0<=b&&b<c.measure&&0<=a&&a<c.duration&&-1==d?(this._getOffset(b,a,0,0),this._getOffset(b,a+1,0,0),e[0].labels&&e[0].labels.length>b&&f.push(e[0].labels[b]),e[1].labels&&e[1].labels.length>a&&f.push(e[1].labels[a]),e[2].labels&&f.push(e[2].labels.slice()),e[3].labels&&f.push(e[3].labels.slice()),
f):0<=b&&b<c.measure&&0<=a&&a<c.duration&&0<=d&&d<c.firstSpace?(this._getOffset(b,a,d,0),this._getOffset(b,a,d+1,0),e[0].labels&&e[0].labels.length>b&&f.push(e[0].labels[b]),e[1].labels&&e[1].labels.length>a&&f.push(e[1].labels[a]),e[2].labels&&e[2].labels.length>d&&f.push(e[2].labels[d]),e[3].labels&&f.push(e[3].labels.slice()),f):null}},{key:"_getOffset",value:function(b,a,d,c){var e=this._qeegModObj.metadata.sizes;return(b*e.duration*e.firstSpace+a*e.firstSpace+d)*e.secondSpace+c}}]);return c})();
var zj=function(c){function b(){I(this,b);var a=P(this,(b.__proto__||Object.getPrototypeOf(b)).call(this));a.addInputValidator(0,ArrayBuffer);a.setMetadata("debug",!1);a._view=null;return a}L(b,c);N(b,[{key:"_run",value:function(){var a=this._getInput(0);if(a){var b=new yj;b.setRawData(a);(a=b.parse())&&(this._output[0]=a)}else console.warn('EegModDecoder requires an ArrayBuffer as input "0". Unable to continue.')}}]);return b}(ra),Aj=function(c){function b(){I(this,b);var a=P(this,(b.__proto__||
Object.getPrototypeOf(b)).call(this));a.setMetadata("compress",!0);a.setMetadata("description","no description");a.setMetadata("madeWith","Pixpipejs");a.setMetadata("userObject",null);return a}L(b,c);N(b,[{key:"_run",value:function(){var a=new Tg;a.enableDataCompression(this.getMetadata("compress"));a.setOption("userObject",this.getMetadata("userObject"));a.setOption("description",this.getMetadata("description"));a.setOption("madeWith",this.getMetadata("madeWith"));this._forEachInput(function(b,c){a.addInput(c)});
a.run();this._output[0]=a.getOutput()}}],[{key:"MAGIC_NUMBER",value:function(){return"PIXPIPE_PIXBIN"}}]);return b}(W),Bj=function(){function c(){}function b(a,b){for(var d=0,c=[],e,f,g=16;0<g&&!a[g-1];)g--;c.push({children:[],index:0});var k=c[0],t;for(e=0;e<g;e++){for(f=0;f<a[e];f++){k=c.pop();for(k.children[k.index]=b[d];0<k.index;)k=c.pop();k.index++;for(c.push(k);c.length<=e;)c.push(t={children:[],index:0}),k.children[k.index]=t.children,k=t;d++}e+1<g&&(c.push(t={children:[],index:0}),k.children[k.index]=
t.children,k=t)}return c[0].children}function a(a,b,d,c,g,r,u,p,t){function f(){if(0<J)return J--,D>>J&1;D=a[b++];if(255==D){var d=a[b++];if(d)throw Error("unexpected marker: "+(D<<8|d).toString(16));}J=7;return D>>>7}function k(a){for(var b;null!==(b=f());){a=a[b];if("number"===typeof a)return a;if("object"!==("undefined"===typeof a?"undefined":O(a)))throw Error("invalid huffman sequence");}return null}function l(a){for(var b=0;0<a;){var d=f();if(null===d)return;b=b<<1|d;a--}return b}function m(a){var b=
l(a);return b>=1<<a-1?b:b+(-1<<a)+1}function n(a,b){var d=k(a.huffmanTableDC),d=0===d?0:m(d);b[0]=a.pred+=d;for(d=1;64>d;){var c=k(a.huffmanTableAC),f=c&15,c=c>>4;if(0===f){if(15>c)break;d+=16}else d+=c,b[e[d]]=m(f),d++}}function q(a,b){var d=k(a.huffmanTableDC),d=0===d?0:m(d)<<t;b[0]=a.pred+=d}function C(a,b){b[0]|=f()<<t}function B(a,b){if(0<E)E--;else for(var d=r;d<=u;){var c=k(a.huffmanTableAC),f=c&15,c=c>>4;if(0===f){if(15>c){E=l(c)+(1<<c)-1;break}d+=16}else d+=c,b[e[d]]=m(f)*(1<<t),d++}}function G(a,
b){for(var d=r,c=0;d<=u;){var g=e[d],p=0>b[g]?-1:1;switch(z){case 0:c=k(a.huffmanTableAC);g=c&15;c>>=4;if(0===g)15>c?(E=l(c)+(1<<c),z=4):(c=16,z=1);else{if(1!==g)throw Error("invalid ACn encoding");H=m(g);z=c?2:3}continue;case 1:case 2:b[g]?b[g]+=(f()<<t)*p:(c--,0===c&&(z=2==z?3:0));break;case 3:b[g]?b[g]+=(f()<<t)*p:(b[g]=H<<t,z=0);break;case 4:b[g]&&(b[g]+=(f()<<t)*p)}d++}4===z&&(E--,0===E&&(z=0))}var K=d.mcusPerLine,M=b,D=0,J=0,E=0,z=0,H,I=c.length,L,N,P,Q,S;p=d.progressive?0===r?0===p?q:C:0===
p?B:G:n;var R=0;d=1==I?c[0].blocksPerLine*c[0].blocksPerColumn:K*d.mcusPerColumn;g||(g=d);for(var U,V;R<d;){for(N=0;N<I;N++)c[N].pred=0;E=0;if(1==I)for(L=c[0],S=0;S<g;S++)p(L,L.blocks[R/L.blocksPerLine|0][R%L.blocksPerLine]),R++;else for(S=0;S<g;S++){for(N=0;N<I;N++)for(L=c[N],U=L.h,V=L.v,P=0;P<V;P++)for(Q=0;Q<U;Q++)p(L,L.blocks[(R/K|0)*L.v+P][R%K*L.h+Q]);R++;if(R===d)break}J=0;L=a[b]<<8|a[b+1];if(65280>L)throw Error("marker was not found");if(65488<=L&&65495>=L)b+=2;else break}return b-M}function d(a,
b){a=[];for(var d=b.blocksPerLine,c=b.blocksPerColumn,e=d<<3,f=new Int32Array(64),g=new Uint8Array(64),k,t,y=0;y<c;y++){var q=y<<3;for(k=0;8>k;k++)a.push(new Uint8Array(e));for(var x=0;x<d;x++){var v,A,F,C,B,G,K,M,D;v=b.blocks[y][x];t=g;var J=f;A=b.quantizationTable;var E=J;for(k=0;64>k;k++)E[k]=v[k]*A[k];for(k=0;8>k;++k){var z=8*k;0==E[1+z]&&0==E[2+z]&&0==E[3+z]&&0==E[4+z]&&0==E[5+z]&&0==E[6+z]&&0==E[7+z]?(v=5793*E[0+z]+512>>10,E[0+z]=v,E[1+z]=v,E[2+z]=v,E[3+z]=v,E[4+z]=v,E[5+z]=v,E[6+z]=v,E[7+z]=
v):(D=5793*E[0+z]+128>>8,M=5793*E[4+z]+128>>8,K=E[2+z],G=E[6+z],B=2896*(E[1+z]-E[7+z])+128>>8,A=2896*(E[1+z]+E[7+z])+128>>8,C=E[3+z]<<4,F=E[5+z]<<4,v=D-M+1>>1,D=D+M+1>>1,M=v,v=3784*K+1567*G+128>>8,K=1567*K-3784*G+128>>8,G=v,v=B-F+1>>1,B=B+F+1>>1,F=v,v=A+C+1>>1,C=A-C+1>>1,A=v,v=D-G+1>>1,D=D+G+1>>1,G=v,v=M-K+1>>1,M=M+K+1>>1,K=v,v=2276*B+3406*A+2048>>12,B=3406*B-2276*A+2048>>12,A=v,v=799*C+4017*F+2048>>12,C=4017*C-799*F+2048>>12,F=v,E[0+z]=D+A,E[7+z]=D-A,E[1+z]=M+F,E[6+z]=M-F,E[2+z]=K+C,E[5+z]=K-C,E[3+
z]=G+B,E[4+z]=G-B)}for(k=0;8>k;++k)z=k,0==E[8+z]&&0==E[16+z]&&0==E[24+z]&&0==E[32+z]&&0==E[40+z]&&0==E[48+z]&&0==E[56+z]?(v=5793*J[k+0]+8192>>14,E[0+z]=v,E[8+z]=v,E[16+z]=v,E[24+z]=v,E[32+z]=v,E[40+z]=v,E[48+z]=v,E[56+z]=v):(D=5793*E[0+z]+2048>>12,M=5793*E[32+z]+2048>>12,K=E[16+z],G=E[48+z],B=2896*(E[8+z]-E[56+z])+2048>>12,A=2896*(E[8+z]+E[56+z])+2048>>12,C=E[24+z],F=E[40+z],v=D-M+1>>1,D=D+M+1>>1,M=v,v=3784*K+1567*G+2048>>12,K=1567*K-3784*G+2048>>12,G=v,v=B-F+1>>1,B=B+F+1>>1,F=v,v=A+C+1>>1,C=A-C+
1>>1,A=v,v=D-G+1>>1,D=D+G+1>>1,G=v,v=M-K+1>>1,M=M+K+1>>1,K=v,v=2276*B+3406*A+2048>>12,B=3406*B-2276*A+2048>>12,A=v,v=799*C+4017*F+2048>>12,C=4017*C-799*F+2048>>12,F=v,E[0+z]=D+A,E[56+z]=D-A,E[8+z]=M+F,E[48+z]=M-F,E[16+z]=K+C,E[40+z]=K-C,E[24+z]=G+B,E[32+z]=G-B);for(k=0;64>k;++k)J=128+(E[k]+8>>4),t[k]=0>J?0:255<J?255:J;E=0;J=x<<3;for(t=0;8>t;t++)for(v=a[q+t],k=0;8>k;k++)v[J+k]=g[E++]}}return a}function g(a){return 0>a?0:255<a?255:a}var e=new Int32Array([0,1,8,16,9,2,3,10,17,24,32,25,18,11,4,5,12,19,
26,33,40,48,41,34,27,20,13,6,7,14,21,28,35,42,49,56,57,50,43,36,29,22,15,23,30,37,44,51,58,59,52,45,38,31,39,46,53,60,61,54,47,55,62,63]);c.prototype={load:function(a){var b=new XMLHttpRequest;b.open("GET",a,!0);b.responseType="arraybuffer";b.onload=function(){var a=new Uint8Array(b.response||b.mozResponseArrayBuffer);this.parse(a);if(this.onload)this.onload()}.bind(this);b.send(null)},parse:function(c){function f(){var a=c[n]<<8|c[n+1];n+=2;return a}function g(){var a=f(),a=c.subarray(n,n+a-2);n+=
a.length;return a}function m(a){var b=0,d=0,c,e;for(e in a.components)a.components.hasOwnProperty(e)&&(c=a.components[e],b<c.h&&(b=c.h),d<c.v&&(d=c.v));var f=Math.ceil(a.samplesPerLine/8/b),g=Math.ceil(a.scanLines/8/d);for(e in a.components)if(a.components.hasOwnProperty(e)){c=a.components[e];for(var k=Math.ceil(Math.ceil(a.samplesPerLine/8)*c.h/b),p=Math.ceil(Math.ceil(a.scanLines/8)*c.v/d),l=f*c.h,m=g*c.v,n=[],u=0;u<m;u++){for(var r=[],t=0;t<l;t++)r.push(new Int32Array(64));n.push(r)}c.blocksPerLine=
k;c.blocksPerColumn=p;c.blocks=n}a.maxH=b;a.maxV=d;a.mcusPerLine=f;a.mcusPerColumn=g}var n=0,r=null,u=null,p,t,y=[],q=[],x=[],v=[],A=f();if(65496!=A)throw Error("SOI not found");for(A=f();65497!=A;){var F;switch(A){case 65280:break;case 65504:case 65505:case 65506:case 65507:case 65508:case 65509:case 65510:case 65511:case 65512:case 65513:case 65514:case 65515:case 65516:case 65517:case 65518:case 65519:case 65534:var C=g();65504===A&&74===C[0]&&70===C[1]&&73===C[2]&&70===C[3]&&0===C[4]&&(r={version:{major:C[5],
minor:C[6]},densityUnits:C[7],xDensity:C[8]<<8|C[9],yDensity:C[10]<<8|C[11],thumbWidth:C[12],thumbHeight:C[13],thumbData:C.subarray(14,14+3*C[12]*C[13])});65518===A&&65===C[0]&&100===C[1]&&111===C[2]&&98===C[3]&&101===C[4]&&0===C[5]&&(u={version:C[6],flags0:C[7]<<8|C[8],flags1:C[9]<<8|C[10],transformCode:C[11]});break;case 65499:for(A=f()+n-2;n<A;){var C=c[n++],z=new Int32Array(64);if(0===C>>4)for(F=0;64>F;F++){var G=e[F];z[G]=c[n++]}else if(1===C>>4)for(F=0;64>F;F++)G=e[F],z[G]=f();else throw Error("DQT: invalid table spec");
y[C&15]=z}break;case 65472:case 65473:case 65474:f();p={};p.extended=65473===A;p.progressive=65474===A;p.precision=c[n++];p.scanLines=f();p.samplesPerLine=f();p.components={};p.componentsOrder=[];C=c[n++];for(A=0;A<C;A++){var z=c[n],G=c[n+1]>>4,B=c[n+1]&15,D=c[n+2];p.componentsOrder.push(z);p.components[z]={h:G,v:B,quantizationIdx:D};n+=3}m(p);q.push(p);break;case 65476:C=f();for(A=2;A<C;){z=c[n++];G=new Uint8Array(16);for(F=B=0;16>F;F++,n++)B+=G[F]=c[n];D=new Uint8Array(B);for(F=0;F<B;F++,n++)D[F]=
c[n];A+=17+B;(0===z>>4?v:x)[z&15]=b(G,D)}break;case 65501:f();t=f();break;case 65498:f();z=c[n++];C=[];for(A=0;A<z;A++)G=p.components[c[n++]],B=c[n++],G.huffmanTableDC=v[B>>4],G.huffmanTableAC=x[B&15],C.push(G);A=c[n++];z=c[n++];G=c[n++];A=a(c,n,p,C,t,A,z,G>>4,G&15);n+=A;break;default:if(255==c[n-3]&&192<=c[n-2]&&254>=c[n-2])n-=3;else throw Error("unknown JPEG marker "+A.toString(16));}A=f()}if(1!=q.length)throw Error("only single frame JPEGs supported");for(A=0;A<q.length;A++)for(F in t=q[A].components,
t)t[F].quantizationTable=y[t[F].quantizationIdx],delete t[F].quantizationIdx;this.width=p.samplesPerLine;this.height=p.scanLines;this.jfif=r;this.adobe=u;this.components=[];for(A=0;A<p.componentsOrder.length;A++)G=p.components[p.componentsOrder[A]],this.components.push({lines:d(p,G),scaleX:G.h/p.maxH,scaleY:G.v/p.maxV})},getData:function(a,b){var d=this.width/a,c=this.height/b,e,f,k,p,t,y,q,x,v,A,F=0,C,z,G,B,D,H,J=new Uint8Array(a*b*this.components.length);switch(this.components.length){case 1:e=
this.components[0];for(A=0;A<b;A++)for(t=e.lines[0|A*e.scaleY*c],v=0;v<a;v++)C=t[0|v*e.scaleX*d],J[F++]=C;break;case 2:e=this.components[0];f=this.components[1];for(A=0;A<b;A++)for(t=e.lines[0|A*e.scaleY*c],y=f.lines[0|A*f.scaleY*c],v=0;v<a;v++)C=t[0|v*e.scaleX*d],J[F++]=C,C=y[0|v*f.scaleX*d],J[F++]=C;break;case 3:H=!0;this.adobe&&this.adobe.transformCode?H=!0:"undefined"!==typeof this.colorTransform&&(H=!!this.colorTransform);e=this.components[0];f=this.components[1];k=this.components[2];for(A=0;A<
b;A++)for(t=e.lines[0|A*e.scaleY*c],y=f.lines[0|A*f.scaleY*c],q=k.lines[0|A*k.scaleY*c],v=0;v<a;v++)H?(C=t[0|v*e.scaleX*d],z=y[0|v*f.scaleX*d],G=q[0|v*k.scaleX*d],p=g(C+1.402*(G-128)),x=g(C-.3441363*(z-128)-.71413636*(G-128)),C=g(C+1.772*(z-128))):(p=t[0|v*e.scaleX*d],x=y[0|v*f.scaleX*d],C=q[0|v*k.scaleX*d]),J[F++]=p,J[F++]=x,J[F++]=C;break;case 4:if(!this.adobe)throw"Unsupported color mode (4 components)";H=!1;this.adobe&&this.adobe.transformCode?H=!0:"undefined"!==typeof this.colorTransform&&(H=
!!this.colorTransform);e=this.components[0];f=this.components[1];k=this.components[2];p=this.components[3];for(A=0;A<b;A++)for(t=e.lines[0|A*e.scaleY*c],y=f.lines[0|A*f.scaleY*c],q=k.lines[0|A*k.scaleY*c],x=p.lines[0|A*p.scaleY*c],v=0;v<a;v++)H?(C=t[0|v*e.scaleX*d],z=y[0|v*f.scaleX*d],G=q[0|v*k.scaleX*d],B=x[0|v*p.scaleX*d],D=255-g(C+1.402*(G-128)),G=255-g(C-.3441363*(z-128)-.71413636*(G-128)),C=255-g(C+1.772*(z-128))):(D=t[0|v*e.scaleX*d],G=y[0|v*f.scaleX*d],C=q[0|v*k.scaleX*d],B=x[0|v*p.scaleX*
d]),J[F++]=255-D,J[F++]=255-G,J[F++]=255-C,J[F++]=255-B;break;default:throw"Unsupported color mode";}return J},copyToImageData:function(a){var b=a.width,d=a.height;a=a.data;var c=this.getData(b,d),e=0,f=0,u,p,t,y,q,x;switch(this.components.length){case 1:for(p=0;p<d;p++)for(u=0;u<b;u++)t=c[e++],a[f++]=t,a[f++]=t,a[f++]=t,a[f++]=255;break;case 3:for(p=0;p<d;p++)for(u=0;u<b;u++)q=c[e++],x=c[e++],t=c[e++],a[f++]=q,a[f++]=x,a[f++]=t,a[f++]=255;break;case 4:for(p=0;p<d;p++)for(u=0;u<b;u++)q=c[e++],x=c[e++],
t=c[e++],y=c[e++],q=255-g(q*(1-y/255)+y),x=255-g(x*(1-y/255)+y),t=255-g(t*(1-y/255)+y),a[f++]=q,a[f++]=x,a[f++]=t,a[f++]=255;break;default:throw"Unsupported color mode";}}};return c}(),Cj={encode:function(c,b){"undefined"===typeof b&&(b=50);return{data:(new pi(b)).encode(c,b),width:c.width,height:c.height}},decode:function(c,b){var a=new Uint8Array(c);c=new Bj;c.parse(a);b={width:c.width,height:c.height,data:b?new Uint8Array(c.width*c.height*4):new z(c.width*c.height*4)};c.copyToImageData(b);return b}},
mh=function(c){function b(){I(this,b);var a=P(this,(b.__proto__||Object.getPrototypeOf(b)).call(this));a.setMetadata("targetType",Q.name);a.addInputValidator(0,ArrayBuffer);return a}L(b,c);N(b,[{key:"_run",value:function(){var a=this._getInput(0);if(a)try{var b=Cj.decode(a),c=b.data.length/(b.width*b.height),e=new Q,f=new Uint8Array(b.data.buffer);e.setData(f,b.width,b.height,c);this._output[0]=e}catch(k){}else console.warn('JpegDecoder requires an ArrayBuffer as input "0". Unable to continue.')}}]);
return b}(ra),Dj=ma(function(c){(function(){function b(){"undefined"!=typeof $b&&"development"!=$b.env.NODE_ENV||console.log.apply(console,arguments)}var a={};c.exports=a;(function(a,c){a.toRGBA8=function(d){var c=d.width,e=d.height,g=c*e,m=a.decode._getBPP(d),n=Math.ceil(c*m/8),m=new Uint8Array(4*g),r=new Uint32Array(m.buffer),u=d.data,p=d.ctype,t=d.depth,y=a._bin.readUshort;if(6==p){g<<=2;if(8==t)for(d=0;d<g;d++)m[d]=u[d];if(16==t)for(d=0;d<g;d++)m[d]=u[d<<1]}else if(2==p){d=d.tabs.tRNS;n=e=c=-1;
d&&(c=d[0],e=d[1],n=d[2]);if(8==t)for(d=0;d<g;d++)r=d<<2,p=3*d,m[r]=u[p],m[r+1]=u[p+1],m[r+2]=u[p+2],m[r+3]=255,-1!=c&&u[p]==c&&u[p+1]==e&&u[p+2]==n&&(m[r+3]=0);if(16==t)for(d=0;d<g;d++)r=d<<2,p=6*d,m[r]=u[p],m[r+1]=u[p+2],m[r+2]=u[p+4],m[r+3]=255,-1!=c&&y(u,p)==c&&y(u,p+2)==e&&y(u,p+4)==n&&(m[r+3]=0)}else if(3==p){var y=d.tabs.PLTE,q=(p=d.tabs.tRNS)?p.length:0;if(1==t)for(var x=0;x<e;x++){var v=x*n,A=x*c;for(d=0;d<c;d++){var r=A+d<<2,F=u[v+(d>>3)]>>7-((d&7)<<0)&1,C=3*F;m[r]=y[C];m[r+1]=y[C+1];m[r+
2]=y[C+2];m[r+3]=F<q?p[F]:255}}if(2==t)for(x=0;x<e;x++)for(v=x*n,A=x*c,d=0;d<c;d++)r=A+d<<2,F=u[v+(d>>2)]>>6-((d&3)<<1)&3,C=3*F,m[r]=y[C],m[r+1]=y[C+1],m[r+2]=y[C+2],m[r+3]=F<q?p[F]:255;if(4==t)for(x=0;x<e;x++)for(v=x*n,A=x*c,d=0;d<c;d++)r=A+d<<2,F=u[v+(d>>1)]>>4-((d&1)<<2)&15,C=3*F,m[r]=y[C],m[r+1]=y[C+1],m[r+2]=y[C+2],m[r+3]=F<q?p[F]:255;if(8==t)for(d=0;d<g;d++)r=d<<2,F=u[d],C=3*F,m[r]=y[C],m[r+1]=y[C+1],m[r+2]=y[C+2],m[r+3]=F<q?p[F]:255}else if(4==p){if(8==t)for(d=0;d<g;d++)r=d<<2,c=d<<1,e=u[c],
m[r]=e,m[r+1]=e,m[r+2]=e,m[r+3]=u[c+1];if(16==t)for(d=0;d<g;d++)r=d<<2,c=d<<2,e=u[c],m[r]=e,m[r+1]=e,m[r+2]=e,m[r+3]=u[c+2]}else if(0==p){c=d.tabs.tRNS?d.tabs.tRNS:-1;if(1==t)for(d=0;d<g;d++)e=255*(u[d>>3]>>7-(d&7)&1),n=e==255*c?0:255,r[d]=n<<24|e<<16|e<<8|e;if(2==t)for(d=0;d<g;d++)e=85*(u[d>>2]>>6-((d&3)<<1)&3),n=e==85*c?0:255,r[d]=n<<24|e<<16|e<<8|e;if(4==t)for(d=0;d<g;d++)e=17*(u[d>>1]>>4-((d&1)<<2)&15),n=e==17*c?0:255,r[d]=n<<24|e<<16|e<<8|e;if(8==t)for(d=0;d<g;d++)e=u[d],n=e==c?0:255,r[d]=n<<
24|e<<16|e<<8|e;if(16==t)for(d=0;d<g;d++)e=u[d<<1],n=y(u,d<<1)==c?0:255,r[d]=n<<24|e<<16|e<<8|e}else b("unsupported color type",p);return m};a.encode=function(b,d,c,g){null==g&&(g=0);var e=new Uint8Array(b);b=new Uint8Array(e.length+100);for(var f=[137,80,78,71,13,10,26,10],k=0;8>k;k++)b[k]=f[k];var f=8,l=a._bin,p=a.crc.crc;g=a.encode.compress(e,d,c,g);l.writeUint(b,f,13);f+=4;l.writeASCII(b,f,"IHDR");f+=4;l.writeUint(b,f,d);f+=4;l.writeUint(b,f,c);f+=4;b[f]=g.depth;f++;b[f]=g.ctype;f++;b[f]=0;f++;
b[f]=0;f++;b[f]=0;f++;l.writeUint(b,f,p(b,f-17,17));f+=4;l.writeUint(b,f,1);f+=4;l.writeASCII(b,f,"sRGB");f+=4;b[f]=1;f++;l.writeUint(b,f,p(b,f-5,5));f+=4;if(3==g.ctype){d=g.plte.length;l.writeUint(b,f,3*d);f+=4;l.writeASCII(b,f,"PLTE");f+=4;for(k=0;k<d;k++){c=3*k;var e=g.plte[k],t=e>>8&255,y=e>>16&255;b[f+c+0]=e&255;b[f+c+1]=t;b[f+c+2]=y}f+=3*d;l.writeUint(b,f,p(b,f-3*d-4,3*d+4));f+=4;if(g.gotAlpha){l.writeUint(b,f,d);f+=4;l.writeASCII(b,f,"tRNS");f+=4;for(k=0;k<d;k++)b[f+k]=g.plte[k]>>24&255;f+=
d;l.writeUint(b,f,p(b,f-d-4,d+4));f+=4}}d=g.data.length;l.writeUint(b,f,d);f+=4;l.writeASCII(b,f,"IDAT");f+=4;for(k=0;k<d;k++)b[f+k]=g.data[k];f+=d;l.writeUint(b,f,p(b,f-d-4,d+4));f+=4;l.writeUint(b,f,0);f+=4;l.writeASCII(b,f,"IEND");f+=4;l.writeUint(b,f,p(b,f-4,4));return b.buffer.slice(0,f+4)};a.encode.compress=function(b,d,c,g){0!=g&&(b=a.quantize(b,d,c,g));var e=6;g=8;for(var f=[],k=4,l=4*d,p=new Uint32Array(b.buffer),t=!1,y=[],q=0;q<b.length;q+=4){var x=p[q>>2];600>f.length&&null==y[x]&&(y[x]=
f.length,f.push(x));255!=b[q+3]&&(t=!0)}q=f.length;if(256>=q){g=2>=q?1:4>=q?2:16>=q?4:8;l=Math.ceil(g*d/8);e=new Uint8Array(l*c);for(b=0;b<c;b++){q=b*l;k=b*d;if(1==g)for(x=0;x<d;x++)e[q+(x>>3)]|=y[p[k+x]]<<7-(x&7);if(2==g)for(x=0;x<d;x++)e[q+(x>>2)]|=y[p[k+x]]<<6-2*(x&3);if(4==g)for(x=0;x<d;x++)e[q+(x>>1)]|=y[p[k+x]]<<4-4*(x&1);if(8==g)for(x=0;x<d;x++)e[q+x]=y[p[k+x]]}b=e;e=3;k=1}else if(0==t){e=new Uint8Array(d*c*3);l=d*c;for(q=0;q<l;q++)p=3*q,y=4*q,e[p]=b[y],e[p+1]=b[y+1],e[p+2]=b[y+2];b=e;e=2;
k=3;l=3*d}d=new Uint8Array(d*c*k+c);return{ctype:e,depth:g,plte:f,gotAlpha:t,data:a.encode._filterZero(b,c,k,l,d)}};a.encode._filterZero=function(b,d,g,l,m){for(var e=[],f=0;5>f;f++)if(!(5E5<d*l)||2!=f&&3!=f&&4!=f){for(var k=0;k<d;k++)a.encode._filterLine(m,b,k,l,g,f);e.push(c.deflate(m));if(1==g)break}var p;b=1E9;for(d=0;d<e.length;d++)e[d].length<b&&(p=d,b=e[d].length);return e[p]};a.encode._filterLine=function(b,d,c,g,m,n){var e=c*g,f=e+c,k=a.decode._paeth;b[f]=n;f++;if(0==n)for(c=0;c<g;c++)b[f+
c]=d[e+c];else if(1==n){for(c=0;c<m;c++)b[f+c]=d[e+c];for(c=m;c<g;c++)b[f+c]=d[e+c]-d[e+c-m]+256&255}else if(0==c){for(c=0;c<m;c++)b[f+c]=d[e+c];if(2==n)for(c=m;c<g;c++)b[f+c]=d[e+c];if(3==n)for(c=m;c<g;c++)b[f+c]=d[e+c]-(d[e+c-m]>>1)+256&255;if(4==n)for(c=m;c<g;c++)b[f+c]=d[e+c]-k(d[e+c-m],0,0)+256&255}else{if(2==n)for(c=0;c<g;c++)b[f+c]=d[e+c]+256-d[e+c-g]&255;if(3==n){for(c=0;c<m;c++)b[f+c]=d[e+c]+256-(d[e+c-g]>>1)&255;for(c=m;c<g;c++)b[f+c]=d[e+c]+256-(d[e+c-g]+d[e+c-m]>>1)&255}if(4==n){for(c=
0;c<m;c++)b[f+c]=d[e+c]+256-k(0,d[e+c-g],0)&255;for(c=m;c<g;c++)b[f+c]=d[e+c]+256-k(d[e+c-m],d[e+c-g],d[e+c-m-g])&255}}};a.crc={table:function(){for(var a=new Uint32Array(256),b=0;256>b;b++){for(var d=b,c=0;8>c;c++)d=d&1?3988292384^d>>>1:d>>>1;a[b]=d}return a}(),update:function(b,d,c,g){for(var e=0;e<g;e++)b=a.crc.table[(b^d[c+e])&255]^b>>>8;return b},crc:function(b,d,c){return a.crc.update(4294967295,b,d,c)^4294967295}};a.quantize=function(b,d,c,g){var e=new Uint8Array(b.length),f=new Uint16Array(d*
c);d*=c;var k=a.quantize.dist;for(c=0;c<d;c++){var l=c<<2,p=b[l+3]/255;e[l+0]=b[l+0]*p;e[l+1]=b[l+1]*p;e[l+2]=b[l+2]*p;e[l+3]=b[l+3]}for(var t=[],y=[],q=0,x=Math.max(100,10*g);;){var y=[],t=[],v=255-((1<<q)-1),A=1<<q>>1;for(c=0;c<d;c++){var l=c<<2,F=e[l],C=e[l+1],z=e[l+2],p=e[l+3],l=(F&v)+A,C=(C&v)+A,z=(z&v)+A,p=(p&v)+A,F=p<<24|z<<16|C<<8|l;y[F]?t[y[F]].occ++:(y[F]=t.length,t.push({occ:1,r:l,g:C,b:z,a:p}));if(t.length>x)break}if(t.length>x)q++;else break}if(0==q&&t.length<=g)return b;t.sort(function(a,
b){return b.occ-a.occ});g=Math.min(g,t.length);p=new Uint8Array(4*g);for(c=0;c<g;c++)l=c<<2,z=t[c],p[l]=z.r,p[l+1]=z.g,p[l+2]=z.b,p[l+3]=z.a;t=p;b=Math.max(1,Math.min(10,Math.floor(1024/g)));for(y=0;y<b;y++){q=new Uint32Array(g);x=new Uint32Array(4*g);v=new Uint32Array(g);A=new Uint32Array(g);for(c=0;c<g;c++){for(var l=c<<2,F=t[l],C=t[l+1],z=t[l+2],p=t[l+3],G=0,B=1E9,l=0;l<g;l++)if(l!=c){var D=k(F,C,z,p,t,l<<2);D<B&&(G=l,B=D)}v[c]=B;A[c]=G}for(c=0;c<d;c++){var l=c<<2,F=e[l],C=e[l+1],z=e[l+2],p=e[l+
3],G=0,B=1E9,G=f[c],B=k(F,C,z,p,t,G<<2);if(!(B<=v[G]>>1))for(l=0;l<g;l++)if(D=k(F,C,z,p,t,l<<2),D<B){G=l;B=D;if(D<=v[G]>>1)break;D=k(F,C,z,p,t,A[l]<<2);if(D<=v[G]>>1){G=A[l];break}}f[c]=G;q[G]++;G<<=2;x[G]+=F;x[G+1]+=C;x[G+2]+=z;x[G+3]+=p}for(c=0;c<g;c++)l=c<<2,p=1/q[c],t[l]=x[l]*p,t[l+1]=x[l+1]*p,t[l+2]=x[l+2]*p,t[l+3]=x[l+3]*p}for(c=0;c<d;c++)l=c<<2,G=f[c],G<<=2,g=0==t[G+3]?0:255/t[G+3],e[l+0]=t[G+0]*g,e[l+1]=t[G+1]*g,e[l+2]=t[G+2]*g,e[l+3]=t[G+3];return e};a.quantize.dist=function(a,b,d,c,g,n){var e=
g[n],f=g[n+1],k=g[n+2];g=g[n+3];return(e-a)*(e-a)+(f-b)*(f-b)+(k-d)*(k-d)+(g-c)*(g-c)};a.quantize.dither=function(b,d,c,g,m,n){for(var e=new Float32Array(d*c*4),f=a.quantize.dist,k=Math.round,l=d<<2,q=0;q<c;q++)for(var w=0;w<d;w++){for(var x=q*d+w,v=x<<2,A=0;4>A;A++)e[v+A]=Math.max(-8,Math.min(8,e[v+A]));for(var F=k(b[v]+e[v]),C=k(b[v+1]+e[v+1]),z=k(b[v+2]+e[v+2]),G=k(b[v+3]+e[v+3]),B=0,D=1E9,A=0;A<n;A++){var H=f(F,C,z,G,m,A<<2);H<D&&(B=A,D=H)}g[x]=B;x=B<<2;F-=m[x];C-=m[x+1];z-=m[x+2];G-=m[x+3];e[v+
4+0]+=.4375*F;e[v+4+1]+=.4375*C;e[v+4+2]+=.4375*z;e[v+4+3]+=.4375*G;e[v+l-4+0]+=.1875*F;e[v+l-4+1]+=.1875*C;e[v+l-4+2]+=.1875*z;e[v+l-4+3]+=.1875*G;e[v+l+0]+=.3125*F;e[v+l+1]+=.3125*C;e[v+l+2]+=.3125*z;e[v+l+3]+=.3125*G;e[v+l+4+0]+=.0625*F;e[v+l+4+1]+=.0625*C;e[v+l+4+2]+=.0625*z;e[v+l+4+3]+=.0625*G}};a.decode=function(d){d=new Uint8Array(d);for(var c=8,e=a._bin,g=e.readUshort,m={tabs:{}},n=new Uint8Array(d.length),r=0;;){var u=e.readUint(d,c),c=c+4,p=e.readASCII(d,c,4),c=c+4;if("IHDR"==p)a.decode._IHDR(d,
c,m);else if("IDAT"==p){for(var t=0;t<u;t++)n[r+t]=d[c+t];r+=u}else if("pHYs"==p)m.tabs[p]=[e.readUint(d,c),e.readUint(d,c+4),d[c+8]];else if("cHRM"==p)for(m.tabs[p]=[],t=0;8>t;t++)m.tabs[p].push(e.readUint(d,c+4*t));else if("tEXt"==p){null==m.tabs[p]&&(m.tabs[p]={});var q=e.nextZero(d,c),t=e.readASCII(d,c,q-c),q=e.readASCII(d,q+1,c+u-q-1);m.tabs[p][t]=q}else if("iTXt"==p){null==m.tabs[p]&&(m.tabs[p]={});var w=c,q=e.nextZero(d,w),t=e.readASCII(d,w,q-w),w=q+1,w=w+2,q=e.nextZero(d,w);e.readASCII(d,
w,q-w);w=q+1;q=e.nextZero(d,w);e.readUTF8(d,w,q-w);w=q+1;q=e.readUTF8(d,w,u-(w-c));m.tabs[p][t]=q}else if("PLTE"==p)m.tabs[p]=e.readBytes(d,c,u);else if("hIST"==p)for(q=m.tabs.PLTE.length/3,m.tabs[p]=[],t=0;t<q;t++)m.tabs[p].push(g(d,c+2*t));else if("tRNS"==p)3==m.ctype?m.tabs[p]=e.readBytes(d,c,u):0==m.ctype?m.tabs[p]=g(d,c):2==m.ctype?m.tabs[p]=[g(d,c),g(d,c+2),g(d,c+4)]:b("tRNS for unsupported color type",m.ctype,u);else if("gAMA"==p)m.tabs[p]=e.readUint(d,c)/1E5;else if("sRGB"==p)m.tabs[p]=d[c];
else if("bKGD"==p)0==m.ctype||4==m.ctype?m.tabs[p]=[g(d,c)]:2==m.ctype||6==m.ctype?m.tabs[p]=[g(d,c),g(d,c+2),g(d,c+4)]:3==m.ctype&&(m.tabs[p]=d[c]);else if("IEND"==p){0==m.compress?n=a.decode._inflate(n):b("unsupported compression method:",m.interlace);0!=m.filter&&b("unsupported filter method:",m.filter);0==m.interlace?m.data=a.decode._filterZero(n,m,0,m.width,m.height):1==m.interlace?m.data=a.decode._readInterlace(n,m):b("unsupported interlace method:",m.interlace);break}else b("unknown chunk type",
p,u);c+=u;e.readUint(d,c);c+=4}delete m.compress;delete m.interlace;delete m.filter;return m};a.decode._inflate=function(a){return c.inflate(a)};a.decode._readInterlace=function(b,d){for(var c=d.width,e=d.height,g=a.decode._getBPP(d),f=g>>3,r=Math.ceil(c*g/8),u=new Uint8Array(e*r),p=0,t=[0,0,4,0,2,0,1],q=[0,4,0,2,0,1,0],w=[8,8,8,4,4,2,2],x=[8,8,4,4,2,2,1],v=0;7>v;){for(var A=w[v],F=x[v],C=0,z=0,B=t[v];B<e;)B+=A,z++;for(B=q[v];B<c;)B+=F,C++;B=Math.ceil(C*g/8);a.decode._filterZero(b,d,p,C,z);for(var D=
0,M=t[v];M<e;){for(var H=q[v],J=p+D*B<<3;H<c;){if(1==g){var E=b[J>>3],E=E>>7-(J&7)&1;u[M*r+(H>>3)]|=E<<7-((H&3)<<0)}2==g&&(E=b[J>>3],E=E>>6-(J&7)&3,u[M*r+(H>>2)]|=E<<6-((H&3)<<1));4==g&&(E=b[J>>3],E=E>>4-(J&7)&15,u[M*r+(H>>1)]|=E<<4-((H&1)<<2));if(8<=g)for(var E=M*r+H*f,I=0;I<f;I++)u[E+I]=b[(J>>3)+I];J+=g;H+=F}D++;M+=A}0!=C*z&&(p+=z*(1+B));v+=1}return u};a.decode._getBPP=function(a){var d=[1,null,3,1,2,null,4][a.ctype];null==d&&b("unsupported color type",a.ctype);return d*a.depth};a.decode._filterZero=
function(b,d,c,g,m){d=a.decode._getBPP(d);g=Math.ceil(g*d/8);var e=a.decode._paeth;d=Math.ceil(d/8);for(var f=0;f<m;f++){var k=c+f*g,p=k+f+1,l=b[p-1];if(0==l)for(var q=0;q<g;q++)b[k+q]=b[p+q];else if(1==l){for(q=0;q<d;q++)b[k+q]=b[p+q];for(q=d;q<g;q++)b[k+q]=b[p+q]+b[k+q-d]&255}else if(0==f){for(q=0;q<d;q++)b[k+q]=b[p+q];if(2==l)for(q=d;q<g;q++)b[k+q]=b[p+q]&255;if(3==l)for(q=d;q<g;q++)b[k+q]=b[p+q]+(b[k+q-d]>>1)&255;if(4==l)for(q=d;q<g;q++)b[k+q]=b[p+q]+e(b[k+q-d],0,0)&255}else{if(2==l)for(q=0;q<
g;q++)b[k+q]=b[p+q]+b[k+q-g]&255;if(3==l){for(q=0;q<d;q++)b[k+q]=b[p+q]+(b[k+q-g]>>1)&255;for(q=d;q<g;q++)b[k+q]=b[p+q]+(b[k+q-g]+b[k+q-d]>>1)&255}if(4==l){for(q=0;q<d;q++)b[k+q]=b[p+q]+e(0,b[k+q-g],0)&255;for(q=d;q<g;q++)b[k+q]=b[p+q]+e(b[k+q-d],b[k+q-g],b[k+q-d-g])&255}}}return b};a.decode._paeth=function(a,b,d){var c=a+b-d,e=Math.abs(c-a),g=Math.abs(c-b),c=Math.abs(c-d);return e<=g&&e<=c?a:g<=c?b:d};a.decode._IHDR=function(b,d,c){var e=a._bin;c.width=e.readUint(b,d);d+=4;c.height=e.readUint(b,
d);d+=4;c.depth=b[d];d++;c.ctype=b[d];d++;c.compress=b[d];d++;c.filter=b[d];d++;c.interlace=b[d]};a._bin={nextZero:function(a,b){for(;0!=a[b];)b++;return b},readUshort:function(a,b){return a[b]<<8|a[b+1]},writeUshort:function(a,b,d){a[b]=d>>8&255;a[b+1]=d&255},readUint:function(a,b){return 16777216*a[b]+(a[b+1]<<16|a[b+2]<<8|a[b+3])},writeUint:function(a,b,d){a[b]=d>>24&255;a[b+1]=d>>16&255;a[b+2]=d>>8&255;a[b+3]=d&255},readASCII:function(a,b,d){for(var c="",e=0;e<d;e++)c+=String.fromCharCode(a[b+
e]);return c},writeASCII:function(a,b,d){for(var c=0;c<d.length;c++)a[b+c]=d.charCodeAt(c)},readBytes:function(a,b,d){for(var c=[],e=0;e<d;e++)c.push(a[b+e]);return c},pad:function(a){return 2>a.length?"0"+a:a},readUTF8:function(b,d,c){for(var e="",g,f=0;f<c;f++)e+="%"+a._bin.pad(b[d+f].toString(16));try{g=decodeURIComponent(e)}catch(r){return a._bin.readASCII(b,d,c)}return g}}})(a,"function"==typeof db?Ca:window.pako)})()}),nh=function(c){function b(){I(this,b);var a=P(this,(b.__proto__||Object.getPrototypeOf(b)).call(this));
a.setMetadata("targetType",Q.name);a.addInputValidator(0,ArrayBuffer);return a}L(b,c);N(b,[{key:"_run",value:function(){var a=this._getInput(0);if(a)if(this._isPng(a))try{var b=Dj.decode(a),c=Math.round(b.data.length/(b.width*b.height)),e=new Q,f=new b.data.constructor(b.data.buffer,0,b.width*b.height*c);e.setData(f,b.width,b.height,c);this._output[0]=e}catch(k){console.warn(k)}else console.warn("This is not a PNG file, unable to decode this file.");else console.warn('PngDecoder requires an ArrayBuffer as input "0". Unable to continue.')}},
{key:"_isPng",value:function(a){a=new Uint8Array(a,0,8);for(var b=new Uint8Array([137,80,78,71,13,10,26,10]),c=0;c<a.length;c++)if(a[c]!=b[c])return!1;return!0}}]);return b}(ra),oh=function(c){function b(){I(this,b);var a=P(this,(b.__proto__||Object.getPrototypeOf(b)).call(this));a.setMetadata("enablePixBin",!0);a._decoders=[lh,mh,nh];return a}L(b,c);return b}(bc),Ej=function(){function c(b,a){for(var d=0;d<a.length;d++){var c=a[d];c.enumerable=c.enumerable||!1;c.configurable=!0;"value"in c&&(c.writable=
!0);Object.defineProperty(b,c.key,c)}}return function(b,a,d){a&&c(b.prototype,a);d&&c(b,d);return b}}(),Fj=function(){function c(){if(!(this instanceof c))throw new TypeError("Cannot call a class as a function");this._shapeData=this._tempResult=this._stackIndex=this._stack=null}Ej(c,[{key:"copy",value:function(b){this._stack=b._stack;this._stackIndex=b._stackIndex;this._tempResult=b._tempResult;this._shapeData=b._shapeData}},{key:"parse",value:function(b){try{this._parseRawData(b),this._arrangeData()}catch(a){console.warn("MNI OBJ file is invalid."),
console.warn(a)}}},{key:"_parseRawData",value:function(b){this._stack=b.trim().split(/\s+/).reverse();this._stackIndex=this._stack.length-1;this._tempResult={};b=this._popStack();var a,d,c,e,f,k;this._tempResult.type="P"===b?"polygon":"L"===b?"line":b;if("polygon"===this._tempResult.type)this._parseSurfProp(),this._tempResult.numVertices=parseInt(this._popStack(),10),this._parseVertices(),this._parseNormals(),this._tempResult.nitems=parseInt(this._popStack(),10);else if("line"===this._tempResult.type)this._parseSurfProp(),
this._tempResult.numVertices=parseInt(this._popStack(),10),this._parseVertices(),this._tempResult.nitems=parseInt(this._popStack(),10);else{this._tempResult.error=!0;this._tempResult.errorMessage='Invalid MNI Object class: must be "polygon" or "line"';return}this._parseColors();this._parseEndIndices();this._parseIndices();if("polygon"!==this._tempResult.type&&"line"===this._tempResult.type){c=this._tempResult.indices;e=this._tempResult.endIndices;d=this._tempResult.nitems;for(var l=f=k=0;l<d;l++)a=
0===l?0:e[l-1],b=e[l],f+=2*(b-a-1);f=new Uint32Array(f);for(l=0;l<d;l++){a=0===l?0:e[l-1];f[k++]=c[a];b=e[l];for(a+=1;a<b-1;a++)f[k++]=c[a],f[k++]=c[a];f[k++]=c[b-1]}this._tempResult.indices=f}}},{key:"_arrangeData",value:function(){this._shapeData={type:this._tempResult.type,vertices:this._tempResult.vertices,normals:this._tempResult.normals,colors:this._tempResult.colors,surfaceProperties:this._tempResult.surfaceProperties,error:this._tempResult.error,errorMessage:this._tempResult.errorMessage};
var b=[this._shapeData.vertices.buffer,this._shapeData.colors.buffer];this._shapeData.normals&&b.push(this._shapeData.normals.buffer);this._shapeData.shapes=this._tempResult.indices;b.push(this._tempResult.indices.buffer);4===this._shapeData.colors.length&&this._unrollColors()}},{key:"_unrollColors",value:function(){var b,a,d,c,e=this._shapeData.vertices.length/3*4,f=new Uint8Array(e);b=this._shapeData.colors[0];a=this._shapeData.colors[1];d=this._shapeData.colors[2];c=this._shapeData.colors[3];for(var k=
0;k<e;k+=4)f[k]=255*b,f[k+1]=255*a,f[k+2]=255*d,f[k+3]=255*c;this._shapeData.colors=f}},{key:"_parseSurfProp",value:function(){"polygon"===this._tempResult.type?this._tempResult.surfaceProperties={ambient:parseFloat(this._popStack()),diffuse:parseFloat(this._popStack()),specularReflectance:parseFloat(this._popStack()),specularScattering:parseFloat(this._popStack()),transparency:parseFloat(this._popStack())}:"line"===this._tempResult.type&&(this._tempResult.surfaceProperties={width:this._popStack()})}},
{key:"_parseVertices",value:function(){for(var b=3*this._tempResult.numVertices,a=new Float32Array(b),d=0;d<b;d++)a[d]=parseFloat(this._popStack());this._tempResult.vertices=a}},{key:"_parseNormals",value:function(){for(var b=3*this._tempResult.numVertices,a=new Float32Array(b),d=0;d<b;d++)a[d]=parseFloat(this._popStack());this._tempResult.normals=a}},{key:"_parseColors",value:function(){var b=parseInt(this._popStack(),10),a,d;if(0===b){a=new Float32Array(4);for(var c=0;4>c;c++)a[c]=parseFloat(this._popStack())}else if(1===
b)for(d=4*this._tempResult.num_polygons,a=new Float32Array(d),c=0;c<d;c++)a[c]=parseFloat(this._popStack());else if(2===b)for(d=4*this._tempResult.numVertices,a=new Float32Array(d),c=0;c<d;c++)a[c]=parseFloat(this._popStack());else this._tempResult.error=!0,this._tempResult.errorMessage="Invalid color flag: "+b;this._tempResult.colorFlag=b;this._tempResult.colors=a}},{key:"_parseEndIndices",value:function(){for(var b=this._tempResult.nitems,a=new Uint32Array(b),d=0;d<b;d++)a[d]=parseInt(this._popStack(),
10);this._tempResult.endIndices=a}},{key:"_parseIndices",value:function(){for(var b=this._stackIndex+1,a=new Uint32Array(b),d=0;d<b;d++)a[d]=parseInt(this._popStack(),10);this._tempResult.indices=a}},{key:"_popStack",value:function(){return this._stack[this._stackIndex--]}},{key:"isValid",value:function(){return!this._shapeData.error}},{key:"getErrorMessage",value:function(){return this._shapeData.errorMessage}},{key:"getShapeData",value:function(){return this._shapeData}},{key:"getShapeRawIndices",
value:function(){return this._shapeData.error?(console.warn("ERROR while parsing: "+this._shapeData.errorMessage),null):this._shapeData.shapes}},{key:"getRawVertices",value:function(){return this._shapeData.error?(console.warn("ERROR while parsing: "+this._shapeData.errorMessage),null):this._shapeData.vertices}},{key:"getRawNormals",value:function(){return this._shapeData.error?(console.warn("ERROR while parsing: "+this._shapeData.errorMessage),null):this._shapeData.normals}},{key:"getRawColors",
value:function(){return this._shapeData.error?(console.warn("ERROR while parsing: "+this._shapeData.errorMessage),null):this._shapeData.colors}},{key:"getSurfaceProperties",value:function(){return this._shapeData.error?(console.warn("ERROR while parsing: "+this._shapeData.errorMessage),null):this._shapeData.surfaceProperties}},{key:"getType",value:function(){return this._shapeData.type}},{key:"isPolygon",value:function(){return"polygon"===this._shapeData.type}},{key:"isLine",value:function(){return"line"===
this._shapeData.type}}]);return c}(),ph=function(c){function b(){I(this,b);var a=P(this,(b.__proto__||Object.getPrototypeOf(b)).call(this));a.setMetadata("targetType",Cc.name);return a}L(b,c);N(b,null,[{key:"isBinary",value:function(){return!1}}]);N(b,[{key:"_run",value:function(){var a=this._getInput();if(a){var b=new Fj;b.parse(a);if(b.isValid())if(b.isPolygon()){var a=b.getRawVertices(),c=b.getShapeRawIndices(),e=b.getRawNormals(),f=b.getRawColors();b.getSurfaceProperties();b=new Cc;b.setVertexPositions(a);
b.setPolygonFacesOrder(c);b.setPolygonFacesNormals(e);b.setVertexColors(f);b.setNumberOfVerticesPerShapes(3);b.setNumberOfComponentsPerColor(4);this._output[0]=b}else console.warn("The MNI OBJ file is valid but does not describe a 3D mesh.");else console.warn("Invalid MNI OBJ file.\nERROR: "+b.getErrorMessage())}else console.warn("Invalid input for MniObjDecoder")}}]);return b}(ra),md=function(c,b){return b={exports:{}},c(b,b.exports),b.exports}(function(c){function b(a){this.value=a}function a(a,
b,c){var e=[],g=[],n=!0;return function x(a){function p(){if("object"===O(v.node)&&null!==v.node){v.keys&&v.node_===v.node||(v.keys=f(v.node));v.isLeaf=0==v.keys.length;for(var b=0;b<g.length;b++)if(g[b].node_===a){v.circular=g[b];break}}else v.isLeaf=!0,v.keys=null;v.notLeaf=!v.isLeaf;v.notRoot=!v.isRoot}var t,r,u,q,y=!0,v={node:c?d(a):a,node_:a,path:[].concat(e),parent:g[g.length-1],parents:g,key:e.slice(-1)[0],isRoot:0===e.length,level:e.length,circular:null,update:function(a,b){v.isRoot||(v.parent.node[v.key]=
a);v.node=a;b&&(y=!1)},"delete":function(a){delete v.parent.node[v.key];a&&(y=!1)},remove:function(a){k(v.parent.node)?v.parent.node.splice(v.key,1):delete v.parent.node[v.key];a&&(y=!1)},keys:null,before:function(a){t=a},after:function(a){r=a},pre:function(a){u=a},post:function(a){q=a},stop:function(){n=!1},block:function(){y=!1}};if(!n)return v;p();var z=b.call(v,v.node);void 0!==z&&v.update&&v.update(z);t&&t.call(v,v.node);if(!y)return v;"object"!=O(v.node)||null===v.node||v.circular||(g.push(v),
p(),l(v.keys,function(a,b){e.push(a);u&&u.call(v,v.node[a],a);var d=x(v.node[a]);c&&m.call(v.node,a)&&(v.node[a]=d.node);d.isLast=b==v.keys.length-1;d.isFirst=0==b;q&&q.call(v,d);e.pop()}),g.pop());r&&r.call(v,v.node);return v}(a).node}function d(a){if("object"===("undefined"===typeof a?"undefined":O(a))&&null!==a){var b;if(k(a))b=[];else if("[object Date]"===g(a))b=new Date(a.getTime?a.getTime():a);else if("[object RegExp]"===g(a))b=new RegExp(a);else if("[object Error]"===g(a))b={message:a.message};
else if("[object Boolean]"===g(a))b=new Boolean(a);else if("[object Number]"===g(a))b=new Number(a);else if("[object String]"===g(a))b=new String(a);else if(Object.create&&Object.getPrototypeOf)b=Object.create(Object.getPrototypeOf(a));else if(a.constructor===Object)b={};else{var d=function(){};d.prototype=a.constructor&&a.constructor.prototype||a.__proto__||{};b=new d}l(f(a),function(d){b[d]=a[d]});return b}return a}function g(a){return Object.prototype.toString.call(a)}var e=c.exports=function(a){return new b(a)};
b.prototype.get=function(a){for(var b=this.value,d=0;d<a.length;d++){var c=a[d];if(!b||!m.call(b,c)){b=void 0;break}b=b[c]}return b};b.prototype.has=function(a){for(var b=this.value,d=0;d<a.length;d++){var c=a[d];if(!b||!m.call(b,c))return!1;b=b[c]}return!0};b.prototype.set=function(a,b){for(var d=this.value,c=0;c<a.length-1;c++){var e=a[c];m.call(d,e)||(d[e]={});d=d[e]}return d[a[c]]=b};b.prototype.map=function(b){return a(this.value,b,!0)};b.prototype.forEach=function(b){return this.value=a(this.value,
b,!1)};b.prototype.reduce=function(a,b){var d=1===arguments.length,c=d?this.value:b;this.forEach(function(b){this.isRoot&&d||(c=a.call(this,c,b))});return c};b.prototype.paths=function(){var a=[];this.forEach(function(b){a.push(this.path)});return a};b.prototype.nodes=function(){var a=[];this.forEach(function(b){a.push(this.node)});return a};b.prototype.clone=function(){var a=[],b=[];return function p(c){for(var e=0;e<a.length;e++)if(a[e]===c)return b[e];if("object"===("undefined"===typeof c?"undefined":
O(c))&&null!==c){var g=d(c);a.push(c);b.push(g);l(f(c),function(a){g[a]=p(c[a])});a.pop();b.pop();return g}return c}(this.value)};var f=Object.keys||function(a){var b=[],d;for(d in a)b.push(d);return b},k=Array.isArray||function(a){return"[object Array]"===Object.prototype.toString.call(a)},l=function(a,b){if(a.forEach)return a.forEach(b);for(var d=0;d<a.length;d++)b(a[d],d,a)};l(f(b.prototype),function(a){e[a]=function(d){var c=[].slice.call(arguments,1),e=new b(d);return e[a].apply(e,c)}});var m=
Object.hasOwnProperty||function(a,b){return b in a}}),Gj=function(){function c(b,a){for(var d=0;d<a.length;d++){var c=a[d];c.enumerable=c.enumerable||!1;c.configurable=!0;"value"in c&&(c.writable=!0);Object.defineProperty(b,c.key,c)}}return function(b,a,d){a&&c(b.prototype,a);d&&c(b,d);return b}}(),Ja=function(){function c(){if(!(this instanceof c))throw new TypeError("Cannot call a class as a function");}Gj(c,null,[{key:"isPlatformLittleEndian",value:function(){var b=new Uint32Array([305419896]);
return 18!=(new Uint8Array(b.buffer,b.byteOffset,b.byteLength))[0]}},{key:"arrayBufferToUnicode",value:function(b){b=new Uint8Array(b);for(var a=[],d=0,c=0;d<b.length;){var e=b[d++];if(128>e)a[c++]=String.fromCharCode(e);else if(191<e&&224>e){var f=b[d++];a[c++]=String.fromCharCode((e&31)<<6|f&63)}else if(239<e&&365>e){var f=b[d++],k=b[d++],l=b[d++],e=((e&7)<<18|(f&63)<<12|(k&63)<<6|l&63)-65536;a[c++]=String.fromCharCode(55296+(e>>10));a[c++]=String.fromCharCode(56320+(e&1023))}else f=b[d++],k=b[d++],
a[c++]=String.fromCharCode((e&15)<<12|(f&63)<<6|k&63)}return a.join("")}},{key:"unicodeToArrayBuffer",value:function(b){for(var a=[],d=0,c=0;c<b.length;c++){var e=b.charCodeAt(c);128>e?a[d++]=e:(2048>e?a[d++]=e>>6|192:(55296==(e&64512)&&c+1<b.length&&56320==(b.charCodeAt(c+1)&64512)?(e=65536+((e&1023)<<10)+(b.charCodeAt(++c)&1023),a[d++]=e>>18|240,a[d++]=e>>12&63|128):a[d++]=e>>12|224,a[d++]=e>>6&63|128),a[d++]=e&63|128)}return(new Uint8Array(a)).buffer}},{key:"arrayBufferToString8",value:function(b){return String.fromCharCode.apply(null,
new Uint8Array(b))}},{key:"string8ToArrayBuffer",value:function(b){for(var a=new ArrayBuffer(b.length),d=new Uint8Array(a),c=0;c<b.length;c++)d[c]=b.charCodeAt(c);return a}},{key:"setString8InBuffer",value:function(b,a){var d=2<arguments.length&&void 0!==arguments[2]?arguments[2]:0;if(0>d)console.warn("The byte offset cannot be negative.");else if(a&&a instanceof ArrayBuffer)if(b.length+d>a.byteLength)console.warn("The string is too long to be writen in this buffer.");else for(var c=new Uint8Array(a),
e=0;e<b.length;e++)c[e+d]=b.charCodeAt(e);else console.warn("The buffer must be a valid ArrayBuffer.")}},{key:"getString8FromBuffer",value:function(b,a){var d=2<arguments.length&&void 0!==arguments[2]?arguments[2]:0;return 0>d?(console.warn("The byte offset cannot be negative."),null):b&&b instanceof ArrayBuffer?a+d>b.byteLength?(console.warn("The string is too long to be writen in this buffer."),null):String.fromCharCode.apply(null,new Uint8Array(b,d,a)):(console.warn("The buffer must be a valid ArrayBuffer."),
null)}},{key:"objectToArrayBuffer",value:function(b){var a=null;b=c.makeSerializeFriendly(b);try{var d=JSON.stringify(b),a=c.unicodeToArrayBuffer(d)}catch(g){console.warn(g)}return a}},{key:"ArrayBufferToObject",value:function(b){var a=null;try{var d=c.arrayBufferToUnicode(b),a=JSON.parse(d)}catch(g){console.warn(g)}return a}},{key:"isTypedArray",value:function(b){return b instanceof Int8Array||b instanceof Uint8Array||b instanceof Uint8ClampedArray||b instanceof Int16Array||b instanceof Uint16Array||
b instanceof Int32Array||b instanceof Uint32Array||b instanceof Float32Array||b instanceof Float64Array}},{key:"mergeBuffers",value:function(b){for(var a=0,d=0;d<b.length;d++)a+=b[d].byteLength;for(var a=new Uint8Array(a),c=0,d=0;d<b.length;d++)a.set(new Uint8Array(b[d]),c),c+=b[d].byteLength;return a.buffer}},{key:"getGlobalObject",value:function(){var b=null;try{b=window}catch(a){try{b=GLOBAL}catch(d){return console.warn("You are not in a Javascript environment?? Weird."),null}}return b}},{key:"extractTypedArray",
value:function(b,a,d,c){if(!b)return console.warn("Input Buffer is null."),null;if(!(b instanceof ArrayBuffer))return console.warn("Buffer must be of type ArrayBuffer"),null;if(0>=c)return console.warn("The number of elements to fetch must be greater than 0"),null;if(0>a)return console.warn("The byte offset must be possitive or 0"),null;if(a>=b.byteLength)return console.warn("The offset cannot be larger than the size of the buffer."),null;if(d instanceof Function&&!("BYTES_PER_ELEMENT"in d))return console.warn("ArrayType must be a typed array constructor function."),
null;if(d.BYTES_PER_ELEMENT*c+a>b.byteLength)console.warn("The requested number of elements is too large for this buffer");else return b=b.slice(a,a+c*d.BYTES_PER_ELEMENT),new d(b)}},{key:"getTypedArrayInfo",value:function(b){var a=null,d=!1;b instanceof Int8Array?(a="int",d=!1):b instanceof Uint8Array?(a="int",d=!0):b instanceof Uint8ClampedArray?(a="int",d=!0):b instanceof Int16Array?(a="int",d=!1):b instanceof Uint16Array?(a="int",d=!0):b instanceof Int32Array?(a="int",d=!1):b instanceof Uint32Array?
(a="int",d=!0):b instanceof Float32Array?(a="float",d=!1):b instanceof Float64Array&&(a="float",d=!1);return{type:a,signed:d,bytesPerElements:b.BYTES_PER_ELEMENT,byteLength:b.byteLength,length:b.length}}},{key:"howManyTypedArrayAttributes",value:function(b){var a=0;md(b).forEach(function(b){a+=c.isTypedArray(b)});return a}},{key:"hasCircularReference",value:function(b){var a=!1;md(b).forEach(function(b){this.circular&&(a=!0)});return a}},{key:"removeCircularReference",value:function(b){var a=!1;b=
md(b).map(function(b){this.circular&&(this.remove(),a=!0)});return a?b:null}},{key:"replaceTypedArrayAttributesByArrays",value:function(b){var a=!1;b=md(b).map(function(b){if(c.isTypedArray(b)){for(var d=Object.keys(b).length,e=Array(d),f=0;f<d;f++)e[f]=b[f];this.update(e);a=!0}});return a?b:null}},{key:"makeSerializeFriendly",value:function(b){var a=c.removeCircularReference(b);a&&(b=a);(a=c.replaceTypedArrayAttributesByArrays(b))&&(b=a);return b}}]);return c}(),qh=function(c,b){if(!(c instanceof
b))throw new TypeError("Cannot call a class as a function");},rh=function(){function c(b,a){for(var d=0;d<a.length;d++){var c=a[d];c.enumerable=c.enumerable||!1;c.configurable=!0;"value"in c&&(c.writable=!0);Object.defineProperty(b,c.key,c)}}return function(b,a,d){a&&c(b.prototype,a);d&&c(b,d);return b}}(),Hj=function(){function c(b,a,d){qh(this,c);this._header=b;this._physicalSignals=d;this._rawSignals=a}rh(c,[{key:"getRecordDuration",value:function(){return this._header.durationDataRecordsSec}},
{key:"getRecordingID",value:function(){return this._header.localRecordingId}},{key:"getNumberOfRecords",value:function(){return this._header.nbDataRecords}},{key:"getNumberOfSignals",value:function(){return this._header.nbSignals}},{key:"getPatientID",value:function(){return this._header.patientId}},{key:"getRecordingStartDate",value:function(){return this._header.recordingDate}},{key:"getReservedField",value:function(){var b=0<arguments.length&&void 0!==arguments[0]?arguments[0]:-1;return-1===b?
this._header.reserved:0<=b&&b<this._header.signalInfo.length?this._header.signalInfo[b].reserved:null}},{key:"getSignalDigitalMax",value:function(b){return 0>b||b>=this._header.signalInfo.length?(console.warn("Signal index is out of range"),null):this._header.signalInfo[b].digitalMaximum}},{key:"getSignalDigitalMin",value:function(b){return 0>b||b>=this._header.signalInfo.length?(console.warn("Signal index is out of range"),null):this._header.signalInfo[b].digitalMinimum}},{key:"getSignalPhysicalMin",
value:function(b){return 0>b||b>=this._header.signalInfo.length?(console.warn("Signal index is out of range"),null):this._header.signalInfo[b].physicalMinimum}},{key:"getSignalPhysicalMax",value:function(b){return 0>b||b>=this._header.signalInfo.length?(console.warn("Signal index is out of range"),null):this._header.signalInfo[b].physicalMaximum}},{key:"getSignalLabel",value:function(b){return 0>b||b>=this._header.signalInfo.length?(console.warn("Signal index is out of range"),null):this._header.signalInfo[b].label}},
{key:"getSignalNumberOfSamplesPerRecord",value:function(b){return 0>b||b>=this._header.signalInfo.length?(console.warn("Signal index is out of range"),null):this._header.signalInfo[b].nbOfSamples}},{key:"getSignalPhysicalUnit",value:function(b){return 0>b||b>=this._header.signalInfo.length?(console.warn("Signal index is out of range"),null):this._header.signalInfo[b].physicalDimension}},{key:"getSignalPrefiltering",value:function(b){return 0>b||b>=this._header.signalInfo.length?(console.warn("Signal index is out of range"),
null):this._header.signalInfo[b].prefiltering}},{key:"getSignalTransducerType",value:function(b){return 0>b||b>=this._header.signalInfo.length?(console.warn("Signal index is out of range"),null):this._header.signalInfo[b].transducerType}},{key:"getSignalSamplingFrequency",value:function(b){return 0>b||b>=this._header.signalInfo.length?(console.warn("Signal index is out of range"),null):this._header.signalInfo[b].nbOfSamples/this._header.durationDataRecordsSec}},{key:"getPhysicalSignal",value:function(b,
a){return 0>b||b>=this._header.signalInfo.length?(console.warn("Signal index is out of range"),null):0>a&&a>=this._physicalSignals[b].length?(console.warn("Record index is out of range"),null):this._physicalSignals[b][a]}},{key:"getRawSignal",value:function(b,a){return 0>b||b>=this._header.signalInfo.length?(console.warn("Signal index is out of range"),null):0>a&&a>=this._rawSignals[b].length?(console.warn("Record index is out of range"),null):this._rawSignals[b][a]}},{key:"getPhysicalSignalConcatRecords",
value:function(b){var a=1<arguments.length&&void 0!==arguments[1]?arguments[1]:-1,d=2<arguments.length&&void 0!==arguments[2]?arguments[2]:-1;if(0>b||b>=this._header.signalInfo.length)return console.warn("Signal index is out of range"),null;if(0>a&&a>=this._physicalSignals[b].length)return console.warn("The index recordStart is out of range"),null;-1===a&&(a=0);-1===d?d=this._physicalSignals[b].length-a:a+d>this._physicalSignals[b].length&&(console.warn("The number of requested records is too large. Forcing only to available records."),
d=this._physicalSignals[b].length-a);var c=a+d-1;if(0>c&&c>=this._physicalSignals[b].length)return console.warn("Too many records to concatenate, this goes out of range."),null;for(var e=0,c=a;c<a+d;c++)e+=this._physicalSignals[b][c].length;for(var e=new Float32Array(e),f=0,c=a;c<a+d;c++)e.set(this._physicalSignals[b][c],f),f+=this._physicalSignals[b][c].length;return e}}]);return c}(),Ij=function(){function c(){qh(this,c);this._output=this._inputBuffer=null}rh(c,[{key:"setInput",value:function(b){this._output=
null;this._inputBuffer=b}},{key:"decode",value:function(){try{var b=this._decodeHeader();this._decodeData(b.offset,b.header)}catch(a){console.warn(a)}}},{key:"_decodeHeader",value:function(){function b(b){for(var c=[],e=0;e<a.nbSignals;e++)c.push(Ja.getString8FromBuffer(f._inputBuffer,b,d).trim()),d+=b;return c}if(this._inputBuffer){var a={},d=0;a.dataFormat=Ja.getString8FromBuffer(this._inputBuffer,8,d).trim();d+=8;a.patientId=Ja.getString8FromBuffer(this._inputBuffer,80,d).trim();d+=80;a.localRecordingId=
Ja.getString8FromBuffer(this._inputBuffer,80,d).trim();var d=d+80,c=Ja.getString8FromBuffer(this._inputBuffer,8,d).trim(),d=d+8,e=Ja.getString8FromBuffer(this._inputBuffer,8,d).trim(),d=d+8,c=c.split("."),e=e.split(".");a.recordingDate=new Date(c[2],c[1],c[0],e[0],e[1],e[2],0);a.nbBytesHeaderRecord=parseInt(Ja.getString8FromBuffer(this._inputBuffer,8,d).trim());d+=8;a.reserved=Ja.getString8FromBuffer(this._inputBuffer,44,d);d+=44;a.nbDataRecords=parseInt(Ja.getString8FromBuffer(this._inputBuffer,
8,d).trim());d+=8;a.durationDataRecordsSec=parseInt(Ja.getString8FromBuffer(this._inputBuffer,8,d).trim());d+=8;a.nbSignals=parseInt(Ja.getString8FromBuffer(this._inputBuffer,4,d).trim());var d=d+4,f=this,e=b(16),c=b(80),k=b(8),l=b(8),m=b(8),n=b(8),r=b(8),u=b(80),p=b(8),t=b(32),q=[];a.signalInfo=q;for(var w=0;w<a.nbSignals;w++)q.push({label:e[w],transducerType:c[w],physicalDimension:k[w],physicalMinimum:parseFloat(l[w]),physicalMaximum:parseFloat(m[w]),digitalMinimum:parseInt(n[w]),digitalMaximum:parseInt(r[w]),
prefiltering:u[w],nbOfSamples:parseInt(p[w]),reserved:t[w]});return{offset:d,header:a}}console.warn("A input buffer must be specified.")}},{key:"_decodeData",value:function(b,a){if(this._inputBuffer)if(a){for(var d=Int16Array,c=Array(a.nbSignals),e=Array(a.nbSignals),f=0;f<a.nbSignals;f++)c[f]=Array(a.nbDataRecords),e[f]=Array(a.nbDataRecords);for(var k=0;k<a.nbDataRecords;k++)for(f=0;f<a.nbSignals;f++){var l=a.signalInfo[f].nbOfSamples,m=Ja.extractTypedArray(this._inputBuffer,b,d,l);b+=l*d.BYTES_PER_ELEMENT;
c[f][k]=m;for(var n=(new Float32Array(m.length)).fill(0),r=a.signalInfo[f].digitalMaximum-a.signalInfo[f].digitalMinimum,u=a.signalInfo[f].physicalMaximum-a.signalInfo[f].physicalMinimum,p=0;p<l;p++)n[p]=(m[p]-a.signalInfo[f].digitalMinimum)/r*u+a.signalInfo[f].physicalMinimum;e[f][k]=n}this._output=new Hj(a,c,e)}else console.warn("Invalid header");else console.warn("A input buffer must be specified.")}},{key:"getOutput",value:function(){return this._output}}]);return c}(),sh=function(c){function b(){I(this,
b);var a=P(this,(b.__proto__||Object.getPrototypeOf(b)).call(this));a.setMetadata("targetType",ua.name);a.addInputValidator(0,ArrayBuffer);a.setMetadata("debug",!1);a.setMetadata("concatenateRecords",!0);return a}L(b,c);N(b,[{key:"_run",value:function(){var a=this._getInput(0);if(a){var b=new Ij;b.setInput(a);b.decode();if(a=b.getOutput())for(var b=a.getNumberOfSignals(),c=a.getNumberOfRecords(),e=0;e<b;e++){var f=new ua;f.setData(a.getPhysicalSignalConcatRecords(e));f.setMetadata("numberOfRecords",
c);f.setMetadata("patientID",a.getPatientID());f.setMetadata("recordDuration",a.getRecordDuration());f.setMetadata("recordingID",a.getRecordingID());f.setMetadata("recordingStartDate",a.getRecordingStartDate());f.setMetadata("reservedField",a.getReservedField());f.setMetadata("signalLabel",a.getSignalLabel(e));f.setMetadata("numberOfSamplesPerRecord",a.getSignalNumberOfSamplesPerRecord(e));f.setMetadata("signalPhysicalMax",a.getSignalPhysicalMax(e));f.setMetadata("signalPhysicalMin",a.getSignalPhysicalMin(e));
f.setMetadata("signalPhysicalUnit",a.getSignalPhysicalUnit(e));f.setMetadata("signalPrefiltering",a.getSignalPrefiltering(e));f.setMetadata("signalTransducerType",a.getSignalTransducerType(e));f.setMetadata("samplingFrequency",a.getSignalSamplingFrequency(e));this._output[e]=f}else console.warn("Invalid EDF file.")}else console.warn('EdfDecoder requires an ArrayBuffer as input "0". Unable to continue.')}}]);return b}(ra),th=function(c){function b(){I(this,b);var a=P(this,(b.__proto__||Object.getPrototypeOf(b)).call(this));
a.setMetadata("enablePixBin",!0);a._decoders=[ph];return a}L(b,c);return b}(bc),uh=function(c){function b(){I(this,b);var a=P(this,(b.__proto__||Object.getPrototypeOf(b)).call(this));a.setMetadata("enablePixBin",!0);a._decoders=[sh];return a}L(b,c);return b}(bc),Jj=function(c){function b(){I(this,b);var a=P(this,(b.__proto__||Object.getPrototypeOf(b)).call(this));a._decoders=[uh,oh,ch,th];return a}L(b,c);return b}(bc),ti=function(c){for(var b=Array(c),a=0;a<c;++a)b[a]=a;return b},vi="undefined"!==
typeof Float64Array,cd={float32:[],float64:[],int8:[],int16:[],int32:[],uint8:[],uint16:[],uint32:[],array:[],uint8_clamped:[],buffer:[],generic:[]},Ka=function(c,b,a,d){if(void 0===c){var g=cd.array[0];return g([])}"number"===typeof c&&(c=[c]);void 0===b&&(b=[c.length]);g=b.length;if(void 0===a){a=Array(g);for(var e=g-1,f=1;0<=e;--e)a[e]=f,f*=b[e]}if(void 0===d)for(e=d=0;e<g;++e)0>a[e]&&(d-=(b[e]-1)*a[e]);e=ui(c);for(f=cd[e];f.length<=g+1;)f.push(si(e,f.length-1));g=f[g+1];return g(c,b,a,d)},vh=
function(c,b){for(var a=1,d=0;d<c.length;++d)a*=c[d];return Ka(new (wi(b||"float64"))(a),c)},Kj=function(c){function b(){I(this,b);var a=P(this,(b.__proto__||Object.getPrototypeOf(b)).call(this));a.addInputValidator(0,Q);a.setMetadata("componentOffset",0);return a}L(b,c);N(b,[{key:"_run",value:function(){if(this.hasValidInput()){for(var a=this._getInput(0),b=a.getMetadata("width"),c=a.getMetadata("height"),e=a.getMetadata("ncpp"),f=this.getMetadata("componentOffset"),a=Ka(a.getData(),[b,c,e]),f=a.pick(null,
null,f),a=vh([b,c],a.dtype),e=0;e<b;e++)for(var k=0;k<c;k++)a.set(e,k,f.get(e,k));f=new Q;f.setData(a.data,b,c,1);this._output[0]=f}else console.warn("A filter of type ComponentProjectionImage2DFilter requires 1 input of Image2D.")}}]);return b}(W),Lj=function(c){function b(){I(this,b);var a=P(this,(b.__proto__||Object.getPrototypeOf(b)).call(this));a.addInputValidator("ALL",Q);return a}L(b,c);N(b,[{key:"_run",value:function(){var a=this;if(2>this.getNumberOfInputs())console.warn("A filter of type ComponentMergeImage2DFilter needs 2 or more inputs.");
else if(this.hasValidInput()){var b=this.getInputCategories().map(function(b){return a._getInput(b)});if(xi(b)){var c=b[0].getMetadata("width"),e=b[0].getMetadata("height"),f=b.map(function(a){return a.getMetadata("ncpp")}).reduce(function(a,b){return a+b}),k=Ka(b[0].getData()).dtype,l=vh([c,e,f],k),m=0;b.forEach(function(a,b){b=a.getMetadata("ncpp");a=Ka(a.getData(),[c,e,b]);for(var d=0;d<c;d++)for(var g=0;g<e;g++)for(var f=0;f<b;f++)l.set(d,g,m+f,a.get(d,g,f));m+=b});this._output[0]=new Q;this._output[0].setData(l.data,
c,e,f)}else console.warn("A filter of type ComponentMergeImage2DFilter requires inputs to be the same dimensions and array type")}else console.warn("A filter of type ComponentMergeImage2DFilter requires inputs of Image2D.")}}]);return b}(W),Mj=function(c,b){for(var a=b[1].length-Math.abs(c.arrayBlockIndices[0])|0,d=Array(c.arrayArgs.length),g=Array(c.arrayArgs.length),e=0;e<c.arrayArgs.length;++e)g[e]=b[2*e],d[e]=b[2*e+1];for(var f=[],k=[],l=[],m=[],n=[],e=0;e<c.arrayArgs.length;++e){0>c.arrayBlockIndices[e]?
(l.push(0),m.push(a),f.push(a),k.push(a+c.arrayBlockIndices[e])):(l.push(c.arrayBlockIndices[e]),m.push(c.arrayBlockIndices[e]+a),f.push(0),k.push(c.arrayBlockIndices[e]));for(var r=[],u=0;u<d[e].length;u++)l[e]<=d[e][u]&&d[e][u]<m[e]&&r.push(d[e][u]-l[e]);n.push(r)}k=["SS"];m=["'use strict'"];r=[];for(u=0;u<a;++u)r.push(["s",u,"=SS[",u,"]"].join(""));for(e=0;e<c.arrayArgs.length;++e){k.push("a"+e);k.push("t"+e);k.push("p"+e);for(u=0;u<a;++u)r.push(["t",e,"p",u,"=t",e,"[",l[e]+u,"]"].join(""));for(u=
0;u<Math.abs(c.arrayBlockIndices[e]);++u)r.push(["t",e,"b",u,"=t",e,"[",f[e]+u,"]"].join(""))}for(e=0;e<c.scalarArgs.length;++e)k.push("Y"+e);0<c.shapeArgs.length&&r.push("shape=SS.slice(0)");if(0<c.indexArgs.length){u=Array(a);for(e=0;e<a;++e)u[e]="0";r.push(["index=[",u.join(","),"]"].join(""))}for(e=0;e<c.offsetArgs.length;++e){f=c.offsetArgs[e];l=[];for(u=0;u<f.offset.length;++u)0!==f.offset[u]&&(1===f.offset[u]?l.push(["t",f.array,"p",u].join("")):l.push([f.offset[u],"*t",f.array,"p",u].join("")));
0===l.length?r.push("q"+e+"=0"):r.push(["q",e,"=",l.join("+")].join(""))}e=[].concat(c.pre.thisVars).concat(c.body.thisVars).concat(c.post.thisVars);if(0!==e.length){e.sort();for(var u=1,f=e.length,l=e[0],p,t=1;t<f;++t)p=l,l=e[t],l!==p&&(t===u?u++:e[u++]=l);e.length=u}r=r.concat(e);0<r.length&&m.push("var "+r.join(","));for(e=0;e<c.arrayArgs.length;++e)m.push("p"+e+"|=0");3<c.pre.body.length&&m.push(Xd(c.pre,c,g));r=Xd(c.body,c,g);a:for(e=0,u=n[0].length;e<u;){for(f=1;f<n.length;++f)if(n[f][e]!==
n[0][e])break a;++e}e<a?m.push(yi(e,n[0],c,r)):m.push(tg(n[0],c,r));3<c.post.body.length&&m.push(Xd(c.post,c,g));c.debug&&console.log("-----Generated cwise routine for ",b,":\n"+m.join("\n")+"\n----------");c=[c.funcName||"unnamed","_cwise_loop_",d[0].join("s"),"m",e,zi(g)].join("");return(new Function(["function ",c,"(",k.join(","),"){",m.join("\n"),"} return ",c].join("")))()},Aa=function(c){var b=new Ai;b.pre=c.pre;b.body=c.body;b.post=c.post;var a=c.args.slice(0);b.argTypes=a;for(var d=0;d<a.length;++d){var g=
a[d];if("array"===g||"object"===("undefined"===typeof g?"undefined":O(g))&&g.blockIndices){b.argTypes[d]="array";b.arrayArgs.push(d);b.arrayBlockIndices.push(g.blockIndices?g.blockIndices:0);b.shimArgs.push("array"+d);if(d<b.pre.args.length&&0<b.pre.args[d].count)throw Error("cwise: pre() block may not reference array args");if(d<b.post.args.length&&0<b.post.args[d].count)throw Error("cwise: post() block may not reference array args");}else if("scalar"===g)b.scalarArgs.push(d),b.shimArgs.push("scalar"+
d);else if("index"===g){b.indexArgs.push(d);if(d<b.pre.args.length&&0<b.pre.args[d].count)throw Error("cwise: pre() block may not reference array index");if(d<b.body.args.length&&b.body.args[d].lvalue)throw Error("cwise: body() block may not write to array index");if(d<b.post.args.length&&0<b.post.args[d].count)throw Error("cwise: post() block may not reference array index");}else if("shape"===g){b.shapeArgs.push(d);if(d<b.pre.args.length&&b.pre.args[d].lvalue)throw Error("cwise: pre() block may not write to array shape");
if(d<b.body.args.length&&b.body.args[d].lvalue)throw Error("cwise: body() block may not write to array shape");if(d<b.post.args.length&&b.post.args[d].lvalue)throw Error("cwise: post() block may not write to array shape");}else if("object"===("undefined"===typeof g?"undefined":O(g))&&g.offset)b.argTypes[d]="offset",b.offsetArgs.push({array:g.array,offset:g.offset}),b.offsetArgIndex.push(d);else throw Error("cwise: Unknown argument type "+a[d]);}if(0>=b.arrayArgs.length)throw Error("cwise: No array arguments specified");
if(b.pre.args.length>a.length)throw Error("cwise: Too many arguments in pre() block");if(b.body.args.length>a.length)throw Error("cwise: Too many arguments in body() block");if(b.post.args.length>a.length)throw Error("cwise: Too many arguments in post() block");b.debug=!!c.printCode||!!c.debug;b.funcName=c.funcName||"cwise";b.blockSize=c.blockSize||64;c=["'use strict'","var CACHED={}"];a=[];c.push(["return function ",b.funcName+"_cwise_thunk","(",b.shimArgs.join(","),"){"].join(""));for(var d=[],
g=[],e=[["array",b.arrayArgs[0],".shape.slice(",Math.max(0,b.arrayBlockIndices[0]),0>b.arrayBlockIndices[0]?","+b.arrayBlockIndices[0]+")":")"].join("")],f=[],k=[],l=0;l<b.arrayArgs.length;++l){var m=b.arrayArgs[l];a.push(["t",m,"=array",m,".dtype,r",m,"=array",m,".order"].join(""));d.push("t"+m);d.push("r"+m);g.push("t"+m);g.push("r"+m+".join()");e.push("array"+m+".data");e.push("array"+m+".stride");e.push("array"+m+".offset|0");0<l&&(f.push("array"+b.arrayArgs[0]+".shape.length===array"+m+".shape.length+"+
(Math.abs(b.arrayBlockIndices[0])-Math.abs(b.arrayBlockIndices[l]))),k.push("array"+b.arrayArgs[0]+".shape[shapeIndex+"+Math.max(0,b.arrayBlockIndices[0])+"]===array"+m+".shape[shapeIndex+"+Math.max(0,b.arrayBlockIndices[l])+"]"))}1<b.arrayArgs.length&&(c.push("if (!("+f.join(" && ")+")) throw new Error('cwise: Arrays do not all have the same dimensionality!')"),c.push("for(var shapeIndex=array"+b.arrayArgs[0]+".shape.length-"+Math.abs(b.arrayBlockIndices[0])+"; shapeIndex--\x3e0;) {"),c.push("if (!("+
k.join(" && ")+")) throw new Error('cwise: Arrays do not all have the same shape!')"),c.push("}"));for(l=0;l<b.scalarArgs.length;++l)e.push("scalar"+b.scalarArgs[l]);a.push(["type=[",g.join(","),"].join()"].join(""));a.push("proc=CACHED[type]");c.push("var "+a.join(","));c.push(["if(!proc){CACHED[type]=proc=compile([",d.join(","),"])}return proc(",e.join(","),")}"].join(""));b.debug&&console.log("-----Generated thunk:\n"+c.join("\n")+"\n----------");return(new Function("compile",c.join("\n")))(Mj.bind(void 0,
b))},dc=ma(function(c,b){function a(a){if(!a)return g;for(var b=0;b<a.args.length;++b){var d=a.args[b];a.args[b]=0===b?{name:d,lvalue:!0,rvalue:!!a.rvalue,count:a.count||1}:{name:d,lvalue:!1,rvalue:!0,count:1}}a.thisVars||(a.thisVars=[]);a.localVars||(a.localVars=[]);return a}function d(b){for(var d=[],c=0;c<b.args.length;++c)d.push("a"+c);d=new Function("P",["return function ",b.funcName,"_ndarrayops(",d.join(","),") {P(",d.join(","),");return a0}"].join(""));b=Aa({args:b.args,pre:a(b.pre),body:a(b.body),
post:a(b.proc),funcName:b.funcName});return d(b)}var g={body:"",args:[],thisVars:[],localVars:[]},e={add:"+",sub:"-",mul:"*",div:"/",mod:"%",band:"&",bor:"|",bxor:"^",lshift:"<<",rshift:">>",rrshift:">>>"};(function(){for(var a in e){var c=e[a];b[a]=d({args:["array","array","array"],body:{args:["a","b","c"],body:"a=b"+c+"c"},funcName:a});b[a+"eq"]=d({args:["array","array"],body:{args:["a","b"],body:"a"+c+"=b"},rvalue:!0,funcName:a+"eq"});b[a+"s"]=d({args:["array","array","scalar"],body:{args:["a",
"b","s"],body:"a=b"+c+"s"},funcName:a+"s"});b[a+"seq"]=d({args:["array","scalar"],body:{args:["a","s"],body:"a"+c+"=s"},rvalue:!0,funcName:a+"seq"})}})();var f={not:"!",bnot:"~",neg:"-",recip:"1.0/"};(function(){for(var a in f){var c=f[a];b[a]=d({args:["array","array"],body:{args:["a","b"],body:"a="+c+"b"},funcName:a});b[a+"eq"]=d({args:["array"],body:{args:["a"],body:"a="+c+"a"},rvalue:!0,count:2,funcName:a+"eq"})}})();var k={and:"&&",or:"||",eq:"===",neq:"!==",lt:"<",gt:">",leq:"<=",geq:">="};(function(){for(var a in k){var c=
k[a];b[a]=d({args:["array","array","array"],body:{args:["a","b","c"],body:"a=b"+c+"c"},funcName:a});b[a+"s"]=d({args:["array","array","scalar"],body:{args:["a","b","s"],body:"a=b"+c+"s"},funcName:a+"s"});b[a+"eq"]=d({args:["array","array"],body:{args:["a","b"],body:"a=a"+c+"b"},rvalue:!0,count:2,funcName:a+"eq"});b[a+"seq"]=d({args:["array","scalar"],body:{args:["a","s"],body:"a=a"+c+"s"},rvalue:!0,count:2,funcName:a+"seq"})}})();var l="abs acos asin atan ceil cos exp floor log round sin sqrt tan".split(" ");
(function(){for(var a=0;a<l.length;++a){var c=l[a];b[c]=d({args:["array","array"],pre:{args:[],body:"this_f=Math."+c,thisVars:["this_f"]},body:{args:["a","b"],body:"a=this_f(b)",thisVars:["this_f"]},funcName:c});b[c+"eq"]=d({args:["array"],pre:{args:[],body:"this_f=Math."+c,thisVars:["this_f"]},body:{args:["a"],body:"a=this_f(a)",thisVars:["this_f"]},rvalue:!0,count:2,funcName:c+"eq"})}})();var m=["max","min","atan2","pow"];(function(){for(var a=0;a<m.length;++a){var c=m[a];b[c]=d({args:["array",
"array","array"],pre:{args:[],body:"this_f=Math."+c,thisVars:["this_f"]},body:{args:["a","b","c"],body:"a=this_f(b,c)",thisVars:["this_f"]},funcName:c});b[c+"s"]=d({args:["array","array","scalar"],pre:{args:[],body:"this_f=Math."+c,thisVars:["this_f"]},body:{args:["a","b","c"],body:"a=this_f(b,c)",thisVars:["this_f"]},funcName:c+"s"});b[c+"eq"]=d({args:["array","array"],pre:{args:[],body:"this_f=Math."+c,thisVars:["this_f"]},body:{args:["a","b"],body:"a=this_f(a,b)",thisVars:["this_f"]},rvalue:!0,
count:2,funcName:c+"eq"});b[c+"seq"]=d({args:["array","scalar"],pre:{args:[],body:"this_f=Math."+c,thisVars:["this_f"]},body:{args:["a","b"],body:"a=this_f(a,b)",thisVars:["this_f"]},rvalue:!0,count:2,funcName:c+"seq"})}})();var n=["atan2","pow"];(function(){for(var a=0;a<n.length;++a){var c=n[a];b[c+"op"]=d({args:["array","array","array"],pre:{args:[],body:"this_f=Math."+c,thisVars:["this_f"]},body:{args:["a","b","c"],body:"a=this_f(c,b)",thisVars:["this_f"]},funcName:c+"op"});b[c+"ops"]=d({args:["array",
"array","scalar"],pre:{args:[],body:"this_f=Math."+c,thisVars:["this_f"]},body:{args:["a","b","c"],body:"a=this_f(c,b)",thisVars:["this_f"]},funcName:c+"ops"});b[c+"opeq"]=d({args:["array","array"],pre:{args:[],body:"this_f=Math."+c,thisVars:["this_f"]},body:{args:["a","b"],body:"a=this_f(b,a)",thisVars:["this_f"]},rvalue:!0,count:2,funcName:c+"opeq"});b[c+"opseq"]=d({args:["array","scalar"],pre:{args:[],body:"this_f=Math."+c,thisVars:["this_f"]},body:{args:["a","b"],body:"a=this_f(b,a)",thisVars:["this_f"]},
rvalue:!0,count:2,funcName:c+"opseq"})}})();b.any=Aa({args:["array"],pre:g,body:{args:[{name:"a",lvalue:!1,rvalue:!0,count:1}],body:"if(a){return true}",localVars:[],thisVars:[]},post:{args:[],localVars:[],thisVars:[],body:"return false"},funcName:"any"});b.all=Aa({args:["array"],pre:g,body:{args:[{name:"x",lvalue:!1,rvalue:!0,count:1}],body:"if(!x){return false}",localVars:[],thisVars:[]},post:{args:[],localVars:[],thisVars:[],body:"return true"},funcName:"all"});b.sum=Aa({args:["array"],pre:{args:[],
localVars:[],thisVars:["this_s"],body:"this_s=0"},body:{args:[{name:"a",lvalue:!1,rvalue:!0,count:1}],body:"this_s+=a",localVars:[],thisVars:["this_s"]},post:{args:[],localVars:[],thisVars:["this_s"],body:"return this_s"},funcName:"sum"});b.prod=Aa({args:["array"],pre:{args:[],localVars:[],thisVars:["this_s"],body:"this_s=1"},body:{args:[{name:"a",lvalue:!1,rvalue:!0,count:1}],body:"this_s*=a",localVars:[],thisVars:["this_s"]},post:{args:[],localVars:[],thisVars:["this_s"],body:"return this_s"},funcName:"prod"});
b.norm2squared=Aa({args:["array"],pre:{args:[],localVars:[],thisVars:["this_s"],body:"this_s=0"},body:{args:[{name:"a",lvalue:!1,rvalue:!0,count:2}],body:"this_s+=a*a",localVars:[],thisVars:["this_s"]},post:{args:[],localVars:[],thisVars:["this_s"],body:"return this_s"},funcName:"norm2squared"});b.norm2=Aa({args:["array"],pre:{args:[],localVars:[],thisVars:["this_s"],body:"this_s=0"},body:{args:[{name:"a",lvalue:!1,rvalue:!0,count:2}],body:"this_s+=a*a",localVars:[],thisVars:["this_s"]},post:{args:[],
localVars:[],thisVars:["this_s"],body:"return Math.sqrt(this_s)"},funcName:"norm2"});b.norminf=Aa({args:["array"],pre:{args:[],localVars:[],thisVars:["this_s"],body:"this_s=0"},body:{args:[{name:"a",lvalue:!1,rvalue:!0,count:4}],body:"if(-a>this_s){this_s=-a}else if(a>this_s){this_s=a}",localVars:[],thisVars:["this_s"]},post:{args:[],localVars:[],thisVars:["this_s"],body:"return this_s"},funcName:"norminf"});b.norm1=Aa({args:["array"],pre:{args:[],localVars:[],thisVars:["this_s"],body:"this_s=0"},
body:{args:[{name:"a",lvalue:!1,rvalue:!0,count:3}],body:"this_s+=a<0?-a:a",localVars:[],thisVars:["this_s"]},post:{args:[],localVars:[],thisVars:["this_s"],body:"return this_s"},funcName:"norm1"});b.sup=Aa({args:["array"],pre:{body:"this_h=-Infinity",args:[],thisVars:["this_h"],localVars:[]},body:{body:"if(_inline_1_arg0_>this_h)this_h=_inline_1_arg0_",args:[{name:"_inline_1_arg0_",lvalue:!1,rvalue:!0,count:2}],thisVars:["this_h"],localVars:[]},post:{body:"return this_h",args:[],thisVars:["this_h"],
localVars:[]}});b.inf=Aa({args:["array"],pre:{body:"this_h=Infinity",args:[],thisVars:["this_h"],localVars:[]},body:{body:"if(_inline_1_arg0_<this_h)this_h=_inline_1_arg0_",args:[{name:"_inline_1_arg0_",lvalue:!1,rvalue:!0,count:2}],thisVars:["this_h"],localVars:[]},post:{body:"return this_h",args:[],thisVars:["this_h"],localVars:[]}});b.argmin=Aa({args:["index","array","shape"],pre:{body:"{this_v=Infinity;this_i=_inline_0_arg2_.slice(0)}",args:[{name:"_inline_0_arg0_",lvalue:!1,rvalue:!1,count:0},
{name:"_inline_0_arg1_",lvalue:!1,rvalue:!1,count:0},{name:"_inline_0_arg2_",lvalue:!1,rvalue:!0,count:1}],thisVars:["this_i","this_v"],localVars:[]},body:{body:"{if(_inline_1_arg1_<this_v){this_v=_inline_1_arg1_;for(var _inline_1_k=0;_inline_1_k<_inline_1_arg0_.length;++_inline_1_k){this_i[_inline_1_k]=_inline_1_arg0_[_inline_1_k]}}}",args:[{name:"_inline_1_arg0_",lvalue:!1,rvalue:!0,count:2},{name:"_inline_1_arg1_",lvalue:!1,rvalue:!0,count:2}],thisVars:["this_i","this_v"],localVars:["_inline_1_k"]},
post:{body:"{return this_i}",args:[],thisVars:["this_i"],localVars:[]}});b.argmax=Aa({args:["index","array","shape"],pre:{body:"{this_v=-Infinity;this_i=_inline_0_arg2_.slice(0)}",args:[{name:"_inline_0_arg0_",lvalue:!1,rvalue:!1,count:0},{name:"_inline_0_arg1_",lvalue:!1,rvalue:!1,count:0},{name:"_inline_0_arg2_",lvalue:!1,rvalue:!0,count:1}],thisVars:["this_i","this_v"],localVars:[]},body:{body:"{if(_inline_1_arg1_>this_v){this_v=_inline_1_arg1_;for(var _inline_1_k=0;_inline_1_k<_inline_1_arg0_.length;++_inline_1_k){this_i[_inline_1_k]=_inline_1_arg0_[_inline_1_k]}}}",
args:[{name:"_inline_1_arg0_",lvalue:!1,rvalue:!0,count:2},{name:"_inline_1_arg1_",lvalue:!1,rvalue:!0,count:2}],thisVars:["this_i","this_v"],localVars:["_inline_1_k"]},post:{body:"{return this_i}",args:[],thisVars:["this_i"],localVars:[]}});b.random=d({args:["array"],pre:{args:[],body:"this_f=Math.random",thisVars:["this_f"]},body:{args:["a"],body:"a=this_f()",thisVars:["this_f"]},funcName:"random"});b.assign=d({args:["array","array"],body:{args:["a","b"],body:"a=b"},funcName:"assign"});b.assigns=
d({args:["array","scalar"],body:{args:["a","b"],body:"a=b"},funcName:"assigns"});b.equals=Aa({args:["array","array"],pre:g,body:{args:[{name:"x",lvalue:!1,rvalue:!0,count:1},{name:"y",lvalue:!1,rvalue:!0,count:1}],body:"if(x!==y){return false}",localVars:[],thisVars:[]},post:{args:[],localVars:[],thisVars:[],body:"return true"},funcName:"equals"})}),Lc=Array(256);(function(c){for(var b=0;256>b;++b){for(var a=b,d=b,g=7,a=a>>>1;a;a>>>=1)d<<=1,d|=a&1,--g;c[b]=d<<g&255}})(Lc);var Ba={INT_BITS:32,INT_MAX:2147483647,
INT_MIN:-2147483648,sign:function(c){return(0<c)-(0>c)},abs:function(c){var b=c>>31;return(c^b)-b},min:function(c,b){return b^(c^b)&-(c<b)},max:function(c,b){return c^(c^b)&-(c<b)},isPow2:function(c){return!(c&c-1)&&!!c},log2:function(c){var b,a;b=(65535<c)<<4;c>>>=b;a=(255<c)<<3;c>>>=a;b|=a;a=(15<c)<<2;c>>>=a;b|=a;a=(3<c)<<1;return b|a|c>>>a>>1},log10:function(c){return 1E9<=c?9:1E8<=c?8:1E7<=c?7:1E6<=c?6:1E5<=c?5:1E4<=c?4:1E3<=c?3:100<=c?2:10<=c?1:0},popCount:function(c){c-=c>>>1&1431655765;c=(c&
858993459)+(c>>>2&858993459);return 16843009*(c+(c>>>4)&252645135)>>>24},countTrailingZeros:ug,nextPow2:function(c){c+=0===c;--c;c|=c>>>1;c|=c>>>2;c|=c>>>4;c|=c>>>8;return(c|c>>>16)+1},prevPow2:function(c){c|=c>>>1;c|=c>>>2;c|=c>>>4;c|=c>>>8;c|=c>>>16;return c-(c>>>1)},parity:function(c){c^=c>>>16;c^=c>>>8;return 27030>>>((c^c>>>4)&15)&1},reverse:function(c){return Lc[c&255]<<24|Lc[c>>>8&255]<<16|Lc[c>>>16&255]<<8|Lc[c>>>24&255]},interleave2:function(c,b){c&=65535;c=(c|c<<8)&16711935;c=(c|c<<4)&252645135;
c=(c|c<<2)&858993459;b&=65535;b=(b|b<<8)&16711935;b=(b|b<<4)&252645135;b=(b|b<<2)&858993459;return(c|c<<1)&1431655765|((b|b<<1)&1431655765)<<1},deinterleave2:function(c,b){c=c>>>b&1431655765;c=(c|c>>>1)&858993459;c=(c|c>>>2)&252645135;c=(c|c>>>4)&16711935;return((c|c>>>16)&65535)<<16>>16},interleave3:function(c,b,a){c&=1023;c=(c|c<<16)&4278190335;c=(c|c<<8)&251719695;c=(c|c<<4)&3272356035;b&=1023;b=(b|b<<16)&4278190335;b=(b|b<<8)&251719695;b=(b|b<<4)&3272356035;a&=1023;a=(a|a<<16)&4278190335;a=(a|
a<<8)&251719695;a=(a|a<<4)&3272356035;return(c|c<<2)&1227133513|((b|b<<2)&1227133513)<<1|((a|a<<2)&1227133513)<<2},deinterleave3:function(c,b){c=c>>>b&1227133513;c=(c|c>>>2)&3272356035;c=(c|c>>>4)&251719695;c=(c|c>>>8)&4278190335;return((c|c>>>16)&1023)<<22>>22},nextCombination:function(c){var b=c|c-1;return b+1|(~b&-~b)-1>>>ug(c)+1}},Da=function(c,b){"undefined"===typeof b&&(b=0);switch("undefined"===typeof c?"undefined":O(c)){case "number":if(0<c){c|=0;var a,d;a=Array(c);for(d=0;d<c;++d)a[d]=b;
return a}break;case "object":if("number"===typeof c.length)return vg(c,b,0)}return[]},ie=ma(function(c,b){function a(a){if(a){var b=Ba.log2(a.length||a.byteLength);x[b].push(a)}}function d(a){a=Ba.nextPow2(a);var b=Ba.log2(a),b=x[b];return 0<b.length?b.pop():new ArrayBuffer(a)}function g(a){return new Uint8Array(d(a),0,a)}function e(a){return new Uint16Array(d(2*a),0,a)}function f(a){return new Uint32Array(d(4*a),0,a)}function k(a){return new Int8Array(d(a),0,a)}function l(a){return new Int16Array(d(2*
a),0,a)}function m(a){return new Int32Array(d(4*a),0,a)}function n(a){return new Float32Array(d(4*a),0,a)}function r(a){return new Float64Array(d(8*a),0,a)}function u(a){return q?new Uint8ClampedArray(d(a),0,a):g(a)}function p(a){return new DataView(d(a),0,a)}function t(a){a=Ba.nextPow2(a);var b=Ba.log2(a),b=v[b];return 0<b.length?b.pop():new z(a)}Hb.__TYPEDARRAY_POOL||(Hb.__TYPEDARRAY_POOL={UINT8:Da([32,0]),UINT16:Da([32,0]),UINT32:Da([32,0]),INT8:Da([32,0]),INT16:Da([32,0]),INT32:Da([32,0]),FLOAT:Da([32,
0]),DOUBLE:Da([32,0]),DATA:Da([32,0]),UINT8C:Da([32,0]),BUFFER:Da([32,0])});var q="undefined"!==typeof Uint8ClampedArray,w=Hb.__TYPEDARRAY_POOL;w.UINT8C||(w.UINT8C=Da([32,0]));w.BUFFER||(w.BUFFER=Da([32,0]));var x=w.DATA,v=w.BUFFER;b.free=function(a){if(ud(a))v[Ba.log2(a.length)].push(a);else if("[object ArrayBuffer]"!==Object.prototype.toString.call(a)&&(a=a.buffer),a){var b=Ba.log2(a.length||a.byteLength)|0;x[b].push(a)}};b.freeUint8=b.freeUint16=b.freeUint32=b.freeInt8=b.freeInt16=b.freeInt32=
b.freeFloat32=b.freeFloat=b.freeFloat64=b.freeDouble=b.freeUint8Clamped=b.freeDataView=function(b){a(b.buffer)};b.freeArrayBuffer=a;b.freeBuffer=function(a){v[Ba.log2(a.length)].push(a)};b.malloc=function(a,b){if(void 0===b||"arraybuffer"===b)return d(a);switch(b){case "uint8":return g(a);case "uint16":return e(a);case "uint32":return f(a);case "int8":return k(a);case "int16":return l(a);case "int32":return m(a);case "float":case "float32":return n(a);case "double":case "float64":return r(a);case "uint8_clamped":return u(a);
case "buffer":return t(a);case "data":case "dataview":return p(a)}return null};b.mallocArrayBuffer=d;b.mallocUint8=g;b.mallocUint16=e;b.mallocUint32=f;b.mallocInt8=k;b.mallocInt16=l;b.mallocInt32=m;b.mallocFloat32=b.mallocFloat=n;b.mallocFloat64=b.mallocDouble=r;b.mallocUint8Clamped=u;b.mallocDataView=p;b.mallocBuffer=t;b.clearCache=function(){for(var a=0;32>a;++a)w.UINT8[a].length=0,w.UINT16[a].length=0,w.UINT32[a].length=0,w.INT8[a].length=0,w.INT16[a].length=0,w.INT32[a].length=0,w.FLOAT[a].length=
0,w.DOUBLE[a].length=0,w.UINT8C[a].length=0,x[a].length=0,v[a].length=0}}),je=function(c,b,a,d,g,e,f){c|=0;b|=0;a|=0;g|=0;e|=0;if(Ba.isPow2(a))dd(c,b,a,d,g,e);else{var k;c|=0;b|=0;a|=0;g|=0;e|=0;k=f|0;f=Ba.nextPow2(2*a+1);var l=k+a,m=l+a,n=m+f,r=n+f,u=r+f,p=-c*Math.PI/a,t,q,w,x,v,A;for(A=0;A<a;++A)t=A*A%(2*a)*p,w=Math.cos(t),x=Math.sin(t),d[r+(f-A)]=d[r+A]=d[k+A]=w,d[u+(f-A)]=d[u+A]=d[l+A]=x;for(A=a;A<=f-a;++A)d[r+A]=0;for(A=a;A<=f-a;++A)d[u+A]=0;dd(1,1,f,d,r,u);p=0>c?1/a:1;for(c=0;c<b;++c){for(A=
0;A<a;++A)t=d[g+A],q=d[e+A],w=d[k+A],x=-d[l+A],v=w*(t+q),t*=x-w,w=q*(w+x),d[m+A]=v-w,d[n+A]=v+t;for(A=a;A<f;++A)d[m+A]=0;for(A=a;A<f;++A)d[n+A]=0;dd(1,1,f,d,m,n);for(A=0;A<f;++A)t=d[m+A],q=d[n+A],w=d[r+A],x=d[u+A],v=w*(t+q),t*=x-w,w=q*(w+x),d[m+A]=v-w,d[n+A]=v+t;dd(-1,1,f,d,m,n);for(A=0;A<a;++A)t=d[m+A],q=d[n+A],w=d[k+A],x=-d[l+A],v=w*(t+q),t*=x-w,w=q*(w+x),d[g+A]=p*(v-w),d[e+A]=p*(v+t);g+=a;e+=a}}};je.scratchMemory=function(c){return Ba.isPow2(c)?0:2*c+4*Ba.nextPow2(2*c+1)};var wh=function(c,b,a){var d=
b.shape,g=d.length,e=1,f=Array(g),k=0,l,m;for(l=g-1;0<=l;--l)if(f[l]=e,e*=d[l],k=Math.max(k,je.scratchMemory(d[l])),b.shape[l]!==a.shape[l])throw Error("Shape mismatch, real and imaginary arrays must have same size");l=4*e+k;var k="array"===b.dtype||"float64"===b.dtype||"custom"===b.dtype?ie.mallocDouble(l):ie.mallocFloat(l),n=Ka(k,d.slice(0),f,0),r=Ka(k,d.slice(0),f.slice(0),e),u=Ka(k,d.slice(0),f.slice(0),2*e),f=Ka(k,d.slice(0),f.slice(0),3*e),p,t,q,w=4*e;dc.assign(n,b);dc.assign(r,a);for(l=g-1;0<=
l;--l){je(c,e/d[l],d[l],k,n.offset,r.offset,w);if(0===l)break;p=1;t=u.stride;q=f.stride;for(m=l-1;m<g;++m)q[m]=t[m]=p,p*=d[m];for(m=l-2;0<=m;--m)q[m]=t[m]=p,p*=d[m];dc.assign(u,n);dc.assign(f,r);m=n;n=u;u=m;m=r;r=f;f=m}dc.assign(b,n);dc.assign(a,r);ie.free(k)},ke={FORWARD:1,INVERSE:-1},xh=function(c){function b(a){I(this,b);var d=P(this,(b.__proto__||Object.getPrototypeOf(b)).call(this));d.direction=a;d.setMetadata("direction",d.direction);if(void 0===ke[d.direction])throw Error(d.direction+" is not a valid fourier transform direction. Please try one of: "+
Object.keys(ke));d.addInputValidator(0,ua);d.addInputValidator(1,ua);return d}L(b,c);N(b,[{key:"_run",value:function(){if(this.hasValidInput()){var a=this._getInput(0),b=this._getInput(1),c=a.getMetadata("length");c!==b.getMetadata("length")&&console.warn("The imaginary and real components of the signal need to be of equal length.");var e=Ka(a.clone().getData(),[c]),b=Ka(b.clone().getData(),[c]);wh(ke[this.direction],e,b);this._output[0]=new ua;this._output[0].setData(e.data);this._output[1]=new ua;
this._output[1].setData(b.data);this._output[0].setMetadata("samplingFrequency",a.getMetadata("samplingFrequency"));this._output[1].setMetadata("samplingFrequency",a.getMetadata("samplingFrequency"))}else console.warn("A filter of type BaseFourierSignalFilter requires 2 inputs of Signal1D.")}}]);return b}(W),yh=function(c){function b(){I(this,b);return P(this,(b.__proto__||Object.getPrototypeOf(b)).call(this,"FORWARD"))}L(b,c);return b}(xh),Nj=function(c){function b(){I(this,b);return P(this,(b.__proto__||
Object.getPrototypeOf(b)).call(this,"INVERSE"))}L(b,c);return b}(xh),le={FORWARD:1,INVERSE:-1},zh=function(c){function b(a){I(this,b);var d=P(this,(b.__proto__||Object.getPrototypeOf(b)).call(this));d.direction=a;if(void 0===le[d.direction])throw Error(d.direction+" is not a valid fourier transform direction. Please try one of: "+Object.keys(le));d.addInputValidator(0,Q);d.addInputValidator(1,Q);return d}L(b,c);N(b,[{key:"_run",value:function(){if(this.hasValidInput()){var a=this._getInput(0),b=this._getInput(1);
if(1<a.getMetadata("ncpp"))console.warn("Please make sure the input images are made of exactly 1 channel.");else{var c=a.getMetadata("width"),e=a.getMetadata("height");c===b.getMetadata("width")&&e===b.getMetadata("height")||console.warn("Please make sure the real and imaginary input images are the same dimensions");a=Ka(a.getDataAsFloat32Array(),[c,e]);b=Ka(b.getDataAsFloat32Array(),[c,e]);this.setMetadata("direction",this.direction);wh(le[this.direction],a,b);this._output[0]=new Q;this._output[0].setData(a.data,
c,e,1);this._output[0].setMetadata("ncpp",1);this._output[1]=new Q;this._output[1].setData(b.data,c,e,1);this._output[1].setMetadata("ncpp",1)}}else console.warn("A filter of type BaseFourierSignalFilter requires 2 inputs of Signal1D.")}}]);return b}(W),Oj=function(c){function b(){I(this,b);return P(this,(b.__proto__||Object.getPrototypeOf(b)).call(this,"FORWARD"))}L(b,c);return b}(zh),Pj=function(c){function b(){I(this,b);return P(this,(b.__proto__||Object.getPrototypeOf(b)).call(this,"INVERSE"))}
L(b,c);return b}(zh),Qj=function(c){function b(){I(this,b);var a=P(this,(b.__proto__||Object.getPrototypeOf(b)).call(this));a.addInputValidator(0,Q);return a}L(b,c);N(b,[{key:"_run",value:function(){if(this.hasValidInput()){var a=this._getInput(),b=a.getWidth()*a.getHeight(),c=a.getDataCopy();this._forEachPixelOfSuch(c,0,b,1);this._addOutput(Q).setData(c,a.getWidth(),a.getHeight(),a.getComponentsPerPixel())}}},{key:"_forEachPixelOfSuch",value:function(a,b,c,e){if(this.hasEvent("pixel"))for(var d=
this._getInput(),g=d.getData(),l=d.getComponentsPerPixel(),m;b<c;b+=e){var n=b*l,r=d.get2dPositionFrom1dIndex(b);m=g.slice(n,n+l);if((m=this.triggerEvent("pixel",r,m))&&m.length==l)for(r=0;r<l;r++)a[n+r]=m[r]}else console.warn("No function to apply per pixel was specified.")}}]);return b}(qa),Rj=function(c){function b(){I(this,b);var a=P(this,(b.__proto__||Object.getPrototypeOf(b)).call(this));a.addInputValidator(0,Q);a.addInputValidator(1,Q);return a}L(b,c);N(b,[{key:"_run",value:function(){if(this.hasValidInput()&&
this.hasSameSizeInput()&&this.hasValidInput()){var a=this._getInput(0),b=this._getInput(1);if(1!=b.getComponentsPerPixel())console.warn("The scaling image must have one single band.");else{for(var c=a.getWidth()*a.getHeight(),e=a.getComponentsPerPixel(),f=a.getDataCopy(),b=b.getData(),k=0;k<c;k++)for(var l=0;l<e;l++)f[k*e+l]*=b[k];this._addOutput(Q).setData(f,a.getWidth(),a.getHeight())}}}}]);return b}(qa),Sj=ma(function(c,b){(function(a,b){c.exports=b()})(Hb,function(){function a(a,b){for(var d=
0;d<a.length;d++)if(a[d]===b)return d;return-1}function b(a,b){this.type=a;this.value=void 0!==b&&null!==b?b:0}function c(a,b){this.tokens=a;this.parser=b;this.unaryOps=b.unaryOps;this.binaryOps=b.binaryOps;this.ternaryOps=b.ternaryOps;this.functions=b.functions}function e(a){return"string"===typeof a?JSON.stringify(a).replace(/\u2028/g,"\\u2028").replace(/\u2029/g,"\\u2029"):a}function f(a,d,c,e,g){for(var k=[],p=[],l,m,n,t,u=0,r=a.length;u<r;u++)if(t=a[u],l=t.type,"INUMBER"===l)k.push(t);else if("IVAR"===
l&&g.hasOwnProperty(t.value))t=new b("INUMBER",g[t.value]),k.push(t);else if("IOP2"===l&&1<k.length)m=k.pop(),l=k.pop(),t=c[t.value],t=new b("INUMBER",t(l.value,m.value)),k.push(t);else if("IOP3"===l&&2<k.length)n=k.pop(),m=k.pop(),l=k.pop(),"?"===t.value?k.push(l.value?m.value:n.value):(t=e[t.value],t=new b("INUMBER",t(l.value,m.value,n.value)),k.push(t));else if("IOP1"===l&&0<k.length)l=k.pop(),t=d[t.value],t=new b("INUMBER",t(l.value)),k.push(t);else if("IEXPR"===l){for(;0<k.length;)p.push(k.shift());
p.push(new b("IEXPR",f(t.value,d,c,e,g)))}else if("IMEMBER"===l&&0<k.length)l=k.pop(),k.push(new b("INUMBER",l.value[t.value]));else{for(;0<k.length;)p.push(k.shift());p.push(t)}for(;0<k.length;)p.push(k.shift());return p}function k(a,d,c){for(var e=[],f=0,g=a.length;f<g;f++){var l=a[f],p=l.type;if("IVAR"===p&&l.value===d)for(l=0;l<c.tokens.length;l++)p=c.tokens[l],p="IOP1"===p.type?da(p.value):"IOP2"===p.type?ea(p.value):"IOP3"===p.type?ha(p.value):new b(p.type,p.value),e.push(p);else"IEXPR"===p?
e.push(new b("IEXPR",k(l.value,d,c))):e.push(l)}return e}function l(a,b,d){for(var c=[],e,f,g,k,p=0,m=a.length;p<m;p++)if(k=a[p],e=k.type,"INUMBER"===e)c.push(k.value);else if("IOP2"===e)f=c.pop(),e=c.pop(),k=b.binaryOps[k.value],c.push(k(e,f));else if("IOP3"===e)g=c.pop(),f=c.pop(),e=c.pop(),"?"===k.value?c.push(l(e?f:g,b,d)):(k=b.ternaryOps[k.value],c.push(k(e,f,g)));else if("IVAR"===e)if(k.value in b.functions)c.push(b.functions[k.value]);else if(e=d[k.value],void 0!==e)c.push(e);else throw Error("undefined variable: "+
k.value);else if("IOP1"===e)e=c.pop(),k=b.unaryOps[k.value],c.push(k(e));else if("IFUNCALL"===e){k=k.value;for(e=[];0<k--;)e.unshift(c.pop());k=c.pop();if(k.apply&&k.call)c.push(k.apply(void 0,e));else throw Error(k+" is not a function");}else if("IEXPR"===e)c.push(k.value);else if("IMEMBER"===e)e=c.pop(),c.push(e[k.value]);else throw Error("invalid Expression");if(1<c.length)throw Error("invalid Expression (parity)");return c[0]}function m(a,b){for(var d=[],c,f,g,k,p=0,l=a.length;p<l;p++)if(k=a[p],
c=k.type,"INUMBER"===c)"number"===typeof k.value&&0>k.value?d.push("("+k.value+")"):d.push(e(k.value));else if("IOP2"===c)f=d.pop(),c=d.pop(),k=k.value,b?"^"===k?d.push("Math.pow("+c+", "+f+")"):"and"===k?d.push("(!!"+c+" && !!"+f+")"):"or"===k?d.push("(!!"+c+" || !!"+f+")"):"||"===k?d.push("(String("+c+") + String("+f+"))"):"=="===k?d.push("("+c+" === "+f+")"):"!="===k?d.push("("+c+" !== "+f+")"):d.push("("+c+" "+k+" "+f+")"):d.push("("+c+" "+k+" "+f+")");else if("IOP3"===c)if(g=d.pop(),f=d.pop(),
c=d.pop(),k=k.value,"?"===k)d.push("("+c+" ? "+f+" : "+g+")");else throw Error("invalid Expression");else if("IVAR"===c)d.push(k.value);else if("IOP1"===c)c=d.pop(),k=k.value,"-"===k||"+"===k?d.push("("+k+c+")"):b?"not"===k?d.push("(!"+c+")"):"!"===k?d.push("fac("+c+")"):d.push(k+"("+c+")"):"!"===k?d.push("("+c+"!)"):d.push("("+k+" "+c+")");else if("IFUNCALL"===c){f=k.value;for(c=[];0<f--;)c.unshift(d.pop());k=d.pop();d.push(k+"("+c.join(", ")+")")}else if("IMEMBER"===c)c=d.pop(),d.push(c+"."+k.value);
else if("IEXPR"===c)d.push("("+m(k.value,b)+")");else throw Error("invalid Expression");if(1<d.length)throw Error("invalid Expression (parity)");return d[0]}function n(b,d){for(var c=0,e=b.length;c<e;c++){var f=b[c];"IVAR"===f.type&&-1===a(d,f.value)?d.push(f.value):"IEXPR"===f.type&&n(f.value,d)}}function r(a,b){return Number(a)+Number(b)}function u(a,b){return a-b}function p(a,b){return a*b}function t(a,b){return a/b}function q(a,b){return a%b}function w(a,b){return""+a+b}function x(a,b){return a===
b}function v(a,b){return a!==b}function A(a,b){return a>b}function F(a,b){return a<b}function C(a,b){return a>=b}function z(a,b){return a<=b}function B(a,b){return!(!a||!b)}function D(a,b){return!(!a&&!b)}function H(a){return(Math.exp(a)-Math.exp(-a))/2}function I(a){return(Math.exp(a)+Math.exp(-a))/2}function J(a){return Infinity===a?1:-Infinity===a?-1:(Math.exp(a)-Math.exp(-a))/(Math.exp(a)+Math.exp(-a))}function E(a){return-Infinity===a?a:Math.log(a+Math.sqrt(a*a+1))}function L(a){return Math.log(a+
Math.sqrt(a*a-1))}function O(a){return Math.log((1+a)/(1-a))/2}function N(a){return Math.log(a)*Math.LOG10E}function P(a){return-a}function Q(a){return!a}function R(a){return 0>a?Math.ceil(a):Math.floor(a)}function S(a){return Math.random()*(a||1)}function U(a){return ba(a+1)}function V(a){return String(a).length}function Y(){for(var a=0,b=0,d=0,c=arguments.length;d<c;d++){var e=Math.abs(arguments[d]),f;b<e?(f=b/e,a=a*f*f+1,b=e):0<e?(f=e/b,a+=f*f):a+=e}return Infinity===b?Infinity:b*Math.sqrt(a)}
function Z(a,b,d){return a?b:d}function ba(a){var b,d;d=a;if(isFinite(d)&&d===Math.round(d)){if(0>=a)return isFinite(a)?Infinity:NaN;if(171<a)return Infinity;d=a-2;for(--a;1<d;)a*=d,d--;0===a&&(a=1);return a}if(.5>a)return Math.PI/(Math.sin(Math.PI*a)*ba(1-a));if(171.35<=a)return Infinity;if(85<a){d=a*a;b=d*a;var c=b*a,e=c*a;return Math.sqrt(2*Math.PI/a)*Math.pow(a/Math.E,a)*(1+1/(12*a)+1/(288*d)-139/(51840*b)-571/(2488320*c)+163879/(209018880*e)+5246819/(75246796800*e*a))}--a;d=ia[0];for(b=1;b<ia.length;++b)d+=
ia[b]/(a+b);b=a+ma+.5;return Math.sqrt(2*Math.PI)*Math.pow(b,a+.5)*Math.exp(-b)*d}function ca(a,b,d,c){this.type=a;this.value=b;this.line=d;this.column=c}function W(a,b,d,c,e){this.column=this.line=this.pos=0;this.current=null;this.unaryOps=b;this.binaryOps=d;this.ternaryOps=c;this.consts=e;this.expression=a;this.savedPosition=0;this.savedCurrent=null;this.savedColumn=this.savedLine=0}function da(a){var d=ja[a];d||(d=ja[a]=new b("IOP1",a));return d}function ea(a){var d=ka[a];d||(d=ka[a]=new b("IOP2",
a));return d}function ha(a){var d=la[a];d||(d=la[a]=new b("IOP3",a));return d}function X(a,b){this.parser=a;this.tokens=b;this.nextToken=this.current=null;this.next();this.savedNextToken=this.savedCurrent=null}function ga(){this.unaryOps={sin:Math.sin,cos:Math.cos,tan:Math.tan,asin:Math.asin,acos:Math.acos,atan:Math.atan,sinh:Math.sinh||H,cosh:Math.cosh||I,tanh:Math.tanh||J,asinh:Math.asinh||E,acosh:Math.acosh||L,atanh:Math.atanh||O,sqrt:Math.sqrt,log:Math.log,ln:Math.log,lg:Math.log10||N,log10:Math.log10||
N,abs:Math.abs,ceil:Math.ceil,floor:Math.floor,round:Math.round,trunc:Math.trunc||R,"-":P,"+":Number,exp:Math.exp,not:Q,length:V,"!":U};this.binaryOps={"+":r,"-":u,"*":p,"/":t,"%":q,"^":Math.pow,"||":w,"==":x,"!=":v,">":A,"<":F,">=":C,"<=":z,and:B,or:D};this.ternaryOps={"?":Z};this.functions={random:S,fac:U,min:Math.min,max:Math.max,hypot:Math.hypot||Y,pyt:Math.hypot||Y,pow:Math.pow,atan2:Math.atan2,"if":Z,gamma:ba};this.consts={E:Math.E,PI:Math.PI,"true":!0,"false":!1}}b.prototype.toString=function(){switch(this.type){case "INUMBER":case "IOP1":case "IOP2":case "IOP3":case "IVAR":return this.value;
case "IFUNCALL":return"CALL "+this.value;case "IMEMBER":return"."+this.value;default:return"Invalid Instruction"}};c.prototype.simplify=function(a){a=a||{};return new c(f(this.tokens,this.unaryOps,this.binaryOps,this.ternaryOps,a),this.parser)};c.prototype.substitute=function(a,b){b instanceof c||(b=this.parser.parse(String(b)));return new c(k(this.tokens,a,b),this.parser)};c.prototype.evaluate=function(a){a=a||{};return l(this.tokens,this,a)};c.prototype.toString=function(){return m(this.tokens,
!1)};c.prototype.symbols=function(){var a=[];n(this.tokens,a);return a};c.prototype.variables=function(){var a=[];n(this.tokens,a);var b=this.functions;return a.filter(function(a){return!(a in b)})};c.prototype.toJSFunction=function(a,b){var d=this,c=new Function(a,"with(this.functions) with (this.ternaryOps) with (this.binaryOps) with (this.unaryOps) { return "+m(this.simplify(b).tokens,!0)+"; }");return function(){return c.apply(d,arguments)}};var ma=4.7421875,ia=[.9999999999999971,57.15623566586292,
-59.59796035547549,14.136097974741746,-.4919138160976202,3.399464998481189E-5,4.652362892704858E-5,-9.837447530487956E-5,1.580887032249125E-4,-2.1026444172410488E-4,2.1743961811521265E-4,-1.643181065367639E-4,8.441822398385275E-5,-2.6190838401581408E-5,3.6899182659531625E-6];ca.prototype.toString=function(){return this.type+": "+this.value};W.prototype.newToken=function(a,b,d,c){return new ca(a,b,null!=d?d:this.line,null!=c?c:this.column)};W.prototype.save=function(){this.savedPosition=this.pos;this.savedCurrent=
this.current;this.savedLine=this.line;this.savedColumn=this.column};W.prototype.restore=function(){this.pos=this.savedPosition;this.current=this.savedCurrent;this.line=this.savedLine;this.column=this.savedColumn};W.prototype.next=function(){if(this.pos>=this.expression.length)return this.newToken("TEOF","EOF");if(this.isWhitespace()||this.isComment())return this.next();if(this.isNumber()||this.isOperator()||this.isString()||this.isParen()||this.isComma()||this.isNamedOp()||this.isConst()||this.isName())return this.current;
this.parseError('Unknown character "'+this.expression.charAt(this.pos)+'"')};W.prototype.isString=function(){var a=!1,b=this.line,d=this.column,c=this.pos,e=this.expression.charAt(c);if("'"===e||'"'===e){this.pos++;this.column++;for(var f=this.expression.indexOf(e,c+1);0<=f&&this.pos<this.expression.length;){this.pos=f+1;if("\\"!==this.expression.charAt(f-1)){a=this.expression.substring(c+1,f);this.current=this.newToken("TSTRING",this.unescape(a),b,d);b=a.indexOf("\n");for(d=-1;0<=b;)this.line++,
this.column=0,d=b,b=a.indexOf("\n",b+1);this.column+=a.length-d;a=!0;break}f=this.expression.indexOf(e,f+1)}}return a};W.prototype.isParen=function(){var a=this.expression.charAt(this.pos);return"("===a||")"===a?(this.current=this.newToken("TPAREN",a),this.pos++,this.column++,!0):!1};W.prototype.isComma=function(){return","===this.expression.charAt(this.pos)?(this.current=this.newToken("TCOMMA",","),this.pos++,this.column++,!0):!1};W.prototype.isConst=function(){for(var a=this.pos,b=a;b<this.expression.length;b++){var d=
this.expression.charAt(b);if(d.toUpperCase()===d.toLowerCase()&&(b===this.pos||"_"!==d&&"."!==d&&("0">d||"9"<d)))break}return b>a&&(a=this.expression.substring(a,b),a in this.consts)?(this.current=this.newToken("TNUMBER",this.consts[a]),this.pos+=a.length,this.column+=a.length,!0):!1};W.prototype.isNamedOp=function(){for(var a=this.pos,b=a;b<this.expression.length;b++){var d=this.expression.charAt(b);if(d.toUpperCase()===d.toLowerCase()&&(b===this.pos||"_"!==d&&("0">d||"9"<d)))break}return b>a&&(a=
this.expression.substring(a,b),a in this.binaryOps||a in this.unaryOps||a in this.ternaryOps)?(this.current=this.newToken("TOP",a),this.pos+=a.length,this.column+=a.length,!0):!1};W.prototype.isName=function(){for(var a=this.pos,b=a;b<this.expression.length;b++){var d=this.expression.charAt(b);if(d.toUpperCase()===d.toLowerCase()&&(b===this.pos||"_"!==d&&("0">d||"9"<d)))break}return b>a?(a=this.expression.substring(a,b),this.current=this.newToken("TNAME",a),this.pos+=a.length,this.column+=a.length,
!0):!1};W.prototype.isWhitespace=function(){for(var a=!1,b=this.expression.charAt(this.pos);" "===b||"\t"===b||"\n"===b||"\r"===b;){a=!0;this.pos++;this.column++;"\n"===b&&(this.line++,this.column=0);if(this.pos>=this.expression.length)break;b=this.expression.charAt(this.pos)}return a};var na=/^[0-9a-f]{4}$/i;W.prototype.unescape=function(a){var b=a.indexOf("\\");if(0>b)return a;for(var d=a.substring(0,b);0<=b;){var c=a.charAt(++b);switch(c){case "'":d+="'";break;case '"':d+='"';break;case "\\":d+=
"\\";break;case "/":d+="/";break;case "b":d+="\b";break;case "f":d+="\f";break;case "n":d+="\n";break;case "r":d+="\r";break;case "t":d+="\t";break;case "u":c=a.substring(b+1,b+5);na.test(c)||this.parseError("Illegal escape sequence: \\u"+c);d+=String.fromCharCode(parseInt(c,16));b+=4;break;default:throw this.parseError('Illegal escape sequence: "\\'+c+'"');}++b;c=a.indexOf("\\",b);d+=a.substring(b,0>c?a.length:c);b=c}return d};W.prototype.isComment=function(){if("/"===this.expression.charAt(this.pos)&&
"*"===this.expression.charAt(this.pos+1)){var a=this.pos;this.pos=this.expression.indexOf("*/",this.pos)+2;1===this.pos&&(this.pos=this.expression.length);for(var a=this.expression.substring(a,this.pos),b=a.indexOf("\n");0<=b;)this.line++,this.column=a.length-b,b=a.indexOf("\n",b+1);return!0}return!1};W.prototype.isNumber=function(){for(var a=!1,b=this.pos,d=b,c=b,e=this.column,f=e,g=!1,k=!1,p;b<this.expression.length;)if(p=this.expression.charAt(b),"0"<=p&&"9">=p||!g&&"."===p)"."===p?g=!0:k=!0,b++,
e++,a=k;else break;a&&(c=b,f=e);if("e"===p||"E"===p){b++;e++;g=!0;for(k=!1;b<this.expression.length;){p=this.expression.charAt(b);if(!g||"+"!==p&&"-"!==p)if("0"<=p&&"9">=p)k=!0,g=!1;else break;else g=!1;b++;e++}k||(b=c,e=f)}a?(this.current=this.newToken("TNUMBER",parseFloat(this.expression.substring(d,b))),this.pos=b,this.column=e):(this.pos=c,this.column=f);return a};W.prototype.isOperator=function(){var a=this.expression.charAt(this.pos);if("+"===a||"-"===a||"*"===a||"/"===a||"%"===a||"^"===a||
"?"===a||":"===a||"."===a)this.current=this.newToken("TOP",a);else if("\u2219"===a||"\u2022"===a)this.current=this.newToken("TOP","*");else if(">"===a)"="===this.expression.charAt(this.pos+1)?(this.current=this.newToken("TOP",">="),this.pos++,this.column++):this.current=this.newToken("TOP",">");else if("<"===a)"="===this.expression.charAt(this.pos+1)?(this.current=this.newToken("TOP","<="),this.pos++,this.column++):this.current=this.newToken("TOP","<");else if("|"===a)if("|"===this.expression.charAt(this.pos+
1))this.current=this.newToken("TOP","||"),this.pos++,this.column++;else return!1;else if("="===a)if("="===this.expression.charAt(this.pos+1))this.current=this.newToken("TOP","=="),this.pos++,this.column++;else return!1;else if("!"===a)"="===this.expression.charAt(this.pos+1)?(this.current=this.newToken("TOP","!="),this.pos++,this.column++):this.current=this.newToken("TOP",a);else return!1;this.pos++;this.column++;return!0};W.prototype.parseError=function(a){throw Error("parse error ["+(this.line+
1)+":"+(this.column+1)+"]: "+a);};var ja={},ka={},la={};X.prototype.next=function(){this.current=this.nextToken;return this.nextToken=this.tokens.next()};X.prototype.tokenMatches=function(b,d){return"undefined"===typeof d?!0:Array.isArray(d)?0<=a(d,b.value):"function"===typeof d?d(b):b.value===d};X.prototype.save=function(){this.savedCurrent=this.current;this.savedNextToken=this.nextToken;this.tokens.save()};X.prototype.restore=function(){this.tokens.restore();this.current=this.savedCurrent;this.nextToken=
this.savedNextToken};X.prototype.accept=function(a,b){return this.nextToken.type===a&&this.tokenMatches(this.nextToken,b)?(this.next(),!0):!1};X.prototype.expect=function(a,b){if(!this.accept(a,b))throw Error("parse error ["+this.tokens.line+":"+this.tokens.column+"]: Expected "+(b||a));};X.prototype.parseAtom=function(a){if(this.accept("TNAME"))a.push(new b("IVAR",this.current.value));else if(this.accept("TNUMBER"))a.push(new b("INUMBER",this.current.value));else if(this.accept("TSTRING"))a.push(new b("INUMBER",
this.current.value));else if(this.accept("TPAREN","("))this.parseExpression(a),this.expect("TPAREN",")");else throw Error("unexpected "+this.nextToken);};X.prototype.parseExpression=function(a){this.parseConditionalExpression(a)};X.prototype.parseConditionalExpression=function(a){for(this.parseOrExpression(a);this.accept("TOP","?");){var d=[],c=[];this.parseConditionalExpression(d);this.expect("TOP",":");this.parseConditionalExpression(c);a.push(new b("IEXPR",d));a.push(new b("IEXPR",c));a.push(ha("?"))}};
X.prototype.parseOrExpression=function(a){for(this.parseAndExpression(a);this.accept("TOP","or");)this.parseAndExpression(a),a.push(ea("or"))};X.prototype.parseAndExpression=function(a){for(this.parseComparison(a);this.accept("TOP","and");)this.parseComparison(a),a.push(ea("and"))};X.prototype.parseComparison=function(a){for(this.parseAddSub(a);this.accept("TOP","== != < <= >= >".split(" "));){var b=this.current;this.parseAddSub(a);a.push(ea(b.value))}};X.prototype.parseAddSub=function(a){for(this.parseTerm(a);this.accept("TOP",
["+","-","||"]);){var b=this.current;this.parseTerm(a);a.push(ea(b.value))}};X.prototype.parseTerm=function(a){for(this.parseFactor(a);this.accept("TOP",["*","/","%"]);){var b=this.current;this.parseFactor(a);a.push(ea(b.value))}};X.prototype.parseFactor=function(a){var b=this.tokens.unaryOps;this.save();if(this.accept("TOP",function(a){return a.value in b}))if("-"!==this.current.value&&"+"!==this.current.value&&"TPAREN"===this.nextToken.type&&"("===this.nextToken.value)this.restore(),this.parseExponential(a);
else{var d=this.current;this.parseFactor(a);a.push(da(d.value))}else this.parseExponential(a)};X.prototype.parseExponential=function(a){for(this.parsePostfixExpression(a);this.accept("TOP","^");)this.parseFactor(a),a.push(ea("^"))};X.prototype.parsePostfixExpression=function(a){for(this.parseFunctionCall(a);this.accept("TOP","!");)a.push(da("!"))};X.prototype.parseFunctionCall=function(a){var d=this.tokens.unaryOps;if(this.accept("TOP",function(a){return a.value in d})){var c=this.current;this.parseAtom(a);
a.push(da(c.value))}else for(this.parseMemberExpression(a);this.accept("TPAREN","(");)this.accept("TPAREN",")")?a.push(new b("IFUNCALL",0)):(c=this.parseArgumentList(a),a.push(new b("IFUNCALL",c)))};X.prototype.parseArgumentList=function(a){for(var b=0;!this.accept("TPAREN",")");)for(this.parseExpression(a),++b;this.accept("TCOMMA");)this.parseExpression(a),++b;return b};X.prototype.parseMemberExpression=function(a){for(this.parseAtom(a);this.accept("TOP",".");)this.expect("TNAME"),a.push(new b("IMEMBER",
this.current.value))};ga.parse=function(a){return(new ga).parse(a)};ga.evaluate=function(a,b){return ga.parse(a).evaluate(b)};ga.prototype={parse:function(a){var b=[];a=new X(this,new W(a,this.unaryOps,this.binaryOps,this.ternaryOps,this.consts));a.parseExpression(b);a.expect("TEOF","EOF");return new c(b,this)},evaluate:function(a,b){return this.parse(a).evaluate(b)}};return{Parser:ga,Expression:c}})}),Tj=function(c){function b(){I(this,b);return P(this,(b.__proto__||Object.getPrototypeOf(b)).call(this))}
L(b,c);N(b,[{key:"_run",value:function(){if(!this.hasMetadata("expression"))console.warn('A filter of type ImageBlendExpressionFilter requires a blending expression.\nUse \'setMetadata("expression", "...")\' to set it.');else if(this.hasSameNcppInput()&&this.hasSameSizeInput())if(this.getNumberOfInputs()){for(var a=this.getInputCategories(),b=this._getInput(a[0]),c=b.getDataCopy(),e=(new Sj.Parser).parse(this.getMetadata("expression")),f=0;f<c.length;f++){for(var k={},l=0;l<a.length;l++)k[a[l]]=this._getInput(a[l]).getData()[f];
c[f]=e.evaluate(k)}this._addOutput(Q).setData(c,b.getWidth(),b.getHeight())}else console.warn("A filter of type ImageBlendExpressionFilter requires at least one input.")}}]);return b}(qa),Uj=function(c){function b(){I(this,b);var a=P(this,(b.__proto__||Object.getPrototypeOf(b)).call(this));a.addInputValidator(0,Q);a.setMetadata("filter",null);return a}L(b,c);N(b,[{key:"_run",value:function(){if(this.hasValidInput()){var a=this.getMetadata("filter");if(a){var b=this._getInput(0);b.getData();for(var c=
b.getNcpp(),e=b.getWidth(),f=b.getHeight(),k=new Q({width:e,height:f,color:Array(c).fill(0)}),l=k.getData(),m=a.length,n=a[0].length,r=Math.floor(n/2),u=Math.floor(m/2),p=e-r,f=f-u,t=r;t<p;t++)for(var q=u;q<f;q++)for(var w=(q*e+t)*c,x=0;x<n;x++)for(var v=0;v<m;v++)for(var A=b.getPixel({x:t+x-r,y:q+v-u}),F=a[v][x],C=0;C<c;C++)l[w+C]+=A[C]*F;this._output[0]=k}else console.warn("A filter must be specified using .setMetadata('filter', [[]])")}else console.warn("A filter of type SpatialConvolutionFilter requires 1 input of category '0' and one input of category '1'.")}}]);
return b}(qa),Vj=function(c){function b(){I(this,b);var a=P(this,(b.__proto__||Object.getPrototypeOf(b)).call(this));a.addInputValidator(0,Q);a.addInputValidator(1,Q);return a}L(b,c);N(b,[{key:"_run",value:function(){if(!this.hasValidInput())console.warn("A filter of type MultiplyImageFilter requires 1 input of category '0' and one input of category '1'.");else if(this.hasSameNcppInput()&&this.hasSameSizeInput()){for(var a=this._getInput(0),b=this._getInput(1).getData(),c=a.getDataCopy(),e=0;e<c.length;e++)c[e]*=
b[e];this._addOutput(Q).setData(c,a.getWidth(),a.getHeight())}}}]);return b}(qa),Wj=function(c){function b(){I(this,b);var a=P(this,(b.__proto__||Object.getPrototypeOf(b)).call(this));a.addInputValidator(0,Q);a.setMetadata("threshold",128);a.setMetadata("lowValue",0);a.setMetadata("highValue",255);a.setMetadata("preserveAlpha",!0);return a}L(b,c);N(b,[{key:"_run",value:function(){if(this.hasValidInput()){var a=this._getInput(0),b=a.clone(),c=a.getComponentsPerPixel(),a=this.getMetadata("threshold"),
e=this.getMetadata("lowValue"),f=this.getMetadata("highValue"),k=b.getData();if(1==c||3==c||4==c){if(this.getMetadata("preserveAlpha")&&4==c)for(c=0;c<k.length;c++)3!=c%4&&(k[c]=k[c]<a?e:f);else for(c=0;c<k.length;c++)k[c]=k[c]<a?e:f;this._output[0]=b}else console.warn("The input data must have 1, 3 or 4 components per pixel.")}}}]);return b}(qa),Xj=function(c){function b(){I(this,b);var a=P(this,(b.__proto__||Object.getPrototypeOf(b)).call(this));a.addInputValidator(0,Q);a.setMetadata("dxFilter",
[[1,-1]]);a.setMetadata("dyFilter",[[1],[-1]]);return a}L(b,c);N(b,[{key:"_run",value:function(){if(this.hasValidInput()){var a=this._getInput(0),b=this.getMetadata("dxFilter"),c=this.getMetadata("dyFilter"),e=new pixpipe.SpatialConvolutionFilter;e.addInput(a);e.setMetadata("filter",b);e.update();this._output.dx=e.getOutput();e.setMetadata("filter",c);e.update();this._output.dy=e.getOutput()}else console.warn("A filter of type ImageDerivativeFilter requires 1 input of category '0' and one input of category '1'.")}}]);
return b}(qa),Yj=function(c){function b(){I(this,b);var a=P(this,(b.__proto__||Object.getPrototypeOf(b)).call(this));a.addInputValidator("dx",Q);a.addInputValidator("dy",Q);return a}L(b,c);N(b,[{key:"_run",value:function(){if(!this.hasValidInput())console.warn("A filter of type GradientImageFilter requires 1 input of category 'dx' and 1 input of category 'dy'.");else if(this.hasSameSizeInput()&&this.hasSameNcppInput()){for(var a=this._getInput("dx"),b=a.getData(),c=this._getInput("dy").getData(),
e=a.hollowClone(),f=e.getData(),a=a.hollowClone(),k=a.getData(),l=Infinity,m=-Infinity,n=Infinity,r=-Infinity,u=0;u<b.length;u++)f[u]=Math.sqrt(b[u]*b[u]+c[u]*c[u]),isNaN(f[u])||(l=Math.min(l,f[u]),m=Math.max(m,f[u])),k[u]=Math.atan(c[u]/b[u]),isNaN(k[u])||(n=Math.min(n,k[u]),r=Math.max(r,k[u]));e.setMetadata("min",l);e.setMetadata("max",m);a.setMetadata("min",n);a.setMetadata("max",r);this._output.direction=a;this._output.magnitude=e}}}]);return b}(qa),Zj=function(c){function b(){I(this,b);var a=
P(this,(b.__proto__||Object.getPrototypeOf(b)).call(this));a.addInputValidator(0,Q);a.setMetadata("max",NaN);return a}L(b,c);N(b,[{key:"_run",value:function(){if(this.hasValidInput()){var a=this._input[0],b=a.getData(),c=a.hollowClone(),e=c.getData(),f=this.getMetadata("max");isNaN(f)&&(f=a.getMax());for(a=0;a<b.length;a++)e[a]=b[a]/f;this._output[0]=c}else console.warn("A filter of type */ requires 1 input of category '0'.")}}]);return b}(qa),me=function(c){function b(){I(this,b);var a=P(this,(b.__proto__||
Object.getPrototypeOf(b)).call(this));a.addInputValidator(0,Q);a.setMetadata("connexity",8);a.setMetadata("seed",[0,0]);a._directionListConnexity4=[[0,-1],[-1,0],[0,1],[1,0]];a._directionListConnexity8=[[0,-1],[-1,-1],[-1,0],[-1,1],[0,1],[1,1],[1,0],[1,-1]];return a}L(b,c);N(b,[{key:"_run",value:function(){function a(a,b){if(a.length!=b.length)return!1;for(var d=0;d<a.length;d++)if(a[d]!=b[d])return!1;return!0}function b(){x[0]=w[0]+k[n][0];x[1]=w[1]+k[n][1];if(0>x[0]||0>x[1]||x[0]>=e||x[1]>=f)return 2;
var b=c.getPixel({x:x[0],y:x[1]});if(a(b,r)){if(x[0]==v[0]&&x[1]==v[1])return 0;w[0]=x[0];w[1]=x[1];v.push(w[0]);v.push(w[1]);return 1}return 2}if(this.hasValidInput()){var c=this._getInput(0);c.getNcpp();var e=c.getWidth(),f=c.getHeight(),k=null,k=8==this.getMetadata("connexity")?this._directionListConnexity8:this._directionListConnexity4,l=this._metadata.seed.slice(),m=k.length/4,n=m;if(0>l[0]||0>l[1]||l[0]>=e||l[1]>=f)console.warn("The seed is out of image range.");else{for(var r=c.getPixel({x:l[0],
y:l[1]}),u=r,p=l.slice(),t=!1,u=0;u<this._directionListConnexity4.length;u++){var q=c.getPixel({x:l[0]+this._directionListConnexity4[u][0],y:l[1]+this._directionListConnexity4[u][1]});if(!a(q,r)){t=!0;n=u;8==this.getMetadata("connexity")&&(n*=2);n+=m;break}}for(;!t;){p[0]+=k[0][0];p[1]+=k[0][1];if(0>p[0]){l[0]=0;l[1]=p[1];break}if((u=c.getPixel({x:p[0],y:p[1]}))&&a(u,r))l[0]=p[0],l[1]=p[1];else break}var w=l.slice(),x=[0,0],v=[];v.push(l[0]);v.push(l[1]);a:for(;;)if(n-=m,0>n&&(n=k.length-m),l=b(),
0==l)break a;else if(1!=l){u=p=0;b:for(;u<k.length-1;u++)if(n++,n%=k.length,l=b(),0==l)break a;else if(1==l)break b;else p++;if(p==k.length-1)break}m=new Bc;m.setData(v);m.setMetadata("closed",!0);this._output[0]=m}}else console.warn("A filter of type AngleToHueWheelHelper requires 1 input of category '0'.")}}]);return b}(W),Ah=function(c){function b(){I(this,b);var a=P(this,(b.__proto__||Object.getPrototypeOf(b)).call(this));a.addInputValidator(0,Q);a.setMetadata("tolerance",1);a.setMetadata("connexity",
4);a.setMetadata("color",null);a.setMetadata("onlyHits",!1);a._directionListConnexity4=[[0,-1],[-1,0],[0,1],[1,0]];a._directionListConnexity8=[[0,-1],[-1,-1],[-1,0],[-1,1],[0,1],[1,1],[1,0],[1,-1]];return a}L(b,c);N(b,[{key:"_run",value:function(){if(this.hasValidInput()){var a=this._getInput(0),b=a.getNcpp(),c=a.getWidth(),e=a.getHeight(),f;f=8==this.getMetadata("connexity")?this._directionListConnexity8:this._directionListConnexity4;var k=Array(b);k[0]=255;k=this.getMetadata("color")||k;if(k.length==
b||3==k.length&&4==b){var b=new Q({width:c,height:e,color:[0]}),l=this.getMetadata("seed"),m=a.getPixel({x:l[0],y:l[1]}),n=this.getMetadata("tolerance"),r=this.getMetadata("onlyHits"),u=null;r||(u=a.clone());var p=[],t=[];for(t.push(l);0<t.length;){var l=t.pop(),q=l[0],w=l[1];if(!(0>q||q>=c||0>w||w>=e)&&0==b.getPixel({x:q,y:w})[0]){b.setPixel({x:q,y:w},[1]);r||u.setPixel({x:q,y:w},k);for(var x=[0,0],v=!1,A=0;A<f.length;A++)if(x[0]=q+f[A][0],x[1]=w+f[A][1],!(0>x[0]||x[0]>=c||0>x[1]||x[1]>=e)){for(var F=
a.getPixel({x:x[0],y:x[1]}),C=!0,z=0;z<m.length;z++)if(Math.abs(F[z]-m[z])>n){C=!1;v=!0;break}C&&t.push([x[0],x[1]])}v&&0!=q&&q!=c-1&&0!=w&&w!=e-1&&p.push(l)}}r||(this._output[0]=u);this._output.edgePoints=p}else console.warn("The color to fill must have the same number of components as the input image. (RGB color for RGBA image is accepted)")}else console.warn("A filter of type FloodFillImageFilter requires 1 input of category '0'.")}}]);return b}(qa),ak=function(c){function b(){I(this,b);var a=
P(this,(b.__proto__||Object.getPrototypeOf(b)).call(this));a.addInputValidator(0,Q);a.setMetadata("connexity",4);a.setMetadata("seed",[0,0]);return a}L(b,c);N(b,[{key:"_run",value:function(){if(this.hasValidInput()){var a=this._getInput(0);a.getNcpp();a.getWidth();a.getHeight();var b=[],c=this.getMetadata("connexity"),e=this.getMetadata("seed"),f=new me;f.addInput(a);f.setMetadata("connexity",c);f.setMetadata("seed",e);f.update();b.push(f.getOutput());f=new Ah;f.addInput(a);f.setMetadata("onlyHits",
!1);f.setMetadata("connexity",4);f.setMetadata("tolerance",0);f.setMetadata("seed",e);f.update();e=f.getOutput("edgePoints");f=new me;f.setMetadata("time",!1);for(var k=0;k<e.length;k++){for(var l=e[k],m=!1,n=0;n<b.length;n++)if(b[n].hasPoint(l)){m=!0;break}m||(f.addInput(a),f.setMetadata("connexity",c),f.setMetadata("seed",l),f.update(),b.push(f.getOutput()))}for(k=0;k<b.length;k++)this._output[k]=b[k]}else console.warn("A filter of type ContourHolesImage2DFilter requires 1 input of category '0'.")}}]);
return b}(W),bk=function(c){function b(){I(this,b);var a=P(this,(b.__proto__||Object.getPrototypeOf(b)).call(this));a.addInputValidator(0,Q);return a}L(b,c);N(b,[{key:"_run",value:function(){if(this.hasValidInput())if(this.hasEvent("pixel")){var a=this._getInput(0);a.getNcpp();for(var b=a.getWidth(),c=a.getHeight(),e=0;e<c;e++)for(var f=0;f<b;f++){var k={x:f,y:e},l=a.getPixel(k);this.triggerEvent("pixel",k,l)}}else console.warn("No function to apply per pixel was specified.");else console.warn("A filter of type ForEachPixelReadOnlyFilter requires 1 input of category '0'.")}}]);
return b}(W),ck=function(c){function b(){I(this,b);var a=P(this,(b.__proto__||Object.getPrototypeOf(b)).call(this));a.addInputValidator(0,Q);return a}L(b,c);N(b,[{key:"_run",value:function(){if(this.hasValidInput()){var a=this._getInput(0),b=a.getNcpp(),c=a.getWidth(),e=a.getHeight();if(3>b)console.warn("A filter of type TerrainRgbToElevationImageFilter requires an input with at least 3 components per pixel.");else{var f=new pixpipe.Image2D({width:c,height:e,color:[0]}),b=new pixpipe.ForEachPixelReadOnlyFilter;
b.addInput(a);b.on("pixel",function(a,b){f.setPixel(a,[-1E4+.1*(65536*b[0]+256*b[1]+b[2])])});b.update();this._output[0]=f}}else console.warn("A filter of type TerrainRgbToElevationImageFilter requires 1 input of category '0'.")}}]);return b}(qa),dk=function(c){function b(){I(this,b);var a=P(this,(b.__proto__||Object.getPrototypeOf(b)).call(this));a.setMetadata("outputSize",{width:0,height:0});return a}L(b,c);N(b,[{key:"_run",value:function(){var a;if("0"in this._input){a=this._input[0];var b=this.getMetadata("outputSize");
if(0==b.width||0==b.height)console.warn("The output size cannot be 0.");else{for(var c=new pixpipe.Image2D({width:b.width,height:b.height,color:[0]}),e=0;e<b.width;e++)for(var f=0;f<b.height;f++){for(var k=0,l=Infinity,m=0;m<a.length;m++){var n=Math.sqrt(Math.pow(a[m].x-e,2)+Math.pow(a[m].y-f,2));n<l&&(l=n,k=m)}c.setPixel({x:e,y:f},[a[k].value])}this._output[0]=c}}else console.warn("No input point set were given.")}}]);return b}(W),ek=function(c){function b(){I(this,b);var a=P(this,(b.__proto__||
Object.getPrototypeOf(b)).call(this));a.setMetadata("strength",2);a.setMetadata("k",5);a.setMetadata("forceBuildMap",!1);a.setMetadata("outputSize",{width:256,height:256});a._map=null;return a}L(b,c);N(b,[{key:"_run",value:function(){var a;if("0"in this._input){a=this._input[0];var b=this.getMetadata("outputSize");if(0==b.width||0==b.height)console.warn("The output size cannot be 0.");else{!this.getMetadata("forceBuildMap")&&this._map||this._buildMap();var c=new pixpipe.Image2D({width:b.width,height:b.height,
color:[0]}),e=this.getMetadata("strength"),f=Math.min(this.getMetadata("k"),a.length);console.time("make");for(var k=0;k<b.width;k++)for(var l=0;l<b.height;l++){for(var m=0,n=0,r=null,u=!1,p=this._map[k+l*b.width],t=0;t<f;t++){var q=p[t].distance,w=p[t].index;if(0==q){u=!0;r=a[w].value;break}q=1/Math.pow(q,e);m+=a[w].value*q;n+=q}c.setPixel({x:k,y:l},[u?r:m/n])}this._output[0]=c}}else console.warn("No input point set were given.")}},{key:"_buildMap",value:function(){var a=this.getMetadata("outputSize"),
b=this._input[0],c=Math.min(this.getMetadata("k"),b.length);this._map=Array(a.width*a.height);for(var e=0;e<a.width;e++)for(var f=0;f<a.height;f++){for(var k=e+f*a.width,l=Array(m),m=0;m<b.length;m++)l[m]={index:m,distance:Math.sqrt(Math.pow(b[m].x-e,2)+Math.pow(b[m].y-f,2))};l.sort(function(a,b){return a.distance<b.distance?-1:1});l=l.slice(0,c);this._map[k]=l}}}]);return b}(W),Bh=ma(function(c){var b;(function(){function a(a){var b=Number.POSITIVE_INFINITY,d=Number.POSITIVE_INFINITY,c=Number.NEGATIVE_INFINITY,
e=Number.NEGATIVE_INFINITY,f;for(f=a.length;f--;)a[f][0]<b&&(b=a[f][0]),a[f][0]>c&&(c=a[f][0]),a[f][1]<d&&(d=a[f][1]),a[f][1]>e&&(e=a[f][1]);a=c-b;c=e-d;e=Math.max(a,c);b+=.5*a;d+=.5*c;return[[b-20*e,d-e],[b,d+20*e],[b+20*e,d-e]]}function d(a,b,d,c){var f=a[b][0],g=a[b][1],k=a[d][0],p=a[d][1],l=a[c][0],m=a[c][1],q=Math.abs(g-p),x=Math.abs(p-m),v,A;if(q<e&&x<e)throw Error("Eek! Coincident points!");q<e?(a=(k+f)/2,q=-((l-k)/(m-p))*(a-(k+l)/2)+(p+m)/2):x<e?(a=(l+k)/2,q=-((k-f)/(p-g))*(a-(f+k)/2)+(g+
p)/2):(v=-((k-f)/(p-g)),A=-((l-k)/(m-p)),f=(f+k)/2,l=(k+l)/2,g=(g+p)/2,m=(p+m)/2,a=(v*f-A*l+m-g)/(v-A),q=q>x?v*(a-f)+g:A*(a-l)+m);k-=a;p-=q;return{i:b,j:d,k:c,x:a,y:q,r:k*k+p*p}}function g(a){var b,d,c,e,f,g;for(d=a.length;d;)for(e=a[--d],c=a[--d],b=d;b;)if(g=a[--b],f=a[--b],c===f&&e===g||c===g&&e===f){a.splice(d,2);a.splice(b,2);break}}var e=1/1048576;b={triangulate:function(b,c){var f=b.length,k,n,r,u,p,t,q,w;if(3>f)return[];b=b.slice(0);if(c)for(k=f;k--;)b[k]=b[k][c];c=Array(f);for(k=f;k--;)c[k]=
k;c.sort(function(a,d){var c=b[d][0]-b[a][0];return 0!==c?c:a-d});k=a(b);b.push(k[0],k[1],k[2]);r=[d(b,f+0,f+1,f+2)];u=[];p=[];for(k=c.length;k--;p.length=0){w=c[k];for(n=r.length;n--;)t=b[w][0]-r[n].x,0<t&&t*t>r[n].r?(u.push(r[n]),r.splice(n,1)):(q=b[w][1]-r[n].y,t*t+q*q-r[n].r>e||(p.push(r[n].i,r[n].j,r[n].j,r[n].k,r[n].k,r[n].i),r.splice(n,1)));g(p);for(n=p.length;n;)q=p[--n],t=p[--n],r.push(d(b,t,q,w))}for(k=r.length;k--;)u.push(r[k]);r.length=0;for(k=u.length;k--;)u[k].i<f&&u[k].j<f&&u[k].k<
f&&r.push(u[k].i,u[k].j,u[k].k);return r},contains:function(a,b){if(b[0]<a[0][0]&&b[0]<a[1][0]&&b[0]<a[2][0]||b[0]>a[0][0]&&b[0]>a[1][0]&&b[0]>a[2][0]||b[1]<a[0][1]&&b[1]<a[1][1]&&b[1]<a[2][1]||b[1]>a[0][1]&&b[1]>a[1][1]&&b[1]>a[2][1])return null;var d=a[1][0]-a[0][0],c=a[2][0]-a[0][0],e=a[1][1]-a[0][1],f=a[2][1]-a[0][1],g=d*f-c*e;if(0===g)return null;c=(f*(b[0]-a[0][0])-c*(b[1]-a[0][1]))/g;a=(d*(b[1]-a[0][1])-e*(b[0]-a[0][0]))/g;return 0>c||0>a||1<c+a?null:[c,a]}};c.exports=b})()}),fk=function(c){function b(){I(this,
b);var a=P(this,(b.__proto__||Object.getPrototypeOf(b)).call(this));a.setMetadata("outputSize",{width:0,height:0});return a}L(b,c);N(b,[{key:"_run",value:function(){function a(a,b,c){var d=[a[0]-b[0],a[1]-b[1]];b=[b[0]-c[0],b[1]-c[1]];c=[c[0]-a[0],c[1]-a[1]];a=Math.sqrt(b[0]*b[0]+b[1]*b[1]);c=Math.sqrt(c[0]*c[0]+c[1]*c[1]);d=Math.sqrt(d[0]*d[0]+d[1]*d[1]);b=(a+c+d)/2;return Math.sqrt(b*(b-a)*(b-c)*(b-d))}var b=null;if("0"in this._input){var b=this._input[0],c=this.getMetadata("outputSize");if(0==
c.width||0==c.height)console.warn("The output size cannot be 0.");else{for(var e=b.map(function(a){return[a.x,a.y]}),f=Bh.triangulate(e),k=[],l=0;l<=f.length-3;l+=3)k.push([f[l],f[l+1],f[l+2]]);console.log(e);console.log(k);f=new pixpipe.Image2D({width:Math.round(c.width),height:Math.round(c.height),color:[0]});for(l=0;l<c.width;l++)for(var m=0;m<c.height;m++){for(var n=0,r=!1,u=0,p=0;p<k.length;p++)if(Bh.contains([e[k[p][0]],e[k[p][1]],e[k[p][2]]],[l,m])){r=!0;u=k[p];break}if(r)var p=e[u[0]],t=e[u[1]],
q=e[u[2]],w=[l,m],n=a(p,t,q),r=a(p,t,w),t=a(t,q,w),p=a(q,p,w),n=r/n*b[u[2]].value+t/n*b[u[0]].value+p/n*b[u[1]].value;f.setPixel({x:l,y:m},[n])}this._output[0]=f}}else console.warn("No input point set were given.")}}]);return b}(W),gk=function(c){function b(){I(this,b);var a=P(this,(b.__proto__||Object.getPrototypeOf(b)).call(this));a.addInputValidator(0,Q);a.setMetadata("x",0);a.setMetadata("y",0);a.setMetadata("w",0);a.setMetadata("h",0);return a}L(b,c);N(b,[{key:"_run",value:function(){if(this.hasValidInput()){var a=
Math.round(this.getMetadata("x")),b=Math.round(this.getMetadata("y")),c=Math.round(this.getMetadata("w")),e=Math.round(this.getMetadata("h")),f=a+c,k=b+e,l=this._getInput(0),m=l.getWidth(),n=l.getHeight(),r=l.getNcpp();if(0>a||0>b||a>=m||b>=n||0>f||0>k||f>=m||k>=n)console.warn("The query area is out of bound");else{f=l.getData();r=new Q({width:c,height:e,color:new f.constructor(r)});for(f=0;f<c;f++)for(k=0;k<e;k++)m=l.getPixel({x:f+a,y:k+b}),r.setPixel({x:f,y:k},m);this._output[0]=r}}else console.warn("A filter of type CropImageFilter requires 1 input of category '0' (Image2D)")}}]);
return b}(qa),hk=ma(function(c){(function(){c.exports=function(b,a,c){a=void 0!==a?a*a:1;var d;if(c)d=b;else{c=b[0];for(var e=[c],f=1,k=b.length;f<k;f++){d=b[f];var l=d.x-c.x,m=d.y-c.y;l*l+m*m>a&&(e.push(d),c=d)}c!==d&&e.push(d);d=e}b=d.length;c=new ("undefined"!==typeof Uint8Array?Uint8Array:Array)(b);var e=0,f=b-1,k=[],l=[],n,r,u;for(c[e]=c[f]=1;f;){n=0;for(m=e+1;m<f;m++){r=d[m];var p=d[e],t=d[f],q=p.x,p=p.y,w=t.x-q,x=t.y-p;if(0!==w||0!==x){var v=((r.x-q)*w+(r.y-p)*x)/(w*w+x*x);1<v?(q=t.x,p=t.y):
0<v&&(q+=w*v,p+=x*v)}w=r.x-q;x=r.y-p;r=w*w+x*x;r>n&&(u=m,n=r)}n>a&&(c[u]=1,k.push(e,u,u,f));f=k.pop();e=k.pop()}for(m=0;m<b;m++)c[m]&&l.push(d[m]);return l}})()}),ik=function(c){function b(){I(this,b);var a=P(this,(b.__proto__||Object.getPrototypeOf(b)).call(this));a.addInputValidator(0,Bc);a.setMetadata("tolerance",.1);return a}L(b,c);N(b,[{key:"_run",value:function(){if(this.hasValidInput()){var a=this._getInput(0),b=a.getNod(),c=a.getData(),e=this.getMetadata("tolerance");if(2!=b)console.warn("SimplifyLineStringFilter is only for 2D LineStrings.");
else{for(var f=Array(c.length/2),k=0;k<f.length;k++)f[k]={x:c[2*k],y:c[2*k+1]};e=hk(f,e,!0);c=Array(2*e.length);for(k=0;k<e.length-1;k++)c[2*k]=e[k].x,c[2*k+1]=e[k+1].y;k=new Bc;k.setData(c,b);k.copyMetadataFrom(a);this._output[0]=k}}else console.warn("A filter of type SimplifyLineStringFilter requires 1 input of category '0' (LineString)")}}]);return b}(W),Ch=function(c){function b(){I(this,b);var a=P(this,(b.__proto__||Object.getPrototypeOf(b)).call(this));a.addInputValidator(0,Q);a.setMetadata("outputSize",
{w:0,h:0});a.setMetadata("outputColor",[0,0,0,255]);a.setMetadata("patchPosition",{x:0,y:0});a.setMetadata("resetOutput",!0);a._patchedOutput=null;return a}L(b,c);N(b,[{key:"_run",value:function(){if(this.hasValidInput()){var a=this._getInput(0),b=a.getNcpp(),c=a.getWidth(),e=a.getHeight(),f=this.getMetadata("outputSize");if(0==f.w||0==f.h)console.warn("The output image cannot have a size of (0, 0). Use .setMetadata( 'outputSize', {w: Number, h:Number} ) to specify a size.");else{var k=this.getMetadata("outputColor");
if(Array.isArray(k)){var l=k.length;if(b!=l)console.warn("The Image2D specified in input has "+b+" ncpp while the output is configured with "+l+" ncpp. Unable to continue patching.");else{this.getMetadata("resetOutput")&&(this._patchedOutput=new pixpipe.Image2D({width:f.w,height:f.h,color:k}));this._output[0]=this._patchedOutput;b=this.getMetadata("patchPosition");b.x=Math.round(b.x);b.y=Math.round(b.y);(b.x+c>f.w||b.y+e>f.h||0>b.x||0>b.y)&&console.warn("The patch is partly or totaly out of bound.");
for(f=0;f<c;f++)for(k=0;k<e;k++)l=a.getPixel({x:f,y:k}),this._patchedOutput.setPixel({x:f+b.x,y:k+b.y},l);this.setMetadata("resetOutput",!1)}}else console.warn("The filter metadata 'outputColor' must be an Array of non null size.")}}else console.warn("A filter of type PatchImageFilter requires 1 input of category '0' (Image2D)")}}]);return b}(qa),jk=function(){function c(b,a){for(var c=0;c<a.length;c++){var g=a[c];g.enumerable=g.enumerable||!1;g.configurable=!0;"value"in g&&(g.writable=!0);Object.defineProperty(b,
g.key,g)}}return function(b,a,d){a&&c(b.prototype,a);d&&c(b,d);return b}}(),kk=function(){function c(){if(!(this instanceof c))throw new TypeError("Cannot call a class as a function");this._bCoefficients=this._aCoefficients=this._outputSignal=this._inputSignal=null;this._enableBackwardSecondPass=!1}jk(c,[{key:"setInput",value:function(b){this._outputSignal=null;this._inputSignal=b}},{key:"setACoefficients",value:function(b){this._aCoefficients=b}},{key:"setBCoefficients",value:function(b){this._bCoefficients=
b}},{key:"getOutput",value:function(){return this._outputSignal}},{key:"enableBackwardSecondPass",value:function(){this._enableBackwardSecondPass=!0}},{key:"disableBackwardSecondPass",value:function(){this._enableBackwardSecondPass=!1}},{key:"run",value:function(){function b(a){for(var b=0,d=0;d<=k;d++)var p=d>a?0:c[a-d],b=b+e[d]*p;for(var d=0,m=1;m<=l;m++)p=m>a?0:g[a-m],d+=f[m]*p;return b-d}for(var a=(new Float32Array(this._inputSignal.length)).fill(0),c=this._inputSignal,g=a,e=this._bCoefficients,
f=this._aCoefficients,k=e.length-1,l=f.length-1,m=0;m<a.length;m++)a[m]=b(m);if(this._enableBackwardSecondPass){a.reverse();c=a;g=a=(new Float32Array(this._inputSignal.length)).fill(0);for(m=0;m<a.length;m++)a[m]=b(m);a.reverse()}this._outputSignal=a}}]);return c}(),lk=function(c){function b(){I(this,b);var a=P(this,(b.__proto__||Object.getPrototypeOf(b)).call(this));a.addInputValidator(0,ua);a.setMetadata("coefficientsB",null);a.setMetadata("coefficientsA",null);a.setMetadata("enableBackwardSecondPass",
!0);return a}L(b,c);N(b,[{key:"_run",value:function(){if(this.hasValidInput()){var a=this._getInput(0),b=this.getMetadata("coefficientsB"),c=this.getMetadata("coefficientsA"),e=this.getMetadata("enableBackwardSecondPass");if(c&&b)if(c.length!=b.length)console.warn("The 'coefficientsB' and 'coefficientsA' metadata must be arrays of the same size.");else{var f=new kk;e&&f.enableBackwardSecondPass();f.setInput(a.getData());f.setACoefficients(c);f.setBCoefficients(b);f.run();if(b=f.getOutput())c=new ua,
c.copyMetadataFrom(a),c.setData(b),this._output[0]=c}else console.warn("Both 'coefficientsB' and 'coefficientsA' metadata must be set to arrays of numbers.")}}}]);return b}(W),Dh=function(){function c(){I(this,c)}N(c,null,[{key:"gaussianFrequencyResponse",value:function(b,a,d){for(var g=3<arguments.length&&void 0!==arguments[3]?arguments[3]:1,e=4<arguments.length&&void 0!==arguments[4]?arguments[4]:0,f=[],k=!1,l=Infinity,m=-Infinity,n=a;n<=d;n+=g){var q=c.gaussianFrequencyResponseSingle(b,n);if(q>
e)k||(l=n,k=!0),f.push(q),m=n;else if(k)break}return{data:new Float32Array(f),actualBegin:l,actualEnd:m}}},{key:"gaussianFrequencyResponseSingle",value:function(b,a){return Math.exp(-(a*a/(2*b*b)))}}]);return c}(),Eh=["gaussian","rectangular"],Fh=function(c){function b(){I(this,b);var a=P(this,(b.__proto__||Object.getPrototypeOf(b)).call(this));a.addInputValidator("real",ua);a.addInputValidator("imaginary",ua);a.setMetadata("cutoffFrequency",0);a.setMetadata("filterType","gaussian");a.setMetadata("gaussianTolerance",
.01);return a}L(b,c);N(b,[{key:"_run",value:function(){if(this.hasValidInput()){var a=this._getInput("real"),b=this._getInput("imaginary"),c=this.getMetadata("cutoffFrequency"),e=this.getMetadata("filterType");0==c?console.warn("The cutoff frequency cannot be 0."):-1==Eh.indexOf(e)?console.warn("The filter type must be one of: "+Eh.join(", ")):(a=a.clone(),b=b.clone(),this["_"+e](a,b,c)&&(this._output.real=a,this._output.imaginary=b))}else console.warn("A filter of type LowPassFreqSignal1D requires 2 input of type Signal1D and of category: 'real' and 'imaginary'.")}},
{key:"_getDataIndexFromFrequency",value:function(a,b){return Math.round(b*a.getData().length/a.getMetadata("samplingFrequency"))}},{key:"_rectangular",value:function(a,b,c){a.getMetadata("samplingFrequency");c=this._getDataIndexFromFrequency(a,c);a=a.getData();b=b.getData();for(var d=c;d<a.length-c;d++)a[d]=0,b[d]=0;return!0}},{key:"_gaussian",value:function(a,b,c){a.getMetadata("samplingFrequency");var d=this._getDataIndexFromFrequency(a,c);a=a.getData();b=b.getData();var f=a.length,g=Math.floor(f/
2),l=this.getMetadata("gaussianTolerance");c=Dh.gaussianFrequencyResponse(c,0,Math.floor(b.length/2),c/d,l).data;for(d=0;d<c.length&&!(d>=g);d++)a[d]*=c[d],b[d]*=c[d],a[f-1-d]*=c[d],b[f-1-d]*=c[d];try{var m=new Float32Array(a.length-2*c.length);a.set(m,c.length);b.set(m,c.length)}catch(n){}return!0}}]);return b}(W),Gh=function(c){function b(){I(this,b);var a=P(this,(b.__proto__||Object.getPrototypeOf(b)).call(this));a.addInputValidator(0,ua);a.setMetadata("cutoffFrequency",0);a.setMetadata("filterType",
"gaussian");a.setMetadata("gaussianTolerance",.01);return a}L(b,c);N(b,[{key:"_run",value:function(){if(this.hasValidInput()){var a=this._getInput(),b=a.getMetadata("samplingFrequency"),c=this.getMetadata("cutoffFrequency"),e=this.getMetadata("filterType"),f=this.getMetadata("gaussianTolerance");if(c>b/2)console.warn("The cutoff frequency cannot be greater than half of the sampling frequency (cf. Nyquist).");else{var k=a.hollowClone(),b=new yh;b.addInput(a,0);b.addInput(k,1);b.update();a=b.getOutput(0);
k=b.getOutput(1);b=new Fh;b.addInput(a,"real");b.addInput(k,"imaginary");b.setMetadata("filterType",e);b.setMetadata("cutoffFrequency",c);b.setMetadata("gaussianTolerance",f);b.update();c=b.getOutput("real");e=b.getOutput("imaginary");f=new pixpipe.InverseFourierSignalFilter;f.addInput(c,0);f.addInput(e,1);f.update();(c=f.getOutput())&&(this._output[0]=c)}}else console.warn("A filter of type LowPassSignal1D requires 1 input of type Signal1D and of category 0")}}]);return b}(W),mk=function(c){function b(){I(this,
b);var a=P(this,(b.__proto__||Object.getPrototypeOf(b)).call(this));a.addInputValidator(0,ua);a.setMetadata("cutoffFrequency",0);a.setMetadata("filterType","gaussian");a.setMetadata("gaussianTolerance",.01);return a}L(b,c);N(b,[{key:"_run",value:function(){if(this.hasValidInput()){var a=this._getInput(),b=a.getMetadata("samplingFrequency"),c=this.getMetadata("cutoffFrequency"),e=this.getMetadata("filterType"),f=this.getMetadata("gaussianTolerance");if(c>b/2)console.warn("The cutoff frequency cannot be greater than half of the sampling frequency (cf. Nyquist).");
else if(b=new Gh,b.setMetadata("cutoffFrequency",c),b.setMetadata("filterType",e),b.setMetadata("gaussianTolerance",f),b.addInput(a),b.update(),e=b.getOutput()){a=a.clone();c=a.getData();e=e.getData();for(f=0;f<c.length;f++)c[f]-=e[f];this._output[0]=a}else console.warn("couldnt compute the low pass filter.")}else console.warn("A filter of type HighPassSignal1D requires 1 input of type Signal1D and of category 0")}}]);return b}(W),nk=function(c){function b(){I(this,b);var a=P(this,(b.__proto__||Object.getPrototypeOf(b)).call(this));
a.addInputValidator(0,ua);a.setMetadata("hiCutoffFrequency",0);a.setMetadata("loCutoffFrequency",0);a.setMetadata("filterType","gaussian");a.setMetadata("gaussianTolerance",.01);return a}L(b,c);N(b,[{key:"_run",value:function(){if(this.hasValidInput()){var a=this._getInput(),b=a.getMetadata("samplingFrequency"),c=this.getMetadata("hiCutoffFrequency"),e=this.getMetadata("loCutoffFrequency"),f=this.getMetadata("filterType"),k=this.getMetadata("gaussianTolerance");0===c&&0===e?console.warn("At least one of the following metadata must be greater than zero: hiCutoffFrequency loCutoffFrequency"):
c>b/2||e>b/2?console.warn("The cutoff frequency cannot be greater than half of the sampling frequency (cf. Nyquist)."):0<e&&0<c&&c>e?console.warn("Band pass filter: the hiCutoffFrequency cannot be greater than the loCutoffFrequency."):(b=null,0<e&&(b=new pixpipe.LowPassSignal1D,b.addInput(a),b.setMetadata("cutoffFrequency",e),b.setMetadata("filterType",f),b.setMetadata("gaussianTolerance",k),b.update(),b=b.getOutput()),0<c&&(e=new pixpipe.HighPassSignal1D,e.addInput(b||a),e.setMetadata("cutoffFrequency",
c),e.setMetadata("filterType",f),e.setMetadata("gaussianTolerance",k),e.update(),b=e.getOutput()),this._output[0]=b)}else console.warn("A filter of type BandPassSignal1D requires 1 input of type Signal1D and of category 0")}}]);return b}(W),ok=function(c){function b(){I(this,b);var a=P(this,(b.__proto__||Object.getPrototypeOf(b)).call(this));a.addInputValidator("mesh",Cc);a.setMetadata("voidValue",0);a.setMetadata("hullValue",254);a.setMetadata("resolutionStep",1);a.setMetadata("margin",1);return a}
L(b,c);N(b,[{key:"_run",value:function(){if(this.hasValidInput()){for(var a=this._getInput("mesh"),b=a.getBox(),c=this.getMetadata("resolutionStep"),e=1/c,f=this.getMetadata("margin"),k=[Math.floor(b.min[0]-f),Math.floor(b.min[1]-f),Math.floor(b.min[2]-f)],l=[Math.ceil(b.max[0]+f),Math.ceil(b.max[1]+f),Math.ceil(b.max[2]+f)],m=l[0]-k[0],n=l[1]-k[1],q=l[2]-k[2],b=[],u=[0,0,1],p=k[0];p<l[0];p+=c)for(var t=k[1];t<l[1];t+=c)for(var f=[p,t,0],y=a.intersectRay(f,u),f=0;f<y.length;f++)b.push(y[f].intersectionPoint);
u=[1,0,0];for(t=k[1];t<l[1];t+=c)for(var w=k[2];w<l[2];w+=c)for(f=[0,t,w],y=a.intersectRay(f,u),f=0;f<y.length;f++)b.push(y[f].intersectionPoint);u=[0,1,0];for(p=k[0];p<l[0];p+=c)for(w=k[2];w<l[2];w+=c)for(f=[p,0,w],y=a.intersectRay(f,u),f=0;f<y.length;f++)b.push(y[f].intersectionPoint);a=new Ta({xSize:m*e,ySize:n*e,zSize:q*e,tSize:1,ncpp:1});f=this.getMetadata("voidValue");l=this.getMetadata("hullValue");a.resetData(f);f=[e,0,0,0,0,e,0,0,0,0,e,0,-k[0]*e,-k[1]*e,-k[2]*e,1];a.addTransformation([c,
0,0,0,0,c,0,0,0,0,c,0,k[0],k[1],k[2],1],"v2w");a.addTransformation(f,"w2v");f=a.getMetadata("dimensions");f[0].step=f[0].worldStep=f[0].worldUnitSize=c;f[1].step=f[1].worldStep=f[1].worldUnitSize=c;f[2].step=f[2].worldStep=f[2].worldUnitSize=c;for(f=0;f<b.length;f++)c=b[f],a.setVoxel({i:Math.round((c.z-k[2])*e),j:Math.round((c.y-k[1])*e),k:Math.round((c.x-k[0])*e)},l);this._output[0]=a}else console.warn("A filter of type Mesh3DToVolumetricHullFilter requires 1 input of category 'mesh' of type Mesh3D")}}]);
return b}(W),ne=ma(function(c,b){function a(a){return Array.isArray(a)?{x:a[0],y:a[1]}:a}Object.defineProperty(b,"__esModule",{value:!0});var d=function(a,b){return b={exports:{}},a(b,b.exports),b.exports}(function(a){function b(){this.toRecycle=this.cells=this.edges=this.vertices=null;this.beachsectionJunkyard=[];this.circleEventJunkyard=[];this.vertexJunkyard=[];this.edgeJunkyard=[];this.cellJunkyard=[]}b.prototype.reset=function(){this.beachline||(this.beachline=new this.RBTree);if(this.beachline.root)for(var a=
this.beachline.getFirst(this.beachline.root);a;)this.beachsectionJunkyard.push(a),a=a.rbNext;this.beachline.root=null;this.circleEvents||(this.circleEvents=new this.RBTree);this.circleEvents.root=this.firstCircleEvent=null;this.vertices=[];this.edges=[];this.cells=[]};b.prototype.sqrt=Math.sqrt;b.prototype.abs=Math.abs;b.prototype.\u03b5=b.\u03b5=1E-9;b.prototype.inv\u03b5=b.inv\u03b5=1/b.\u03b5;b.prototype.equalWithEpsilon=function(a,b){return 1E-9>this.abs(a-b)};b.prototype.greaterThanWithEpsilon=
function(a,b){return 1E-9<a-b};b.prototype.greaterThanOrEqualWithEpsilon=function(a,b){return 1E-9>b-a};b.prototype.lessThanWithEpsilon=function(a,b){return 1E-9<b-a};b.prototype.lessThanOrEqualWithEpsilon=function(a,b){return 1E-9>a-b};b.prototype.RBTree=function(){this.root=null};b.prototype.RBTree.prototype.rbInsertSuccessor=function(a,b){var c;if(a){b.rbPrevious=a;if(b.rbNext=a.rbNext)a.rbNext.rbPrevious=b;a.rbNext=b;if(a.rbRight){for(a=a.rbRight;a.rbLeft;)a=a.rbLeft;a.rbLeft=b}else a.rbRight=
b;c=a}else this.root?(a=this.getFirst(this.root),b.rbPrevious=null,b.rbNext=a,a.rbPrevious=b,a.rbLeft=b,c=a):(b.rbPrevious=b.rbNext=null,this.root=b,c=null);b.rbLeft=b.rbRight=null;b.rbParent=c;b.rbRed=!0;var d;for(a=b;c&&c.rbRed;)b=c.rbParent,c===b.rbLeft?(d=b.rbRight)&&d.rbRed?(c.rbRed=d.rbRed=!1,b.rbRed=!0,a=b):(a===c.rbRight&&(this.rbRotateLeft(c),a=c,c=a.rbParent),c.rbRed=!1,b.rbRed=!0,this.rbRotateRight(b)):(d=b.rbLeft)&&d.rbRed?(c.rbRed=d.rbRed=!1,b.rbRed=!0,a=b):(a===c.rbLeft&&(this.rbRotateRight(c),
a=c,c=a.rbParent),c.rbRed=!1,b.rbRed=!0,this.rbRotateLeft(b)),c=a.rbParent;this.root.rbRed=!1};b.prototype.RBTree.prototype.rbRemoveNode=function(a){a.rbNext&&(a.rbNext.rbPrevious=a.rbPrevious);a.rbPrevious&&(a.rbPrevious.rbNext=a.rbNext);a.rbNext=a.rbPrevious=null;var b=a.rbParent,c=a.rbLeft,d=a.rbRight,e;e=c?d?this.getFirst(d):c:d;b?b.rbLeft===a?b.rbLeft=e:b.rbRight=e:this.root=e;var f;c&&d?(f=e.rbRed,e.rbRed=a.rbRed,e.rbLeft=c,c.rbParent=e,e!==d?(b=e.rbParent,e.rbParent=a.rbParent,a=e.rbRight,
b.rbLeft=a,e.rbRight=d,d.rbParent=e):(e.rbParent=b,b=e,a=e.rbRight)):(f=a.rbRed,a=e);a&&(a.rbParent=b);if(!f)if(a&&a.rbRed)a.rbRed=!1;else{do{if(a===this.root)break;if(a===b.rbLeft){if(a=b.rbRight,a.rbRed&&(a.rbRed=!1,b.rbRed=!0,this.rbRotateLeft(b),a=b.rbRight),a.rbLeft&&a.rbLeft.rbRed||a.rbRight&&a.rbRight.rbRed){a.rbRight&&a.rbRight.rbRed||(a.rbLeft.rbRed=!1,a.rbRed=!0,this.rbRotateRight(a),a=b.rbRight);a.rbRed=b.rbRed;b.rbRed=a.rbRight.rbRed=!1;this.rbRotateLeft(b);a=this.root;break}}else if(a=
b.rbLeft,a.rbRed&&(a.rbRed=!1,b.rbRed=!0,this.rbRotateRight(b),a=b.rbLeft),a.rbLeft&&a.rbLeft.rbRed||a.rbRight&&a.rbRight.rbRed){a.rbLeft&&a.rbLeft.rbRed||(a.rbRight.rbRed=!1,a.rbRed=!0,this.rbRotateLeft(a),a=b.rbLeft);a.rbRed=b.rbRed;b.rbRed=a.rbLeft.rbRed=!1;this.rbRotateRight(b);a=this.root;break}a.rbRed=!0;a=b;b=b.rbParent}while(!a.rbRed);a&&(a.rbRed=!1)}};b.prototype.RBTree.prototype.rbRotateLeft=function(a){var b=a.rbRight,c=a.rbParent;c?c.rbLeft===a?c.rbLeft=b:c.rbRight=b:this.root=b;b.rbParent=
c;a.rbParent=b;a.rbRight=b.rbLeft;a.rbRight&&(a.rbRight.rbParent=a);b.rbLeft=a};b.prototype.RBTree.prototype.rbRotateRight=function(a){var b=a.rbLeft,c=a.rbParent;c?c.rbLeft===a?c.rbLeft=b:c.rbRight=b:this.root=b;b.rbParent=c;a.rbParent=b;a.rbLeft=b.rbRight;a.rbLeft&&(a.rbLeft.rbParent=a);b.rbRight=a};b.prototype.RBTree.prototype.getFirst=function(a){for(;a.rbLeft;)a=a.rbLeft;return a};b.prototype.RBTree.prototype.getLast=function(a){for(;a.rbRight;)a=a.rbRight;return a};b.prototype.Diagram=function(a){this.site=
a};b.prototype.Cell=function(a){this.site=a;this.halfedges=[];this.closeMe=!1};b.prototype.Cell.prototype.init=function(a){this.site=a;this.halfedges=[];this.closeMe=!1;return this};b.prototype.createCell=function(a){var b=this.cellJunkyard.pop();return b?b.init(a):new this.Cell(a)};b.prototype.Cell.prototype.prepareHalfedges=function(){for(var a=this.halfedges,b=a.length,c;b--;)c=a[b].edge,c.vb&&c.va||a.splice(b,1);a.sort(function(a,b){return b.angle-a.angle});return a.length};b.prototype.Cell.prototype.getNeighborIds=
function(){for(var a=[],b=this.halfedges.length,c;b--;)c=this.halfedges[b].edge,null!==c.lSite&&c.lSite.voronoiId!=this.site.voronoiId?a.push(c.lSite.voronoiId):null!==c.rSite&&c.rSite.voronoiId!=this.site.voronoiId&&a.push(c.rSite.voronoiId);return a};b.prototype.Cell.prototype.getBbox=function(){for(var a=this.halfedges,b=a.length,c=Infinity,d=Infinity,e=-Infinity,f=-Infinity,g,k;b--;)g=a[b].getStartpoint(),k=g.x,g=g.y,k<c&&(c=k),g<d&&(d=g),k>e&&(e=k),g>f&&(f=g);return{x:c,y:d,width:e-c,height:f-
d}};b.prototype.Cell.prototype.pointIntersection=function(a,b){for(var c=this.halfedges,d=c.length,e,f;d--;){e=c[d];f=e.getStartpoint();e=e.getEndpoint();f=(b-f.y)*(e.x-f.x)-(a-f.x)*(e.y-f.y);if(!f)return 0;if(0<f)return-1}return 1};b.prototype.Vertex=function(a,b){this.x=a;this.y=b};b.prototype.Edge=function(a,b){this.lSite=a;this.rSite=b;this.va=this.vb=null};b.prototype.Halfedge=function(a,b,c){this.site=b;this.edge=a;if(c)this.angle=Math.atan2(c.y-b.y,c.x-b.x);else{c=a.va;var d=a.vb;this.angle=
a.lSite===b?Math.atan2(d.x-c.x,c.y-d.y):Math.atan2(c.x-d.x,d.y-c.y)}};b.prototype.createHalfedge=function(a,b,c){return new this.Halfedge(a,b,c)};b.prototype.Halfedge.prototype.getStartpoint=function(){return this.edge.lSite===this.site?this.edge.va:this.edge.vb};b.prototype.Halfedge.prototype.getEndpoint=function(){return this.edge.lSite===this.site?this.edge.vb:this.edge.va};b.prototype.createVertex=function(a,b){var c=this.vertexJunkyard.pop();c?(c.x=a,c.y=b):c=new this.Vertex(a,b);this.vertices.push(c);
return c};b.prototype.createEdge=function(a,b,c,d){var e=this.edgeJunkyard.pop();e?(e.lSite=a,e.rSite=b,e.va=e.vb=null):e=new this.Edge(a,b);this.edges.push(e);c&&this.setEdgeStartpoint(e,a,b,c);d&&this.setEdgeEndpoint(e,a,b,d);this.cells[a.voronoiId].halfedges.push(this.createHalfedge(e,a,b));this.cells[b.voronoiId].halfedges.push(this.createHalfedge(e,b,a));return e};b.prototype.createBorderEdge=function(a,b,c){var d=this.edgeJunkyard.pop();d?(d.lSite=a,d.rSite=null):d=new this.Edge(a,null);d.va=
b;d.vb=c;this.edges.push(d);return d};b.prototype.setEdgeStartpoint=function(a,b,c,d){a.va||a.vb?a.lSite===c?a.vb=d:a.va=d:(a.va=d,a.lSite=b,a.rSite=c)};b.prototype.setEdgeEndpoint=function(a,b,c,d){this.setEdgeStartpoint(a,c,b,d)};b.prototype.Beachsection=function(){};b.prototype.createBeachsection=function(a){var b=this.beachsectionJunkyard.pop();b||(b=new this.Beachsection);b.site=a;return b};b.prototype.leftBreakPoint=function(a,b){var c=a.site,d=c.x,e=c.y,f=e-b;if(!f)return d;a=a.rbPrevious;
if(!a)return-Infinity;c=a.site;a=c.x;c=c.y;b=c-b;if(!b)return a;var g=a-d,k=1/f-1/b,l=g/b;return k?(-l+this.sqrt(l*l-2*k*(g*g/(-2*b)-c+b/2+e-f/2)))/k+d:(d+a)/2};b.prototype.rightBreakPoint=function(a,b){var c=a.rbNext;if(c)return this.leftBreakPoint(c,b);a=a.site;return a.y===b?a.x:Infinity};b.prototype.detachBeachsection=function(a){this.detachCircleEvent(a);this.beachline.rbRemoveNode(a);this.beachsectionJunkyard.push(a)};b.prototype.removeBeachsection=function(a){var b=a.circleEvent,c=b.x,d=b.ycenter,
b=this.createVertex(c,d),e=a.rbPrevious,f=a.rbNext,g=[a],k=Math.abs;this.detachBeachsection(a);for(a=e;a.circleEvent&&1E-9>k(c-a.circleEvent.x)&&1E-9>k(d-a.circleEvent.ycenter);)e=a.rbPrevious,g.unshift(a),this.detachBeachsection(a),a=e;g.unshift(a);this.detachCircleEvent(a);for(e=f;e.circleEvent&&1E-9>k(c-e.circleEvent.x)&&1E-9>k(d-e.circleEvent.ycenter);)f=e.rbNext,g.push(e),this.detachBeachsection(e),e=f;g.push(e);this.detachCircleEvent(e);c=g.length;for(d=1;d<c;d++)e=g[d],a=g[d-1],this.setEdgeStartpoint(e.edge,
a.site,e.site,b);a=g[0];e=g[c-1];e.edge=this.createEdge(a.site,e.site,void 0,b);this.attachCircleEvent(a);this.attachCircleEvent(e)};b.prototype.addBeachsection=function(a){for(var b=a.x,c=a.y,d,e,f,g,k=this.beachline.root;k;)if(f=this.leftBreakPoint(k,c)-b,1E-9<f)k=k.rbLeft;else if(g=b-this.rightBreakPoint(k,c),1E-9<g){if(!k.rbRight){d=k;break}k=k.rbRight}else{-1E-9<f?(d=k.rbPrevious,e=k):-1E-9<g?(d=k,e=k.rbNext):d=e=k;break}b=this.createBeachsection(a);this.beachline.rbInsertSuccessor(d,b);if(d||
e)if(d===e)this.detachCircleEvent(d),e=this.createBeachsection(d.site),this.beachline.rbInsertSuccessor(b,e),b.edge=e.edge=this.createEdge(d.site,b.site),this.attachCircleEvent(d),this.attachCircleEvent(e);else if(d&&!e)b.edge=this.createEdge(d.site,b.site);else if(d!==e){this.detachCircleEvent(d);this.detachCircleEvent(e);c=d.site;g=c.x;var k=c.y,l=a.x-g,m=a.y-k;f=e.site;var p=f.x-g,n=f.y-k,q=2*(l*n-m*p),r=l*l+m*m,u=p*p+n*n;g=this.createVertex((n*r-m*u)/q+g,(l*u-p*r)/q+k);this.setEdgeStartpoint(e.edge,
c,f,g);b.edge=this.createEdge(c,a,void 0,g);e.edge=this.createEdge(a,f,void 0,g);this.attachCircleEvent(d);this.attachCircleEvent(e)}};b.prototype.CircleEvent=function(){this.rbPrevious=this.rbParent=this.rbNext=this.rbLeft=this.arc=null;this.rbRed=!1;this.site=this.rbRight=null;this.x=this.y=this.ycenter=0};b.prototype.attachCircleEvent=function(a){var b=a.rbPrevious,c=a.rbNext;if(b&&c){var d=b.site,b=a.site,e=c.site;if(d!==e){var c=b.x,f=b.y,g=d.x-c,k=d.y-f,d=e.x-c,l=e.y-f,e=2*(g*l-k*d);if(!(-2E-12<=
e)){var m=g*g+k*k,p=d*d+l*l,k=(l*m-k*p)/e,g=(g*p-d*m)/e,d=g+f;(f=this.circleEventJunkyard.pop())||(f=new this.CircleEvent);f.arc=a;f.site=b;f.x=k+c;f.y=d+this.sqrt(k*k+g*g);f.ycenter=d;a.circleEvent=f;a=null;for(b=this.circleEvents.root;b;)if(f.y<b.y||f.y===b.y&&f.x<=b.x)if(b.rbLeft)b=b.rbLeft;else{a=b.rbPrevious;break}else if(b.rbRight)b=b.rbRight;else{a=b;break}this.circleEvents.rbInsertSuccessor(a,f);a||(this.firstCircleEvent=f)}}}};b.prototype.detachCircleEvent=function(a){var b=a.circleEvent;
b&&(b.rbPrevious||(this.firstCircleEvent=b.rbNext),this.circleEvents.rbRemoveNode(b),this.circleEventJunkyard.push(b),a.circleEvent=null)};b.prototype.connectEdge=function(a,b){var c=a.vb;if(c)return!0;var d=a.va,c=b.xl,e=b.xr,f=b.yt;b=b.yb;var g=a.lSite,k=a.rSite,l=g.x,m=g.y,p=k.x,n=k.y,q=(l+p)/2,r=(m+n)/2,t,u;this.cells[g.voronoiId].closeMe=!0;this.cells[k.voronoiId].closeMe=!0;n!==m&&(t=(l-p)/(n-m),u=r-t*q);if(void 0===t){if(q<c||q>=e)return!1;if(l>p){if(!d||d.y<f)d=this.createVertex(q,f);else if(d.y>=
b)return!1;c=this.createVertex(q,b)}else{if(!d||d.y>b)d=this.createVertex(q,b);else if(d.y<f)return!1;c=this.createVertex(q,f)}}else if(-1>t||1<t)if(l>p){if(!d||d.y<f)d=this.createVertex((f-u)/t,f);else if(d.y>=b)return!1;c=this.createVertex((b-u)/t,b)}else{if(!d||d.y>b)d=this.createVertex((b-u)/t,b);else if(d.y<f)return!1;c=this.createVertex((f-u)/t,f)}else if(m<n){if(!d||d.x<c)d=this.createVertex(c,t*c+u);else if(d.x>=e)return!1;c=this.createVertex(e,t*e+u)}else{if(!d||d.x>e)d=this.createVertex(e,
t*e+u);else if(d.x<c)return!1;c=this.createVertex(c,t*c+u)}a.va=d;a.vb=c;return!0};b.prototype.clipEdge=function(a,b){var c=a.va.x,d=a.va.y,e=0,f=1,g=a.vb.x-c,k=a.vb.y-d,l=c-b.xl;if(0===g&&0>l)return!1;l=-l/g;if(0>g){if(l<e)return!1;l<f&&(f=l)}else if(0<g){if(l>f)return!1;l>e&&(e=l)}l=b.xr-c;if(0===g&&0>l)return!1;l/=g;if(0>g){if(l>f)return!1;l>e&&(e=l)}else if(0<g){if(l<e)return!1;l<f&&(f=l)}l=d-b.yt;if(0===k&&0>l)return!1;l=-l/k;if(0>k){if(l<e)return!1;l<f&&(f=l)}else if(0<k){if(l>f)return!1;l>
e&&(e=l)}l=b.yb-d;if(0===k&&0>l)return!1;l/=k;if(0>k){if(l>f)return!1;l>e&&(e=l)}else if(0<k){if(l<e)return!1;l<f&&(f=l)}0<e&&(a.va=this.createVertex(c+e*g,d+e*k));1>f&&(a.vb=this.createVertex(c+f*g,d+f*k));if(0<e||1>f)this.cells[a.lSite.voronoiId].closeMe=!0,this.cells[a.rSite.voronoiId].closeMe=!0;return!0};b.prototype.clipEdges=function(a){for(var b=this.edges,c=b.length,d,e=Math.abs;c--;)if(d=b[c],!this.connectEdge(d,a)||!this.clipEdge(d,a)||1E-9>e(d.va.x-d.vb.x)&&1E-9>e(d.va.y-d.vb.y))d.va=d.vb=
null,b.splice(c,1)};b.prototype.closeCells=function(a){var b=a.xl,c=a.xr,d=a.yt;a=a.yb;for(var e=this.cells,f=e.length,g,k,l,m,p,n,q,r,u=Math.abs;f--;)if(g=e[f],g.prepareHalfedges()&&g.closeMe){l=g.halfedges;m=l.length;for(k=0;k<m;){p=l[k].getEndpoint();q=l[(k+1)%m].getStartpoint();if(1E-9<=u(p.x-q.x)||1E-9<=u(p.y-q.y))switch(!0){case this.equalWithEpsilon(p.x,b)&&this.lessThanWithEpsilon(p.y,a):r=this.equalWithEpsilon(q.x,b);n=this.createVertex(b,r?q.y:a);p=this.createBorderEdge(g.site,p,n);k++;
l.splice(k,0,this.createHalfedge(p,g.site,null));m++;if(r)break;p=n;case this.equalWithEpsilon(p.y,a)&&this.lessThanWithEpsilon(p.x,c):r=this.equalWithEpsilon(q.y,a);n=this.createVertex(r?q.x:c,a);p=this.createBorderEdge(g.site,p,n);k++;l.splice(k,0,this.createHalfedge(p,g.site,null));m++;if(r)break;p=n;case this.equalWithEpsilon(p.x,c)&&this.greaterThanWithEpsilon(p.y,d):r=this.equalWithEpsilon(q.x,c);n=this.createVertex(c,r?q.y:d);p=this.createBorderEdge(g.site,p,n);k++;l.splice(k,0,this.createHalfedge(p,
g.site,null));m++;if(r)break;p=n;case this.equalWithEpsilon(p.y,d)&&this.greaterThanWithEpsilon(p.x,b):r=this.equalWithEpsilon(q.y,d);n=this.createVertex(r?q.x:b,d);p=this.createBorderEdge(g.site,p,n);k++;l.splice(k,0,this.createHalfedge(p,g.site,null));m++;if(r)break;p=n;r=this.equalWithEpsilon(q.x,b);n=this.createVertex(b,r?q.y:a);p=this.createBorderEdge(g.site,p,n);k++;l.splice(k,0,this.createHalfedge(p,g.site,null));m++;if(r)break;p=n;r=this.equalWithEpsilon(q.y,a);n=this.createVertex(r?q.x:c,
a);p=this.createBorderEdge(g.site,p,n);k++;l.splice(k,0,this.createHalfedge(p,g.site,null));m++;if(r)break;p=n;r=this.equalWithEpsilon(q.x,c);n=this.createVertex(c,r?q.y:d);p=this.createBorderEdge(g.site,p,n);k++;l.splice(k,0,this.createHalfedge(p,g.site,null));m++;if(r)break;default:throw"Voronoi.closeCells() > this makes no sense!";}k++}g.closeMe=!1}};b.prototype.quantizeSites=function(a){for(var b=this.\u03b5,c=a.length,d;c--;)d=a[c],d.x=Math.floor(d.x/b)*b,d.y=Math.floor(d.y/b)*b};b.prototype.recycle=
function(a){if(a)if(a instanceof this.Diagram)this.toRecycle=a;else throw"Voronoi.recycleDiagram() > Need a Diagram object.";};b.prototype.compute=function(a,b){var c=new Date;this.reset();this.toRecycle&&(this.vertexJunkyard=this.vertexJunkyard.concat(this.toRecycle.vertices),this.edgeJunkyard=this.edgeJunkyard.concat(this.toRecycle.edges),this.cellJunkyard=this.cellJunkyard.concat(this.toRecycle.cells),this.toRecycle=null);a=a.slice(0);a.sort(function(a,b){var c=b.y-a.y;return c?c:b.x-a.x});for(var d=
a.pop(),e=0,f,g,k=this.cells,l;;)if(l=this.firstCircleEvent,d&&(!l||d.y<l.y||d.y===l.y&&d.x<l.x)){if(d.x!==f||d.y!==g)k[e]=this.createCell(d),d.voronoiId=e++,this.addBeachsection(d),g=d.y,f=d.x;d=a.pop()}else if(l)this.removeBeachsection(l.arc);else break;this.clipEdges(b);this.closeCells(b);b=new Date;f=new this.Diagram;f.cells=this.cells;f.edges=this.edges;f.vertices=this.vertices;f.execTime=b.getTime()-c.getTime();this.reset();return f};a.exports=b}),g=function(a,b){var c=a[0];a=a[1];for(var d=
!1,e=0,f=b.length-1;e<b.length;f=e++){var g=b[e][0],k=b[e][1],l=b[f][0],f=b[f][1];k>a!=f>a&&c<(l-g)*(a-k)/(f-k)+g&&(d=!d)}return d},e=function(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function");},f=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1;d.configurable=!0;"value"in d&&(d.writable=!0);Object.defineProperty(a,d.key,d)}}return function(b,c,d){c&&a(b.prototype,c);d&&a(b,d);return b}}(),k=function(){function a(){e(this,
a)}f(a,null,[{key:"crossProduct",value:function(b,c){var d=[b[1]*c[2]-b[2]*c[1],-1*(b[0]*c[2]-b[2]*c[0]),b[0]*c[1]-b[1]*c[0]];2<arguments.length&&void 0!==arguments[2]&&arguments[2]&&(d=a.normalize(d));return d}},{key:"dotProduct",value:function(a,b){if(a.length!=b.length)return console.log("ERROR: v1 and v2 must be the same size to compute a dot product"),null;for(var c=0,d=0;d<a.length;d++)c+=a[d]*b[d];return c}},{key:"normalize",value:function(b){var c=a.getNorm(b);return[b[0]/c,b[1]/c,b[2]/c]}},
{key:"getNorm",value:function(a){return Math.sqrt(a[0]*a[0]+a[1]*a[1]+a[2]*a[2])}},{key:"rotate",value:function(a,b){return[a[0]*b[0][0]+a[1]*b[0][1]+a[2]*b[0][2],a[0]*b[1][0]+a[1]*b[1][1]+a[2]*b[1][2],a[0]*b[2][0]+a[1]*b[2][1]+a[2]*b[2][2]]}},{key:"getAnglePoints",value:function(b,c,d){b=[b[0]-c[0],b[1]-c[1],b[2]-c[2]];c=[d[0]-c[0],d[1]-c[1],d[2]-c[2]];b=a.normalize(b);c=a.normalize(c);c=a.dotProduct(b,c);return Math.acos(c)}},{key:"vector2DCrossing",value:function(a,b,c,d){var e=null,f=b[0]-a[0];
b=b[1]-a[1];var g=d[0]-c[0],k=d[1]-c[1];d=(-b*(a[0]-c[0])+f*(a[1]-c[1]))/(-g*b+f*k);c=(g*(a[1]-c[1])-k*(a[0]-c[0]))/(-g*b+f*k);0<=d&&1>=d&&0<=c&&1>=c&&(e=[a[0]+c*f,a[1]+c*b]);return e}},{key:"pointToSegmentDistance",value:function(a,b,c){var d=a[0]-b[0],e=a[1]-b[1],f=c[0]-b[0],g=c[1]-b[1],k=f*f+g*g,l=-1;0!=k&&(l=(d*f+e*g)/k);0>l?(d=b[0],b=b[1]):1<l?(d=c[0],b=c[1]):(d=b[0]+l*f,b=b[1]+l*g);c=a[0]-d;a=a[1]-b;return Math.sqrt(c*c+a*a)}}]);return a}(),l=function(){function b(a){e(this,b);this._isValid=
!1;this._area=this._hull=null;if(Array.isArray(a)&&2<a.length){var c=null;"x"in a[0]&&"y"in a[0]?c=a.map(function(a){return[a.x,a.y]}):Array.isArray(a[0])&&(c=a.map(function(a){return[a[0],a[1]]}));c&&(c=b.removeDuplicateVertices(c),this._hull=b.orderPolygonPoints(c));this._isValid=!!this._hull}}f(b,[{key:"isValid",value:function(){return this._isValid}},{key:"getArea",value:function(){if(!this._area){var b;b=this._hull;var c=b.length,d=0;b=b.map(a);b[0]!=b[b.length-1]&&(b=b.concat(b[0]));for(var e=
0;e<c;e++)d+=b[e].x*b[e+1].y-b[e].y*b[e+1].x;b=Math.abs(d)/2;this._area=b}return this._area}},{key:"getCellReplacementIntersection",value:function(a){var c=this.getHull();a=a.getHull();for(var d=[],e=c.length,f=a.length,l=0;l<e;l++){var m=c[l],n=c[(l+1)%e],q=g(c[l],a);q&&d.push(c[l]);for(var r=0;r<f;r++){0===l&&(q=g(a[r],c))&&d.push(a[r]);var q=a[r],u=a[(r+1)%f],z=k.vector2DCrossing(m,n,q,u);z&&d.push(z);1E-4>k.pointToSegmentDistance(q,m,n)&&d.push(q);1E-4>k.pointToSegmentDistance(m,q,u)&&d.push(m)}}return new b(d)}},
{key:"getHull",value:function(){return this._hull}},{key:"isSame",value:function(a){a=a.getHull();if(this._hull.length!==a.length)return!1;for(var b=0;b<a.length;b++)if(1E-4<Math.abs(a[b][0]-this._hull[b][0])||1E-4<Math.abs(a[b][1]-this._hull[b][1]))return!1;return!0}}],[{key:"removeDuplicateVertices",value:function(a){for(var b=[a[0]],c=1;c<a.length;c++){for(var d=!1,e=0;e<b.length;e++){var f=Math.abs(a[c][1]-b[e][1]);if(1E-4>Math.abs(a[c][0]-b[e][0])&&1E-4>f){d=!0;break}}d||b.push(a[c])}return b}},
{key:"getPolygonCenter",value:function(a){for(var b=a.length,c=0,d=0,e=0,f=0;f<b;f++)c+=a[f][0],d+=a[f][1],e+=a[f][2];return[c/b,d/b,e/b]}},{key:"orderPolygonPoints",value:function(a){for(var c=a.length,d=b.getPolygonCenter(a),e=Array(c),f=[0,1,0],g=0;g<c;g++){var l=k.normalize([d[0]-a[g][0],d[1]-a[g][1],0]),m=k.dotProduct(f,l),m=Math.acos(m),l=k.crossProduct(f,l),l=0<k.dotProduct(l,[0,0,1])?1:-1,m=m*l;0>m&&(m=Math.PI+(Math.PI+m));e[g]={vertex:a[g],angle:m}}e.sort(function(a,b){return a.angle-b.angle});
a=[];for(g=0;g<c;g++)a.push(e[g].vertex);return a}}]);return b}(),m=function(){function a(b,c){e(this,a);this._hash=a.genarateHash(c.x,c.y);this._polygon=new l(b);this._seed=c;this._isValid=this._polygon.isValid()&&!!this._hash}f(a,[{key:"isValid",value:function(){return this._isValid}},{key:"getHash",value:function(){return this._hash}},{key:"getSeed",value:function(){return this._seed}},{key:"getPolygon",value:function(){return this._polygon}},{key:"getArea",value:function(){return this._polygon.getArea()}},
{key:"intersectWithCell",value:function(a){return this._polygon.getCellReplacementIntersection(a.getPolygon())}},{key:"hasSamePolygon",value:function(a){return this._polygon.isSame(a.getPolygon())}}],[{key:"genarateHash",value:function(a,b){return a.toString()+"_"+b.toString()}}]);return a}(),n=function(){function a(){e(this,a);this._cells={};this._cellArray=[];this._addedSeedHash=null}f(a,[{key:"buildFromVoronoiDiagram",value:function(a){a=a.cells;for(var b=0;b<a.length;b++){for(var c=a[b].halfedges,
d=[],e=0;e<c.length;e++)d.push(c[e].edge.va),d.push(c[e].edge.vb);c=new m(d,a[b].site);c.isValid()&&(this._cells[c.getHash()]=c,this._cellArray.push(c))}}},{key:"getCellHashes",value:function(){return Object.keys(this._cells)}},{key:"getCell",value:function(a){return a in this._cells?this._cells[a]:null}},{key:"referenceSeed",value:function(a,b){this._addedSeedHash=m.genarateHash(a,b)}},{key:"getReferencedSeedCell",value:function(){return this._cells[this._addedSeedHash]}},{key:"getStolenAreaInfo",
value:function(a){var b=a.getReferencedSeedCell();b.getArea();var c=[],d;for(d in this._cells)if(d!==b.getHash()){var e=this._cells[d],f=a.getCell(d);if(!e.hasSamePolygon(f)){var f=0,g=b.intersectWithCell(e);g.isValid()&&(f=g.getArea()/b.getArea());f=Math.round(1E4*f)/1E4;c.push({seedIndex:e.getSeed().seedIndex,weight:f})}}return c}}]);return a}();c=function(){function a(){e(this,a);this._seeds=[];this._output={width:256,height:256};this._samplingMap=[];this._recomputeMap=!0;this._onProgressCallback=
this._seedCellCollection=null}f(a,[{key:"onProgress",value:function(a){a&&"function"===typeof a&&(this._onProgressCallback=a)}},{key:"cleanSeeds",value:function(){this._seeds=[];this._recomputeMap=!0}},{key:"addSeed",value:function(a){"x"in a&&"y"in a&&"value"in a&&(this._seeds.push(a),this._recomputeMap=!0)}},{key:"addSeeds",value:function(a){for(var b=0;b<a.length;b++)this.addSeed(a[b])}},{key:"getNumberOfSeeds",value:function(){return this._seeds.length}},{key:"setOutputSize",value:function(a,
b){0<a&&0<b&&(this._output.width=a,this._output.height=b)}},{key:"hasAllSeedsInside",value:function(){var a=this._output;return this._seeds.every(function(b){return 0<=b.x&&0<=b.y&&b.x<a.width&&b.y<a.width})}},{key:"generateMap",value:function(){if(!this.hasAllSeedsInside())return console.log("ERR: some seeds are outside of the image. Use .setOutputSize() to change the output size or modify the seed."),!1;this._generateSeedCells();var a=this._output.width,b=this._output.height;this._samplingMap=Array(a*
b);for(var c=0;c<a;c++){this._onProgressCallback&&this._onProgressCallback(Math.round((c+1)/a*100),"sampling map");for(var d=0;d<b;d++){var e=this.isAtSeedPosition(c,d),f=c+d*a;-1===e?(e=this._generatePixelCells(c,d),e=this._seedCellCollection.getStolenAreaInfo(e),this._samplingMap[f]=e):this._samplingMap[f]=[{seedIndex:e,weight:1}]}}return!0}},{key:"getMap",value:function(a){return this._samplingMap}},{key:"setMap",value:function(a){if(a.length===this._output.width*this._output.height)return this._samplingMap=
a,!0;console.log("The sampling map must be an 1D array of size output.x*output.y");return!1}},{key:"isAtSeedPosition",value:function(a,b){return this._seeds.findIndex(function(c){return c.x==a&&c.y==b})}},{key:"_generateSeedCells",value:function(){var a={xl:0,xr:this._output.width,yt:0,yb:this._output.height},b=this._seeds.map(function(a,b){return{x:a.x,y:a.y,seedIndex:b}}),a=(new d).compute(b,a);this._seedCellCollection=new n;this._seedCellCollection.buildFromVoronoiDiagram(a)}},{key:"_generatePixelCells",
value:function(a,b){var c=new d,e={xl:0,xr:this._output.width,yt:0,yb:this._output.height},f=this._seeds.map(function(a,b){return{x:a.x,y:a.y,seedIndex:b}});f.push({x:a,y:b,seedIndex:-1});c=c.compute(f,e);e=new n;e.buildFromVoronoiDiagram(c);e.referenceSeed(a,b);return e}},{key:"generateImage",value:function(){for(var a=this._output.width*this._output.height,b=new Float32Array(a),c=this._seeds,d=this._samplingMap,e=0;e<a;e++){this._onProgressCallback&&this._onProgressCallback(Math.round((e+1)/a*100),
"output image");for(var f=d[e],g=0,k=0;k<f.length;k++)g+=f[k].weight*c[f[k].seedIndex].value;b[e]=g}return{_metadata:{width:this._output.width,height:this._output.height},_data:b}}}]);return a}();b.Interpolator=c}),pk=function(c){return c&&c.__esModule&&Object.prototype.hasOwnProperty.call(c,"default")?c["default"]:c}(ne),Hh=ne.Interpolator,qk=Object.freeze({default:pk,__moduleExports:ne,Interpolator:Hh}),rk=function(c){function b(){I(this,b);var a=P(this,(b.__proto__||Object.getPrototypeOf(b)).call(this));
a.setMetadata("outputSize",{width:0,height:0});a.setMetadata("samplingMapOnly",!1);console.log(qk);return a}L(b,c);N(b,[{key:"_run",value:function(){var a=this._getInput("seeds"),b=this._getInput("samplingMap"),c=this.getMetadata("outputSize"),e=this.getMetadata("samplingMapOnly");if(a)if(c&&0<c.width&&0<c.height){var f=new Hh;f.setOutputSize(c.width,c.height);f.addSeeds(a);if(0===f.getNumberOfSeeds())console.log("Seeds are probably of the wrong format, check documentation.");else{if(b){if(!f.setMap(b)){console.log("The provided sampling map is of the wrong size.");
return}}else if(f.generateMap())this._output.samplingMap=f.getMap();else{console.log("The sampling map generation went wrong.");return}if(!e){e=f.generateImage();b=new Q;b.setData(e._data,c.width,c.height,1);c=Infinity;e=-Infinity;for(f=0;f<a.length;f++)c=Math.min(c,a[f].value),e=Math.max(e,a[f].value);b.setMetadata("min",c);b.setMetadata("max",e);this._output[0]=b}}}else console.log("The output size must be of form {width: Number, height: Number}, both being positive.");else console.log("The sparse nn interpolation needs seeds to process.")}}]);
return b}(W),nd={jet:[{index:0,rgb:[0,0,131]},{index:.125,rgb:[0,60,170]},{index:.375,rgb:[5,255,255]},{index:.625,rgb:[255,255,0]},{index:.875,rgb:[250,0,0]},{index:1,rgb:[128,0,0]}],hsv:[{index:0,rgb:[255,0,0]},{index:.169,rgb:[253,255,2]},{index:.173,rgb:[247,255,2]},{index:.337,rgb:[0,252,4]},{index:.341,rgb:[0,252,10]},{index:.506,rgb:[1,249,255]},{index:.671,rgb:[2,0,253]},{index:.675,rgb:[8,0,253]},{index:.839,rgb:[255,0,251]},{index:.843,rgb:[255,0,245]},{index:1,rgb:[255,0,6]}],hot:[{index:0,
rgb:[0,0,0]},{index:.3,rgb:[230,0,0]},{index:.6,rgb:[255,210,0]},{index:1,rgb:[255,255,255]}],cool:[{index:0,rgb:[0,255,255]},{index:1,rgb:[255,0,255]}],spring:[{index:0,rgb:[255,0,255]},{index:1,rgb:[255,255,0]}],summer:[{index:0,rgb:[0,128,102]},{index:1,rgb:[255,255,102]}],autumn:[{index:0,rgb:[255,0,0]},{index:1,rgb:[255,255,0]}],winter:[{index:0,rgb:[0,0,255]},{index:1,rgb:[0,255,128]}],bone:[{index:0,rgb:[0,0,0]},{index:.376,rgb:[84,84,116]},{index:.753,rgb:[169,200,200]},{index:1,rgb:[255,
255,255]}],copper:[{index:0,rgb:[0,0,0]},{index:.804,rgb:[255,160,102]},{index:1,rgb:[255,199,127]}],greys:[{index:0,rgb:[0,0,0]},{index:1,rgb:[255,255,255]}],yignbu:[{index:0,rgb:[8,29,88]},{index:.125,rgb:[37,52,148]},{index:.25,rgb:[34,94,168]},{index:.375,rgb:[29,145,192]},{index:.5,rgb:[65,182,196]},{index:.625,rgb:[127,205,187]},{index:.75,rgb:[199,233,180]},{index:.875,rgb:[237,248,217]},{index:1,rgb:[255,255,217]}],greens:[{index:0,rgb:[0,68,27]},{index:.125,rgb:[0,109,44]},{index:.25,rgb:[35,
139,69]},{index:.375,rgb:[65,171,93]},{index:.5,rgb:[116,196,118]},{index:.625,rgb:[161,217,155]},{index:.75,rgb:[199,233,192]},{index:.875,rgb:[229,245,224]},{index:1,rgb:[247,252,245]}],yiorrd:[{index:0,rgb:[128,0,38]},{index:.125,rgb:[189,0,38]},{index:.25,rgb:[227,26,28]},{index:.375,rgb:[252,78,42]},{index:.5,rgb:[253,141,60]},{index:.625,rgb:[254,178,76]},{index:.75,rgb:[254,217,118]},{index:.875,rgb:[255,237,160]},{index:1,rgb:[255,255,204]}],bluered:[{index:0,rgb:[0,0,255]},{index:1,rgb:[255,
0,0]}],rdbu:[{index:0,rgb:[5,10,172]},{index:.35,rgb:[106,137,247]},{index:.5,rgb:[190,190,190]},{index:.6,rgb:[220,170,132]},{index:.7,rgb:[230,145,90]},{index:1,rgb:[178,10,28]}],picnic:[{index:0,rgb:[0,0,255]},{index:.1,rgb:[51,153,255]},{index:.2,rgb:[102,204,255]},{index:.3,rgb:[153,204,255]},{index:.4,rgb:[204,204,255]},{index:.5,rgb:[255,255,255]},{index:.6,rgb:[255,204,255]},{index:.7,rgb:[255,153,255]},{index:.8,rgb:[255,102,204]},{index:.9,rgb:[255,102,102]},{index:1,rgb:[255,0,0]}],rainbow:[{index:0,
rgb:[150,0,90]},{index:.125,rgb:[0,0,200]},{index:.25,rgb:[0,25,255]},{index:.375,rgb:[0,152,255]},{index:.5,rgb:[44,255,150]},{index:.625,rgb:[151,255,0]},{index:.75,rgb:[255,234,0]},{index:.875,rgb:[255,111,0]},{index:1,rgb:[255,0,0]}],portland:[{index:0,rgb:[12,51,131]},{index:.25,rgb:[10,136,186]},{index:.5,rgb:[242,211,56]},{index:.75,rgb:[242,143,56]},{index:1,rgb:[217,30,30]}],blackbody:[{index:0,rgb:[0,0,0]},{index:.2,rgb:[230,0,0]},{index:.4,rgb:[230,210,0]},{index:.7,rgb:[255,255,255]},
{index:1,rgb:[160,200,255]}],earth:[{index:0,rgb:[0,0,130]},{index:.1,rgb:[0,180,180]},{index:.2,rgb:[40,210,40]},{index:.4,rgb:[230,230,50]},{index:.6,rgb:[120,70,20]},{index:1,rgb:[255,255,255]}],electric:[{index:0,rgb:[0,0,0]},{index:.15,rgb:[30,0,100]},{index:.4,rgb:[120,0,100]},{index:.6,rgb:[160,90,0]},{index:.8,rgb:[230,200,0]},{index:1,rgb:[255,250,220]}],viridis:[{index:0,rgb:[68,1,84]},{index:.13,rgb:[71,44,122]},{index:.25,rgb:[59,81,139]},{index:.38,rgb:[44,113,142]},{index:.5,rgb:[33,
144,141]},{index:.63,rgb:[39,173,129]},{index:.75,rgb:[92,200,99]},{index:.88,rgb:[170,220,50]},{index:1,rgb:[253,231,37]}],inferno:[{index:0,rgb:[0,0,4]},{index:.13,rgb:[31,12,72]},{index:.25,rgb:[85,15,109]},{index:.38,rgb:[136,34,106]},{index:.5,rgb:[186,54,85]},{index:.63,rgb:[227,89,51]},{index:.75,rgb:[249,140,10]},{index:.88,rgb:[249,201,50]},{index:1,rgb:[252,255,164]}],magma:[{index:0,rgb:[0,0,4]},{index:.13,rgb:[28,16,68]},{index:.25,rgb:[79,18,123]},{index:.38,rgb:[129,37,129]},{index:.5,
rgb:[181,54,122]},{index:.63,rgb:[229,80,100]},{index:.75,rgb:[251,135,97]},{index:.88,rgb:[254,194,135]},{index:1,rgb:[252,253,191]}],plasma:[{index:0,rgb:[13,8,135]},{index:.13,rgb:[75,3,161]},{index:.25,rgb:[125,3,168]},{index:.38,rgb:[168,34,150]},{index:.5,rgb:[203,70,121]},{index:.63,rgb:[229,107,93]},{index:.75,rgb:[248,148,65]},{index:.88,rgb:[253,195,40]},{index:1,rgb:[240,249,33]}],warm:[{index:0,rgb:[125,0,179]},{index:.13,rgb:[172,0,187]},{index:.25,rgb:[219,0,170]},{index:.38,rgb:[255,
0,130]},{index:.5,rgb:[255,63,74]},{index:.63,rgb:[255,123,0]},{index:.75,rgb:[234,176,0]},{index:.88,rgb:[190,228,0]},{index:1,rgb:[147,255,0]}],cool2:[{index:0,rgb:[125,0,179]},{index:.13,rgb:[116,0,218]},{index:.25,rgb:[98,74,237]},{index:.38,rgb:[68,146,231]},{index:.5,rgb:[0,204,197]},{index:.63,rgb:[0,247,146]},{index:.75,rgb:[0,255,88]},{index:.88,rgb:[40,255,8]},{index:1,rgb:[147,255,0]}],"rainbow-soft":[{index:0,rgb:[125,0,179]},{index:.1,rgb:[199,0,180]},{index:.2,rgb:[255,0,121]},{index:.3,
rgb:[255,108,0]},{index:.4,rgb:[222,194,0]},{index:.5,rgb:[150,255,0]},{index:.6,rgb:[0,255,55]},{index:.7,rgb:[0,246,150]},{index:.8,rgb:[50,167,222]},{index:.9,rgb:[103,51,235]},{index:1,rgb:[124,0,186]}],bathymetry:[{index:0,rgb:[40,26,44]},{index:.13,rgb:[59,49,90]},{index:.25,rgb:[64,76,139]},{index:.38,rgb:[63,110,151]},{index:.5,rgb:[72,142,158]},{index:.63,rgb:[85,174,163]},{index:.75,rgb:[120,206,163]},{index:.88,rgb:[187,230,172]},{index:1,rgb:[253,254,204]}],cdom:[{index:0,rgb:[47,15,62]},
{index:.13,rgb:[87,23,86]},{index:.25,rgb:[130,28,99]},{index:.38,rgb:[171,41,96]},{index:.5,rgb:[206,67,86]},{index:.63,rgb:[230,106,84]},{index:.75,rgb:[242,149,103]},{index:.88,rgb:[249,193,135]},{index:1,rgb:[254,237,176]}],chlorophyll:[{index:0,rgb:[18,36,20]},{index:.13,rgb:[25,63,41]},{index:.25,rgb:[24,91,59]},{index:.38,rgb:[13,119,72]},{index:.5,rgb:[18,148,80]},{index:.63,rgb:[80,173,89]},{index:.75,rgb:[132,196,122]},{index:.88,rgb:[175,221,162]},{index:1,rgb:[215,249,208]}],density:[{index:0,
rgb:[54,14,36]},{index:.13,rgb:[89,23,80]},{index:.25,rgb:[110,45,132]},{index:.38,rgb:[120,77,178]},{index:.5,rgb:[120,113,213]},{index:.63,rgb:[115,151,228]},{index:.75,rgb:[134,185,227]},{index:.88,rgb:[177,214,227]},{index:1,rgb:[230,241,241]}],"freesurface-blue":[{index:0,rgb:[30,4,110]},{index:.13,rgb:[47,14,176]},{index:.25,rgb:[41,45,236]},{index:.38,rgb:[25,99,212]},{index:.5,rgb:[68,131,200]},{index:.63,rgb:[114,156,197]},{index:.75,rgb:[157,181,203]},{index:.88,rgb:[200,208,216]},{index:1,
rgb:[241,237,236]}],"freesurface-red":[{index:0,rgb:[60,9,18]},{index:.13,rgb:[100,17,27]},{index:.25,rgb:[142,20,29]},{index:.38,rgb:[177,43,27]},{index:.5,rgb:[192,87,63]},{index:.63,rgb:[205,125,105]},{index:.75,rgb:[216,162,148]},{index:.88,rgb:[227,199,193]},{index:1,rgb:[241,237,236]}],oxygen:[{index:0,rgb:[64,5,5]},{index:.13,rgb:[106,6,15]},{index:.25,rgb:[144,26,7]},{index:.38,rgb:[168,64,3]},{index:.5,rgb:[188,100,4]},{index:.63,rgb:[206,136,11]},{index:.75,rgb:[220,174,25]},{index:.88,
rgb:[231,215,44]},{index:1,rgb:[248,254,105]}],par:[{index:0,rgb:[51,20,24]},{index:.13,rgb:[90,32,35]},{index:.25,rgb:[129,44,34]},{index:.38,rgb:[159,68,25]},{index:.5,rgb:[182,99,19]},{index:.63,rgb:[199,134,22]},{index:.75,rgb:[212,171,35]},{index:.88,rgb:[221,210,54]},{index:1,rgb:[225,253,75]}],phase:[{index:0,rgb:[145,105,18]},{index:.13,rgb:[184,71,38]},{index:.25,rgb:[186,58,115]},{index:.38,rgb:[160,71,185]},{index:.5,rgb:[110,97,218]},{index:.63,rgb:[50,123,164]},{index:.75,rgb:[31,131,
110]},{index:.88,rgb:[77,129,34]},{index:1,rgb:[145,105,18]}],salinity:[{index:0,rgb:[42,24,108]},{index:.13,rgb:[33,50,162]},{index:.25,rgb:[15,90,145]},{index:.38,rgb:[40,118,137]},{index:.5,rgb:[59,146,135]},{index:.63,rgb:[79,175,126]},{index:.75,rgb:[120,203,104]},{index:.88,rgb:[193,221,100]},{index:1,rgb:[253,239,154]}],temperature:[{index:0,rgb:[4,35,51]},{index:.13,rgb:[23,51,122]},{index:.25,rgb:[85,59,157]},{index:.38,rgb:[129,79,143]},{index:.5,rgb:[175,95,130]},{index:.63,rgb:[222,112,
101]},{index:.75,rgb:[249,146,66]},{index:.88,rgb:[249,196,65]},{index:1,rgb:[232,250,91]}],turbidity:[{index:0,rgb:[34,31,27]},{index:.13,rgb:[65,50,41]},{index:.25,rgb:[98,69,52]},{index:.38,rgb:[131,89,57]},{index:.5,rgb:[161,112,59]},{index:.63,rgb:[185,140,66]},{index:.75,rgb:[202,174,88]},{index:.88,rgb:[216,209,126]},{index:1,rgb:[233,246,171]}],"velocity-blue":[{index:0,rgb:[17,32,64]},{index:.13,rgb:[35,52,116]},{index:.25,rgb:[29,81,156]},{index:.38,rgb:[31,113,162]},{index:.5,rgb:[50,144,
169]},{index:.63,rgb:[87,173,176]},{index:.75,rgb:[149,196,189]},{index:.88,rgb:[203,221,211]},{index:1,rgb:[254,251,230]}],"velocity-green":[{index:0,rgb:[23,35,19]},{index:.13,rgb:[24,64,38]},{index:.25,rgb:[11,95,45]},{index:.38,rgb:[39,123,35]},{index:.5,rgb:[95,146,12]},{index:.63,rgb:[152,165,18]},{index:.75,rgb:[201,186,69]},{index:.88,rgb:[233,216,137]},{index:1,rgb:[255,253,205]}],cubehelix:[{index:0,rgb:[0,0,0]},{index:.07,rgb:[22,5,59]},{index:.13,rgb:[60,4,105]},{index:.2,rgb:[109,1,135]},
{index:.27,rgb:[161,0,147]},{index:.33,rgb:[210,2,142]},{index:.4,rgb:[251,11,123]},{index:.47,rgb:[255,29,97]},{index:.53,rgb:[255,54,69]},{index:.6,rgb:[255,85,46]},{index:.67,rgb:[255,120,34]},{index:.73,rgb:[255,157,37]},{index:.8,rgb:[241,191,57]},{index:.87,rgb:[224,220,93]},{index:.93,rgb:[218,241,142]},{index:1,rgb:[227,253,198]}]},Ih=function(c){function b(){var a=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};I(this,b);var c=P(this,(b.__proto__||Object.getPrototypeOf(b)).call(this));
c._type=b.TYPE();c._colormapDescription=null;c._LUT=[];c.setMetadata("flip",!1);var g=c._getOption(a,"style",null);g?c.setStyle(g):(g=c._getOption(a,"description",null),c.setDescription(g));c._colormapDescription&&(a=c._getOption(a,"lutSize",null))&&c.buildLut(a);return c}L(b,c);N(b,[{key:"setStyle",value:function(a){a in nd?this._validateDescription(nd[a])&&(this._colormapDescription=JSON.parse(JSON.stringify(nd[a]))):console.warn("The given colormap style des not exist.")}},{key:"setDescription",
value:function(a){(a="string"===typeof a?JSON.parse(a):a)&&this._validateDescription(a)&&(this._colormapDescription=a)}},{key:"_validateDescription",value:function(a){if(!Array.isArray(a))return console.warn("The colormap description has to be an Array"),!1;for(var b=0;b<a.length;b++)if(null!==a[b]&&"object"===O(a[b]))if("index"in a[b]&&"rgb"in a[b]){if("number"===typeof a[b].index){if(0>a[b].index||1<a[b].index)return console.warn("Each colormap segment 'index' property should be in [0, 1]"),!1}else return console.warn("Each colormap segment 'index' property should be a number."),
!1;if(Array.isArray(a[b].rgb))if(3==a[b].rgb.length)for(var c=0;c<a[b].rgb.length;c++){if(0>a[b].rgb[c]||255<a[b].rgb[c])return console.warn("The colormap must have only values in [0, 255]"),!1}else return console.warn("Each colormap segment 'rgb' should contain 3 values"),!1}else return console.warn("Each colormap segment must have a 'index' property and a 'rgb' property."),!1;else return console.warn("Each colormap segment must be a non-null object"),!1;return!0}},{key:"getValueAt",value:function(a){if(!this._colormapDescription)return console.warn("The colormap description is not defined."),
null;this._metadata.flip&&(a=1-a);if(a<=this._colormapDescription[0].index)return this._colormapDescription[0].rgb.slice();if(a>=this._colormapDescription[this._colormapDescription.length-1].index)return this._colormapDescription[this._colormapDescription.length-1].rgb.slice();for(var b=0;b<this._colormapDescription.length-1;b++)if(a>=this._colormapDescription[b].index&&a<this._colormapDescription[b+1].index){a=(a-this._colormapDescription[b].index)/(this._colormapDescription[b+1].index-this._colormapDescription[b].index);
var c=1-a;return[Math.round(this._colormapDescription[b].rgb[0]*c+this._colormapDescription[b+1].rgb[0]*a),Math.round(this._colormapDescription[b].rgb[1]*c+this._colormapDescription[b+1].rgb[1]*a),Math.round(this._colormapDescription[b].rgb[2]*c+this._colormapDescription[b+1].rgb[2]*a)]}}},{key:"getValueAtWithClusters",value:function(a,b){return this.getValueAt((Math.floor(a*b)+.5)/b)}},{key:"buildLut",value:function(){var a=0<arguments.length&&void 0!==arguments[0]?arguments[0]:Math.pow(2,16);if(!this._colormapDescription)return console.warn("The colormap description is not defined, the LUT cannot be created"),
null;if(0>a)console.warn("Size of the colormap can not be negative.");else{this._LUT=Array(a);for(var b=0;b<a;b++)this._LUT[b]=this.getValueAt(b/a+.5/a)}}},{key:"getLutAt",value:function(a){return 0>a||a>this._LUT.length?null:this._LUT[a]}},{key:"getLutAtNormalized",value:function(a){return this._LUT[0>a?0:a<this._LUT.length?Math.floor(a*(this._LUT.length-1)):this._LUT.length-1]}},{key:"createHorizontalLutImage",value:function(){if(this._LUT){for(var a=this._LUT.length,b=new Q({width:a,height:1,color:[0,
0,0]}),c=0;c<a;c++)b.setPixel({x:c,y:0},this._LUT[c]);return b}console.warn("The LUT must be built before creating a LUT image.")}},{key:"createVerticalLutImage",value:function(){if(this._LUT){for(var a=this._LUT.length,b=new Q({width:1,height:a,color:[0,0,0]}),c=0;c<a;c++)b.setPixel({x:0,y:c},this._LUT[c]);return b}console.warn("The LUT must be built before creating a LUT image.")}},{key:"addColor",value:function(a,b){this._colormapDescription||(this._colormapDescription=[]);if(0>a||1<a)return console.warn("The color cannot be added because its index is out of range [0, 1]"),
!1;if(this._colormapDescription.find(function(b){return b.index==a}))return console.warn("A color is already present at index "+a),!1;if(b&&Array.isArray(b)&&3==b.length)for(var c=0;c<b.length;c++){if("number"!==typeof b[c]||0>b[c]||255<b[c])return console.warn("The rgb colors must be in [0, 255]"),!1}else return console.warn("The color cannot be added because its rgb array is the wrong size."),!1;this._colormapDescription.push({index:a,rgb:b.slice()});this._colormapDescription.sort(function(a,b){return a.index-
b.index});return!0}},{key:"removeColor",value:function(a){if(!this._colormapDescription)return console.warn("The colormap description is empty."),!1;var b=this._colormapDescription.findIndex(function(b){return b.index==a});if(-1==b)return console.warn("Such index does not exist."),!1;this._colormapDescription.splice(b,1);return!0}},{key:"toJson",value:function(){return JSON.stringify(this._colormapDescription)}}],[{key:"TYPE",value:function(){return"COLORMAP"}},{key:"getAvailableStyles",value:function(){return Object.keys(nd)}}]);
return b}(ed),sk=function(c){function b(){I(this,b);var a=P(this,(b.__proto__||Object.getPrototypeOf(b)).call(this));a.addInputValidator(0,Q);a.setMetadata("style","jet");a.setMetadata("flip",!1);a.setMetadata("min",void 0);a.setMetadata("max",void 0);a.setMetadata("clusters",null);a.setMetadata("component",0);return a}L(b,c);N(b,[{key:"_run",value:function(){if(this.hasValidInput()){var a=this._getInput(0),b=a.getWidth(),c=a.getHeight(),e=a.getNcpp(),f=this.getMetadata("component");if(f>=e)console.warn("The chosen component must be lower than the input ncpp");
else{var e=this.getMetadata("min")||a.getMin(),k=this.getMetadata("max")||a.getMax(),l=this.getMetadata("clusters");if(1E-6>Math.abs(e-k))console.warn("Min and max values are similar, no interpolation is possible.");else{var m=new Ih;m.setMetadata("flip",this.getMetadata("flip"));m.setStyle(this.getMetadata("style"));var n=m.getValueAt.bind(m);l&&(n=m.getValueAtWithClusters.bind(m));a.getData();var q=new Q({width:b,height:c,color:new Uint8Array([0,0,0])});m.buildLut();for(m=0;m<b;m++)for(var u=0;u<
c;u++){var p=(a.getPixel({x:m,y:u})[f]-e)/(k-e),p=n(p,l);q.setPixel({x:m,y:u},p)}this._output[0]=q}}}else console.warn("A filter of type CropImageFilter requires 1 input of category '0' (Image2D)")}}]);return b}(qa),tk=function(c){function b(){I(this,b);var a=P(this,(b.__proto__||Object.getPrototypeOf(b)).call(this));a.addInputValidator(0,Q);a.setMetadata("component",0);a.setMetadata("minAngle",0);a.setMetadata("maxAngle",Math.PI/2);return a}L(b,c);N(b,[{key:"_run",value:function(){if(this.hasValidInput()){var a=
this,b=this._getInput(0).getNcpp(),c=this.getMetadata("component");if(0>c&&c>=b)console.warn("The component to filter must be valid.");else{var e=this._getInput(),f=e.getWidth(),k=e.getHeight(),b=e.getNcpp(),l=this.getMetadata("minAngle"),m=this.getMetadata("maxAngle");if("auto"===l||"auto"===m)l=e.getMin(),m=e.getMax();b=new Q({width:f,height:k,color:[0,0,0,255]});f=new pixpipe.ForEachPixelImageFilter;f.addInput(b);f.on("pixel",function(b,d){b=(e.getPixel(b)[c]-l)/(m-l)*360;return a._hsl2Rgba(b,
100,50)});f.update();0==f.getNumberOfOutputs()?console.warn("No output of ForEachPixelImageFilter."):this._output[0]=f.getOutput()}}else console.warn("A filter of type AngleToHueWheelHelper requires 1 input of category '0'.")}},{key:"_hsl2Rgba",value:function(a){var b=1<arguments.length&&void 0!==arguments[1]?arguments[1]:100,c=2<arguments.length&&void 0!==arguments[2]?arguments[2]:100,e;a=360===a?1:a%360/360;b=100===b?1:b%100/100;c=100===c?1:c%100/100;if(0===b)c=b=e=c;else{e=function(a,b,c){0>c&&
(c+=1);1<c&&--c;return c<1/6?a+6*(b-a)*c:.5>c?b:c<2/3?a+(b-a)*(2/3-c)*6:a};var f=.5>c?c*(1+b):c+b-c*b,k=2*c-f,c=e(k,f,a+1/3),b=e(k,f,a);e=e(k,f,a-1/3)}return[Math.round(255*c),Math.round(255*b),Math.round(255*e),255]}}]);return b}(qa),uk=function(c){function b(){I(this,b);var a=P(this,(b.__proto__||Object.getPrototypeOf(b)).call(this));a.addInputValidator(0,Q);a.setMetadata("lineStrings",[]);a.setMetadata("lineStringsColors",[]);return a}L(b,c);N(b,[{key:"addLineString",value:function(a,b){this._metadata.lineStrings.push(a);
this._metadata.lineStringsColors.push(b)}},{key:"_run",value:function(){if(this.hasValidInput()){var a=this._getInput(),b=a.clone();a.getWidth();a.getHeight();for(var a=a.getNcpp(),c=!1,e=this._metadata.lineStrings,f=this._metadata.lineStringsColors,k=0;k<e.length;k++)if(2!=e[k].getMetadata("nod"))console.warn("Linstring must be 2D to be printed on images.");else if(a==f[k].length||4==a&&3==f[k].length){for(var c=e[k].getData(),l=0;l<c.length-1;l+=2)b.setPixel({x:c[l],y:c[l+1]},f[k]);c=!0}c&&(this._output[0]=
b)}else console.warn("A filter of type LineStringPrinterOnImage2DHelper requires 1 input of category '0'.")}}]);return b}(qa),vk=function(c){function b(){I(this,b);var a=P(this,(b.__proto__||Object.getPrototypeOf(b)).call(this));a.addInputValidator(0,Ac);a.setMetadata("maxWidth",4096);a.setMetadata("maxHeight",4096);a.setMetadata("axis","xspace");a.setMetadata("time",0);return a}L(b,c);N(b,[{key:"_run",value:function(){function a(a,b,c,d){return e.getIntensity_xyzOrientation(c,a,b,d)}function b(a,
b,c,d){return e.getIntensity_xyzOrientation(a,c,b,d)}function c(a,b,c,d){return e.getIntensity_xyzOrientation(a,b,c,d)}if(this.hasValidInput()){var e=this._getInput(0),f=e.getMetadata(this.getMetadata("axis"));if(f){var k=f.space_length,l=f.width,f=f.height,m=0,n=1;if(e.hasMetadata("time")){var q=e.getMetadata("time").space_length;-1==this._metadata.time?(m=0,n=q):this._metadata.time<q&&(m=this._metadata.time,n=m+1)}var u=k*(n-m),q=Math.floor(this.getMetadata("maxWidth")/l),p=Math.floor(this.getMetadata("maxHeight")/
f),t=q*l,y=p*f,p=q*p;1==Math.ceil(u/p)&&(y=Math.ceil(u/q)*f);this.setMetadata("gridWidth",t/l);this.setMetadata("gridHeight",y/f);var w=u=0,x=0,v=null,z=null;"xspace"===this._metadata.axis?z=a:"yspace"===this._metadata.axis?z=b:"zspace"===this._metadata.axis&&(z=c);if(z)for(var B=Array(e.getMetadata("ncpp")).fill(0);m<n;m++)for(var C=0;C<k;C++){0==w%p&&(v=new Q({width:t,height:y,color:B}),this._output[u]=v,x=0,u++);var D=x%q,G=Math.floor(x/q);x++;for(var D=D*l,G=G*f,H=0;H<f;H++)for(var I=0;I<l;I++){var L=
[z(I,H,C,m)];v.setPixel({x:D+I,y:G+(f-H-1)},L)}w++}else console.warn("The axis to sample along for the mosaic was not properly set.")}else console.warn("Sampling axis for mosaicing was not poperly set. Has to be 'xspace', 'yspace' or 'zspace'.")}}}]);return b}(W),wk=function(c){function b(){I(this,b);var a=P(this,(b.__proto__||Object.getPrototypeOf(b)).call(this));a.addInputValidator(0,Ta);a.setMetadata("maxWidth",4096);a.setMetadata("maxHeight",4096);a.setMetadata("axis","x");a.setMetadata("time",
0);return a}L(b,c);N(b,[{key:"_run",value:function(){if(this.hasValidInput()){var a=this._getInput(0),b=this.getMetadata("axis"),c=a.getSliceSize(b),e=a.getNumberOfSlices(b),f=a.getTimeLength(),k;if(-1==this._metadata.time)k=0;else if(0<=this._metadata.time&&this._metadata.time<f)k=this._metadata.time,f=k+1;else{console.warn("The required time sample is out of bound. Must be 0 <= t < "+f);return}var l=e*(f-k),m=Math.floor(this.getMetadata("maxWidth")/c.w),n=Math.floor(this.getMetadata("maxHeight")/
c.h),q=m*c.w,u=n*c.h,n=m*n;1==Math.ceil(l/n)&&(u=Math.ceil(l/m)*c.h);this.setMetadata("gridWidth",q/c.w);this.setMetadata("gridHeight",u/c.h);var p=Array(a.getMetadata("ncpp")).fill(0),l=new Ch;l.setMetadata("time",!1);l.setMetadata("outputSize",{w:q,h:u});l.setMetadata("outputColor",p);for(p=u=q=0;k<f;k++)for(var t=0;t<e;t++){0==u%n&&(l.setMetadata("resetOutput",!0),p=0);var y=p%m*c.w,w=Math.floor(p/m)*c.h,x=a.getSlice(b,t,k);l.addInput(x);l.setMetadata("patchPosition",{x:y,y:w});l.update();0==u%
n&&(this._output[q]=l.getOutput(),q++);p++;u++}}else console.warn("A filter of type Image3DToMosaicFilterAlt requires 1 input of category '0' (Image3DAlt)")}}]);return b}(W),La=Array;q.CoreTypes=Za;q.PixpipeObject=ed;q.Filter=W;q.Signal1D=ua;q.Image2D=Q;q.Image3D=Ac;q.ImageToImageFilter=qa;q.MniVolume=Ia;q.LineString=Bc;q.Image3DAlt=Ta;q.Mesh3D=Cc;q.Decoder=ra;q.CanvasImageWriter=Ei;q.UrlImageReader=Fi;q.FileImageReader=Gi;q.FileToArrayBufferReader=Ui;q.UrlToArrayBufferReader=Vi;q.BrowserDownloadBuffer=
Wi;q.GenericDecoderInterface=bc;q.Minc2Decoder=Vg;q.NiftiDecoder=Wg;q.NiftiDecoderAlt=Yg;q.PixpEncoder=lj;q.PixpDecoder=Zg;q.Image3DGenericDecoder=mj;q.Image3DGenericDecoderAlt=ch;q.TiffDecoder=lh;q.MghDecoder=$g;q.MghDecoderAlt=bh;q.EegModDecoder=zj;q.PixBinEncoder=Aj;q.PixBinDecoder=Ug;q.JpegDecoder=mh;q.PngDecoder=nh;q.Image2DGenericDecoder=oh;q.Minc2DecoderAlt=ah;q.MniObjDecoder=ph;q.EdfDecoder=sh;q.Mesh3DGenericDecoder=th;q.AllFormatsGenericDecoder=Jj;q.Signal1DGenericDecoder=uh;q.ComponentProjectionImage2DFilter=
Kj;q.ComponentMergeImage2DFilter=Lj;q.ForwardFourierSignalFilter=yh;q.InverseFourierSignalFilter=Nj;q.ForwardFourierImageFilter=Oj;q.InverseFourierImageFilter=Pj;q.ForEachPixelImageFilter=Qj;q.SpectralScaleImageFilter=Rj;q.ImageBlendExpressionFilter=Tj;q.SpatialConvolutionFilter=Uj;q.MultiplyImageFilter=Vj;q.SimpleThresholdFilter=Wj;q.ImageDerivativeFilter=Xj;q.GradientImageFilter=Yj;q.NormalizeImageFilter=Zj;q.ContourImage2DFilter=me;q.FloodFillImageFilter=Ah;q.ContourHolesImage2DFilter=ak;q.ForEachPixelReadOnlyFilter=
bk;q.TerrainRgbToElevationImageFilter=ck;q.NearestNeighborSparseInterpolationImageFilter=dk;q.IDWSparseInterpolationImageFilter=ek;q.TriangulationSparseInterpolationImageFilter=fk;q.CropImageFilter=gk;q.SimplifyLineStringFilter=ik;q.PatchImageFilter=Ch;q.DifferenceEquationSignal1D=lk;q.LowPassFreqSignal1D=Fh;q.LowPassSignal1D=Gh;q.HighPassSignal1D=mk;q.BandPassSignal1D=nk;q.Mesh3DToVolumetricHullFilter=ok;q.NaturalNeighborSparseInterpolationImageFilter=rk;q.ApplyColormapFilter=sk;q.AngleToHueWheelHelper=
tk;q.LineStringPrinterOnImage2DHelper=uk;q.Colormap=Ih;q.Image3DToMosaicFilter=vk;q.Image3DToMosaicFilterAlt=wk;q.Image3DMetadataConverter=Kc;q.MatrixTricks=Ib;q.FunctionGenerator=Dh;Object.defineProperty(q,"__esModule",{value:!0})});
