// Build date: 2017-1214T10:09:19

/*
* Author   Jonathan Lurie - http://me.jonathanlurie.fr
* License  MIT
* Link     https://github.com/Pixpipe/pixpipejs
* Lab      MCIN - Montreal Neurological Institute
*/
/*
 Chen, Yi-Cyuan 2014-2017
 @license MIT
 The buffer module from node.js, for the browser.

 @author   Feross Aboukhadijeh <feross@feross.org> <http://feross.org>
 @license  MIT
 @source http://purl.eligrey.com/github/FileSaver.js/blob/master/FileSaver.js  Determine if an object is a Buffer

 @author   Feross Aboukhadijeh <feross@feross.org> <http://feross.org>
 @license  MIT
 Based on ndef.parser, by Raphael Graf(r@undefined.ch)
     http://www.undefined.ch/mparser/index.html

     Ported to JavaScript and modified by Matthew Crumley (email@matthewcrumley.com, http://silentmatt.com/)

     You are free to use and modify this code in anyway you find useful. Please leave this comment in the code
     to acknowledge its original source. If you feel like it, I enjoy hearing about projects that use my code,
     but don't feel like you have to let me know or ask permission.
*/
'use strict';var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.defineProperty="function"==typeof Object.defineProperties?Object.defineProperty:function(p,u,B){if(B.get||B.set)throw new TypeError("ES3 does not support getters and setters.");p!=Array.prototype&&p!=Object.prototype&&(p[u]=B.value)};$jscomp.getGlobal=function(p){return"undefined"!=typeof window&&window===p?p:"undefined"!=typeof global&&null!=global?global:p};$jscomp.global=$jscomp.getGlobal(this);$jscomp.SYMBOL_PREFIX="jscomp_symbol_";
$jscomp.initSymbol=function(){$jscomp.initSymbol=function(){};$jscomp.global.Symbol||($jscomp.global.Symbol=$jscomp.Symbol)};$jscomp.symbolCounter_=0;$jscomp.Symbol=function(p){return $jscomp.SYMBOL_PREFIX+(p||"")+$jscomp.symbolCounter_++};
$jscomp.initSymbolIterator=function(){$jscomp.initSymbol();var p=$jscomp.global.Symbol.iterator;p||(p=$jscomp.global.Symbol.iterator=$jscomp.global.Symbol("iterator"));"function"!=typeof Array.prototype[p]&&$jscomp.defineProperty(Array.prototype,p,{configurable:!0,writable:!0,value:function(){return $jscomp.arrayIterator(this)}});$jscomp.initSymbolIterator=function(){}};$jscomp.arrayIterator=function(p){var u=0;return $jscomp.iteratorPrototype(function(){return u<p.length?{done:!1,value:p[u++]}:{done:!0}})};
$jscomp.iteratorPrototype=function(p){$jscomp.initSymbolIterator();p={next:p};p[$jscomp.global.Symbol.iterator]=function(){return this};return p};$jscomp.makeIterator=function(p){$jscomp.initSymbolIterator();var u=p[Symbol.iterator];return u?u.call(p):$jscomp.arrayIterator(p)};
$jscomp.polyfill=function(p,u,B,y){if(u){B=$jscomp.global;p=p.split(".");for(y=0;y<p.length-1;y++){var Q=p[y];Q in B||(B[Q]={});B=B[Q]}p=p[p.length-1];y=B[p];u=u(y);u!=y&&null!=u&&$jscomp.defineProperty(B,p,{configurable:!0,writable:!0,value:u})}};$jscomp.EXPOSE_ASYNC_EXECUTOR=!0;$jscomp.FORCE_POLYFILL_PROMISE=!1;
$jscomp.polyfill("Promise",function(p){function u(){this.batch_=null}if(p&&!$jscomp.FORCE_POLYFILL_PROMISE)return p;u.prototype.asyncExecute=function(p){null==this.batch_&&(this.batch_=[],this.asyncExecuteBatch_());this.batch_.push(p);return this};u.prototype.asyncExecuteBatch_=function(){var p=this;this.asyncExecuteFunction(function(){p.executeBatch_()})};var B=$jscomp.global.setTimeout;u.prototype.asyncExecuteFunction=function(p){B(p,0)};u.prototype.executeBatch_=function(){for(;this.batch_&&this.batch_.length;){var p=
this.batch_;this.batch_=[];for(var u=0;u<p.length;++u){var B=p[u];delete p[u];try{B()}catch(Ob){this.asyncThrow_(Ob)}}}this.batch_=null};u.prototype.asyncThrow_=function(p){this.asyncExecuteFunction(function(){throw p;})};var y=function(p){this.state_=0;this.result_=void 0;this.onSettledCallbacks_=[];var u=this.createResolveAndReject_();try{p(u.resolve,u.reject)}catch(ga){u.reject(ga)}};y.prototype.createResolveAndReject_=function(){function p(p){return function(ga){B||(B=!0,p.call(u,ga))}}var u=
this,B=!1;return{resolve:p(this.resolveTo_),reject:p(this.reject_)}};y.prototype.resolveTo_=function(p){if(p===this)this.reject_(new TypeError("A Promise cannot resolve to itself"));else if(p instanceof y)this.settleSameAsPromise_(p);else{var u;a:switch(typeof p){case "object":u=null!=p;break a;case "function":u=!0;break a;default:u=!1}u?this.resolveToNonPromiseObj_(p):this.fulfill_(p)}};y.prototype.resolveToNonPromiseObj_=function(p){var u=void 0;try{u=p.then}catch(ga){this.reject_(ga);return}"function"==
typeof u?this.settleSameAsThenable_(u,p):this.fulfill_(p)};y.prototype.reject_=function(p){this.settle_(2,p)};y.prototype.fulfill_=function(p){this.settle_(1,p)};y.prototype.settle_=function(p,u){if(0!=this.state_)throw Error("Cannot settle("+p+", "+u|"): Promise already settled in state"+this.state_);this.state_=p;this.result_=u;this.executeOnSettledCallbacks_()};y.prototype.executeOnSettledCallbacks_=function(){if(null!=this.onSettledCallbacks_){for(var p=this.onSettledCallbacks_,u=0;u<p.length;++u)p[u].call(),
p[u]=null;this.onSettledCallbacks_=null}};var Q=new u;y.prototype.settleSameAsPromise_=function(p){var u=this.createResolveAndReject_();p.callWhenSettled_(u.resolve,u.reject)};y.prototype.settleSameAsThenable_=function(p,u){var B=this.createResolveAndReject_();try{p.call(u,B.resolve,B.reject)}catch(Ob){B.reject(Ob)}};y.prototype.then=function(p,u){function B(p,u){return"function"==typeof p?function(u){try{Q(p(u))}catch(Sc){R(Sc)}}:u}var Q,R,X=new y(function(p,u){Q=p;R=u});this.callWhenSettled_(B(p,
Q),B(u,R));return X};y.prototype.catch=function(p){return this.then(void 0,p)};y.prototype.callWhenSettled_=function(p,u){function B(){switch(y.state_){case 1:p(y.result_);break;case 2:u(y.result_);break;default:throw Error("Unexpected state: "+y.state_);}}var y=this;null==this.onSettledCallbacks_?Q.asyncExecute(B):this.onSettledCallbacks_.push(function(){Q.asyncExecute(B)})};y.resolve=function(p){return p instanceof y?p:new y(function(u,B){u(p)})};y.reject=function(p){return new y(function(u,B){B(p)})};
y.race=function(p){return new y(function(u,B){for(var ga=$jscomp.makeIterator(p),Q=ga.next();!Q.done;Q=ga.next())y.resolve(Q.value).callWhenSettled_(u,B)})};y.all=function(p){var u=$jscomp.makeIterator(p),B=u.next();return B.done?y.resolve([]):new y(function(p,ga){function Q(u){return function(B){R[u]=B;X--;0==X&&p(R)}}var R=[],X=0;do R.push(void 0),X++,y.resolve(B.value).callWhenSettled_(Q(R.length-1),ga),B=u.next();while(!B.done)})};$jscomp.EXPOSE_ASYNC_EXECUTOR&&(y.$jscomp$new$AsyncExecutor=function(){return new u});
return y},"es6-impl","es3");$jscomp.polyfill("Array.from",function(p){return p?p:function(p,B,y){$jscomp.initSymbolIterator();B=null!=B?B:function(p){return p};var u=[],R=p[Symbol.iterator];if("function"==typeof R)for(p=R.call(p);!(R=p.next()).done;)u.push(B.call(y,R.value));else for(var R=p.length,X=0;X<R;X++)u.push(B.call(y,p[X]));return u}},"es6-impl","es3");$jscomp.owns=function(p,u){return Object.prototype.hasOwnProperty.call(p,u)};
$jscomp.polyfill("Object.assign",function(p){return p?p:function(p,B){for(var u=1;u<arguments.length;u++){var Q=arguments[u];if(Q)for(var R in Q)$jscomp.owns(Q,R)&&(p[R]=Q[R])}return p}},"es6-impl","es3");$jscomp.iteratorFromArray=function(p,u){$jscomp.initSymbolIterator();p instanceof String&&(p+="");var B=0,y={next:function(){if(B<p.length){var Q=B++;return{value:u(Q,p[Q]),done:!1}}y.next=function(){return{done:!0,value:void 0}};return y.next()}};y[Symbol.iterator]=function(){return y};return y};
$jscomp.polyfill("Array.prototype.keys",function(p){return p?p:function(){return $jscomp.iteratorFromArray(this,function(p){return p})}},"es6-impl","es3");
$jscomp.polyfill("WeakMap",function(p){function u(p){$jscomp.owns(p,y)||$jscomp.defineProperty(p,y,{value:{}})}function B(p){var B=Object[p];B&&(Object[p]=function(p){u(p);return B(p)})}if(function(){if(!p||!Object.seal)return!1;try{var u=Object.seal({}),B=Object.seal({}),y=new p([[u,2],[B,3]]);if(2!=y.get(u)||3!=y.get(B))return!1;y.delete(u);y.set(B,4);return!y.has(u)&&4==y.get(B)}catch(zd){return!1}}())return p;var y="$jscomp_hidden_"+Math.random().toString().substring(2);B("freeze");B("preventExtensions");
B("seal");var Q=0,R=function(p){this.id_=(Q+=Math.random()+1).toString();if(p){$jscomp.initSymbol();$jscomp.initSymbolIterator();p=$jscomp.makeIterator(p);for(var u;!(u=p.next()).done;)u=u.value,this.set(u[0],u[1])}};R.prototype.set=function(p,B){u(p);if(!$jscomp.owns(p,y))throw Error("WeakMap key fail: "+p);p[y][this.id_]=B;return this};R.prototype.get=function(p){return $jscomp.owns(p,y)?p[y][this.id_]:void 0};R.prototype.has=function(p){return $jscomp.owns(p,y)&&$jscomp.owns(p[y],this.id_)};R.prototype.delete=
function(p){return $jscomp.owns(p,y)&&$jscomp.owns(p[y],this.id_)?delete p[y][this.id_]:!1};return R},"es6-impl","es3");$jscomp.MapEntry=function(){};$jscomp.ASSUME_NO_NATIVE_MAP=!1;
$jscomp.polyfill("Map",function(p){if(!$jscomp.ASSUME_NO_NATIVE_MAP&&function(){if(!p||!p.prototype.entries||"function"!=typeof Object.seal)return!1;try{var u=Object.seal({x:4}),B=new p($jscomp.makeIterator([[u,"s"]]));if("s"!=B.get(u)||1!=B.size||B.get({x:4})||B.set({x:4},"t")!=B||2!=B.size)return!1;var y=B.entries(),Q=y.next();if(Q.done||Q.value[0]!=u||"s"!=Q.value[1])return!1;Q=y.next();return Q.done||4!=Q.value[0].x||"t"!=Q.value[1]||!y.next().done?!1:!0}catch(De){return!1}}())return p;$jscomp.initSymbol();
$jscomp.initSymbolIterator();var u=new WeakMap,B=function(p){this.data_={};this.head_=R();this.size=0;if(p){p=$jscomp.makeIterator(p);for(var u;!(u=p.next()).done;)u=u.value,this.set(u[0],u[1])}};B.prototype.set=function(p,u){var B=y(this,p);B.list||(B.list=this.data_[B.id]=[]);B.entry?B.entry.value=u:(B.entry={next:this.head_,previous:this.head_.previous,head:this.head_,key:p,value:u},B.list.push(B.entry),this.head_.previous.next=B.entry,this.head_.previous=B.entry,this.size++);return this};B.prototype.delete=
function(p){p=y(this,p);return p.entry&&p.list?(p.list.splice(p.index,1),p.list.length||delete this.data_[p.id],p.entry.previous.next=p.entry.next,p.entry.next.previous=p.entry.previous,p.entry.head=null,this.size--,!0):!1};B.prototype.clear=function(){this.data_={};this.head_=this.head_.previous=R();this.size=0};B.prototype.has=function(p){return!!y(this,p).entry};B.prototype.get=function(p){return(p=y(this,p).entry)&&p.value};B.prototype.entries=function(){return Q(this,function(p){return[p.key,
p.value]})};B.prototype.keys=function(){return Q(this,function(p){return p.key})};B.prototype.values=function(){return Q(this,function(p){return p.value})};B.prototype.forEach=function(p,u){for(var B=this.entries(),y;!(y=B.next()).done;)y=y.value,p.call(u,y[1],y[0],this)};B.prototype[Symbol.iterator]=B.prototype.entries;var y=function(p,B){var y;y=B&&typeof B;"object"==y||"function"==y?u.has(B)?y=u.get(B):(y=""+ ++X,u.set(B,y)):y="p_"+B;var Q=p.data_[y];if(Q&&$jscomp.owns(p.data_,y))for(p=0;p<Q.length;p++){var R=
Q[p];if(B!==B&&R.key!==R.key||B===R.key)return{id:y,list:Q,index:p,entry:R}}return{id:y,list:Q,index:-1,entry:void 0}},Q=function(p,u){var B=p.head_;return $jscomp.iteratorPrototype(function(){if(B){for(;B.head!=p.head_;)B=B.previous;for(;B.next!=B.head;)return B=B.next,{done:!1,value:u(B)};B=null}return{done:!0,value:void 0}})},R=function(){var p={};return p.previous=p.next=p.head=p},X=0;return B},"es6-impl","es3");$jscomp.ASSUME_NO_NATIVE_SET=!1;
$jscomp.polyfill("Set",function(p){if(!$jscomp.ASSUME_NO_NATIVE_SET&&function(){if(!p||!p.prototype.entries||"function"!=typeof Object.seal)return!1;try{var u=Object.seal({x:4}),y=new p($jscomp.makeIterator([u]));if(!y.has(u)||1!=y.size||y.add(u)!=y||1!=y.size||y.add({x:4})!=y||2!=y.size)return!1;var Q=y.entries(),R=Q.next();if(R.done||R.value[0]!=u||R.value[1]!=u)return!1;R=Q.next();return R.done||R.value[0]==u||4!=R.value[0].x||R.value[1]!=R.value[0]?!1:Q.next().done}catch(X){return!1}}())return p;
$jscomp.initSymbol();$jscomp.initSymbolIterator();var u=function(p){this.map_=new Map;if(p){p=$jscomp.makeIterator(p);for(var u;!(u=p.next()).done;)this.add(u.value)}this.size=this.map_.size};u.prototype.add=function(p){this.map_.set(p,p);this.size=this.map_.size;return this};u.prototype.delete=function(p){p=this.map_.delete(p);this.size=this.map_.size;return p};u.prototype.clear=function(){this.map_.clear();this.size=0};u.prototype.has=function(p){return this.map_.has(p)};u.prototype.entries=function(){return this.map_.entries()};
u.prototype.values=function(){return this.map_.values()};u.prototype.keys=u.prototype.values;u.prototype[Symbol.iterator]=u.prototype.values;u.prototype.forEach=function(p,u){var B=this;this.map_.forEach(function(y){return p.call(u,y,y,B)})};return u},"es6-impl","es3");$jscomp.polyfill("Number.MAX_SAFE_INTEGER",function(){return 9007199254740991},"es6-impl","es3");
$jscomp.polyfill("Number.isFinite",function(p){return p?p:function(p){return"number"!==typeof p?!1:!isNaN(p)&&Infinity!==p&&-Infinity!==p}},"es6-impl","es3");$jscomp.polyfill("Number.isInteger",function(p){return p?p:function(p){return Number.isFinite(p)?p===Math.floor(p):!1}},"es6-impl","es3");$jscomp.polyfill("Number.isSafeInteger",function(p){return p?p:function(p){return Number.isInteger(p)&&Math.abs(p)<=Number.MAX_SAFE_INTEGER}},"es6-impl","es3");
$jscomp.polyfill("Array.prototype.values",function(p){return p?p:function(){return $jscomp.iteratorFromArray(this,function(p,B){return B})}},"es6","es3");$jscomp.polyfill("Number.isNaN",function(p){return p?p:function(p){return"number"===typeof p&&isNaN(p)}},"es6-impl","es3");$jscomp.findInternal=function(p,u,B){p instanceof String&&(p=String(p));for(var y=p.length,Q=0;Q<y;Q++){var R=p[Q];if(u.call(B,R,Q,p))return{i:Q,v:R}}return{i:-1,v:void 0}};
$jscomp.polyfill("Array.prototype.find",function(p){return p?p:function(p,B){return $jscomp.findInternal(this,p,B).v}},"es6-impl","es3");$jscomp.polyfill("Array.prototype.entries",function(p){return p?p:function(){return $jscomp.iteratorFromArray(this,function(p,B){return[p,B]})}},"es6-impl","es3");
$jscomp.polyfill("Array.prototype.fill",function(p){return p?p:function(p,B,y){var u=this.length||0;0>B&&(B=Math.max(0,u+B));if(null==y||y>u)y=u;y=Number(y);0>y&&(y=Math.max(0,u+y));for(B=Number(B||0);B<y;B++)this[B]=p;return this}},"es6-impl","es3");$jscomp.polyfill("Math.log2",function(p){return p?p:function(p){return Math.log(p)/Math.LN2}},"es6-impl","es3");$jscomp.polyfill("Math.sign",function(p){return p?p:function(p){p=Number(p);return 0===p||isNaN(p)?p:0<p?1:-1}},"es6-impl","es3");
$jscomp.polyfill("Math.sinh",function(p){if(p)return p;var u=Math.exp;return function(p){p=Number(p);return 0===p?p:(u(p)-u(-p))/2}},"es6-impl","es3");$jscomp.polyfill("Math.cosh",function(p){if(p)return p;var u=Math.exp;return function(p){p=Number(p);return(u(p)+u(-p))/2}},"es6-impl","es3");$jscomp.polyfill("Math.tanh",function(p){return p?p:function(p){p=Number(p);if(0===p)return p;var u=Math.exp(-2*Math.abs(p)),u=(1-u)/(1+u);return 0>p?-u:u}},"es6-impl","es3");
$jscomp.polyfill("Math.asinh",function(p){return p?p:function(p){p=Number(p);if(0===p)return p;var u=Math.log(Math.abs(p)+Math.sqrt(p*p+1));return 0>p?-u:u}},"es6-impl","es3");$jscomp.polyfill("Math.acosh",function(p){return p?p:function(p){p=Number(p);return Math.log(p+Math.sqrt(p*p-1))}},"es6-impl","es3");
$jscomp.polyfill("Math.log1p",function(p){return p?p:function(p){p=Number(p);if(.25>p&&-.25<p){for(var u=p,y=1,Q=p,R=0,X=1;R!=Q;)u*=p,X*=-1,Q=(R=Q)+X*u/++y;return Q}return Math.log(1+p)}},"es6-impl","es3");$jscomp.polyfill("Math.atanh",function(p){if(p)return p;var u=Math.log1p;return function(p){p=Number(p);return(u(p)-u(-p))/2}},"es6-impl","es3");$jscomp.polyfill("Math.log10",function(p){return p?p:function(p){return Math.log(p)/Math.LN10}},"es6-impl","es3");
$jscomp.polyfill("Math.trunc",function(p){return p?p:function(p){p=Number(p);if(isNaN(p)||Infinity===p||-Infinity===p||0===p)return p;var u=Math.floor(Math.abs(p));return 0>p?-u:u}},"es6-impl","es3");
$jscomp.polyfill("Math.hypot",function(p){return p?p:function(p,B,y){p=Number(p);B=Number(B);var u,R,X,ga=Math.max(Math.abs(p),Math.abs(B));for(u=2;u<arguments.length;u++)ga=Math.max(ga,Math.abs(arguments[u]));if(1E100<ga||1E-100>ga){p/=ga;B/=ga;X=p*p+B*B;for(u=2;u<arguments.length;u++)R=Number(arguments[u])/ga,X+=R*R;return Math.sqrt(X)*ga}X=p*p+B*B;for(u=2;u<arguments.length;u++)R=Number(arguments[u]),X+=R*R;return Math.sqrt(X)}},"es6-impl","es3");
$jscomp.polyfill("Array.prototype.findIndex",function(p){return p?p:function(p,B){return $jscomp.findInternal(this,p,B).i}},"es6-impl","es3");
(function(p,u){"object"===typeof exports&&"undefined"!==typeof module?u(exports):"function"===typeof define&&define.amd?define(["exports"],u):u(p.pixpipe={})})(this,function(p){function u(){var h=new Na(9);h[0]=1;h[1]=0;h[2]=0;h[3]=0;h[4]=1;h[5]=0;h[6]=0;h[7]=0;h[8]=1;return h}function B(){var h=new Na(16);h[0]=1;h[1]=0;h[2]=0;h[3]=0;h[4]=0;h[5]=1;h[6]=0;h[7]=0;h[8]=0;h[9]=0;h[10]=1;h[11]=0;h[12]=0;h[13]=0;h[14]=0;h[15]=1;return h}function y(h,c,b,a,d,g,e,f,k,l,m,n,r,v,q,t){var F=new Na(16);F[0]=
h;F[1]=c;F[2]=b;F[3]=a;F[4]=d;F[5]=g;F[6]=e;F[7]=f;F[8]=k;F[9]=l;F[10]=m;F[11]=n;F[12]=r;F[13]=v;F[14]=q;F[15]=t;return F}function Q(h,c){var b=c[0],a=c[1],d=c[2],g=c[3],e=c[4],f=c[5],k=c[6],l=c[7],m=c[8],n=c[9],r=c[10],v=c[11],q=c[12],t=c[13],F=c[14];c=c[15];var x=b*f-a*e,D=b*k-d*e,w=b*l-g*e,A=a*k-d*f,I=a*l-g*f,G=d*l-g*k,p=m*t-n*q,K=m*F-r*q,W=m*c-v*q,L=n*F-r*t,u=n*c-v*t,J=r*c-v*F,E=x*J-D*u+w*L+A*W-I*K+G*p;if(!E)return null;E=1/E;h[0]=(f*J-k*u+l*L)*E;h[1]=(d*u-a*J-g*L)*E;h[2]=(t*G-F*I+c*A)*E;h[3]=
(r*I-n*G-v*A)*E;h[4]=(k*W-e*J-l*K)*E;h[5]=(b*J-d*W+g*K)*E;h[6]=(F*w-q*G-c*D)*E;h[7]=(m*G-r*w+v*D)*E;h[8]=(e*u-f*W+l*p)*E;h[9]=(a*W-b*u-g*p)*E;h[10]=(q*I-t*w+c*x)*E;h[11]=(n*w-m*I-v*x)*E;h[12]=(f*K-e*L-k*p)*E;h[13]=(b*L-a*K+d*p)*E;h[14]=(t*D-q*A-F*x)*E;h[15]=(m*A-n*D+r*x)*E;return h}function R(){var h=new Na(3);h[0]=0;h[1]=0;h[2]=0;return h}function X(h,c,b){var a=new Na(3);a[0]=h;a[1]=c;a[2]=b;return a}function ga(h,c,b){var a=c[0],d=c[1];c=c[2];var g=b[0],e=b[1];b=b[2];h[0]=d*b-c*e;h[1]=c*g-a*b;
h[2]=a*e-d*g;return h}function Ob(){var h=new Na(4);h[0]=0;h[1]=0;h[2]=0;h[3]=0;return h}function zd(){var h=new Na(4);h[0]=0;h[1]=0;h[2]=0;h[3]=1;return h}function Ad(h,c,b,a){var d=c[0],g=c[1],e=c[2];c=c[3];var f=b[0],k=b[1],l=b[2];b=b[3];var m,n,r;n=d*f+g*k+e*l+c*b;0>n&&(n=-n,f=-f,k=-k,l=-l,b=-b);1E-6<1-n?(m=Math.acos(n),r=Math.sin(m),n=Math.sin((1-a)*m)/r,a=Math.sin(a*m)/r):n=1-a;h[0]=n*d+a*f;h[1]=n*g+a*k;h[2]=n*e+a*l;h[3]=n*c+a*b;return h}function De(){var h=new Na(2);h[0]=0;h[1]=0;return h}
function hb(){throw Error("Dynamic requires are not currently supported by rollup-plugin-commonjs");}function qa(h,c){return c={exports:{}},h(c,c.exports),c.exports}function Sc(){throw Error("setTimeout has not been defined");}function Fe(){throw Error("clearTimeout has not been defined");}function Ge(h){if(ib===setTimeout)return setTimeout(h,0);if((ib===Sc||!ib)&&setTimeout)return ib=setTimeout,setTimeout(h,0);try{return ib(h,0)}catch(c){try{return ib.call(null,h,0)}catch(b){return ib.call(this,
h,0)}}}function di(h){if(jb===clearTimeout)return clearTimeout(h);if((jb===Fe||!jb)&&clearTimeout)return jb=clearTimeout,clearTimeout(h);try{return jb(h)}catch(c){try{return jb.call(null,h)}catch(b){return jb.call(this,h)}}}function ei(){Pb&&wb&&(Pb=!1,wb.length?Ya=wb.concat(Ya):Tc=-1,Ya.length&&He())}function He(){if(!Pb){var h=Ge(ei);Pb=!0;for(var c=Ya.length;c;){wb=Ya;for(Ya=[];++Tc<c;)wb&&wb[Tc].run();Tc=-1;c=Ya.length}wb=null;Pb=!1;di(h)}}function Ie(h,c){this.fun=h;this.array=c}function xb(){}
function Je(){Bd=!0;for(var h=0;64>h;++h)Oa[h]="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"[h],Fa["ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charCodeAt(h)]=h;Fa[45]=62;Fa[95]=63}function fi(h,c,b){for(var a=[],d=c;d<b;d+=3)c=(h[d]<<16)+(h[d+1]<<8)+h[d+2],a.push(Oa[c>>18&63]+Oa[c>>12&63]+Oa[c>>6&63]+Oa[c&63]);return a.join("")}function Ke(h){Bd||Je();for(var c=h.length,b=c%3,a="",d=[],g=0,e=c-b;g<e;g+=16383)d.push(fi(h,g,g+16383>e?e:g+16383));1===b?(h=
h[c-1],a+=Oa[h>>2],a+=Oa[h<<4&63],a+="=="):2===b&&(h=(h[c-2]<<8)+h[c-1],a+=Oa[h>>10],a+=Oa[h>>4&63],a+=Oa[h<<2&63],a+="=");d.push(a);return d.join("")}function Uc(h,c,b,a,d){var g;g=8*d-a-1;var e=(1<<g)-1,f=e>>1,k=-7;d=b?d-1:0;var l=b?-1:1,m=h[c+d];d+=l;b=m&(1<<-k)-1;m>>=-k;for(k+=g;0<k;b=256*b+h[c+d],d+=l,k-=8);g=b&(1<<-k)-1;b>>=-k;for(k+=a;0<k;g=256*g+h[c+d],d+=l,k-=8);if(0===b)b=1-f;else{if(b===e)return g?NaN:Infinity*(m?-1:1);g+=Math.pow(2,a);b-=f}return(m?-1:1)*g*Math.pow(2,b-a)}function Le(h,
c,b,a,d,g){var e,f=8*g-d-1,k=(1<<f)-1,l=k>>1,m=23===d?Math.pow(2,-24)-Math.pow(2,-77):0;g=a?0:g-1;var n=a?1:-1,r=0>c||0===c&&0>1/c?1:0;c=Math.abs(c);isNaN(c)||Infinity===c?(c=isNaN(c)?1:0,a=k):(a=Math.floor(Math.log(c)/Math.LN2),1>c*(e=Math.pow(2,-a))&&(a--,e*=2),c=1<=a+l?c+m/e:c+m*Math.pow(2,1-l),2<=c*e&&(a++,e/=2),a+l>=k?(c=0,a=k):1<=a+l?(c=(c*e-1)*Math.pow(2,d),a+=l):(c=c*Math.pow(2,l-1)*Math.pow(2,d),a=0));for(;8<=d;h[b+g]=c&255,g+=n,c/=256,d-=8);a=a<<d|c;for(f+=d;0<f;h[b+g]=a&255,g+=n,a/=256,
f-=8);h[b+g-n]|=128*r}function Za(h,c){if((z.TYPED_ARRAY_SUPPORT?2147483647:1073741823)<c)throw new RangeError("Invalid typed array length");z.TYPED_ARRAY_SUPPORT?(h=new Uint8Array(c),h.__proto__=z.prototype):(null===h&&(h=new z(c)),h.length=c);return h}function z(h,c,b){if(!(z.TYPED_ARRAY_SUPPORT||this instanceof z))return new z(h,c,b);if("number"===typeof h){if("string"===typeof c)throw Error("If encoding is specified then the first argument must be a string");return Cd(this,h)}return Me(this,h,
c,b)}function Me(h,c,b,a){if("number"===typeof c)throw new TypeError('"value" argument must not be a number');if("undefined"!==typeof ArrayBuffer&&c instanceof ArrayBuffer){c.byteLength;if(0>b||c.byteLength<b)throw new RangeError("'offset' is out of bounds");if(c.byteLength<b+(a||0))throw new RangeError("'length' is out of bounds");c=void 0===b&&void 0===a?new Uint8Array(c):void 0===a?new Uint8Array(c,b):new Uint8Array(c,b,a);z.TYPED_ARRAY_SUPPORT?(h=c,h.__proto__=z.prototype):h=Dd(h,c);return h}if("string"===
typeof c){a=h;h=b;if("string"!==typeof h||""===h)h="utf8";if(!z.isEncoding(h))throw new TypeError('"encoding" must be a valid string encoding');b=Ne(c,h)|0;a=Za(a,b);c=a.write(c,h);c!==b&&(a=a.slice(0,c));return a}return gi(h,c)}function Oe(h){if("number"!==typeof h)throw new TypeError('"size" argument must be a number');if(0>h)throw new RangeError('"size" argument must not be negative');}function Cd(h,c){Oe(c);h=Za(h,0>c?0:Ed(c)|0);if(!z.TYPED_ARRAY_SUPPORT)for(var b=0;b<c;++b)h[b]=0;return h}function Dd(h,
c){var b=0>c.length?0:Ed(c.length)|0;h=Za(h,b);for(var a=0;a<b;a+=1)h[a]=c[a]&255;return h}function gi(h,c){if(Pa(c)){var b=Ed(c.length)|0;h=Za(h,b);if(0===h.length)return h;c.copy(h,0,0,b);return h}if(c){if("undefined"!==typeof ArrayBuffer&&c.buffer instanceof ArrayBuffer||"length"in c)return(b="number"!==typeof c.length)||(b=c.length,b=b!==b),b?Za(h,0):Dd(h,c);if("Buffer"===c.type&&Pe(c.data))return Dd(h,c.data)}throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.");
}function Ed(h){if(h>=(z.TYPED_ARRAY_SUPPORT?2147483647:1073741823))throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+(z.TYPED_ARRAY_SUPPORT?2147483647:1073741823).toString(16)+" bytes");return h|0}function Pa(h){return!(null==h||!h._isBuffer)}function Ne(h,c){if(Pa(h))return h.length;if("undefined"!==typeof ArrayBuffer&&"function"===typeof ArrayBuffer.isView&&(ArrayBuffer.isView(h)||h instanceof ArrayBuffer))return h.byteLength;"string"!==typeof h&&(h=""+h);var b=h.length;
if(0===b)return 0;for(var a=!1;;)switch(c){case "ascii":case "latin1":case "binary":return b;case "utf8":case "utf-8":case void 0:return Vc(h).length;case "ucs2":case "ucs-2":case "utf16le":case "utf-16le":return 2*b;case "hex":return b>>>1;case "base64":return Qe(h).length;default:if(a)return Vc(h).length;c=(""+c).toLowerCase();a=!0}}function hi(h,c,b){var a=!1;if(void 0===c||0>c)c=0;if(c>this.length)return"";if(void 0===b||b>this.length)b=this.length;if(0>=b)return"";b>>>=0;c>>>=0;if(b<=c)return"";
for(h||(h="utf8");;)switch(h){case "hex":h=c;c=b;b=this.length;if(!h||0>h)h=0;if(!c||0>c||c>b)c=b;a="";for(b=h;b<c;++b)h=a,a=this[b],a=16>a?"0"+a.toString(16):a.toString(16),a=h+a;return a;case "utf8":case "utf-8":return Re(this,c,b);case "ascii":h="";for(b=Math.min(this.length,b);c<b;++c)h+=String.fromCharCode(this[c]&127);return h;case "latin1":case "binary":h="";for(b=Math.min(this.length,b);c<b;++c)h+=String.fromCharCode(this[c]);return h;case "base64":return c=0===c&&b===this.length?Ke(this):
Ke(this.slice(c,b)),c;case "ucs2":case "ucs-2":case "utf16le":case "utf-16le":c=this.slice(c,b);b="";for(h=0;h<c.length;h+=2)b+=String.fromCharCode(c[h]+256*c[h+1]);return b;default:if(a)throw new TypeError("Unknown encoding: "+h);h=(h+"").toLowerCase();a=!0}}function yb(h,c,b){var a=h[c];h[c]=h[b];h[b]=a}function Se(h,c,b,a,d){if(0===h.length)return-1;"string"===typeof b?(a=b,b=0):2147483647<b?b=2147483647:-2147483648>b&&(b=-2147483648);b=+b;isNaN(b)&&(b=d?0:h.length-1);0>b&&(b=h.length+b);if(b>=
h.length){if(d)return-1;b=h.length-1}else if(0>b)if(d)b=0;else return-1;"string"===typeof c&&(c=z.from(c,a));if(Pa(c))return 0===c.length?-1:Te(h,c,b,a,d);if("number"===typeof c)return c&=255,z.TYPED_ARRAY_SUPPORT&&"function"===typeof Uint8Array.prototype.indexOf?d?Uint8Array.prototype.indexOf.call(h,c,b):Uint8Array.prototype.lastIndexOf.call(h,c,b):Te(h,[c],b,a,d);throw new TypeError("val must be string, number or Buffer");}function Te(h,c,b,a,d){function g(a,d){return 1===e?a[d]:a.readUInt16BE(d*
e)}var e=1,f=h.length,k=c.length;if(void 0!==a&&(a=String(a).toLowerCase(),"ucs2"===a||"ucs-2"===a||"utf16le"===a||"utf-16le"===a)){if(2>h.length||2>c.length)return-1;e=2;f/=2;k/=2;b/=2}if(d)for(a=-1;b<f;b++)if(g(h,b)===g(c,-1===a?0:b-a)){if(-1===a&&(a=b),b-a+1===k)return a*e}else-1!==a&&(b-=b-a),a=-1;else for(b+k>f&&(b=f-k);0<=b;b--){f=!0;for(a=0;a<k;a++)if(g(h,b+a)!==g(c,a)){f=!1;break}if(f)return b}return-1}function Re(h,c,b){b=Math.min(h.length,b);for(var a=[];c<b;){var d=h[c],g=null,e=239<d?
4:223<d?3:191<d?2:1;if(c+e<=b){var f,k,l;switch(e){case 1:128>d&&(g=d);break;case 2:f=h[c+1];128===(f&192)&&(d=(d&31)<<6|f&63,127<d&&(g=d));break;case 3:f=h[c+1];k=h[c+2];128===(f&192)&&128===(k&192)&&(d=(d&15)<<12|(f&63)<<6|k&63,2047<d&&(55296>d||57343<d)&&(g=d));break;case 4:f=h[c+1],k=h[c+2],l=h[c+3],128===(f&192)&&128===(k&192)&&128===(l&192)&&(d=(d&15)<<18|(f&63)<<12|(k&63)<<6|l&63,65535<d&&1114112>d&&(g=d))}}null===g?(g=65533,e=1):65535<g&&(g-=65536,a.push(g>>>10&1023|55296),g=56320|g&1023);
a.push(g);c+=e}h=a.length;if(h<=Ue)a=String.fromCharCode.apply(String,a);else{b="";for(c=0;c<h;)b+=String.fromCharCode.apply(String,a.slice(c,c+=Ue));a=b}return a}function ha(h,c,b){if(0!==h%1||0>h)throw new RangeError("offset is not uint");if(h+c>b)throw new RangeError("Trying to access beyond buffer length");}function ua(h,c,b,a,d,g){if(!Pa(h))throw new TypeError('"buffer" argument must be a Buffer instance');if(c>d||c<g)throw new RangeError('"value" argument is out of bounds');if(b+a>h.length)throw new RangeError("Index out of range");
}function Wc(h,c,b,a){0>c&&(c=65535+c+1);for(var d=0,g=Math.min(h.length-b,2);d<g;++d)h[b+d]=(c&255<<8*(a?d:1-d))>>>8*(a?d:1-d)}function Xc(h,c,b,a){0>c&&(c=4294967295+c+1);for(var d=0,g=Math.min(h.length-b,4);d<g;++d)h[b+d]=c>>>8*(a?d:3-d)&255}function Ve(h,c,b,a,d,g){if(b+a>h.length)throw new RangeError("Index out of range");if(0>b)throw new RangeError("Index out of range");}function We(h,c,b,a,d){d||Ve(h,c,b,4,3.4028234663852886E38,-3.4028234663852886E38);Le(h,c,b,a,23,4);return b+4}function Xe(h,
c,b,a,d){d||Ve(h,c,b,8,1.7976931348623157E308,-1.7976931348623157E308);Le(h,c,b,a,52,8);return b+8}function Vc(h,c){c=c||Infinity;for(var b,a=h.length,d=null,g=[],e=0;e<a;++e){b=h.charCodeAt(e);if(55295<b&&57344>b){if(!d){if(56319<b){-1<(c-=3)&&g.push(239,191,189);continue}else if(e+1===a){-1<(c-=3)&&g.push(239,191,189);continue}d=b;continue}if(56320>b){-1<(c-=3)&&g.push(239,191,189);d=b;continue}b=(d-55296<<10|b-56320)+65536}else d&&-1<(c-=3)&&g.push(239,191,189);d=null;if(128>b){if(0>--c)break;
g.push(b)}else if(2048>b){if(0>(c-=2))break;g.push(b>>6|192,b&63|128)}else if(65536>b){if(0>(c-=3))break;g.push(b>>12|224,b>>6&63|128,b&63|128)}else if(1114112>b){if(0>(c-=4))break;g.push(b>>18|240,b>>12&63|128,b>>6&63|128,b&63|128)}else throw Error("Invalid code point");}return g}function Ye(h){for(var c=[],b=0;b<h.length;++b)c.push(h.charCodeAt(b)&255);return c}function Qe(h){h=(h.trim?h.trim():h.replace(/^\s+|\s+$/g,"")).replace(ii,"");if(2>h.length)h="";else for(;0!==h.length%4;)h+="=";Bd||Je();
var c,b,a,d,g;c=h.length;if(0<c%4)throw Error("Invalid string. Length must be a multiple of 4");d="="===h[c-2]?2:"="===h[c-1]?1:0;g=new ji(3*c/4-d);b=0<d?c-4:c;var e=0;for(c=0;c<b;c+=4)a=Fa[h.charCodeAt(c)]<<18|Fa[h.charCodeAt(c+1)]<<12|Fa[h.charCodeAt(c+2)]<<6|Fa[h.charCodeAt(c+3)],g[e++]=a>>16&255,g[e++]=a>>8&255,g[e++]=a&255;2===d?(a=Fa[h.charCodeAt(c)]<<2|Fa[h.charCodeAt(c+1)]>>4,g[e++]=a&255):1===d&&(a=Fa[h.charCodeAt(c)]<<10|Fa[h.charCodeAt(c+1)]<<4|Fa[h.charCodeAt(c+2)]>>2,g[e++]=a>>8&255,
g[e++]=a&255);return g}function kc(h,c,b,a){for(var d=0;d<a&&!(d+b>=c.length||d>=h.length);++d)c[d+b]=h[d];return d}function Ze(h){return null!=h&&(!!h._isBuffer||$e(h)||"function"===typeof h.readFloatLE&&"function"===typeof h.slice&&$e(h.slice(0,0)))}function $e(h){return!!h.constructor&&"function"===typeof h.constructor.isBuffer&&h.constructor.isBuffer(h)}function Qb(h){for(var c=h.length;0<=--c;)h[c]=0}function Fd(h,c,b,a,d){this.static_tree=h;this.extra_bits=c;this.extra_base=b;this.elems=a;this.max_length=
d;this.has_stree=h&&h.length}function Gd(h,c){this.dyn_tree=h;this.max_code=0;this.stat_desc=c}function lc(h,c){h.pending_buf[h.pending++]=c&255;h.pending_buf[h.pending++]=c>>>8&255}function va(h,c,b){h.bi_valid>16-b?(h.bi_buf|=c<<h.bi_valid&65535,lc(h,h.bi_buf),h.bi_buf=c>>16-h.bi_valid,h.bi_valid+=b-16):(h.bi_buf|=c<<h.bi_valid&65535,h.bi_valid+=b)}function Qa(h,c,b){va(h,b[2*c],b[2*c+1])}function af(h,c){var b=0;do b|=h&1,h>>>=1,b<<=1;while(0<--c);return b>>>1}function bf(h,c,b){var a=Array(16),
d=0,g;for(g=1;15>=g;g++)a[g]=d=d+b[g-1]<<1;for(b=0;b<=c;b++)d=h[2*b+1],0!==d&&(h[2*b]=af(a[d]++,d))}function cf(h){var c;for(c=0;286>c;c++)h.dyn_ltree[2*c]=0;for(c=0;30>c;c++)h.dyn_dtree[2*c]=0;for(c=0;19>c;c++)h.bl_tree[2*c]=0;h.dyn_ltree[512]=1;h.opt_len=h.static_len=0;h.last_lit=h.matches=0}function df(h){8<h.bi_valid?lc(h,h.bi_buf):0<h.bi_valid&&(h.pending_buf[h.pending++]=h.bi_buf);h.bi_buf=0;h.bi_valid=0}function ef(h,c,b,a){var d=2*c,g=2*b;return h[d]<h[g]||h[d]===h[g]&&a[c]<=a[b]}function Hd(h,
c,b){for(var a=h.heap[b],d=b<<1;d<=h.heap_len;){d<h.heap_len&&ef(c,h.heap[d+1],h.heap[d],h.depth)&&d++;if(ef(c,a,h.heap[d],h.depth))break;h.heap[b]=h.heap[d];b=d;d<<=1}h.heap[b]=a}function ff(h,c,b){var a,d,g=0,e,f;if(0!==h.last_lit){do a=h.pending_buf[h.d_buf+2*g]<<8|h.pending_buf[h.d_buf+2*g+1],d=h.pending_buf[h.l_buf+g],g++,0===a?Qa(h,d,c):(e=mc[d],Qa(h,e+256+1,c),f=Id[e],0!==f&&(d-=Jd[e],va(h,d,f)),a--,e=256>a?zb[a]:zb[256+(a>>>7)],Qa(h,e,b),f=Yc[e],0!==f&&(a-=Zc[e],va(h,a,f)));while(g<h.last_lit)
}Qa(h,256,c)}function Kd(h,c){var b=c.dyn_tree,a=c.stat_desc.static_tree,d=c.stat_desc.has_stree,g=c.stat_desc.elems,e,f=-1,k;h.heap_len=0;h.heap_max=573;for(e=0;e<g;e++)0!==b[2*e]?(h.heap[++h.heap_len]=f=e,h.depth[e]=0):b[2*e+1]=0;for(;2>h.heap_len;)k=h.heap[++h.heap_len]=2>f?++f:0,b[2*k]=1,h.depth[k]=0,h.opt_len--,d&&(h.static_len-=a[2*k+1]);c.max_code=f;for(e=h.heap_len>>1;1<=e;e--)Hd(h,b,e);k=g;do e=h.heap[1],h.heap[1]=h.heap[h.heap_len--],Hd(h,b,1),a=h.heap[1],h.heap[--h.heap_max]=e,h.heap[--h.heap_max]=
a,b[2*k]=b[2*e]+b[2*a],h.depth[k]=(h.depth[e]>=h.depth[a]?h.depth[e]:h.depth[a])+1,b[2*e+1]=b[2*a+1]=k,h.heap[1]=k++,Hd(h,b,1);while(2<=h.heap_len);h.heap[--h.heap_max]=h.heap[1];e=c.dyn_tree;k=c.max_code;var a=c.stat_desc.static_tree,d=c.stat_desc.has_stree,g=c.stat_desc.extra_bits,l=c.stat_desc.extra_base,m=c.stat_desc.max_length,n,r,v,q,t=0;for(r=0;15>=r;r++)h.bl_count[r]=0;e[2*h.heap[h.heap_max]+1]=0;for(c=h.heap_max+1;573>c;c++)n=h.heap[c],r=e[2*e[2*n+1]+1]+1,r>m&&(r=m,t++),e[2*n+1]=r,n>k||(h.bl_count[r]++,
v=0,n>=l&&(v=g[n-l]),q=e[2*n],h.opt_len+=q*(r+v),d&&(h.static_len+=q*(a[2*n+1]+v)));if(0!==t){do{for(r=m-1;0===h.bl_count[r];)r--;h.bl_count[r]--;h.bl_count[r+1]+=2;h.bl_count[m]--;t-=2}while(0<t);for(r=m;0!==r;r--)for(n=h.bl_count[r];0!==n;)a=h.heap[--c],a>k||(e[2*a+1]!==r&&(h.opt_len+=(r-e[2*a+1])*e[2*a],e[2*a+1]=r),n--)}bf(b,f,h.bl_count)}function gf(h,c,b){var a,d=-1,g,e=c[1],f=0,k=7,l=4;0===e&&(k=138,l=3);c[2*(b+1)+1]=65535;for(a=0;a<=b;a++)g=e,e=c[2*(a+1)+1],++f<k&&g===e||(f<l?h.bl_tree[2*g]+=
f:0!==g?(g!==d&&h.bl_tree[2*g]++,h.bl_tree[32]++):10>=f?h.bl_tree[34]++:h.bl_tree[36]++,f=0,d=g,0===e?(k=138,l=3):g===e?(k=6,l=3):(k=7,l=4))}function hf(h,c,b){var a,d=-1,g,e=c[1],f=0,k=7,l=4;0===e&&(k=138,l=3);for(a=0;a<=b;a++)if(g=e,e=c[2*(a+1)+1],!(++f<k&&g===e)){if(f<l){do Qa(h,g,h.bl_tree);while(0!==--f)}else 0!==g?(g!==d&&(Qa(h,g,h.bl_tree),f--),Qa(h,16,h.bl_tree),va(h,f-3,2)):10>=f?(Qa(h,17,h.bl_tree),va(h,f-3,3)):(Qa(h,18,h.bl_tree),va(h,f-11,7));f=0;d=g;0===e?(k=138,l=3):g===e?(k=6,l=3):
(k=7,l=4)}}function ki(h){var c=4093624447,b;for(b=0;31>=b;b++,c>>>=1)if(c&1&&0!==h.dyn_ltree[2*b])return 0;if(0!==h.dyn_ltree[18]||0!==h.dyn_ltree[20]||0!==h.dyn_ltree[26])return 1;for(b=32;256>b;b++)if(0!==h.dyn_ltree[2*b])return 1;return 0}function jf(h,c,b,a){va(h,0+(a?1:0),3);df(h);lc(h,b);lc(h,~b);T.arraySet(h.pending_buf,h.window,c,b,h.pending);h.pending+=b}function kb(h,c){h.msg=Rb[c];return c}function lb(h){for(var c=h.length;0<=--c;)h[c]=0}function mb(h){var c=h.state,b=c.pending;b>h.avail_out&&
(b=h.avail_out);0!==b&&(T.arraySet(h.output,c.pending_buf,c.pending_out,b,h.next_out),h.next_out+=b,c.pending_out+=b,h.total_out+=b,h.avail_out-=b,c.pending-=b,0===c.pending&&(c.pending_out=0))}function ma(h,c){Ga._tr_flush_block(h,0<=h.block_start?h.block_start:-1,h.strstart-h.block_start,c);h.block_start=h.strstart;mb(h.strm)}function da(h,c){h.pending_buf[h.pending++]=c}function nc(h,c){h.pending_buf[h.pending++]=c>>>8&255;h.pending_buf[h.pending++]=c&255}function kf(h,c){var b=h.max_chain_length,
a=h.strstart,d,g=h.prev_length,e=h.nice_match,f=h.strstart>h.w_size-262?h.strstart-(h.w_size-262):0,k=h.window,l=h.w_mask,m=h.prev,n=h.strstart+258,r=k[a+g-1],v=k[a+g];h.prev_length>=h.good_match&&(b>>=2);e>h.lookahead&&(e=h.lookahead);do if(d=c,k[d+g]===v&&k[d+g-1]===r&&k[d]===k[a]&&k[++d]===k[a+1]){a+=2;for(d++;k[++a]===k[++d]&&k[++a]===k[++d]&&k[++a]===k[++d]&&k[++a]===k[++d]&&k[++a]===k[++d]&&k[++a]===k[++d]&&k[++a]===k[++d]&&k[++a]===k[++d]&&a<n;);d=258-(n-a);a=n-258;if(d>g){h.match_start=c;
g=d;if(d>=e)break;r=k[a+g-1];v=k[a+g]}}while((c=m[c&l])>f&&0!==--b);return g<=h.lookahead?g:h.lookahead}function Ab(h){var c=h.w_size,b,a,d,g;do{g=h.window_size-h.lookahead-h.strstart;if(h.strstart>=c+(c-262)){T.arraySet(h.window,h.window,c,c,0);h.match_start-=c;h.strstart-=c;h.block_start-=c;b=a=h.hash_size;do d=h.head[--b],h.head[b]=d>=c?d-c:0;while(--a);b=a=c;do d=h.prev[--b],h.prev[b]=d>=c?d-c:0;while(--a);g+=c}if(0===h.strm.avail_in)break;b=h.strm;a=h.window;d=h.strstart+h.lookahead;var e=b.avail_in;
e>g&&(e=g);0===e?a=0:(b.avail_in-=e,T.arraySet(a,b.input,b.next_in,e,d),1===b.state.wrap?b.adler=oc(b.adler,a,e,d):2===b.state.wrap&&(b.adler=na(b.adler,a,e,d)),b.next_in+=e,b.total_in+=e,a=e);h.lookahead+=a;if(3<=h.lookahead+h.insert)for(g=h.strstart-h.insert,h.ins_h=h.window[g],h.ins_h=(h.ins_h<<h.hash_shift^h.window[g+1])&h.hash_mask;h.insert&&!(h.ins_h=(h.ins_h<<h.hash_shift^h.window[g+3-1])&h.hash_mask,h.prev[g&h.w_mask]=h.head[h.ins_h],h.head[h.ins_h]=g,g++,h.insert--,3>h.lookahead+h.insert););
}while(262>h.lookahead&&0!==h.strm.avail_in)}function Ld(h,c){for(var b;;){if(262>h.lookahead){Ab(h);if(262>h.lookahead&&0===c)return 1;if(0===h.lookahead)break}b=0;3<=h.lookahead&&(h.ins_h=(h.ins_h<<h.hash_shift^h.window[h.strstart+3-1])&h.hash_mask,b=h.prev[h.strstart&h.w_mask]=h.head[h.ins_h],h.head[h.ins_h]=h.strstart);0!==b&&h.strstart-b<=h.w_size-262&&(h.match_length=kf(h,b));if(3<=h.match_length)if(b=Ga._tr_tally(h,h.strstart-h.match_start,h.match_length-3),h.lookahead-=h.match_length,h.match_length<=
h.max_lazy_match&&3<=h.lookahead){h.match_length--;do h.strstart++,h.ins_h=(h.ins_h<<h.hash_shift^h.window[h.strstart+3-1])&h.hash_mask,h.prev[h.strstart&h.w_mask]=h.head[h.ins_h],h.head[h.ins_h]=h.strstart;while(0!==--h.match_length);h.strstart++}else h.strstart+=h.match_length,h.match_length=0,h.ins_h=h.window[h.strstart],h.ins_h=(h.ins_h<<h.hash_shift^h.window[h.strstart+1])&h.hash_mask;else b=Ga._tr_tally(h,0,h.window[h.strstart]),h.lookahead--,h.strstart++;if(b&&(ma(h,!1),0===h.strm.avail_out))return 1}h.insert=
2>h.strstart?h.strstart:2;return 4===c?(ma(h,!0),0===h.strm.avail_out?3:4):h.last_lit&&(ma(h,!1),0===h.strm.avail_out)?1:2}function Sb(h,c){for(var b,a;;){if(262>h.lookahead){Ab(h);if(262>h.lookahead&&0===c)return 1;if(0===h.lookahead)break}b=0;3<=h.lookahead&&(h.ins_h=(h.ins_h<<h.hash_shift^h.window[h.strstart+3-1])&h.hash_mask,b=h.prev[h.strstart&h.w_mask]=h.head[h.ins_h],h.head[h.ins_h]=h.strstart);h.prev_length=h.match_length;h.prev_match=h.match_start;h.match_length=2;0!==b&&h.prev_length<h.max_lazy_match&&
h.strstart-b<=h.w_size-262&&(h.match_length=kf(h,b),5>=h.match_length&&(1===h.strategy||3===h.match_length&&4096<h.strstart-h.match_start)&&(h.match_length=2));if(3<=h.prev_length&&h.match_length<=h.prev_length){a=h.strstart+h.lookahead-3;b=Ga._tr_tally(h,h.strstart-1-h.prev_match,h.prev_length-3);h.lookahead-=h.prev_length-1;h.prev_length-=2;do++h.strstart<=a&&(h.ins_h=(h.ins_h<<h.hash_shift^h.window[h.strstart+3-1])&h.hash_mask,h.prev[h.strstart&h.w_mask]=h.head[h.ins_h],h.head[h.ins_h]=h.strstart);
while(0!==--h.prev_length);h.match_available=0;h.match_length=2;h.strstart++;if(b&&(ma(h,!1),0===h.strm.avail_out))return 1}else if(h.match_available){if((b=Ga._tr_tally(h,0,h.window[h.strstart-1]))&&ma(h,!1),h.strstart++,h.lookahead--,0===h.strm.avail_out)return 1}else h.match_available=1,h.strstart++,h.lookahead--}h.match_available&&(Ga._tr_tally(h,0,h.window[h.strstart-1]),h.match_available=0);h.insert=2>h.strstart?h.strstart:2;return 4===c?(ma(h,!0),0===h.strm.avail_out?3:4):h.last_lit&&(ma(h,
!1),0===h.strm.avail_out)?1:2}function li(h,c){for(var b,a,d,g=h.window;;){if(258>=h.lookahead){Ab(h);if(258>=h.lookahead&&0===c)return 1;if(0===h.lookahead)break}h.match_length=0;if(3<=h.lookahead&&0<h.strstart&&(a=h.strstart-1,b=g[a],b===g[++a]&&b===g[++a]&&b===g[++a])){for(d=h.strstart+258;b===g[++a]&&b===g[++a]&&b===g[++a]&&b===g[++a]&&b===g[++a]&&b===g[++a]&&b===g[++a]&&b===g[++a]&&a<d;);h.match_length=258-(d-a);h.match_length>h.lookahead&&(h.match_length=h.lookahead)}3<=h.match_length?(b=Ga._tr_tally(h,
1,h.match_length-3),h.lookahead-=h.match_length,h.strstart+=h.match_length,h.match_length=0):(b=Ga._tr_tally(h,0,h.window[h.strstart]),h.lookahead--,h.strstart++);if(b&&(ma(h,!1),0===h.strm.avail_out))return 1}h.insert=0;return 4===c?(ma(h,!0),0===h.strm.avail_out?3:4):h.last_lit&&(ma(h,!1),0===h.strm.avail_out)?1:2}function mi(h,c){for(var b;;){if(0===h.lookahead&&(Ab(h),0===h.lookahead)){if(0===c)return 1;break}h.match_length=0;b=Ga._tr_tally(h,0,h.window[h.strstart]);h.lookahead--;h.strstart++;
if(b&&(ma(h,!1),0===h.strm.avail_out))return 1}h.insert=0;return 4===c?(ma(h,!0),0===h.strm.avail_out?3:4):h.last_lit&&(ma(h,!1),0===h.strm.avail_out)?1:2}function Ra(h,c,b,a,d){this.good_length=h;this.max_lazy=c;this.nice_length=b;this.max_chain=a;this.func=d}function ni(){this.strm=null;this.status=0;this.pending_buf=null;this.wrap=this.pending=this.pending_out=this.pending_buf_size=0;this.gzhead=null;this.gzindex=0;this.method=8;this.last_flush=-1;this.w_mask=this.w_bits=this.w_size=0;this.window=
null;this.window_size=0;this.head=this.prev=null;this.nice_match=this.good_match=this.strategy=this.level=this.max_lazy_match=this.max_chain_length=this.prev_length=this.lookahead=this.match_start=this.strstart=this.match_available=this.prev_match=this.match_length=this.block_start=this.hash_shift=this.hash_mask=this.hash_bits=this.hash_size=this.ins_h=0;this.dyn_ltree=new T.Buf16(1146);this.dyn_dtree=new T.Buf16(122);this.bl_tree=new T.Buf16(78);lb(this.dyn_ltree);lb(this.dyn_dtree);lb(this.bl_tree);
this.bl_desc=this.d_desc=this.l_desc=null;this.bl_count=new T.Buf16(16);this.heap=new T.Buf16(573);lb(this.heap);this.heap_max=this.heap_len=0;this.depth=new T.Buf16(573);lb(this.depth);this.bi_valid=this.bi_buf=this.insert=this.matches=this.static_len=this.opt_len=this.d_buf=this.last_lit=this.lit_bufsize=this.l_buf=0}function lf(h){var c;if(!h||!h.state)return kb(h,-2);h.total_in=h.total_out=0;h.data_type=2;c=h.state;c.pending=0;c.pending_out=0;0>c.wrap&&(c.wrap=-c.wrap);c.status=c.wrap?42:113;
h.adler=2===c.wrap?0:1;c.last_flush=0;Ga._tr_init(c);return 0}function mf(h){var c=lf(h);0===c&&(h=h.state,h.window_size=2*h.w_size,lb(h.head),h.max_lazy_match=Tb[h.level].max_lazy,h.good_match=Tb[h.level].good_length,h.nice_match=Tb[h.level].nice_length,h.max_chain_length=Tb[h.level].max_chain,h.strstart=0,h.block_start=0,h.lookahead=0,h.insert=0,h.match_length=h.prev_length=2,h.match_available=0,h.ins_h=0);return c}function nf(h,c,b,a,d,g){if(!h)return-2;var e=1;-1===c&&(c=6);0>a?(e=0,a=-a):15<
a&&(e=2,a-=16);if(1>d||9<d||8!==b||8>a||15<a||0>c||9<c||0>g||4<g)return kb(h,-2);8===a&&(a=9);var f=new ni;h.state=f;f.strm=h;f.wrap=e;f.gzhead=null;f.w_bits=a;f.w_size=1<<f.w_bits;f.w_mask=f.w_size-1;f.hash_bits=d+7;f.hash_size=1<<f.hash_bits;f.hash_mask=f.hash_size-1;f.hash_shift=~~((f.hash_bits+3-1)/3);f.window=new T.Buf8(2*f.w_size);f.head=new T.Buf16(f.hash_size);f.prev=new T.Buf16(f.w_size);f.lit_bufsize=1<<d+6;f.pending_buf_size=4*f.lit_bufsize;f.pending_buf=new T.Buf8(f.pending_buf_size);
f.d_buf=1*f.lit_bufsize;f.l_buf=3*f.lit_bufsize;f.level=c;f.strategy=g;f.method=b;return mf(h)}function of(h,c){if(65537>c&&(h.subarray&&pf||!h.subarray&&qf))return String.fromCharCode.apply(null,T.shrinkBuf(h,c));for(var b="",a=0;a<c;a++)b+=String.fromCharCode(h[a]);return b}function Bb(h){if(!(this instanceof Bb))return new Bb(h);h=this.options=T.assign({level:-1,method:8,chunkSize:16384,windowBits:15,memLevel:8,strategy:0,to:""},h||{});h.raw&&0<h.windowBits?h.windowBits=-h.windowBits:h.gzip&&0<
h.windowBits&&16>h.windowBits&&(h.windowBits+=16);this.err=0;this.msg="";this.ended=!1;this.chunks=[];this.strm=new rf;this.strm.avail_out=0;var c=pc.deflateInit2(this.strm,h.level,h.method,h.windowBits,h.memLevel,h.strategy);if(0!==c)throw Error(Rb[c]);h.header&&pc.deflateSetHeader(this.strm,h.header);if(h.dictionary){h="string"===typeof h.dictionary?Cb.string2buf(h.dictionary):"[object ArrayBuffer]"===sf.call(h.dictionary)?new Uint8Array(h.dictionary):h.dictionary;c=pc.deflateSetDictionary(this.strm,
h);if(0!==c)throw Error(Rb[c]);this._dict_set=!0}}function Md(h,c){c=new Bb(c);c.push(h,!0);if(c.err)throw c.msg||Rb[c.err];return c.result}function tf(h){return(h>>>24&255)+(h>>>8&65280)+((h&65280)<<8)+((h&255)<<24)}function oi(){this.mode=0;this.last=!1;this.wrap=0;this.havedict=!1;this.total=this.check=this.dmax=this.flags=0;this.head=null;this.wnext=this.whave=this.wsize=this.wbits=0;this.window=null;this.extra=this.offset=this.length=this.bits=this.hold=0;this.distcode=this.lencode=null;this.have=
this.ndist=this.nlen=this.ncode=this.distbits=this.lenbits=0;this.next=null;this.lens=new T.Buf16(320);this.work=new T.Buf16(288);this.distdyn=this.lendyn=null;this.was=this.back=this.sane=0}function uf(h){var c;if(!h||!h.state)return-2;c=h.state;h.total_in=h.total_out=c.total=0;h.msg="";c.wrap&&(h.adler=c.wrap&1);c.mode=1;c.last=0;c.havedict=0;c.dmax=32768;c.head=null;c.hold=0;c.bits=0;c.lencode=c.lendyn=new T.Buf32(852);c.distcode=c.distdyn=new T.Buf32(592);c.sane=1;c.back=-1;return 0}function vf(h){var c;
if(!h||!h.state)return-2;c=h.state;c.wsize=0;c.whave=0;c.wnext=0;return uf(h)}function wf(h,c){var b,a;if(!h||!h.state)return-2;a=h.state;0>c?(b=0,c=-c):(b=(c>>4)+1,48>c&&(c&=15));if(c&&(8>c||15<c))return-2;null!==a.window&&a.wbits!==c&&(a.window=null);a.wrap=b;a.wbits=c;return vf(h)}function xf(h,c){var b;if(!h)return-2;b=new oi;h.state=b;b.window=null;c=wf(h,c);0!==c&&(h.state=null);return c}function yf(h,c,b,a){var d=h.state;null===d.window&&(d.wsize=1<<d.wbits,d.wnext=0,d.whave=0,d.window=new T.Buf8(d.wsize));
a>=d.wsize?(T.arraySet(d.window,c,b-d.wsize,d.wsize,0),d.wnext=0,d.whave=d.wsize):(h=d.wsize-d.wnext,h>a&&(h=a),T.arraySet(d.window,c,b-a,h,d.wnext),(a-=h)?(T.arraySet(d.window,c,b-a,a,0),d.wnext=a,d.whave=d.wsize):(d.wnext+=h,d.wnext===d.wsize&&(d.wnext=0),d.whave<d.wsize&&(d.whave+=h)));return 0}function Db(h){if(!(this instanceof Db))return new Db(h);var c=this.options=T.assign({chunkSize:16384,windowBits:0,to:""},h||{});c.raw&&0<=c.windowBits&&16>c.windowBits&&(c.windowBits=-c.windowBits,0===
c.windowBits&&(c.windowBits=-15));!(0<=c.windowBits&&16>c.windowBits)||h&&h.windowBits||(c.windowBits+=32);15<c.windowBits&&48>c.windowBits&&0===(c.windowBits&15)&&(c.windowBits|=15);this.err=0;this.msg="";this.ended=!1;this.chunks=[];this.strm=new rf;this.strm.avail_out=0;h=qc.inflateInit2(this.strm,c.windowBits);if(h!==ia.Z_OK)throw Error(Rb[h]);this.header=new pi;qc.inflateGetHeader(this.strm,this.header)}function Nd(h,c){c=new Db(c);c.push(h,!0);if(c.err)throw c.msg||Rb[c.err];return c.result}
function zf(){}function qi(h,c,b,a,d){function g(a){var c=a.slice(1,-1);if(c in b)return b[c];if("#"===c.charAt(0))return a=parseInt(c.substr(1).replace("x","0x")),65535<a?(a-=65536,a=String.fromCharCode(55296+(a>>10),56320+(a&1023))):a=String.fromCharCode(a),a;d.error("entity not found:"+a);return a}function e(d){if(d>v){var b=h.substring(v,d).replace(/&#?\w+;/g,g);n&&f(v);a.characters(b,0,d-v);v=d}}function f(a,d){for(;a>=l&&(d=m.exec(h));)k=d.index,l=k+d[0].length,n.lineNumber++;n.columnNumber=
a-k+1}var k=0,l=0,m=/.*(?:\r\n?|\n)|.*$/g,n=a.locator;c=[{currentNSMap:c}];for(var r={},v=0;;){try{var q=h.indexOf("<",v);if(0>q){if(!h.substr(v).match(/^\s*$/)){var t=a.doc,F=t.createTextNode(h.substr(v));t.appendChild(F);a.currentElement=F}break}q>v&&e(q);switch(h.charAt(q+1)){case "/":var x=h.indexOf(">",q+3),D=h.substring(q+2,x),w=c.pop();0>x?(D=h.substring(q+2).replace(/[\s<].*/,""),d.error("end tag name: "+D+" is not complete:"+w.tagName),x=q+1+D.length):D.match(/\s</)&&(D=D.replace(/[\s<].*/,
""),d.error("end tag name: "+D+" maybe not complete"),x=q+1+D.length);var A=w.localNSMap,I=w.tagName==D;if(I||w.tagName&&w.tagName.toLowerCase()==D.toLowerCase()){a.endElement(w.uri,w.localName,D);if(A)for(var G in A)a.endPrefixMapping(G);I||d.fatalError("end tag name: "+D+" is not match the current start tagName:"+w.tagName)}else c.push(w);x++;break;case "?":n&&f(q);x=ri(h,q,a);break;case "!":n&&f(q);x=si(h,q,a,d);break;default:n&&f(q);var p=new Af,K=c[c.length-1].currentNSMap,x=ti(h,q,p,K,g,d),
W=p.length;!p.closed&&ui(h,x,p.tagName,r)&&(p.closed=!0,b.nbsp||d.warning("unclosed xml attribute"));if(n&&W){for(var L=Bf(n,{}),u=0;u<W;u++){var J=p[u];f(J.offset);J.locator=Bf(n,{})}a.locator=L;Cf(p,a,K)&&c.push(p);a.locator=n}else Cf(p,a,K)&&c.push(p);"http://www.w3.org/1999/xhtml"!==p.uri||p.closed?x++:x=vi(h,x,p.tagName,g,a)}}catch(E){d.error("element parse error: "+E),x=-1}x>v?v=x:e(Math.max(q,v)+1)}}function Bf(h,c){c.lineNumber=h.lineNumber;c.columnNumber=h.columnNumber;return c}function ti(h,
c,b,a,d,g){for(var e,f,k=++c,l=0;;){var m=h.charAt(k);switch(m){case "=":if(1===l)e=h.slice(c,k),l=3;else if(2===l)l=3;else throw Error("attribute equal must after attrName");break;case "'":case '"':if(3===l||1===l)if(1===l&&(g.warning('attribute value must after "="'),e=h.slice(c,k)),c=k+1,k=h.indexOf(m,c),0<k)f=h.slice(c,k).replace(/&#?\w+;/g,d),b.add(e,f,c-1),l=5;else throw Error("attribute value no end '"+m+"' match");else if(4==l)f=h.slice(c,k).replace(/&#?\w+;/g,d),b.add(e,f,c),g.warning('attribute "'+
e+'" missed start quot('+m+")!!"),c=k+1,l=5;else throw Error('attribute value must after "="');break;case "/":switch(l){case 0:b.setTagName(h.slice(c,k));case 5:case 6:case 7:l=7,b.closed=!0;case 4:case 1:case 2:break;default:throw Error("attribute invalid close char('/')");}break;case "":return g.error("unexpected end of input"),0==l&&b.setTagName(h.slice(c,k)),k;case ">":switch(l){case 0:b.setTagName(h.slice(c,k));case 5:case 6:case 7:break;case 4:case 1:f=h.slice(c,k),"/"===f.slice(-1)&&(b.closed=
!0,f=f.slice(0,-1));case 2:2===l&&(f=e);4==l?(g.warning('attribute "'+f+'" missed quot(")!!'),b.add(e,f.replace(/&#?\w+;/g,d),c)):("http://www.w3.org/1999/xhtml"===a[""]&&f.match(/^(?:disabled|checked|selected)$/i)||g.warning('attribute "'+f+'" missed value!! "'+f+'" instead!!'),b.add(f,f,c));break;case 3:throw Error("attribute value missed!!");}return k;case "\u0080":m=" ";default:if(" ">=m)switch(l){case 0:b.setTagName(h.slice(c,k));l=6;break;case 1:e=h.slice(c,k);l=2;break;case 4:f=h.slice(c,k).replace(/&#?\w+;/g,
d),g.warning('attribute "'+f+'" missed quot(")!!'),b.add(e,f,c);case 5:l=6}else switch(l){case 2:"http://www.w3.org/1999/xhtml"===a[""]&&e.match(/^(?:disabled|checked|selected)$/i)||g.warning('attribute "'+e+'" missed value!! "'+e+'" instead2!!');b.add(e,e,c);c=k;l=1;break;case 5:g.warning('attribute space is required"'+e+'"!!');case 6:l=1;c=k;break;case 3:l=4;c=k;break;case 7:throw Error("elements closed character '/' and '>' must be connected to");}}k++}}function Cf(h,c,b){for(var a=h.tagName,d=
null,g=h.length;g--;){var e=h[g],f=e.qName,k=e.value,l=f.indexOf(":");if(0<l)var m=e.prefix=f.slice(0,l),l=f.slice(l+1),m="xmlns"===m&&l;else l=f,m="xmlns"===f&&"";e.localName=l;!1!==m&&(null==d&&(d={},Df(b,b={})),b[m]=d[m]=k,e.uri="http://www.w3.org/2000/xmlns/",c.startPrefixMapping(m,k))}for(g=h.length;g--;)if(e=h[g],m=e.prefix)"xml"===m&&(e.uri="http://www.w3.org/XML/1998/namespace"),"xmlns"!==m&&(e.uri=b[m||""]);l=a.indexOf(":");0<l?(m=h.prefix=a.slice(0,l),l=h.localName=a.slice(l+1)):(m=null,
l=h.localName=a);g=h.uri=b[m||""];c.startElement(g,l,a,h);if(h.closed){if(c.endElement(g,l,a),d)for(m in d)c.endPrefixMapping(m)}else return h.currentNSMap=b,h.localNSMap=d,!0}function vi(h,c,b,a,d){if(/^(?:script|textarea)$/i.test(b)){var g=h.indexOf("</"+b+">",c);h=h.substring(c+1,g);if(/[&<]/.test(h)){if(/^script$/i.test(b))return d.characters(h,0,h.length),g;h=h.replace(/&#?\w+;/g,a);d.characters(h,0,h.length);return g}}return c+1}function ui(h,c,b,a){var d=a[b];null==d&&(d=h.lastIndexOf("</"+
b+">"),d<c&&(d=h.lastIndexOf("</"+b)),a[b]=d);return d<c}function Df(h,c){for(var b in h)c[b]=h[b]}function si(h,c,b,a){switch(h.charAt(c+2)){case "-":if("-"===h.charAt(c+3)){var d=h.indexOf("--\x3e",c+4);if(d>c)return b.comment(h,c+4,d-c-4),d+3;a.error("Unclosed comment")}break;default:if("CDATA["==h.substr(c+3,6))return d=h.indexOf("]]\x3e",c+9),b.startCDATA(),b.characters(h,c+9,d-c-9),b.endCDATA(),d+3;a:{a=[];d=/'[^']+'|"[^"]+"|[^\s<>\/=]+=?|(\/?\s*>|<)/g;d.lastIndex=c;for(d.exec(h);c=d.exec(h);)if(a.push(c),
c[1]){d=a;break a}d=void 0}var g=d.length;if(1<g&&/!doctype/i.test(d[0][0]))return h=d[1][0],c=3<g&&/^public$/i.test(d[2][0])&&d[3][0],a=4<g&&d[4][0],d=d[g-1],b.startDTD(h,c&&c.replace(/^(['"])(.*?)\1$/,"$2"),a&&a.replace(/^(['"])(.*?)\1$/,"$2")),b.endDTD(),d.index+d[0].length}return-1}function ri(h,c,b){var a=h.indexOf("?>",c);return a&&(h=h.substring(c,a).match(/^<\?(\S*)\s*([\s\S]*?)\s*$/))?(b.processingInstruction(h[1],h[2]),a+2):-1}function Af(h){}function $c(h,c){h.__proto__=c;return h}function rc(h,
c){for(var b in h)c[b]=h[b]}function wa(h,c){var b=h.prototype;if(Object.create){var a=Object.create(c.prototype);b.__proto__=a}b instanceof c||(a=function(){},a.prototype=c.prototype,a=new a,rc(b,a),h.prototype=b=a);b.constructor!=h&&("function"!=typeof h&&console.error("unknow Class:"+h),b.constructor=h)}function Ub(h,c){if(c instanceof Error)var b=c;else b=this,Error.call(this,ja[h]),this.message=ja[h],Error.captureStackTrace&&Error.captureStackTrace(this,Ub);b.code=h;c&&(this.message=this.message+
": "+c);return b}function nb(){}function sc(h,c){this._node=h;this._refresh=c;Od(this)}function Od(h){var c=h._node._inc||h._node.ownerDocument._inc;if(h._inc!=c){var b=h._refresh(h._node);Ef(h,"length",b.length);rc(b,h);h._inc=c}}function ad(){}function Ff(h,c){for(var b=h.length;b--;)if(h[b]===c)return b}function Gf(h,c,b,a){a?c[Ff(c,a)]=b:c[c.length++]=b;h&&(b.ownerElement=h,c=h.ownerDocument)&&(a&&Hf(c,h,a),c&&c._inc++,"http://www.w3.org/2000/xmlns/"==b.namespaceURI&&(h._nsMap[b.prefix?b.localName:
""]=b.value))}function If(h,c,b){var a=Ff(c,b);if(0<=a){for(var d=c.length-1;a<d;)c[a]=c[++a];c.length=d;h&&(c=h.ownerDocument)&&(Hf(c,h,b),b.ownerElement=null)}else throw Ub(wi,Error(h.tagName+"@"+b));}function Jf(h){this._features={};if(h)for(var c in h)this._features=h[c]}function ta(){}function Kf(h){return"<"==h&&"&lt;"||">"==h&&"&gt;"||"&"==h&&"&amp;"||'"'==h&&"&quot;"||"&#"+h.charCodeAt()+";"}function bd(h,c){if(c(h))return!0;if(h=h.firstChild){do if(bd(h,c))return!0;while(h=h.nextSibling)
}}function tc(){}function Hf(h,c,b,a){h&&h._inc++;"http://www.w3.org/2000/xmlns/"==b.namespaceURI&&delete c._nsMap[b.prefix?b.localName:""]}function Pd(h,c,b){if(h&&h._inc)if(h._inc++,h=c.childNodes,b)h[h.length++]=b;else{c=c.firstChild;for(b=0;c;)h[b++]=c,c=c.nextSibling;h.length=b}}function Lf(h,c){var b=c.previousSibling,a=c.nextSibling;b?b.nextSibling=a:h.firstChild=a;a?a.previousSibling=b:h.lastChild=b;Pd(h.ownerDocument,h);return c}function Mf(h,c,b){var a=c.parentNode;a&&a.removeChild(c);if(c.nodeType===
$a){a=c.firstChild;if(null==a)return c;var d=c.lastChild}else a=d=c;var g=b?b.previousSibling:h.lastChild;a.previousSibling=g;d.nextSibling=b;g?g.nextSibling=a:h.firstChild=a;null==b?h.lastChild=d:b.previousSibling=d;do a.parentNode=h;while(a!==d&&(a=a.nextSibling));Pd(h.ownerDocument||h,h);c.nodeType==$a&&(c.firstChild=c.lastChild=null);return c}function Vb(){this._nsMap={}}function cd(){}function uc(){}function Qd(){}function Rd(){}function Sd(){}function Td(){}function Nf(){}function Of(){}function Ud(){}
function dd(){}function Vd(){}function Pf(){}function Qf(h,c){var b=[],a=9==this.nodeType?this.documentElement:this,d=a.prefix,g=a.namespaceURI;if(g&&null==d&&(d=a.lookupPrefix(g),null==d))var e=[{namespace:g,prefix:null}];Wb(this,b,h,c,e);return b.join("")}function Rf(h,c,b){c=h.prefix||"";h=h.namespaceURI;if(!c&&!h||"xml"===c&&"http://www.w3.org/XML/1998/namespace"===h||"http://www.w3.org/2000/xmlns/"==h)return!1;for(var a=b.length;a--;){var d=b[a];if(d.prefix==c)return d.namespace!=h}return!0}
function Wb(h,c,b,a,d){if(a)if(h=a(h)){if("string"==typeof h){c.push(h);return}}else return;switch(h.nodeType){case Sa:d||(d=[]);var g=h.attributes,e=g.length,f=h.firstChild,k=h.tagName;b="http://www.w3.org/1999/xhtml"===h.namespaceURI||b;c.push("<",k);for(var l=0;l<e;l++){var m=g.item(l);"xmlns"==m.prefix?d.push({prefix:m.localName,namespace:m.value}):"xmlns"==m.nodeName&&d.push({prefix:"",namespace:m.value})}for(l=0;l<e;l++){m=g.item(l);if(Rf(m,b,d)){var n=m.prefix||"",r=m.namespaceURI;c.push(n?
" xmlns:"+n:" xmlns",'="',r,'"');d.push({prefix:n,namespace:r})}Wb(m,c,b,a,d)}Rf(h,b,d)&&(n=h.prefix||"",r=h.namespaceURI,c.push(n?" xmlns:"+n:" xmlns",'="',r,'"'),d.push({prefix:n,namespace:r}));if(f||b&&!/^(?:meta|link|img|br|hr|input)$/i.test(k)){c.push(">");if(b&&/^script$/i.test(k))for(;f;)f.data?c.push(f.data):Wb(f,c,b,a,d),f=f.nextSibling;else for(;f;)Wb(f,c,b,a,d),f=f.nextSibling;c.push("</",k,">")}else c.push("/>");break;case Sf:case $a:for(f=h.firstChild;f;)Wb(f,c,b,a,d),f=f.nextSibling;
break;case Xb:return c.push(" ",h.name,'="',h.value.replace(/[<&"]/g,Kf),'"');case ed:return c.push(h.data.replace(/[<&]/g,Kf));case Tf:return c.push("<![CDATA[",h.data,"]]\x3e");case Uf:return c.push("\x3c!--",h.data,"--\x3e");case Vf:b=h.publicId;a=h.systemId;c.push("<!DOCTYPE ",h.name);b?(c.push(' PUBLIC "',b),a&&"."!=a&&c.push('" "',a),c.push('">')):a&&"."!=a?c.push(' SYSTEM "',a,'">'):((h=h.internalSubset)&&c.push(" [",h,"]"),c.push(">"));break;case Wf:return c.push("<?",h.target," ",h.data,
"?>");case Xf:return c.push("&",h.nodeName,";");default:c.push("??",h.nodeName)}}function Yf(h,c,b){var a;switch(c.nodeType){case Sa:a=c.cloneNode(!1),a.ownerDocument=h;case $a:break;case Xb:b=!0}a||(a=c.cloneNode(!1));a.ownerDocument=h;a.parentNode=null;if(b)for(c=c.firstChild;c;)a.appendChild(Yf(h,c,b)),c=c.nextSibling;return a}function Wd(h,c,b){var a=new c.constructor,d;for(d in c){var g=c[d];"object"!=("undefined"===typeof g?"undefined":H(g))&&g!=a[d]&&(a[d]=g)}c.childNodes&&(a.childNodes=new nb);
a.ownerDocument=h;switch(a.nodeType){case Sa:d=c.attributes;var e=a.attributes=new ad,g=d.length;e._ownerElement=a;for(e=0;e<g;e++)a.setAttributeNode(Wd(h,d.item(e),!0));break;case Xb:b=!0}if(b)for(c=c.firstChild;c;)a.appendChild(Wd(h,c,b)),c=c.nextSibling;return a}function Ef(h,c,b){h[c]=b}function vc(){}function wc(){}function Xd(){this.littleEndian=!1;this.position=0;this._makeEntryLookup=!1;this.dictionary=[]}function xc(){this.decompressor=new Xd}function yc(){}function zc(){}function Zf(h,c,
b,a,d){this.fileDirectory=h;this.geoKeys=c;this.dataView=b;this.littleEndian=a;this.tiles=d?{}:null;this.isTiled=h.StripOffsets?!1:!0;h=h.PlanarConfiguration;this.planarConfiguration="undefined"===typeof h?1:h;if(1!==this.planarConfiguration&&2!==this.planarConfiguration)throw Error("Invalid planar configuration.");switch(this.fileDirectory.Compression){case void 0:case 1:this.decoder=new xi;break;case 5:this.decoder=new yi;break;case 6:throw Error("JPEG compression not supported.");case 8:this.decoder=
new zi;break;case 32773:this.decoder=new Ai;break;default:throw Error("Unknown compresseion method identifier: "+this.fileDirectory.Compression);}}function $f(h,c){this.dataView=new Bi(h);c=c||{};this.cache=c.cache||!1;h=this.dataView.getUint16(0,0);if(18761===h)this.littleEndian=!0;else if(19789===h)this.littleEndian=!1;else throw new TypeError("Invalid byte order value.");h=this.dataView.getUint16(2,this.littleEndian);if(42===this.dataView.getUint16(2,this.littleEndian))this.bigTiff=!1;else if(43===
h){if(this.bigTiff=!0,8!==this.dataView.getUint16(4,this.littleEndian))throw Error("Unsupported offset byte-size.");}else throw new TypeError("Invalid magic number.");this.fileDirectories=this.parseFileDirectories(this.getOffset(this.bigTiff?8:4))}function ag(h,c){return c={exports:{}},h(c,c.exports),c.exports}function Yb(h){for(var c=h.length;0<=--c;)h[c]=0}function Yd(h,c,b,a,d){this.static_tree=h;this.extra_bits=c;this.extra_base=b;this.elems=a;this.max_length=d;this.has_stree=h&&h.length}function Zd(h,
c){this.dyn_tree=h;this.max_code=0;this.stat_desc=c}function Ac(h,c){h.pending_buf[h.pending++]=c&255;h.pending_buf[h.pending++]=c>>>8&255}function xa(h,c,b){h.bi_valid>16-b?(h.bi_buf|=c<<h.bi_valid&65535,Ac(h,h.bi_buf),h.bi_buf=c>>16-h.bi_valid,h.bi_valid+=b-16):(h.bi_buf|=c<<h.bi_valid&65535,h.bi_valid+=b)}function Ta(h,c,b){xa(h,b[2*c],b[2*c+1])}function bg(h,c){var b=0;do b|=h&1,h>>>=1,b<<=1;while(0<--c);return b>>>1}function cg(h,c,b){var a=Array(16),d=0,g;for(g=1;15>=g;g++)a[g]=d=d+b[g-1]<<
1;for(b=0;b<=c;b++)d=h[2*b+1],0!==d&&(h[2*b]=bg(a[d]++,d))}function dg(h){var c;for(c=0;286>c;c++)h.dyn_ltree[2*c]=0;for(c=0;30>c;c++)h.dyn_dtree[2*c]=0;for(c=0;19>c;c++)h.bl_tree[2*c]=0;h.dyn_ltree[512]=1;h.opt_len=h.static_len=0;h.last_lit=h.matches=0}function eg(h){8<h.bi_valid?Ac(h,h.bi_buf):0<h.bi_valid&&(h.pending_buf[h.pending++]=h.bi_buf);h.bi_buf=0;h.bi_valid=0}function fg(h,c,b,a){var d=2*c,g=2*b;return h[d]<h[g]||h[d]===h[g]&&a[c]<=a[b]}function $d(h,c,b){for(var a=h.heap[b],d=b<<1;d<=
h.heap_len;){d<h.heap_len&&fg(c,h.heap[d+1],h.heap[d],h.depth)&&d++;if(fg(c,a,h.heap[d],h.depth))break;h.heap[b]=h.heap[d];b=d;d<<=1}h.heap[b]=a}function gg(h,c,b){var a,d,g=0,e,f;if(0!==h.last_lit){do a=h.pending_buf[h.d_buf+2*g]<<8|h.pending_buf[h.d_buf+2*g+1],d=h.pending_buf[h.l_buf+g],g++,0===a?Ta(h,d,c):(e=Bc[d],Ta(h,e+256+1,c),f=ae[e],0!==f&&(d-=be[e],xa(h,d,f)),a--,e=256>a?Eb[a]:Eb[256+(a>>>7)],Ta(h,e,b),f=fd[e],0!==f&&(a-=gd[e],xa(h,a,f)));while(g<h.last_lit)}Ta(h,256,c)}function ce(h,c){var b=
c.dyn_tree,a=c.stat_desc.static_tree,d=c.stat_desc.has_stree,g=c.stat_desc.elems,e,f=-1,k;h.heap_len=0;h.heap_max=573;for(e=0;e<g;e++)0!==b[2*e]?(h.heap[++h.heap_len]=f=e,h.depth[e]=0):b[2*e+1]=0;for(;2>h.heap_len;)k=h.heap[++h.heap_len]=2>f?++f:0,b[2*k]=1,h.depth[k]=0,h.opt_len--,d&&(h.static_len-=a[2*k+1]);c.max_code=f;for(e=h.heap_len>>1;1<=e;e--)$d(h,b,e);k=g;do e=h.heap[1],h.heap[1]=h.heap[h.heap_len--],$d(h,b,1),a=h.heap[1],h.heap[--h.heap_max]=e,h.heap[--h.heap_max]=a,b[2*k]=b[2*e]+b[2*a],
h.depth[k]=(h.depth[e]>=h.depth[a]?h.depth[e]:h.depth[a])+1,b[2*e+1]=b[2*a+1]=k,h.heap[1]=k++,$d(h,b,1);while(2<=h.heap_len);h.heap[--h.heap_max]=h.heap[1];e=c.dyn_tree;k=c.max_code;var a=c.stat_desc.static_tree,d=c.stat_desc.has_stree,g=c.stat_desc.extra_bits,l=c.stat_desc.extra_base,m=c.stat_desc.max_length,n,r,v,q,t=0;for(r=0;15>=r;r++)h.bl_count[r]=0;e[2*h.heap[h.heap_max]+1]=0;for(c=h.heap_max+1;573>c;c++)n=h.heap[c],r=e[2*e[2*n+1]+1]+1,r>m&&(r=m,t++),e[2*n+1]=r,n>k||(h.bl_count[r]++,v=0,n>=
l&&(v=g[n-l]),q=e[2*n],h.opt_len+=q*(r+v),d&&(h.static_len+=q*(a[2*n+1]+v)));if(0!==t){do{for(r=m-1;0===h.bl_count[r];)r--;h.bl_count[r]--;h.bl_count[r+1]+=2;h.bl_count[m]--;t-=2}while(0<t);for(r=m;0!==r;r--)for(n=h.bl_count[r];0!==n;)a=h.heap[--c],a>k||(e[2*a+1]!==r&&(h.opt_len+=(r-e[2*a+1])*e[2*a],e[2*a+1]=r),n--)}cg(b,f,h.bl_count)}function hg(h,c,b){var a,d=-1,g,e=c[1],f=0,k=7,l=4;0===e&&(k=138,l=3);c[2*(b+1)+1]=65535;for(a=0;a<=b;a++)g=e,e=c[2*(a+1)+1],++f<k&&g===e||(f<l?h.bl_tree[2*g]+=f:0!==
g?(g!==d&&h.bl_tree[2*g]++,h.bl_tree[32]++):10>=f?h.bl_tree[34]++:h.bl_tree[36]++,f=0,d=g,0===e?(k=138,l=3):g===e?(k=6,l=3):(k=7,l=4))}function ig(h,c,b){var a,d=-1,g,e=c[1],f=0,k=7,l=4;0===e&&(k=138,l=3);for(a=0;a<=b;a++)if(g=e,e=c[2*(a+1)+1],!(++f<k&&g===e)){if(f<l){do Ta(h,g,h.bl_tree);while(0!==--f)}else 0!==g?(g!==d&&(Ta(h,g,h.bl_tree),f--),Ta(h,16,h.bl_tree),xa(h,f-3,2)):10>=f?(Ta(h,17,h.bl_tree),xa(h,f-3,3)):(Ta(h,18,h.bl_tree),xa(h,f-11,7));f=0;d=g;0===e?(k=138,l=3):g===e?(k=6,l=3):(k=7,l=
4)}}function Ci(h){var c=4093624447,b;for(b=0;31>=b;b++,c>>>=1)if(c&1&&0!==h.dyn_ltree[2*b])return 0;if(0!==h.dyn_ltree[18]||0!==h.dyn_ltree[20]||0!==h.dyn_ltree[26])return 1;for(b=32;256>b;b++)if(0!==h.dyn_ltree[2*b])return 1;return 0}function jg(h,c,b,a){xa(h,0+(a?1:0),3);eg(h);Ac(h,b);Ac(h,~b);U.arraySet(h.pending_buf,h.window,c,b,h.pending);h.pending+=b}function ob(h,c){h.msg=Zb[c];return c}function pb(h){for(var c=h.length;0<=--c;)h[c]=0}function qb(h){var c=h.state,b=c.pending;b>h.avail_out&&
(b=h.avail_out);0!==b&&(U.arraySet(h.output,c.pending_buf,c.pending_out,b,h.next_out),h.next_out+=b,c.pending_out+=b,h.total_out+=b,h.avail_out-=b,c.pending-=b,0===c.pending&&(c.pending_out=0))}function pa(h,c){Ha._tr_flush_block(h,0<=h.block_start?h.block_start:-1,h.strstart-h.block_start,c);h.block_start=h.strstart;qb(h.strm)}function ca(h,c){h.pending_buf[h.pending++]=c}function Cc(h,c){h.pending_buf[h.pending++]=c>>>8&255;h.pending_buf[h.pending++]=c&255}function kg(h,c){var b=h.max_chain_length,
a=h.strstart,d,g=h.prev_length,e=h.nice_match,f=h.strstart>h.w_size-262?h.strstart-(h.w_size-262):0,k=h.window,l=h.w_mask,m=h.prev,n=h.strstart+258,r=k[a+g-1],v=k[a+g];h.prev_length>=h.good_match&&(b>>=2);e>h.lookahead&&(e=h.lookahead);do if(d=c,k[d+g]===v&&k[d+g-1]===r&&k[d]===k[a]&&k[++d]===k[a+1]){a+=2;for(d++;k[++a]===k[++d]&&k[++a]===k[++d]&&k[++a]===k[++d]&&k[++a]===k[++d]&&k[++a]===k[++d]&&k[++a]===k[++d]&&k[++a]===k[++d]&&k[++a]===k[++d]&&a<n;);d=258-(n-a);a=n-258;if(d>g){h.match_start=c;
g=d;if(d>=e)break;r=k[a+g-1];v=k[a+g]}}while((c=m[c&l])>f&&0!==--b);return g<=h.lookahead?g:h.lookahead}function Fb(h){var c=h.w_size,b,a,d,g;do{g=h.window_size-h.lookahead-h.strstart;if(h.strstart>=c+(c-262)){U.arraySet(h.window,h.window,c,c,0);h.match_start-=c;h.strstart-=c;h.block_start-=c;b=a=h.hash_size;do d=h.head[--b],h.head[b]=d>=c?d-c:0;while(--a);b=a=c;do d=h.prev[--b],h.prev[b]=d>=c?d-c:0;while(--a);g+=c}if(0===h.strm.avail_in)break;b=h.strm;a=h.window;d=h.strstart+h.lookahead;var e=b.avail_in;
e>g&&(e=g);0===e?a=0:(b.avail_in-=e,U.arraySet(a,b.input,b.next_in,e,d),1===b.state.wrap?b.adler=Dc(b.adler,a,e,d):2===b.state.wrap&&(b.adler=oa(b.adler,a,e,d)),b.next_in+=e,b.total_in+=e,a=e);h.lookahead+=a;if(3<=h.lookahead+h.insert)for(g=h.strstart-h.insert,h.ins_h=h.window[g],h.ins_h=(h.ins_h<<h.hash_shift^h.window[g+1])&h.hash_mask;h.insert&&!(h.ins_h=(h.ins_h<<h.hash_shift^h.window[g+3-1])&h.hash_mask,h.prev[g&h.w_mask]=h.head[h.ins_h],h.head[h.ins_h]=g,g++,h.insert--,3>h.lookahead+h.insert););
}while(262>h.lookahead&&0!==h.strm.avail_in)}function de(h,c){for(var b;;){if(262>h.lookahead){Fb(h);if(262>h.lookahead&&0===c)return 1;if(0===h.lookahead)break}b=0;3<=h.lookahead&&(h.ins_h=(h.ins_h<<h.hash_shift^h.window[h.strstart+3-1])&h.hash_mask,b=h.prev[h.strstart&h.w_mask]=h.head[h.ins_h],h.head[h.ins_h]=h.strstart);0!==b&&h.strstart-b<=h.w_size-262&&(h.match_length=kg(h,b));if(3<=h.match_length)if(b=Ha._tr_tally(h,h.strstart-h.match_start,h.match_length-3),h.lookahead-=h.match_length,h.match_length<=
h.max_lazy_match&&3<=h.lookahead){h.match_length--;do h.strstart++,h.ins_h=(h.ins_h<<h.hash_shift^h.window[h.strstart+3-1])&h.hash_mask,h.prev[h.strstart&h.w_mask]=h.head[h.ins_h],h.head[h.ins_h]=h.strstart;while(0!==--h.match_length);h.strstart++}else h.strstart+=h.match_length,h.match_length=0,h.ins_h=h.window[h.strstart],h.ins_h=(h.ins_h<<h.hash_shift^h.window[h.strstart+1])&h.hash_mask;else b=Ha._tr_tally(h,0,h.window[h.strstart]),h.lookahead--,h.strstart++;if(b&&(pa(h,!1),0===h.strm.avail_out))return 1}h.insert=
2>h.strstart?h.strstart:2;return 4===c?(pa(h,!0),0===h.strm.avail_out?3:4):h.last_lit&&(pa(h,!1),0===h.strm.avail_out)?1:2}function $b(h,c){for(var b,a;;){if(262>h.lookahead){Fb(h);if(262>h.lookahead&&0===c)return 1;if(0===h.lookahead)break}b=0;3<=h.lookahead&&(h.ins_h=(h.ins_h<<h.hash_shift^h.window[h.strstart+3-1])&h.hash_mask,b=h.prev[h.strstart&h.w_mask]=h.head[h.ins_h],h.head[h.ins_h]=h.strstart);h.prev_length=h.match_length;h.prev_match=h.match_start;h.match_length=2;0!==b&&h.prev_length<h.max_lazy_match&&
h.strstart-b<=h.w_size-262&&(h.match_length=kg(h,b),5>=h.match_length&&(1===h.strategy||3===h.match_length&&4096<h.strstart-h.match_start)&&(h.match_length=2));if(3<=h.prev_length&&h.match_length<=h.prev_length){a=h.strstart+h.lookahead-3;b=Ha._tr_tally(h,h.strstart-1-h.prev_match,h.prev_length-3);h.lookahead-=h.prev_length-1;h.prev_length-=2;do++h.strstart<=a&&(h.ins_h=(h.ins_h<<h.hash_shift^h.window[h.strstart+3-1])&h.hash_mask,h.prev[h.strstart&h.w_mask]=h.head[h.ins_h],h.head[h.ins_h]=h.strstart);
while(0!==--h.prev_length);h.match_available=0;h.match_length=2;h.strstart++;if(b&&(pa(h,!1),0===h.strm.avail_out))return 1}else if(h.match_available){if((b=Ha._tr_tally(h,0,h.window[h.strstart-1]))&&pa(h,!1),h.strstart++,h.lookahead--,0===h.strm.avail_out)return 1}else h.match_available=1,h.strstart++,h.lookahead--}h.match_available&&(Ha._tr_tally(h,0,h.window[h.strstart-1]),h.match_available=0);h.insert=2>h.strstart?h.strstart:2;return 4===c?(pa(h,!0),0===h.strm.avail_out?3:4):h.last_lit&&(pa(h,
!1),0===h.strm.avail_out)?1:2}function Di(h,c){for(var b,a,d,g=h.window;;){if(258>=h.lookahead){Fb(h);if(258>=h.lookahead&&0===c)return 1;if(0===h.lookahead)break}h.match_length=0;if(3<=h.lookahead&&0<h.strstart&&(a=h.strstart-1,b=g[a],b===g[++a]&&b===g[++a]&&b===g[++a])){for(d=h.strstart+258;b===g[++a]&&b===g[++a]&&b===g[++a]&&b===g[++a]&&b===g[++a]&&b===g[++a]&&b===g[++a]&&b===g[++a]&&a<d;);h.match_length=258-(d-a);h.match_length>h.lookahead&&(h.match_length=h.lookahead)}3<=h.match_length?(b=Ha._tr_tally(h,
1,h.match_length-3),h.lookahead-=h.match_length,h.strstart+=h.match_length,h.match_length=0):(b=Ha._tr_tally(h,0,h.window[h.strstart]),h.lookahead--,h.strstart++);if(b&&(pa(h,!1),0===h.strm.avail_out))return 1}h.insert=0;return 4===c?(pa(h,!0),0===h.strm.avail_out?3:4):h.last_lit&&(pa(h,!1),0===h.strm.avail_out)?1:2}function Ei(h,c){for(var b;;){if(0===h.lookahead&&(Fb(h),0===h.lookahead)){if(0===c)return 1;break}h.match_length=0;b=Ha._tr_tally(h,0,h.window[h.strstart]);h.lookahead--;h.strstart++;
if(b&&(pa(h,!1),0===h.strm.avail_out))return 1}h.insert=0;return 4===c?(pa(h,!0),0===h.strm.avail_out?3:4):h.last_lit&&(pa(h,!1),0===h.strm.avail_out)?1:2}function Ua(h,c,b,a,d){this.good_length=h;this.max_lazy=c;this.nice_length=b;this.max_chain=a;this.func=d}function Fi(){this.strm=null;this.status=0;this.pending_buf=null;this.wrap=this.pending=this.pending_out=this.pending_buf_size=0;this.gzhead=null;this.gzindex=0;this.method=8;this.last_flush=-1;this.w_mask=this.w_bits=this.w_size=0;this.window=
null;this.window_size=0;this.head=this.prev=null;this.nice_match=this.good_match=this.strategy=this.level=this.max_lazy_match=this.max_chain_length=this.prev_length=this.lookahead=this.match_start=this.strstart=this.match_available=this.prev_match=this.match_length=this.block_start=this.hash_shift=this.hash_mask=this.hash_bits=this.hash_size=this.ins_h=0;this.dyn_ltree=new U.Buf16(1146);this.dyn_dtree=new U.Buf16(122);this.bl_tree=new U.Buf16(78);pb(this.dyn_ltree);pb(this.dyn_dtree);pb(this.bl_tree);
this.bl_desc=this.d_desc=this.l_desc=null;this.bl_count=new U.Buf16(16);this.heap=new U.Buf16(573);pb(this.heap);this.heap_max=this.heap_len=0;this.depth=new U.Buf16(573);pb(this.depth);this.bi_valid=this.bi_buf=this.insert=this.matches=this.static_len=this.opt_len=this.d_buf=this.last_lit=this.lit_bufsize=this.l_buf=0}function lg(h){var c;if(!h||!h.state)return ob(h,-2);h.total_in=h.total_out=0;h.data_type=2;c=h.state;c.pending=0;c.pending_out=0;0>c.wrap&&(c.wrap=-c.wrap);c.status=c.wrap?42:113;
h.adler=2===c.wrap?0:1;c.last_flush=0;Ha._tr_init(c);return 0}function mg(h){var c=lg(h);0===c&&(h=h.state,h.window_size=2*h.w_size,pb(h.head),h.max_lazy_match=ac[h.level].max_lazy,h.good_match=ac[h.level].good_length,h.nice_match=ac[h.level].nice_length,h.max_chain_length=ac[h.level].max_chain,h.strstart=0,h.block_start=0,h.lookahead=0,h.insert=0,h.match_length=h.prev_length=2,h.match_available=0,h.ins_h=0);return c}function ng(h,c,b,a,d,g){if(!h)return-2;var e=1;-1===c&&(c=6);0>a?(e=0,a=-a):15<
a&&(e=2,a-=16);if(1>d||9<d||8!==b||8>a||15<a||0>c||9<c||0>g||4<g)return ob(h,-2);8===a&&(a=9);var f=new Fi;h.state=f;f.strm=h;f.wrap=e;f.gzhead=null;f.w_bits=a;f.w_size=1<<f.w_bits;f.w_mask=f.w_size-1;f.hash_bits=d+7;f.hash_size=1<<f.hash_bits;f.hash_mask=f.hash_size-1;f.hash_shift=~~((f.hash_bits+3-1)/3);f.window=new U.Buf8(2*f.w_size);f.head=new U.Buf16(f.hash_size);f.prev=new U.Buf16(f.w_size);f.lit_bufsize=1<<d+6;f.pending_buf_size=4*f.lit_bufsize;f.pending_buf=new U.Buf8(f.pending_buf_size);
f.d_buf=1*f.lit_bufsize;f.l_buf=3*f.lit_bufsize;f.level=c;f.strategy=g;f.method=b;return mg(h)}function og(h,c){if(65537>c&&(h.subarray&&pg||!h.subarray&&qg))return String.fromCharCode.apply(null,U.shrinkBuf(h,c));for(var b="",a=0;a<c;a++)b+=String.fromCharCode(h[a]);return b}function Gb(h){if(!(this instanceof Gb))return new Gb(h);h=this.options=U.assign({level:-1,method:8,chunkSize:16384,windowBits:15,memLevel:8,strategy:0,to:""},h||{});h.raw&&0<h.windowBits?h.windowBits=-h.windowBits:h.gzip&&0<
h.windowBits&&16>h.windowBits&&(h.windowBits+=16);this.err=0;this.msg="";this.ended=!1;this.chunks=[];this.strm=new rg;this.strm.avail_out=0;var c=Ec.deflateInit2(this.strm,h.level,h.method,h.windowBits,h.memLevel,h.strategy);if(0!==c)throw Error(Zb[c]);h.header&&Ec.deflateSetHeader(this.strm,h.header);if(h.dictionary){h="string"===typeof h.dictionary?Hb.string2buf(h.dictionary):"[object ArrayBuffer]"===sg.call(h.dictionary)?new Uint8Array(h.dictionary):h.dictionary;c=Ec.deflateSetDictionary(this.strm,
h);if(0!==c)throw Error(Zb[c]);this._dict_set=!0}}function ee(h,c){c=new Gb(c);c.push(h,!0);if(c.err)throw c.msg||Zb[c.err];return c.result}function tg(h){return(h>>>24&255)+(h>>>8&65280)+((h&65280)<<8)+((h&255)<<24)}function Gi(){this.mode=0;this.last=!1;this.wrap=0;this.havedict=!1;this.total=this.check=this.dmax=this.flags=0;this.head=null;this.wnext=this.whave=this.wsize=this.wbits=0;this.window=null;this.extra=this.offset=this.length=this.bits=this.hold=0;this.distcode=this.lencode=null;this.have=
this.ndist=this.nlen=this.ncode=this.distbits=this.lenbits=0;this.next=null;this.lens=new U.Buf16(320);this.work=new U.Buf16(288);this.distdyn=this.lendyn=null;this.was=this.back=this.sane=0}function ug(h){var c;if(!h||!h.state)return-2;c=h.state;h.total_in=h.total_out=c.total=0;h.msg="";c.wrap&&(h.adler=c.wrap&1);c.mode=1;c.last=0;c.havedict=0;c.dmax=32768;c.head=null;c.hold=0;c.bits=0;c.lencode=c.lendyn=new U.Buf32(852);c.distcode=c.distdyn=new U.Buf32(592);c.sane=1;c.back=-1;return 0}function vg(h){var c;
if(!h||!h.state)return-2;c=h.state;c.wsize=0;c.whave=0;c.wnext=0;return ug(h)}function wg(h,c){var b,a;if(!h||!h.state)return-2;a=h.state;0>c?(b=0,c=-c):(b=(c>>4)+1,48>c&&(c&=15));if(c&&(8>c||15<c))return-2;null!==a.window&&a.wbits!==c&&(a.window=null);a.wrap=b;a.wbits=c;return vg(h)}function xg(h,c){var b;if(!h)return-2;b=new Gi;h.state=b;b.window=null;c=wg(h,c);0!==c&&(h.state=null);return c}function yg(h,c,b,a){var d=h.state;null===d.window&&(d.wsize=1<<d.wbits,d.wnext=0,d.whave=0,d.window=new U.Buf8(d.wsize));
a>=d.wsize?(U.arraySet(d.window,c,b-d.wsize,d.wsize,0),d.wnext=0,d.whave=d.wsize):(h=d.wsize-d.wnext,h>a&&(h=a),U.arraySet(d.window,c,b-a,h,d.wnext),(a-=h)?(U.arraySet(d.window,c,b-a,a,0),d.wnext=a,d.whave=d.wsize):(d.wnext+=h,d.wnext===d.wsize&&(d.wnext=0),d.whave<d.wsize&&(d.whave+=h)));return 0}function Ib(h){if(!(this instanceof Ib))return new Ib(h);var c=this.options=U.assign({chunkSize:16384,windowBits:0,to:""},h||{});c.raw&&0<=c.windowBits&&16>c.windowBits&&(c.windowBits=-c.windowBits,0===
c.windowBits&&(c.windowBits=-15));!(0<=c.windowBits&&16>c.windowBits)||h&&h.windowBits||(c.windowBits+=32);15<c.windowBits&&48>c.windowBits&&0===(c.windowBits&15)&&(c.windowBits|=15);this.err=0;this.msg="";this.ended=!1;this.chunks=[];this.strm=new rg;this.strm.avail_out=0;h=Fc.inflateInit2(this.strm,c.windowBits);if(h!==Z.Z_OK)throw Error(Zb[h]);this.header=new Hi;Fc.inflateGetHeader(this.strm,this.header)}function fe(h,c){c=new Ib(c);c.push(h,!0);if(c.err)throw c.msg||Zb[c.err];return c.result}
function zg(){throw Error("setTimeout has not been defined");}function Ag(){throw Error("clearTimeout has not been defined");}function Bg(h){if(rb===setTimeout)return setTimeout(h,0);if((rb===zg||!rb)&&setTimeout)return rb=setTimeout,setTimeout(h,0);try{return rb(h,0)}catch(c){try{return rb.call(null,h,0)}catch(b){return rb.call(this,h,0)}}}function Ii(h){if(sb===clearTimeout)return clearTimeout(h);if((sb===Ag||!sb)&&clearTimeout)return sb=clearTimeout,clearTimeout(h);try{return sb(h)}catch(c){try{return sb.call(null,
h)}catch(b){return sb.call(this,h)}}}function Ji(){bc&&Jb&&(bc=!1,Jb.length?ab=Jb.concat(ab):hd=-1,ab.length&&Cg())}function Cg(){if(!bc){var h=Bg(Ji);bc=!0;for(var c=ab.length;c;){Jb=ab;for(ab=[];++hd<c;)Jb&&Jb[hd].run();hd=-1;c=ab.length}Jb=null;bc=!1;Ii(h)}}function Dg(h,c){this.fun=h;this.array=c}function Kb(){}function Eg(){ge=!0;for(var h=0;64>h;++h)Va[h]="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"[h],Ia["ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charCodeAt(h)]=
h;Ia[45]=62;Ia[95]=63}function Ki(h,c,b){for(var a=[],d=c;d<b;d+=3)c=(h[d]<<16)+(h[d+1]<<8)+h[d+2],a.push(Va[c>>18&63]+Va[c>>12&63]+Va[c>>6&63]+Va[c&63]);return a.join("")}function Fg(h){ge||Eg();for(var c=h.length,b=c%3,a="",d=[],g=0,e=c-b;g<e;g+=16383)d.push(Ki(h,g,g+16383>e?e:g+16383));1===b?(h=h[c-1],a+=Va[h>>2],a+=Va[h<<4&63],a+="=="):2===b&&(h=(h[c-2]<<8)+h[c-1],a+=Va[h>>10],a+=Va[h>>4&63],a+=Va[h<<2&63],a+="=");d.push(a);return d.join("")}function id(h,c,b,a,d){var g;g=8*d-a-1;var e=(1<<g)-
1,f=e>>1,k=-7;d=b?d-1:0;var l=b?-1:1,m=h[c+d];d+=l;b=m&(1<<-k)-1;m>>=-k;for(k+=g;0<k;b=256*b+h[c+d],d+=l,k-=8);g=b&(1<<-k)-1;b>>=-k;for(k+=a;0<k;g=256*g+h[c+d],d+=l,k-=8);if(0===b)b=1-f;else{if(b===e)return g?NaN:Infinity*(m?-1:1);g+=Math.pow(2,a);b-=f}return(m?-1:1)*g*Math.pow(2,b-a)}function Gg(h,c,b,a,d,g){var e,f=8*g-d-1,k=(1<<f)-1,l=k>>1,m=23===d?Math.pow(2,-24)-Math.pow(2,-77):0;g=a?0:g-1;var n=a?1:-1,r=0>c||0===c&&0>1/c?1:0;c=Math.abs(c);isNaN(c)||Infinity===c?(c=isNaN(c)?1:0,a=k):(a=Math.floor(Math.log(c)/
Math.LN2),1>c*(e=Math.pow(2,-a))&&(a--,e*=2),c=1<=a+l?c+m/e:c+m*Math.pow(2,1-l),2<=c*e&&(a++,e/=2),a+l>=k?(c=0,a=k):1<=a+l?(c=(c*e-1)*Math.pow(2,d),a+=l):(c=c*Math.pow(2,l-1)*Math.pow(2,d),a=0));for(;8<=d;h[b+g]=c&255,g+=n,c/=256,d-=8);a=a<<d|c;for(f+=d;0<f;h[b+g]=a&255,g+=n,a/=256,f-=8);h[b+g-n]|=128*r}function bb(h,c){if((C.TYPED_ARRAY_SUPPORT?2147483647:1073741823)<c)throw new RangeError("Invalid typed array length");C.TYPED_ARRAY_SUPPORT?(h=new Uint8Array(c),h.__proto__=C.prototype):(null===h&&
(h=new C(c)),h.length=c);return h}function C(h,c,b){if(!(C.TYPED_ARRAY_SUPPORT||this instanceof C))return new C(h,c,b);if("number"===typeof h){if("string"===typeof c)throw Error("If encoding is specified then the first argument must be a string");return he(this,h)}return Hg(this,h,c,b)}function Hg(h,c,b,a){if("number"===typeof c)throw new TypeError('"value" argument must not be a number');if("undefined"!==typeof ArrayBuffer&&c instanceof ArrayBuffer){c.byteLength;if(0>b||c.byteLength<b)throw new RangeError("'offset' is out of bounds");
if(c.byteLength<b+(a||0))throw new RangeError("'length' is out of bounds");c=void 0===b&&void 0===a?new Uint8Array(c):void 0===a?new Uint8Array(c,b):new Uint8Array(c,b,a);C.TYPED_ARRAY_SUPPORT?(h=c,h.__proto__=C.prototype):h=ie(h,c);return h}if("string"===typeof c){a=h;h=b;if("string"!==typeof h||""===h)h="utf8";if(!C.isEncoding(h))throw new TypeError('"encoding" must be a valid string encoding');b=Ig(c,h)|0;a=bb(a,b);c=a.write(c,h);c!==b&&(a=a.slice(0,c));return a}return Li(h,c)}function Jg(h){if("number"!==
typeof h)throw new TypeError('"size" argument must be a number');if(0>h)throw new RangeError('"size" argument must not be negative');}function he(h,c){Jg(c);h=bb(h,0>c?0:je(c)|0);if(!C.TYPED_ARRAY_SUPPORT)for(var b=0;b<c;++b)h[b]=0;return h}function ie(h,c){var b=0>c.length?0:je(c.length)|0;h=bb(h,b);for(var a=0;a<b;a+=1)h[a]=c[a]&255;return h}function Li(h,c){if(Wa(c)){var b=je(c.length)|0;h=bb(h,b);if(0===h.length)return h;c.copy(h,0,0,b);return h}if(c){if("undefined"!==typeof ArrayBuffer&&c.buffer instanceof
ArrayBuffer||"length"in c)return(b="number"!==typeof c.length)||(b=c.length,b=b!==b),b?bb(h,0):ie(h,c);if("Buffer"===c.type&&Kg(c.data))return ie(h,c.data)}throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.");}function je(h){if(h>=(C.TYPED_ARRAY_SUPPORT?2147483647:1073741823))throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+(C.TYPED_ARRAY_SUPPORT?2147483647:1073741823).toString(16)+" bytes");return h|0}function Wa(h){return!(null==
h||!h._isBuffer)}function Ig(h,c){if(Wa(h))return h.length;if("undefined"!==typeof ArrayBuffer&&"function"===typeof ArrayBuffer.isView&&(ArrayBuffer.isView(h)||h instanceof ArrayBuffer))return h.byteLength;"string"!==typeof h&&(h=""+h);var b=h.length;if(0===b)return 0;for(var a=!1;;)switch(c){case "ascii":case "latin1":case "binary":return b;case "utf8":case "utf-8":case void 0:return jd(h).length;case "ucs2":case "ucs-2":case "utf16le":case "utf-16le":return 2*b;case "hex":return b>>>1;case "base64":return Lg(h).length;
default:if(a)return jd(h).length;c=(""+c).toLowerCase();a=!0}}function Mi(h,c,b){var a=!1;if(void 0===c||0>c)c=0;if(c>this.length)return"";if(void 0===b||b>this.length)b=this.length;if(0>=b)return"";b>>>=0;c>>>=0;if(b<=c)return"";for(h||(h="utf8");;)switch(h){case "hex":h=c;c=b;b=this.length;if(!h||0>h)h=0;if(!c||0>c||c>b)c=b;a="";for(b=h;b<c;++b)h=a,a=this[b],a=16>a?"0"+a.toString(16):a.toString(16),a=h+a;return a;case "utf8":case "utf-8":return Mg(this,c,b);case "ascii":h="";for(b=Math.min(this.length,
b);c<b;++c)h+=String.fromCharCode(this[c]&127);return h;case "latin1":case "binary":h="";for(b=Math.min(this.length,b);c<b;++c)h+=String.fromCharCode(this[c]);return h;case "base64":return c=0===c&&b===this.length?Fg(this):Fg(this.slice(c,b)),c;case "ucs2":case "ucs-2":case "utf16le":case "utf-16le":c=this.slice(c,b);b="";for(h=0;h<c.length;h+=2)b+=String.fromCharCode(c[h]+256*c[h+1]);return b;default:if(a)throw new TypeError("Unknown encoding: "+h);h=(h+"").toLowerCase();a=!0}}function Lb(h,c,b){var a=
h[c];h[c]=h[b];h[b]=a}function Ng(h,c,b,a,d){if(0===h.length)return-1;"string"===typeof b?(a=b,b=0):2147483647<b?b=2147483647:-2147483648>b&&(b=-2147483648);b=+b;isNaN(b)&&(b=d?0:h.length-1);0>b&&(b=h.length+b);if(b>=h.length){if(d)return-1;b=h.length-1}else if(0>b)if(d)b=0;else return-1;"string"===typeof c&&(c=C.from(c,a));if(Wa(c))return 0===c.length?-1:Og(h,c,b,a,d);if("number"===typeof c)return c&=255,C.TYPED_ARRAY_SUPPORT&&"function"===typeof Uint8Array.prototype.indexOf?d?Uint8Array.prototype.indexOf.call(h,
c,b):Uint8Array.prototype.lastIndexOf.call(h,c,b):Og(h,[c],b,a,d);throw new TypeError("val must be string, number or Buffer");}function Og(h,c,b,a,d){function g(a,d){return 1===e?a[d]:a.readUInt16BE(d*e)}var e=1,f=h.length,k=c.length;if(void 0!==a&&(a=String(a).toLowerCase(),"ucs2"===a||"ucs-2"===a||"utf16le"===a||"utf-16le"===a)){if(2>h.length||2>c.length)return-1;e=2;f/=2;k/=2;b/=2}if(d)for(a=-1;b<f;b++)if(g(h,b)===g(c,-1===a?0:b-a)){if(-1===a&&(a=b),b-a+1===k)return a*e}else-1!==a&&(b-=b-a),a=
-1;else for(b+k>f&&(b=f-k);0<=b;b--){f=!0;for(a=0;a<k;a++)if(g(h,b+a)!==g(c,a)){f=!1;break}if(f)return b}return-1}function Mg(h,c,b){b=Math.min(h.length,b);for(var a=[];c<b;){var d=h[c],g=null,e=239<d?4:223<d?3:191<d?2:1;if(c+e<=b){var f,k,l;switch(e){case 1:128>d&&(g=d);break;case 2:f=h[c+1];128===(f&192)&&(d=(d&31)<<6|f&63,127<d&&(g=d));break;case 3:f=h[c+1];k=h[c+2];128===(f&192)&&128===(k&192)&&(d=(d&15)<<12|(f&63)<<6|k&63,2047<d&&(55296>d||57343<d)&&(g=d));break;case 4:f=h[c+1],k=h[c+2],l=h[c+
3],128===(f&192)&&128===(k&192)&&128===(l&192)&&(d=(d&15)<<18|(f&63)<<12|(k&63)<<6|l&63,65535<d&&1114112>d&&(g=d))}}null===g?(g=65533,e=1):65535<g&&(g-=65536,a.push(g>>>10&1023|55296),g=56320|g&1023);a.push(g);c+=e}h=a.length;if(h<=Pg)a=String.fromCharCode.apply(String,a);else{b="";for(c=0;c<h;)b+=String.fromCharCode.apply(String,a.slice(c,c+=Pg));a=b}return a}function ka(h,c,b){if(0!==h%1||0>h)throw new RangeError("offset is not uint");if(h+c>b)throw new RangeError("Trying to access beyond buffer length");
}function ya(h,c,b,a,d,g){if(!Wa(h))throw new TypeError('"buffer" argument must be a Buffer instance');if(c>d||c<g)throw new RangeError('"value" argument is out of bounds');if(b+a>h.length)throw new RangeError("Index out of range");}function kd(h,c,b,a){0>c&&(c=65535+c+1);for(var d=0,g=Math.min(h.length-b,2);d<g;++d)h[b+d]=(c&255<<8*(a?d:1-d))>>>8*(a?d:1-d)}function ld(h,c,b,a){0>c&&(c=4294967295+c+1);for(var d=0,g=Math.min(h.length-b,4);d<g;++d)h[b+d]=c>>>8*(a?d:3-d)&255}function Qg(h,c,b,a,d,g){if(b+
a>h.length)throw new RangeError("Index out of range");if(0>b)throw new RangeError("Index out of range");}function Rg(h,c,b,a,d){d||Qg(h,c,b,4,3.4028234663852886E38,-3.4028234663852886E38);Gg(h,c,b,a,23,4);return b+4}function Sg(h,c,b,a,d){d||Qg(h,c,b,8,1.7976931348623157E308,-1.7976931348623157E308);Gg(h,c,b,a,52,8);return b+8}function jd(h,c){c=c||Infinity;for(var b,a=h.length,d=null,g=[],e=0;e<a;++e){b=h.charCodeAt(e);if(55295<b&&57344>b){if(!d){if(56319<b){-1<(c-=3)&&g.push(239,191,189);continue}else if(e+
1===a){-1<(c-=3)&&g.push(239,191,189);continue}d=b;continue}if(56320>b){-1<(c-=3)&&g.push(239,191,189);d=b;continue}b=(d-55296<<10|b-56320)+65536}else d&&-1<(c-=3)&&g.push(239,191,189);d=null;if(128>b){if(0>--c)break;g.push(b)}else if(2048>b){if(0>(c-=2))break;g.push(b>>6|192,b&63|128)}else if(65536>b){if(0>(c-=3))break;g.push(b>>12|224,b>>6&63|128,b&63|128)}else if(1114112>b){if(0>(c-=4))break;g.push(b>>18|240,b>>12&63|128,b>>6&63|128,b&63|128)}else throw Error("Invalid code point");}return g}function Tg(h){for(var c=
[],b=0;b<h.length;++b)c.push(h.charCodeAt(b)&255);return c}function Lg(h){h=(h.trim?h.trim():h.replace(/^\s+|\s+$/g,"")).replace(Ni,"");if(2>h.length)h="";else for(;0!==h.length%4;)h+="=";ge||Eg();var c,b,a,d,g;c=h.length;if(0<c%4)throw Error("Invalid string. Length must be a multiple of 4");d="="===h[c-2]?2:"="===h[c-1]?1:0;g=new Oi(3*c/4-d);b=0<d?c-4:c;var e=0;for(c=0;c<b;c+=4)a=Ia[h.charCodeAt(c)]<<18|Ia[h.charCodeAt(c+1)]<<12|Ia[h.charCodeAt(c+2)]<<6|Ia[h.charCodeAt(c+3)],g[e++]=a>>16&255,g[e++]=
a>>8&255,g[e++]=a&255;2===d?(a=Ia[h.charCodeAt(c)]<<2|Ia[h.charCodeAt(c+1)]>>4,g[e++]=a&255):1===d&&(a=Ia[h.charCodeAt(c)]<<10|Ia[h.charCodeAt(c+1)]<<4|Ia[h.charCodeAt(c+2)]>>2,g[e++]=a>>8&255,g[e++]=a&255);return g}function Gc(h,c,b,a){for(var d=0;d<a&&!(d+b>=c.length||d>=h.length);++d)c[d+b]=h[d];return d}function Ug(h){return null!=h&&(!!h._isBuffer||Vg(h)||"function"===typeof h.readFloatLE&&"function"===typeof h.slice&&Vg(h.slice(0,0)))}function Vg(h){return!!h.constructor&&"function"===typeof h.constructor.isBuffer&&
h.constructor.isBuffer(h)}function Pi(h){function c(a,d){for(var b=0,c=0,g=[],e=1;16>=e;e++){for(var f=1;f<=a[e];f++)g[d[c]]=[],g[d[c]][0]=b,g[d[c]][1]=e,c++,b++;b*=2}return g}function b(d){var b=d[0];for(d=d[1]-1;0<=d;)b&1<<d&&(I|=1<<G),d--,G--,0>G&&(255==I?(a(255),a(0)):a(I),G=7,I=0)}function a(a){A.push(a)}function d(d){a(d>>8&255);a(d&255)}function g(a,d,c,g,e){var f=e[0],h=e[240],k,n,l,m,q,r,t,v,A,I=0;for(k=0;8>k;++k){n=a[I];l=a[I+1];m=a[I+2];q=a[I+3];r=a[I+4];t=a[I+5];v=a[I+6];A=a[I+7];var G=
n+A;n-=A;A=l+v;l-=v;v=m+t;m-=t;t=q+r;q-=r;r=G+t;G-=t;t=A+v;A-=v;a[I]=r+t;a[I+4]=r-t;r=.707106781*(A+G);a[I+2]=G+r;a[I+6]=G-r;r=q+m;t=m+l;A=l+n;m=.382683433*(r-A);q=.5411961*r+m;r=1.306562965*A+m;t*=.707106781;m=n+t;n-=t;a[I+5]=n+q;a[I+3]=n-q;a[I+1]=m+r;a[I+7]=m-r;I+=8}for(k=I=0;8>k;++k)n=a[I],l=a[I+8],m=a[I+16],q=a[I+24],r=a[I+32],t=a[I+40],v=a[I+48],A=a[I+56],G=n+A,n-=A,A=l+v,l-=v,v=m+t,m-=t,t=q+r,q-=r,r=G+t,G-=t,t=A+v,A-=v,a[I]=r+t,a[I+32]=r-t,r=.707106781*(A+G),a[I+16]=G+r,a[I+48]=G-r,r=q+m,t=
m+l,A=l+n,m=.382683433*(r-A),q=.5411961*r+m,r=1.306562965*A+m,t*=.707106781,m=n+t,n-=t,a[I+40]=n+q,a[I+24]=n-q,a[I+8]=m+r,a[I+56]=m-r,I++;for(k=0;64>k;++k)I=a[k]*d[k],D[k]=0<I?I+.5|0:I-.5|0;a=D;for(d=0;64>d;++d)w[E[d]]=a[d];a=w[0]-c;c=w[0];0==a?b(g[0]):(k=32767+a,b(g[x[k]]),b(F[k]));for(g=63;0<g&&0==w[g];g--);if(0==g)return b(f),c;for(a=1;a<=g;){for(d=a;0==w[a]&&a<=g;++a);d=a-d;if(16<=d){k=d>>4;for(I=1;I<=k;++I)b(h);d&=15}k=32767+w[a];b(e[(d<<4)+x[k]]);b(F[k]);a++}63!=g&&b(f);return c}function e(a){0>=
a&&(a=1);100<a&&(a=100);if(J!=a){for(var d=50>a?Math.floor(5E3/a):Math.floor(200-2*a),b=[16,11,10,16,24,40,51,61,12,12,14,19,26,58,60,55,14,13,16,24,40,57,69,56,14,17,22,29,51,87,80,62,18,22,37,56,68,109,103,77,24,35,55,64,81,104,113,92,49,64,78,87,103,121,120,101,72,92,95,98,112,100,103,99],c=0;64>c;c++){var g=f((b[c]*d+50)/100);1>g?g=1:255<g&&(g=255);k[E[c]]=g}b=[17,18,24,47,99,99,99,99,18,21,26,66,99,99,99,99,24,26,56,99,99,99,99,99,47,66,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,
99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99];for(c=0;64>c;c++)g=f((b[c]*d+50)/100),1>g?g=1:255<g&&(g=255),l[E[c]]=g;d=[1,1.387039845,1.306562965,1.175875602,1,.785694958,.5411961,.275899379];for(c=b=0;8>c;c++)for(g=0;8>g;g++)m[b]=1/(k[E[b]]*d[c]*d[g]*8),n[b]=1/(l[E[b]]*d[c]*d[g]*8),b++;J=a}}var f=Math.floor,k=Array(64),l=Array(64),m=Array(64),n=Array(64),r,v,q,t,F=Array(65535),x=Array(65535),D=Array(64),w=Array(64),A=[],I=0,G=7,p=Array(64),K=Array(64),W=Array(64),L=Array(256),u=Array(2048),
J,E=[0,1,5,6,14,15,27,28,2,4,7,13,16,26,29,42,3,8,12,17,25,30,41,43,9,11,18,24,31,40,44,53,10,19,23,32,39,45,52,54,20,22,33,38,46,51,55,60,21,34,37,47,50,56,59,61,35,36,48,49,57,58,62,63],Y=[0,0,1,5,1,1,1,1,1,1,0,0,0,0,0,0,0],B=[0,1,2,3,4,5,6,7,8,9,10,11],Wg=[0,0,2,1,3,3,2,4,3,5,5,4,4,0,0,1,125],y=[1,2,3,0,4,17,5,18,33,49,65,6,19,81,97,7,34,113,20,50,129,145,161,8,35,66,177,193,21,82,209,240,36,51,98,114,130,9,10,22,23,24,25,26,37,38,39,40,41,42,52,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,
85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,225,226,227,228,229,230,231,232,233,234,241,242,243,244,245,246,247,248,249,250],Xg=[0,0,3,1,1,1,1,1,1,1,1,1,0,0,0,0,0],md=[0,1,2,3,4,5,6,7,8,9,10,11],z=[0,0,2,1,2,4,4,3,4,7,5,4,4,0,1,2,119],H=[0,1,2,3,17,4,5,
33,49,6,18,65,81,7,97,113,19,34,50,129,8,20,66,145,161,177,193,9,35,51,82,240,21,98,114,209,10,22,36,52,225,37,241,23,24,25,26,38,39,40,41,42,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,130,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,226,227,228,229,
230,231,232,233,234,242,243,244,245,246,247,248,249,250];this.encode=function(c,f){(new Date).getTime();f&&e(f);A=[];I=0;G=7;d(65496);d(65504);d(16);a(74);a(70);a(73);a(70);a(0);a(1);a(1);a(0);d(1);d(1);a(0);a(0);d(65499);d(132);a(0);for(f=0;64>f;f++)a(k[f]);a(1);for(f=0;64>f;f++)a(l[f]);f=c.width;var h=c.height;d(65472);d(17);a(8);d(h);d(f);a(3);a(1);a(17);a(0);a(2);a(17);a(1);a(3);a(17);a(1);d(65476);d(418);a(0);for(f=0;16>f;f++)a(Y[f+1]);for(f=0;11>=f;f++)a(B[f]);a(16);for(f=0;16>f;f++)a(Wg[f+
1]);for(f=0;161>=f;f++)a(y[f]);a(1);for(f=0;16>f;f++)a(Xg[f+1]);for(f=0;11>=f;f++)a(md[f]);a(17);for(f=0;16>f;f++)a(z[f+1]);for(f=0;161>=f;f++)a(H[f]);d(65498);d(12);a(3);a(1);a(0);a(2);a(17);a(3);a(17);a(0);a(63);a(0);var x=h=f=0;I=0;G=7;this.encode.displayName="_encode_";var F=c.data,D=c.height;c=4*c.width;for(var w,La=0,L,E,J,Ee,tb;La<D;){for(w=0;w<c;){Ee=c*La+w;for(tb=0;64>tb;tb++)E=tb>>3,L=4*(tb&7),J=Ee+E*c+L,La+E>=D&&(J-=c*(La+1+E-D)),w+L>=c&&(J-=w+L-c+4),L=F[J++],E=F[J++],J=F[J++],p[tb]=(u[L]+
u[E+256>>0]+u[J+512>>0]>>16)-128,K[tb]=(u[L+768>>0]+u[E+1024>>0]+u[J+1280>>0]>>16)-128,W[tb]=(u[L+1280>>0]+u[E+1536>>0]+u[J+1792>>0]>>16)-128;f=g(p,m,f,r,q);h=g(K,n,h,v,t);x=g(W,n,x,v,t);w+=32}La+=8}0<=G&&(c=[],c[1]=G+1,c[0]=(1<<G+1)-1,b(c));d(65497);return new C(A)};(function(){(new Date).getTime();h||(h=50);for(var a=String.fromCharCode,d=0;256>d;d++)L[d]=a(d);r=c(Y,B);v=c(Xg,md);q=c(Wg,y);t=c(z,H);for(var a=1,d=2,b=1;15>=b;b++){for(var g=a;g<d;g++)x[32767+g]=b,F[32767+g]=[],F[32767+g][1]=b,F[32767+
g][0]=g;for(g=-(d-1);g<=-a;g++)x[32767+g]=b,F[32767+g]=[],F[32767+g][1]=b,F[32767+g][0]=d-1+g;a<<=1;d<<=1}for(a=0;256>a;a++)u[a]=19595*a,u[a+256>>0]=38470*a,u[a+512>>0]=7471*a+32768,u[a+768>>0]=-11059*a,u[a+1024>>0]=-21709*a,u[a+1280>>0]=32768*a+8421375,u[a+1536>>0]=-27439*a,u[a+1792>>0]=-5329*a;e(h);(new Date).getTime()})()}function Yg(h){return!!h.constructor&&"function"===typeof h.constructor.isBuffer&&h.constructor.isBuffer(h)}function Qi(h,c){return h[0]-c[0]}function Ri(){var h=this.stride,
c=Array(h.length),b;for(b=0;b<c.length;++b)c[b]=[Math.abs(h[b]),b];c.sort(Qi);h=Array(c.length);for(b=0;b<h.length;++b)h[b]=c[b][1];return h}function Si(h,c){var b=["View",c,"d",h].join("");0>c&&(b="View_Nil"+h);var a="generic"===h;if(-1===c){var d;c=new Function("function "+b+"(a){this.data=a;};var proto="+b+".prototype;proto.dtype='"+h+"';proto.index=function(){return -1};proto.size=0;proto.dimension=-1;proto.shape=proto.stride=proto.order=[];proto.lo=proto.hi=proto.transpose=proto.step=function(){return new "+
b+"(this.data);};proto.get=proto.set=function(){};proto.pick=function(){return null};return function construct_"+b+"(a){return new "+b+"(a);}");return c()}if(0===c)return c=new Function("TrivialArray","function "+b+"(a,d) {this.data = a;this.offset = d};var proto="+b+".prototype;proto.dtype='"+h+"';proto.index=function(){return this.offset};proto.dimension=0;proto.size=1;proto.shape=proto.stride=proto.order=[];proto.lo=proto.hi=proto.transpose=proto.step=function "+b+"_copy() {return new "+b+"(this.data,this.offset)};proto.pick=function "+
b+"_pick(){return TrivialArray(this.data);};proto.valueOf=proto.get=function "+b+"_get(){return "+(a?"this.data.get(this.offset)":"this.data[this.offset]")+"};proto.set=function "+b+"_set(v){return "+(a?"this.data.set(this.offset,v)":"this.data[this.offset]=v")+"};return function construct_"+b+"(a,b,c,d){return new "+b+"(a,d)}"),c(nd[h][0]);d=["'use strict'"];var g=Ti(c),e=g.map(function(a){return"i"+a}),f="this.offset+"+g.map(function(a){return"this.stride["+a+"]*i"+a}).join("+"),k=g.map(function(a){return"b"+
a}).join(","),l=g.map(function(a){return"c"+a}).join(",");d.push("function "+b+"(a,"+k+","+l+",d){this.data=a","this.shape=["+k+"]","this.stride=["+l+"]","this.offset=d|0}","var proto="+b+".prototype","proto.dtype='"+h+"'","proto.dimension="+c);d.push("Object.defineProperty(proto,'size',{get:function "+b+"_size(){return "+g.map(function(a){return"this.shape["+a+"]"}).join("*"),"}})");1===c?d.push("proto.order=[0]"):(d.push("Object.defineProperty(proto,'order',{get:"),4>c?(d.push("function "+b+"_order(){"),
2===c?d.push("return (Math.abs(this.stride[0])>Math.abs(this.stride[1]))?[1,0]:[0,1]}})"):3===c&&d.push("var s0=Math.abs(this.stride[0]),s1=Math.abs(this.stride[1]),s2=Math.abs(this.stride[2]);if(s0>s1){if(s1>s2){return [2,1,0];}else if(s0>s2){return [1,2,0];}else{return [1,0,2];}}else if(s0>s2){return [2,0,1];}else if(s2>s1){return [0,1,2];}else{return [0,2,1];}}})")):d.push("ORDER})"));d.push("proto.set=function "+b+"_set("+e.join(",")+",v){");a?d.push("return this.data.set("+f+",v)}"):d.push("return this.data["+
f+"]=v}");d.push("proto.get=function "+b+"_get("+e.join(",")+"){");a?d.push("return this.data.get("+f+")}"):d.push("return this.data["+f+"]}");d.push("proto.index=function "+b+"_index(",e.join(),"){return "+f+"}");d.push("proto.hi=function "+b+"_hi("+e.join(",")+"){return new "+b+"(this.data,"+g.map(function(a){return["(typeof i",a,"!=='number'||i",a,"<0)?this.shape[",a,"]:i",a,"|0"].join("")}).join(",")+","+g.map(function(a){return"this.stride["+a+"]"}).join(",")+",this.offset)}");a=g.map(function(a){return"a"+
a+"=this.shape["+a+"]"});f=g.map(function(a){return"c"+a+"=this.stride["+a+"]"});d.push("proto.lo=function "+b+"_lo("+e.join(",")+"){var b=this.offset,d=0,"+a.join(",")+","+f.join(","));for(a=0;a<c;++a)d.push("if(typeof i"+a+"==='number'&&i"+a+">=0){d=i"+a+"|0;b+=c"+a+"*d;a"+a+"-=d}");d.push("return new "+b+"(this.data,"+g.map(function(a){return"a"+a}).join(",")+","+g.map(function(a){return"c"+a}).join(",")+",b)}");d.push("proto.step=function "+b+"_step("+e.join(",")+"){var "+g.map(function(a){return"a"+
a+"=this.shape["+a+"]"}).join(",")+","+g.map(function(a){return"b"+a+"=this.stride["+a+"]"}).join(",")+",c=this.offset,d=0,ceil=Math.ceil");for(a=0;a<c;++a)d.push("if(typeof i"+a+"==='number'){d=i"+a+"|0;if(d<0){c+=b"+a+"*(a"+a+"-1);a"+a+"=ceil(-a"+a+"/d)}else{a"+a+"=ceil(a"+a+"/d)}b"+a+"*=d}");d.push("return new "+b+"(this.data,"+g.map(function(a){return"a"+a}).join(",")+","+g.map(function(a){return"b"+a}).join(",")+",c)}");f=Array(c);k=Array(c);for(a=0;a<c;++a)f[a]="a[i"+a+"]",k[a]="b[i"+a+"]";
d.push("proto.transpose=function "+b+"_transpose("+e+"){"+e.map(function(a,d){return a+"=("+a+"===undefined?"+d+":"+a+"|0)"}).join(";"),"var a=this.shape,b=this.stride;return new "+b+"(this.data,"+f.join(",")+","+k.join(",")+",this.offset)}");d.push("proto.pick=function "+b+"_pick("+e+"){var a=[],b=[],c=this.offset");for(a=0;a<c;++a)d.push("if(typeof i"+a+"==='number'&&i"+a+">=0){c=(c+this.stride["+a+"]*i"+a+")|0}else{a.push(this.shape["+a+"]);b.push(this.stride["+a+"])}");d.push("var ctor=CTOR_LIST[a.length+1];return ctor(this.data,a,b,c)}");
d.push("return function construct_"+b+"(data,shape,stride,offset){return new "+b+"(data,"+g.map(function(a){return"shape["+a+"]"}).join(",")+","+g.map(function(a){return"stride["+a+"]"}).join(",")+",offset)}");c=new Function("CTOR_LIST","ORDER",d.join("\n"));return c(nd[h],Ri)}function Ui(h){if(null!=h&&(Yg(h)||"function"===typeof h.readFloatLE&&"function"===typeof h.slice&&Yg(h.slice(0,0))||h._isBuffer))return"buffer";if(Vi)switch(Object.prototype.toString.call(h)){case "[object Float64Array]":return"float64";
case "[object Float32Array]":return"float32";case "[object Int8Array]":return"int8";case "[object Int16Array]":return"int16";case "[object Int32Array]":return"int32";case "[object Uint8Array]":return"uint8";case "[object Uint16Array]":return"uint16";case "[object Uint32Array]":return"uint32";case "[object Uint8ClampedArray]":return"uint8_clamped"}return Array.isArray(h)?"array":"generic"}function Wi(h){switch(h){case "uint8":return Uint8Array;case "uint16":return Uint16Array;case "uint32":return Uint32Array;
case "int8":return Int8Array;case "int16":return Int16Array;case "int32":return Int32Array;case "float":case "float32":return Float32Array;case "double":case "float64":return Float64Array;case "uint8_clamped":return Uint8ClampedArray;case "generic":case "buffer":case "data":case "dataview":return ArrayBuffer;case "array":return Array}}function Xi(h){var c=h.map(function(a){return a.getMetadata("width")});if(!c.reduce(function(a,b){return a&&b===c[0]},!0))return!1;var b=h.map(function(a){return a.getMetadata("height")});
if(!b.reduce(function(a,c){return a&&c===b[0]},!0))return!1;var a=h.map(function(a){return a.getData().constructor});return a.reduce(function(d,b){return d&&b===a[0]},!0)?!0:!1}function Zg(h,c,b){var a=h.length,d=c.arrayArgs.length;c=0<c.indexArgs.length;var g=[],e=[],f=0,k,l,m;for(l=0;l<a;++l)e.push(["i",l,"=0"].join(""));for(m=0;m<d;++m)for(l=0;l<a;++l)k=f,f=h[l],0===l?e.push(["d",m,"s",l,"=t",m,"p",f].join("")):e.push(["d",m,"s",l,"=(t",m,"p",f,"-s",k,"*t",m,"p",k,")"].join(""));0<e.length&&g.push("var "+
e.join(","));for(l=a-1;0<=l;--l)f=h[l],g.push(["for(i",l,"=0;i",l,"<s",f,";++i",l,"){"].join(""));g.push(b);for(l=0;l<a;++l){k=f;f=h[l];for(m=0;m<d;++m)g.push(["p",m,"+=d",m,"s",l].join(""));c&&(0<l&&g.push(["index[",k,"]-=s",k].join("")),g.push(["++index[",f,"]"].join("")));g.push("}")}return g.join("\n")}function Yi(h,c,b,a){for(var d=c.length,g=b.arrayArgs.length,e=b.blockSize,f=0<b.indexArgs.length,k=[],l=0;l<g;++l)k.push(["var offset",l,"=p",l].join(""));for(l=h;l<d;++l)k.push(["for(var j"+l+
"=SS[",c[l],"]|0;j",l,">0;){"].join("")),k.push(["if(j",l,"<",e,"){"].join("")),k.push(["s",c[l],"=j",l].join("")),k.push(["j",l,"=0"].join("")),k.push(["}else{s",c[l],"=",e].join("")),k.push(["j",l,"-=",e,"}"].join("")),f&&k.push(["index[",c[l],"]=j",l].join(""));for(l=0;l<g;++l){e=["offset"+l];for(f=h;f<d;++f)e.push(["j",f,"*t",l,"p",c[f]].join(""));k.push(["p",l,"=(",e.join("+"),")"].join(""))}k.push(Zg(c,b,a));for(l=h;l<d;++l)k.push("}");return k.join("\n")}function ke(h,c,b){for(var a=h.body,
d=[],g=[],e=0;e<h.args.length;++e){var f=h.args[e];if(!(0>=f.count)){var k=new RegExp(f.name,"g"),l="",m=c.arrayArgs.indexOf(e);switch(c.argTypes[e]){case "offset":var n=c.offsetArgIndex.indexOf(e),m=c.offsetArgs[n].array,l="+q"+n;case "array":var l="p"+m+l,r="l"+e,n="a"+m;if(0===c.arrayBlockIndices[m])1===f.count?"generic"===b[m]?f.lvalue?(d.push(["var ",r,"=",n,".get(",l,")"].join("")),a=a.replace(k,r),g.push([n,".set(",l,",",r,")"].join(""))):a=a.replace(k,[n,".get(",l,")"].join("")):a=a.replace(k,
[n,"[",l,"]"].join("")):"generic"===b[m]?(d.push(["var ",r,"=",n,".get(",l,")"].join("")),a=a.replace(k,r),f.lvalue&&g.push([n,".set(",l,",",r,")"].join(""))):(d.push(["var ",r,"=",n,"[",l,"]"].join("")),a=a.replace(k,r),f.lvalue&&g.push([n,"[",l,"]=",r].join("")));else{k=[f.name];f=[l];for(l=0;l<Math.abs(c.arrayBlockIndices[m]);l++)k.push("\\s*\\[([^\\]]+)\\]"),f.push("$"+(l+1)+"*t"+m+"b"+l);k=new RegExp(k.join(""),"g");l=f.join("+");if("generic"===b[m])throw Error("cwise: Generic arrays not supported in combination with blocks!");
a=a.replace(k,[n,"[",l,"]"].join(""))}break;case "scalar":a=a.replace(k,"Y"+c.scalarArgs.indexOf(e));break;case "index":a=a.replace(k,"index");break;case "shape":a=a.replace(k,"shape")}}}return[d.join("\n"),a,g.join("\n")].join("\n").trim()}function Zi(h){for(var c=Array(h.length),b=!0,a=0;a<h.length;++a){var d=h[a],g=d.match(/\d+/),g=g?g[0]:"";0===d.charAt(0)?c[a]="u"+d.charAt(1)+g:c[a]=d.charAt(0)+g;0<a&&(b=b&&c[a]===c[a-1])}return b?c[0]:c.join("")}function $i(){this.argTypes=[];this.shimArgs=
[];this.arrayArgs=[];this.arrayBlockIndices=[];this.scalarArgs=[];this.offsetArgs=[];this.offsetArgIndex=[];this.indexArgs=[];this.shapeArgs=[];this.funcName="";this.post=this.body=this.pre=null;this.debug=!1}function $g(h){var c=32;(h&=-h)&&c--;h&65535&&(c-=16);h&16711935&&(c-=8);h&252645135&&(c-=4);h&858993459&&(c-=2);h&1431655765&&--c;return c}function ah(h,c,b){var a=h[b]|0;if(0>=a)return[];var d=Array(a),g;if(b===h.length-1)for(g=0;g<a;++g)d[g]=c;else for(g=0;g<a;++g)d[g]=ah(h,c,b+1);return d}
function od(h,c,b,a,d,g){h|=0;c|=0;b|=0;d|=0;g|=0;var e,f,k,l,m,n,r,v,q,t,F,x,D,w,A,I,G,p;e=b;f=Ca.log2(e);for(A=0;A<c;++A){l=e>>1;for(k=m=0;k<e-1;k++){k<m&&(n=a[d+k],a[d+k]=a[d+m],a[d+m]=n,n=a[g+k],a[g+k]=a[g+m],a[g+m]=n);for(n=l;n<=m;)m-=n,n>>=1;m+=n}q=-1;t=0;v=1;for(n=0;n<f;n++){r=v;v<<=1;D=1;for(m=w=0;m<r;m++){for(k=m;k<e;k+=v)l=k+r,I=a[d+l],F=a[g+l],G=a[d+k],p=a[g+k],x=D*(I+F),I*=w-D,F*=D+w,F=x-F,x+=I,a[d+l]=G-F,a[g+l]=p-x,a[d+k]+=F,a[g+k]+=x;x=q*(D+w);I=D*(t-q);F=w*(q+t);D=x-F;w=x+I}t=Math.sqrt((1-
q)/2);0>h&&(t=-t);q=Math.sqrt((1+q)/2)}if(0>h)for(m=1/e,k=0;k<e;k++)a[d+k]*=m,a[g+k]*=m;d+=b;g+=b}}var Na="undefined"!==typeof Float32Array?Float32Array:Array;(function(){var h=R();return function(c,b,a,d,g,e){b||(b=3);a||(a=0);for(d=d?Math.min(d*b+a,c.length):c.length;a<d;a+=b)h[0]=c[a],h[1]=c[a+1],h[2]=c[a+2],g(h,h,e),c[a]=h[0],c[a+1]=h[1],c[a+2]=h[2];return c}})();(function(){var h=Ob();return function(c,b,a,d,g,e){b||(b=4);a||(a=0);for(d=d?Math.min(d*b+a,c.length):c.length;a<d;a+=b)h[0]=c[a],
h[1]=c[a+1],h[2]=c[a+2],h[3]=c[a+3],g(h,h,e),c[a]=h[0],c[a+1]=h[1],c[a+2]=h[2],c[a+3]=h[3];return c}})();var bh=function(h,c){var b=c[0],a=c[1],d=c[2];c=c[3];var g=b*b+a*a+d*d+c*c;0<g&&(g=1/Math.sqrt(g),h[0]=b*g,h[1]=a*g,h[2]=d*g,h[3]=c*g);return h};(function(){var h=R(),c=X(1,0,0),b=X(0,1,0);return function(a,d,g){var e=d[0]*g[0]+d[1]*g[1]+d[2]*g[2];if(-.999999>e){ga(h,c,d);g=h[0];var e=h[1],f=h[2];1E-6>Math.sqrt(g*g+e*e+f*f)&&ga(h,b,d);d=h[0];g=h[1];e=h[2];d=d*d+g*g+e*e;0<d&&(d=1/Math.sqrt(d),h[0]*=
d,h[1]*=d,h[2]*=d);d=Math.PI;d*=.5;g=Math.sin(d);a[0]=g*h[0];a[1]=g*h[1];a[2]=g*h[2];a[3]=Math.cos(d);return a}if(.999999<e)return a[0]=0,a[1]=0,a[2]=0,a[3]=1,a;ga(h,d,g);a[0]=h[0];a[1]=h[1];a[2]=h[2];a[3]=1+e;return bh(a,a)}})();(function(){var h=zd(),c=zd();return function(b,a,d,g,e,f){Ad(h,a,e,f);Ad(c,d,g,f);Ad(b,h,c,2*f*(1-f));return b}})();(function(){var h=u();return function(c,b,a,d){h[0]=a[0];h[3]=a[1];h[6]=a[2];h[1]=d[0];h[4]=d[1];h[7]=d[2];h[2]=-b[0];h[5]=-b[1];h[8]=-b[2];b=h[0]+h[4]+h[8];
if(0<b)b=Math.sqrt(b+1),c[3]=.5*b,b=.5/b,c[0]=(h[5]-h[7])*b,c[1]=(h[6]-h[2])*b,c[2]=(h[1]-h[3])*b;else{a=0;h[4]>h[0]&&(a=1);h[8]>h[3*a+a]&&(a=2);d=(a+1)%3;var g=(a+2)%3;b=Math.sqrt(h[3*a+a]-h[3*d+d]-h[3*g+g]+1);c[a]=.5*b;b=.5/b;c[3]=(h[3*d+g]-h[3*g+d])*b;c[d]=(h[3*d+a]+h[3*a+d])*b;c[g]=(h[3*g+a]+h[3*a+g])*b}return bh(c,c)}})();(function(){var h=De();return function(c,b,a,d,g,e){b||(b=2);a||(a=0);for(d=d?Math.min(d*b+a,c.length):c.length;a<d;a+=b)h[0]=c[a],h[1]=c[a+1],g(h,h,e),c[a]=h[0],c[a+1]=h[1];
return c}})();var H="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(h){return typeof h}:function(h){return h&&"function"===typeof Symbol&&h.constructor===Symbol&&h!==Symbol.prototype?"symbol":typeof h};(function(){function h(b){this.value=b}function c(b){function a(c,g){try{var e=b[c](g),f=e.value;f instanceof h?Promise.resolve(f.value).then(function(d){a("next",d)},function(d){a("throw",d)}):d(e.done?"return":"normal",e.value)}catch(n){d("throw",n)}}function d(d,b){switch(d){case "return":c.resolve({value:b,
done:!0});break;case "throw":c.reject(b);break;default:c.resolve({value:b,done:!1})}(c=c.next)?a(c.key,c.arg):e=null}var c,e;this._invoke=function(d,b){return new Promise(function(g,f){g={key:d,arg:b,resolve:g,reject:f,next:null};e?e=e.next=g:(c=e=g,a(d,b))})};"function"!==typeof b.return&&(this.return=void 0)}"function"===typeof Symbol&&Symbol.asyncIterator&&(c.prototype[Symbol.asyncIterator]=function(){return this});c.prototype.next=function(b){return this._invoke("next",b)};c.prototype.throw=function(b){return this._invoke("throw",
b)};c.prototype.return=function(b){return this._invoke("return",b)};return{wrap:function(b){return function(){return new c(b.apply(this,arguments))}},await:function(b){return new h(b)}}})();var N=function(h,c){if(!(h instanceof c))throw new TypeError("Cannot call a class as a function");},O=function(){function h(c,b){for(var a=0;a<b.length;a++){var d=b[a];d.enumerable=d.enumerable||!1;d.configurable=!0;"value"in d&&(d.writable=!0);Object.defineProperty(c,d.key,d)}}return function(c,b,a){b&&h(c.prototype,
b);a&&h(c,a);return c}}(),aj=function c(b,a,d){null===b&&(b=Function.prototype);var g=Object.getOwnPropertyDescriptor(b,a);if(void 0===g){if(b=Object.getPrototypeOf(b),null!==b)return c(b,a,d)}else{if("value"in g)return g.value;a=g.get;return void 0===a?void 0:a.call(d)}},M=function(c,b){if("function"!==typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function, not "+typeof b);c.prototype=Object.create(b&&b.prototype,{constructor:{value:c,enumerable:!1,writable:!0,
configurable:!0}});b&&(Object.setPrototypeOf?Object.setPrototypeOf(c,b):c.__proto__=b)},P=function(c,b){if(!c)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!b||"object"!==typeof b&&"function"!==typeof b?c:b},bj=function(c){if(Array.isArray(c)){for(var b=0,a=Array(c.length);b<c.length;b++)a[b]=c[b];return a}return Array.from(c)},le={},cb=function(){function c(){N(this,c)}O(c,null,[{key:"addCoreType",value:function(b){"function"===typeof b&&(le[b.name]=
b)}},{key:"getCoreType",value:function(b){return b in le?le[b]:null}}]);return c}(),Mb="undefined"!==typeof window?window:"undefined"!==typeof global?global:"undefined"!==typeof self?self:{},ea=qa(function(c,b){(function(a,d){c.exports=d()})(Mb,function(){return function(a){function d(c){if(b[c])return b[c].exports;var g=b[c]={exports:{},id:c,loaded:!1};a[c].call(g.exports,g,g.exports,d);g.loaded=!0;return g.exports}var b={};d.m=a;d.c=b;d.p="";return d(0)}([function(a,d,b){d=b(1);a.exports=d},function(a,
d,b){function c(a,d,b){d in a?Object.defineProperty(a,d,{value:b,enumerable:!0,configurable:!0,writable:!0}):a[d]=b;return a}function g(a,d){if("function"!==typeof d&&null!==d)throw new TypeError("Super expression must either be null or a function, not "+("undefined"===typeof d?"undefined":H(d)));a.prototype=Object.create(d&&d.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}});if(d)if(Object.setPrototypeOf)Object.setPrototypeOf(a,d);else for(var b=Object.getOwnPropertyNames(d),
c=0;c<b.length;c++){var g=b[c],e=Object.getOwnPropertyDescriptor(d,g);e&&e.configurable&&void 0===a[g]&&Object.defineProperty(a,g,e)}}var k=Object.assign||function(a){for(var d=1;d<arguments.length;d++){var b=arguments[d],c;for(c in b)Object.prototype.hasOwnProperty.call(b,c)&&(a[c]=b[c])}return a},l=b(2),m=b(11),n=b(16),r=b(13),v=b(29),q=b(12),t={alternatives:b(25),array:b(30),boolean:b(24),binary:b(31),date:b(17),number:b(23),object:b(26),string:b(18),root:function(){var a=new m,d=a.clone();d.any=
function(){l.assert(0===arguments.length,"Joi.any() does not allow arguments.");return a};d.alternatives=d.alt=function(){return arguments.length?t.alternatives.try.apply(t.alternatives,arguments):t.alternatives};d.array=function(){l.assert(0===arguments.length,"Joi.array() does not allow arguments.");return t.array};d.boolean=d.bool=function(){l.assert(0===arguments.length,"Joi.boolean() does not allow arguments.");return t.boolean};d.binary=function(){l.assert(0===arguments.length,"Joi.binary() does not allow arguments.");
return t.binary};d.date=function(){l.assert(0===arguments.length,"Joi.date() does not allow arguments.");return t.date};d.func=function(){l.assert(0===arguments.length,"Joi.func() does not allow arguments.");return t.object._func()};d.number=function(){l.assert(0===arguments.length,"Joi.number() does not allow arguments.");return t.number};d.object=function(){return arguments.length?t.object.keys.apply(t.object,arguments):t.object};d.string=function(){l.assert(0===arguments.length,"Joi.string() does not allow arguments.");
return t.string};d.ref=function(){return q.create.apply(null,arguments)};d.isRef=function(a){return q.isRef(a)};d.validate=function(b){var c=arguments[arguments.length-1],c="function"===typeof c?c:null,g=arguments.length-(c?1:0);if(1===g)return a.validate(b,c);g=3===g?arguments[2]:{};return d.compile(arguments[1])._validateWithOptions(b,g,c)};d.describe=function(){return(arguments.length?d.compile(arguments[0]):a).describe()};d.compile=function(a){try{return n.schema(a)}catch(w){throw w.hasOwnProperty("path")&&
(w.message=w.message+"("+w.path+")"),w;}};d.assert=function(a,b,c){d.attempt(a,b,c)};d.attempt=function(a,b,c){a=d.validate(a,b);if(b=a.error){if(!c)throw"function"===typeof b.annotate&&(b.message=b.annotate()),b;if(!(c instanceof Error))throw"function"===typeof b.annotate&&(b.message=c+" "+b.annotate()),b;throw c;}return a.value};d.reach=function(a,d){l.assert(a&&a instanceof m,"you must provide a joi schema");l.assert("string"===typeof d,"path must be a string");if(""===d)return a;var b=d.split(".");
if(a=a._inner.children)for(var b=b[0],c=0;c<a.length;++c){var g=a[c];if(g.key===b)return this.reach(g.schema,d.substr(b.length+1))}};d.lazy=function(a){return v.set(a)};d.extend=function(){var a=this,b=l.flatten(Array.prototype.slice.call(arguments));l.assert(0<b.length,"You need to provide at least one extension");this.assert(b,d.extensionsSchema);var e=Object.create(this.any());k(e,this);for(var f=function(f){var t=b[f];"function"===typeof t&&(t=t(e));a.assert(t,d.extensionSchema);var F=(t.base||
a.any()).clone(),x=F.constructor,v=function(a){function d(){if(!(this instanceof d))throw new TypeError("Cannot call a class as a function");var b;b=a.call(this);if(!this)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");b=!b||"object"!==("undefined"===typeof b?"undefined":H(b))&&"function"!==typeof b?this:b;t.base&&k(b,F);b._type=t.name;t.language&&(b._settings=b._settings||{language:{}},b._settings.language=l.applyToDefaults(b._settings.language,c({},t.name,t.language)));
return b}g(d,a);return d}(x);t.coerce&&(v.prototype._coerce=function(a,d,b){if(x.prototype._coerce){a=x.prototype._coerce.call(this,a,d,b);if(a.errors)return a;a=a.value}d=t.coerce.call(this,a,d,b);return d instanceof r.Err?{value:a,errors:d}:{value:d}});t.pre&&(v.prototype._base=function(a,d,b){if(x.prototype._base){a=x.prototype._base.call(this,a,d,b);if(a.errors)return a;a=a.value}d=t.pre.call(this,a,d,b);return d instanceof r.Err?{value:a,errors:d}:{value:d}});if(t.rules){f=function(a){var d=
t.rules[a],b=d.params?d.params instanceof m?d.params._inner.children.map(function(a){return a.key}):Object.keys(d.params):[],c=d.params?n.schema(d.params):null;v.prototype[d.name]=function(){if(arguments.length>b.length)throw Error("Unexpected number of arguments");for(var a=Array.prototype.slice.call(arguments),g=!1,f={},k=0;k<b.length;++k)f[b[k]]=a[k],!g&&q.isRef(a[k])&&(g=!0);c&&(f=e.attempt(f,c));a=void 0;a=d.validate?this._test(d.name,f,function(a,b,c){return d.validate.call(this,f,a,b,c)},{description:d.description,
hasRef:g}):this.clone();d.setup&&(g=d.setup.call(a,f),void 0!==g&&(l.assert(g instanceof m,"Setup of extension Joi."+this._type+"()."+d.name+"() must return undefined or a Joi object"),a=g));return a}};for(var D=0;D<t.rules.length;++D)f(D)}t.describe&&(v.prototype.describe=function(){var a=x.prototype.describe.call(this);return t.describe.call(this,a)});var w=new v;e[t.name]=function(){return w}},t=0;t<b.length;++t)f(t);return e};d.extensionSchema=t.object.keys({base:t.object.type(m,"Joi object"),
name:t.string.required(),coerce:t.object._func().arity(3),pre:t.object._func().arity(3),language:t.object,describe:t.object._func().arity(1),rules:t.array.items(t.object.keys({name:t.string.required(),setup:t.object._func().arity(1),validate:t.object._func().arity(4),params:[t.object.pattern(/.*/,t.object.type(m,"Joi object")),t.object.type(t.object.constructor,"Joi object")],description:[t.string,t.object._func().arity(1)]}).or("setup","validate"))}).strict();d.extensionsSchema=t.array.items([t.object,
t.object._func().arity(1)]).strict();d.version=b(32).version;return d}};a.exports=t.root()},function(a,d,b){(function(a,c){var g="function"===typeof Symbol&&"symbol"===H(Symbol.iterator)?function(a){return"undefined"===typeof a?"undefined":H(a)}:function(a){return a&&"function"===typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":"undefined"===typeof a?"undefined":H(a)},e=b(5),f=b(6),n=b(7),r=b(10),v={};d.clone=function(b,c){if("object"!==("undefined"===typeof b?"undefined":g(b))||
null===b)return b;c=c||new Map;var e=c.get(b);if(e)return e;var f=!1;Array.isArray(b)?(e=[],f=!0):a.isBuffer(b)?e=new a(b):b instanceof Date?e=new Date(b.getTime()):b instanceof RegExp?e=new RegExp(b):(e=Object.getPrototypeOf(b))&&e.isImmutable?e=b:(e=Object.create(e),f=!0);c.set(b,e);if(f)for(var f=Object.getOwnPropertyNames(b),k=0;k<f.length;++k){var n=f[k],l=Object.getOwnPropertyDescriptor(b,n);l&&(l.get||l.set)?Object.defineProperty(e,n,l):e[n]=d.clone(b[n],c)}return e};d.merge=function(b,c,e,
f){d.assert(b&&"object"===("undefined"===typeof b?"undefined":g(b)),"Invalid target value: must be an object");d.assert(null===c||void 0===c||"object"===("undefined"===typeof c?"undefined":g(c)),"Invalid source value: must be null, undefined, or an object");if(!c)return b;if(Array.isArray(c)){d.assert(Array.isArray(b),"Cannot merge array onto an object");!1===f&&(b.length=0);for(e=0;e<c.length;++e)b.push(d.clone(c[e]));return b}for(var k=Object.keys(c),n=0;n<k.length;++n){var l=k[n],m=c[l];m&&"object"===
("undefined"===typeof m?"undefined":g(m))?!b[l]||"object"!==g(b[l])||Array.isArray(b[l])!==Array.isArray(m)||m instanceof Date||a.isBuffer(m)||m instanceof RegExp?b[l]=d.clone(m):d.merge(b[l],m,e,f):null!==m&&void 0!==m?b[l]=m:!1!==e&&(b[l]=m)}return b};d.applyToDefaults=function(a,b,c){d.assert(a&&"object"===("undefined"===typeof a?"undefined":g(a)),"Invalid defaults value: must be an object");d.assert(!b||!0===b||"object"===("undefined"===typeof b?"undefined":g(b)),"Invalid options value: must be true, falsy or an object");
if(!b)return null;a=d.clone(a);return!0===b?a:d.merge(a,b,!0===c,!1)};d.cloneWithShallow=function(a,b){if(!a||"object"!==("undefined"===typeof a?"undefined":g(a)))return a;b=v.store(a,b);var c=d.clone(a);v.restore(c,a,b);return c};v.store=function(a,b){for(var c={},g=0;g<b.length;++g){var e=b[g],f=d.reach(a,e);void 0!==f&&(c[e]=f,v.reachSet(a,e,void 0))}return c};v.restore=function(a,d,b){for(var c=Object.keys(b),g=0;g<c.length;++g){var e=c[g];v.reachSet(a,e,b[e]);v.reachSet(d,e,b[e])}};v.reachSet=
function(a,d,b){d=d.split(".");for(var c=0;c<d.length;++c){var g=d[c];c+1===d.length&&(a[g]=b);a=a[g]}};d.applyToDefaultsWithShallow=function(a,b,c){d.assert(a&&"object"===("undefined"===typeof a?"undefined":g(a)),"Invalid defaults value: must be an object");d.assert(!b||!0===b||"object"===("undefined"===typeof b?"undefined":g(b)),"Invalid options value: must be true, falsy or an object");d.assert(c&&Array.isArray(c),"Invalid keys");if(!b)return null;a=d.cloneWithShallow(a,c);if(!0===b)return a;c=
v.store(b,c);d.merge(a,b,!1,!1);v.restore(a,b,c);return a};d.deepEqual=function(b,c,e,f){e=e||{prototype:!0};var k="undefined"===typeof b?"undefined":g(b);if(k!==("undefined"===typeof c?"undefined":g(c)))return!1;if("object"!==k||null===b||null===c)return b===c?0!==b||1/b===1/c:b!==b&&c!==c;f=f||[];if(-1!==f.indexOf(b))return!0;f.push(b);if(Array.isArray(b)){if(!Array.isArray(c)||!e.part&&b.length!==c.length)return!1;for(f=0;f<b.length;++f){if(e.part){for(var k=!1,n=0;n<c.length;++n)if(d.deepEqual(b[f],
c[n],e)){k=!0;break}return k}if(!d.deepEqual(b[f],c[f],e))return!1}return!0}if(a.isBuffer(b)){if(!a.isBuffer(c)||b.length!==c.length)return!1;for(e=0;e<b.length;++e)if(b[e]!==c[e])return!1;return!0}if(b instanceof Date)return c instanceof Date&&b.getTime()===c.getTime();if(b instanceof RegExp)return c instanceof RegExp&&b.toString()===c.toString();if(e.prototype&&Object.getPrototypeOf(b)!==Object.getPrototypeOf(c))return!1;k=Object.getOwnPropertyNames(b);if(!e.part&&k.length!==Object.getOwnPropertyNames(c).length)return!1;
for(n=0;n<k.length;++n){var l=k[n],m=Object.getOwnPropertyDescriptor(b,l);if(m.get){if(!d.deepEqual(m,Object.getOwnPropertyDescriptor(c,l),e,f))return!1}else if(!d.deepEqual(b[l],c[l],e,f))return!1}return!0};d.unique=function(a,d){var b=void 0;d?function(){b=[];var c=new Set;a.forEach(function(a){var g=a[d];c.has(g)||(c.add(g),b.push(a))})}():b=Array.from(new Set(a));return b};d.mapToObject=function(a,d){if(!a)return null;for(var b={},c=0;c<a.length;++c)d?a[c][d]&&(b[a[c][d]]=!0):b[a[c]]=!0;return b};
d.intersect=function(a,b,c){if(!a||!b)return[];var g=[];a=Array.isArray(a)?d.mapToObject(a):a;for(var e={},f=0;f<b.length;++f)if(a[b[f]]&&!e[b[f]]){if(c)return b[f];g.push(b[f]);e[b[f]]=!0}return c?null:g};d.contain=function(a,b,c){var e=null;"object"!==("undefined"===typeof a?"undefined":g(a))||"object"!==("undefined"===typeof b?"undefined":g(b))||Array.isArray(a)||Array.isArray(b)?b=[].concat(b):(e=b,b=Object.keys(b));c=c||{};d.assert(2<=arguments.length,"Insufficient arguments");d.assert("string"===
typeof a||"object"===("undefined"===typeof a?"undefined":g(a)),"Reference must be string or an object");d.assert(b.length,"Values array cannot be empty");var f=void 0,k=void 0;if(c.deep)var f=d.deepEqual,n=c.hasOwnProperty("only"),k=c.hasOwnProperty("part"),k={prototype:n?c.only:k?!c.part:!1,part:n?!c.only:k?c.part:!0};else f=function(a,d){return a===d};for(var n=!1,l=Array(b.length),m=0;m<l.length;++m)l[m]=0;if("string"===typeof a){f="(";for(n=0;n<b.length;++n)k=b[n],d.assert("string"===typeof k,
"Cannot compare string reference to non-string value"),f+=(n?"|":"")+d.escapeRegex(k);n=!!a.replace(new RegExp(f+")","g"),function(a,d){a=b.indexOf(d);++l[a];return""})}else if(Array.isArray(a))for(e=0;e<a.length;++e){for(var m=!1,r=0;r<b.length&&!1===m;++r)m=f(b[r],a[e],k)&&r;!1!==m?++l[m]:n=!0}else for(m=Object.getOwnPropertyNames(a),r=0;r<m.length;++r){var q=m[r],t=b.indexOf(q);if(-1!==t){if(e&&!f(e[q],a[q],k))return!1;++l[t]}else n=!0}f=!1;for(k=0;k<l.length;++k)if(f=f||!!l[k],c.once&&1<l[k]||
!c.part&&!l[k])return!1;return c.only&&n?!1:f};d.flatten=function(a,b){b=b||[];for(var c=0;c<a.length;++c)Array.isArray(a[c])?d.flatten(a[c],b):b.push(a[c]);return b};d.reach=function(a,b,c){if(!1===b||null===b||"undefined"===typeof b)return a;c=c||{};"string"===typeof c&&(c={separator:c});for(var e=b.split(c.separator||"."),f=0;f<e.length;++f){var k=e[f];"-"===k[0]&&Array.isArray(a)&&(k=k.slice(1,k.length),k=a.length-k);if(!a||"object"!==("undefined"===typeof a?"undefined":g(a))&&"function"!==typeof a||
!(k in a)||"object"!==("undefined"===typeof a?"undefined":g(a))&&!1===c.functions){d.assert(!c.strict||f+1===e.length,"Missing segment",k,"in reach path ",b);d.assert("object"===("undefined"===typeof a?"undefined":g(a))||!0===c.functions||"function"!==typeof a,"Invalid segment",k,"in reach path ",b);a=c.default;break}a=a[k]}return a};d.reachTemplate=function(a,b,c){return b.replace(/{([^}]+)}/g,function(b,g){b=d.reach(a,g,c);return void 0===b||null===b?"":b})};d.formatStack=function(a){for(var d=
[],b=0;b<a.length;++b){var c=a[b];d.push([c.getFileName(),c.getLineNumber(),c.getColumnNumber(),c.getFunctionName(),c.isConstructor()])}return d};d.formatTrace=function(a){for(var d=[],b=0;b<a.length;++b){var c=a[b];d.push((c[4]?"new ":"")+c[3]+" ("+c[0]+":"+c[1]+":"+c[2]+")")}return d};d.callStack=function(a){var b=Error.prepareStackTrace;Error.prepareStackTrace=function(a,d){return d};var c={};Error.captureStackTrace(c,this);c=c.stack;Error.prepareStackTrace=b;return d.formatStack(c).slice(1+a)};
d.displayStack=function(a){a=d.callStack(void 0===a?1:a+1);return d.formatTrace(a)};d.abortThrow=!1;d.abort=function(a,b){if("test"===c.env.NODE_ENV||!0===d.abortThrow)throw Error(a||"Unknown error");var g="";b||(g=d.displayStack(1).join("\n\t"));console.log("ABORT: "+a+"\n\t"+g);c.exit(1)};d.assert=function(a){if(!a){if(2===arguments.length&&arguments[1]instanceof Error)throw arguments[1];for(var b=[],c=1;c<arguments.length;++c)""!==arguments[c]&&b.push(arguments[c]);b=b.map(function(a){return"string"===
typeof a?a:a instanceof Error?a.message:d.stringify(a)});throw Error(b.join(" ")||"Unknown error");}};d.Timer=function(){this.ts=0;this.reset()};d.Timer.prototype.reset=function(){this.ts=Date.now()};d.Timer.prototype.elapsed=function(){return Date.now()-this.ts};d.Bench=function(){this.ts=0;this.reset()};d.Bench.prototype.reset=function(){this.ts=d.Bench.now()};d.Bench.prototype.elapsed=function(){return d.Bench.now()-this.ts};d.Bench.now=function(){var a=c.hrtime();return 1E3*a[0]+a[1]/1E6};d.escapeRegex=
function(a){return a.replace(/[\^\$\.\*\+\-\?\=\!\:\|\\\/\(\)\[\]\{\}\,]/g,"\\$&")};d.base64urlEncode=function(b,c){d.assert("string"===typeof b||a.isBuffer(b),"value must be string or buffer");return(a.isBuffer(b)?b:new a(b,c||"binary")).toString("base64").replace(/\+/g,"-").replace(/\//g,"_").replace(/\=/g,"")};d.base64urlDecode=function(d,b){if("string"!==typeof d)return Error("Value not a string");if(!/^[\w\-]*$/.test(d))return Error("Invalid character");d=new a(d,"base64");return"buffer"===b?
d:d.toString(b||"binary")};d.escapeHeaderAttribute=function(a){d.assert(/^[ \w\!#\$%&'\(\)\*\+,\-\.\/\:;<\=>\?@\[\]\^`\{\|\}~\"\\]*$/.test(a),"Bad attribute value ("+a+")");return a.replace(/\\/g,"\\\\").replace(/\"/g,'\\"')};d.escapeHtml=function(a){return r.escapeHtml(a)};d.escapeJavaScript=function(a){return r.escapeJavaScript(a)};d.nextTick=function(a){return function(){var d=arguments;c.nextTick(function(){a.apply(null,d)})}};d.once=function(a){if(a._hoekOnce)return a;var d=!1,b=function(){d||
(d=!0,a.apply(null,arguments))};b._hoekOnce=!0;return b};d.isInteger=Number.isSafeInteger;d.ignore=function(){};d.inherits=n.inherits;d.format=n.format;d.transform=function(a,b,c){d.assert(null===a||void 0===a||"object"===("undefined"===typeof a?"undefined":g(a))||Array.isArray(a),"Invalid source object: must be null, undefined, an object, or an array");var e="object"===("undefined"===typeof c?"undefined":g(c))&&null!==c?c.separator||".":".";if(Array.isArray(a)){for(var e=[],f=0;f<a.length;++f)e.push(d.transform(a[f],
b,c));return e}for(var f={},k=Object.keys(b),n=0;n<k.length;++n){var l=k[n],m=l.split(e),l=b[l];d.assert("string"===typeof l,'All mappings must be "." delineated strings');for(var r,q=f;1<m.length;)r=m.shift(),q[r]||(q[r]={}),q=q[r];r=m.shift();q[r]=d.reach(a,l,c)}return f};d.uniqueFilename=function(a,d){d=d?"."!==d[0]?"."+d:d:"";a=f.resolve(a);d=[Date.now(),c.pid,e.randomBytes(8).toString("hex")].join("-")+d;return f.join(a,d)};d.stringify=function(){try{return JSON.stringify.apply(null,arguments)}catch(q){return"[Cannot display object: "+
q.message+"]"}};d.shallow=function(a){for(var d={},b=Object.keys(a),c=0;c<b.length;++c){var g=b[c];d[g]=a[g]}return d}}).call(d,b(3).Buffer,b(4))},function(a,d){function b(){throw Error("Buffer is not included.");}b.isBuffer=function(){return!1};d.INSPECT_MAX_BYTES=50;d.SlowBuffer=b;d.Buffer=b},function(a,d){function b(){throw Error("setTimeout has not been defined");}function c(){throw Error("clearTimeout has not been defined");}function f(a){if(v===setTimeout)return setTimeout(a,0);if((v===b||!v)&&
setTimeout)return v=setTimeout,setTimeout(a,0);try{return v(a,0)}catch(A){try{return v.call(null,a,0)}catch(I){return v.call(this,a,0)}}}function k(a){if(q===clearTimeout)return clearTimeout(a);if((q===c||!q)&&clearTimeout)return q=clearTimeout,clearTimeout(a);try{return q(a)}catch(A){try{return q.call(null,a)}catch(I){return q.call(this,a)}}}function l(){F&&x&&(F=!1,x.length?t=x.concat(t):D=-1,t.length&&m())}function m(){if(!F){var a=f(l);F=!0;for(var d=t.length;d;){x=t;for(t=[];++D<d;)x&&x[D].run();
D=-1;d=t.length}x=null;F=!1;k(a)}}function n(a,d){this.fun=a;this.array=d}function r(){}a=a.exports={};var v,q;try{v="function"===typeof setTimeout?setTimeout:b}catch(w){v=b}try{q="function"===typeof clearTimeout?clearTimeout:c}catch(w){q=c}var t=[],F=!1,x,D=-1;a.nextTick=function(a){var d=Array(arguments.length-1);if(1<arguments.length)for(var b=1;b<arguments.length;b++)d[b-1]=arguments[b];t.push(new n(a,d));1!==t.length||F||f(m)};n.prototype.run=function(){this.fun.apply(null,this.array)};a.title=
"browser";a.browser=!0;a.env={};a.argv=[];a.version="";a.versions={};a.on=r;a.addListener=r;a.once=r;a.off=r;a.removeListener=r;a.removeAllListeners=r;a.emit=r;a.binding=function(a){throw Error("process.binding is not supported");};a.cwd=function(){return"/"};a.chdir=function(a){throw Error("process.chdir is not supported");};a.umask=function(){return 0}},function(a,d){},function(a,d,b){(function(a){function b(a,d){for(var b=0,c=a.length-1;0<=c;c--){var g=a[c];"."===g?a.splice(c,1):".."===g?(a.splice(c,
1),b++):b&&(a.splice(c,1),b--)}if(d)for(;b--;b)a.unshift("..");return a}function c(a,d){if(a.filter)return a.filter(d);for(var b=[],c=0;c<a.length;c++)d(a[c],c,a)&&b.push(a[c]);return b}var g=/^(\/?|)([\s\S]*?)((?:\.{1,2}|[^\/]+?|)(\.[^.\/]*|))(?:[\/]*)$/;d.resolve=function(){for(var d="",g=!1,e=arguments.length-1;-1<=e&&!g;e--){var f=0<=e?arguments[e]:a.cwd();if("string"!==typeof f)throw new TypeError("Arguments to path.resolve must be strings");f&&(d=f+"/"+d,g="/"===f.charAt(0))}d=b(c(d.split("/"),
function(a){return!!a}),!g).join("/");return(g?"/":"")+d||"."};d.normalize=function(a){var g=d.isAbsolute(a),f="/"===e(a,-1);(a=b(c(a.split("/"),function(a){return!!a}),!g).join("/"))||g||(a=".");a&&f&&(a+="/");return(g?"/":"")+a};d.isAbsolute=function(a){return"/"===a.charAt(0)};d.join=function(){var a=Array.prototype.slice.call(arguments,0);return d.normalize(c(a,function(a,d){if("string"!==typeof a)throw new TypeError("Arguments to path.join must be strings");return a}).join("/"))};d.relative=
function(a,b){function c(a){for(var d=0;d<a.length&&""===a[d];d++);for(var b=a.length-1;0<=b&&""===a[b];b--);return d>b?[]:a.slice(d,b-d+1)}a=d.resolve(a).substr(1);b=d.resolve(b).substr(1);a=c(a.split("/"));b=c(b.split("/"));for(var g=Math.min(a.length,b.length),e=g,f=0;f<g;f++)if(a[f]!==b[f]){e=f;break}g=[];for(f=e;f<a.length;f++)g.push("..");g=g.concat(b.slice(e));return g.join("/")};d.sep="/";d.delimiter=":";d.dirname=function(a){var d=g.exec(a).slice(1);a=d[0];d=d[1];if(!a&&!d)return".";d&&(d=
d.substr(0,d.length-1));return a+d};d.basename=function(a,d){a=g.exec(a).slice(1)[2];d&&a.substr(-1*d.length)===d&&(a=a.substr(0,a.length-d.length));return a};d.extname=function(a){return g.exec(a).slice(1)[3]};var e="b"==="ab".substr(-1)?function(a,d,b){return a.substr(d,b)}:function(a,d,b){0>d&&(d=a.length+d);return a.substr(d,b)}}).call(d,b(4))},function(a,d,b){(function(a,c){function g(a,b){var c={seen:[],stylize:f};3<=arguments.length&&(c.depth=arguments[2]);4<=arguments.length&&(c.colors=arguments[3]);
w(b)?c.showHidden=b:b&&d._extend(c,b);G(c.showHidden)&&(c.showHidden=!1);G(c.depth)&&(c.depth=2);G(c.colors)&&(c.colors=!1);G(c.customInspect)&&(c.customInspect=!0);c.colors&&(c.stylize=e);return r(c,a,c.depth)}function e(a,d){return(d=g.styles[d])?"\u001b["+g.colors[d][0]+"m"+a+"\u001b["+g.colors[d][1]+"m":a}function f(a,d){return a}function n(a){var d={};a.forEach(function(a,b){d[a]=!0});return d}function r(a,b,c){if(a.customInspect&&b&&u(b.inspect)&&b.inspect!==d.inspect&&(!b.constructor||b.constructor.prototype!==
b)){var g=b.inspect(c,a);I(g)||(g=r(a,g,c));return g}if(g=v(a,b))return g;var e=Object.keys(b),f=n(e);a.showHidden&&(e=Object.getOwnPropertyNames(b));if(L(b)&&(0<=e.indexOf("message")||0<=e.indexOf("description")))return q(b);if(0===e.length){if(u(b))return a.stylize("[Function"+(b.name?": "+b.name:"")+"]","special");if(p(b))return a.stylize(RegExp.prototype.toString.call(b),"regexp");if(W(b))return a.stylize(Date.prototype.toString.call(b),"date");if(L(b))return q(b)}var g="",k=!1,l=["{","}"];D(b)&&
(k=!0,l=["[","]"]);u(b)&&(g=" [Function"+(b.name?": "+b.name:"")+"]");p(b)&&(g=" "+RegExp.prototype.toString.call(b));W(b)&&(g=" "+Date.prototype.toUTCString.call(b));L(b)&&(g=" "+q(b));if(0===e.length&&(!k||0==b.length))return l[0]+g+l[1];if(0>c)return p(b)?a.stylize(RegExp.prototype.toString.call(b),"regexp"):a.stylize("[Object]","special");a.seen.push(b);e=k?t(a,b,c,f,e):e.map(function(d){return F(a,b,c,f,d,k)});a.seen.pop();return x(e,g,l)}function v(a,d){if(G(d))return a.stylize("undefined",
"undefined");if(I(d))return d="'"+JSON.stringify(d).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'",a.stylize(d,"string");if(A(d))return a.stylize(""+d,"number");if(w(d))return a.stylize(""+d,"boolean");if(null===d)return a.stylize("null","null")}function q(a){return"["+Error.prototype.toString.call(a)+"]"}function t(a,d,b,c,g){for(var e=[],f=0,k=d.length;f<k;++f)Object.prototype.hasOwnProperty.call(d,String(f))?e.push(F(a,d,b,c,String(f),!0)):e.push("");g.forEach(function(g){g.match(/^\d+$/)||
e.push(F(a,d,b,c,g,!0))});return e}function F(a,d,b,c,g,e){var f,k;d=Object.getOwnPropertyDescriptor(d,g)||{value:d[g]};d.get?k=d.set?a.stylize("[Getter/Setter]","special"):a.stylize("[Getter]","special"):d.set&&(k=a.stylize("[Setter]","special"));Object.prototype.hasOwnProperty.call(c,g)||(f="["+g+"]");k||(0>a.seen.indexOf(d.value)?(k=null===b?r(a,d.value,null):r(a,d.value,b-1),-1<k.indexOf("\n")&&(k=e?k.split("\n").map(function(a){return"  "+a}).join("\n").substr(2):"\n"+k.split("\n").map(function(a){return"   "+
a}).join("\n"))):k=a.stylize("[Circular]","special"));if(G(f)){if(e&&g.match(/^\d+$/))return k;f=JSON.stringify(""+g);f.match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(f=f.substr(1,f.length-2),f=a.stylize(f,"name")):(f=f.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),f=a.stylize(f,"string"))}return f+": "+k}function x(a,d,b){var c=0;return 60<a.reduce(function(a,d){c++;0<=d.indexOf("\n")&&c++;return a+d.replace(/\u001b\[\d\d?m/g,"").length+1},0)?b[0]+(""===d?"":d+"\n ")+" "+a.join(",\n  ")+
" "+b[1]:b[0]+d+" "+a.join(", ")+" "+b[1]}function D(a){return Array.isArray(a)}function w(a){return"boolean"===typeof a}function A(a){return"number"===typeof a}function I(a){return"string"===typeof a}function G(a){return void 0===a}function p(a){return K(a)&&"[object RegExp]"===Object.prototype.toString.call(a)}function K(a){return"object"===("undefined"===typeof a?"undefined":H(a))&&null!==a}function W(a){return K(a)&&"[object Date]"===Object.prototype.toString.call(a)}function L(a){return K(a)&&
("[object Error]"===Object.prototype.toString.call(a)||a instanceof Error)}function u(a){return"function"===typeof a}function J(a){return 10>a?"0"+a.toString(10):a.toString(10)}function E(){var a=new Date,d=[J(a.getHours()),J(a.getMinutes()),J(a.getSeconds())].join(":");return[a.getDate(),z[a.getMonth()],d].join(" ")}var Y=/%[sdj%]/g;d.format=function(a){if(!I(a)){for(var d=[],b=0;b<arguments.length;b++)d.push(g(arguments[b]));return d.join(" ")}for(var b=1,c=arguments,e=c.length,d=String(a).replace(Y,
function(a){if("%%"===a)return"%";if(b>=e)return a;switch(a){case "%s":return String(c[b++]);case "%d":return Number(c[b++]);case "%j":try{return JSON.stringify(c[b++])}catch(Zk){return"[Circular]"}default:return a}}),f=c[b];b<e;f=c[++b])d=null!==f&&K(f)?d+(" "+g(f)):d+(" "+f);return d};d.deprecate=function(b,g){if(G(a.process))return function(){return d.deprecate(b,g).apply(this,arguments)};if(!0===c.noDeprecation)return b;var e=!1;return function(){if(!e){if(c.throwDeprecation)throw Error(g);c.traceDeprecation?
console.trace(g):console.error(g);e=!0}return b.apply(this,arguments)}};var B={},y;d.debuglog=function(a){G(y)&&(y=c.env.NODE_DEBUG||"");a=a.toUpperCase();if(!B[a])if((new RegExp("\\b"+a+"\\b","i")).test(y)){var b=c.pid;B[a]=function(){var c=d.format.apply(d,arguments);console.error("%s %d: %s",a,b,c)}}else B[a]=function(){};return B[a]};d.inspect=g;g.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],
magenta:[35,39],red:[31,39],yellow:[33,39]};g.styles={special:"cyan",number:"yellow","boolean":"yellow",undefined:"grey","null":"bold",string:"green",date:"magenta",regexp:"red"};d.isArray=D;d.isBoolean=w;d.isNull=function(a){return null===a};d.isNullOrUndefined=function(a){return null==a};d.isNumber=A;d.isString=I;d.isSymbol=function(a){return"symbol"===("undefined"===typeof a?"undefined":H(a))};d.isUndefined=G;d.isRegExp=p;d.isObject=K;d.isDate=W;d.isError=L;d.isFunction=u;d.isPrimitive=function(a){return null===
a||"boolean"===typeof a||"number"===typeof a||"string"===typeof a||"symbol"===("undefined"===typeof a?"undefined":H(a))||"undefined"===typeof a};d.isBuffer=b(8);var z="Jan Feb Mar Apr May Jun Jul Aug Sep Oct Nov Dec".split(" ");d.log=function(){console.log("%s - %s",E(),d.format.apply(d,arguments))};d.inherits=b(9);d._extend=function(a,d){if(!d||!K(d))return a;for(var b=Object.keys(d),c=b.length;c--;)a[b[c]]=d[b[c]];return a}}).call(d,function(){return this}(),b(4))},function(a,d){a.exports=function(a){return a&&
"object"===("undefined"===typeof a?"undefined":H(a))&&"function"===typeof a.copy&&"function"===typeof a.fill&&"function"===typeof a.readUInt8}},function(a,d){a.exports="function"===typeof Object.create?function(a,d){a.super_=d;a.prototype=Object.create(d.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}})}:function(a,d){a.super_=d;var b=function(){};b.prototype=d.prototype;a.prototype=new b;a.prototype.constructor=a}},function(a,d,b){(function(a){var b={};d.escapeJavaScript=
function(a){if(!a)return"";for(var d="",c=0;c<a.length;++c)var g=a.charCodeAt(c),d=b.isSafe(g)?d+a[c]:d+b.escapeJavaScriptChar(g);return d};d.escapeHtml=function(a){if(!a)return"";for(var d="",c=0;c<a.length;++c)var g=a.charCodeAt(c),d=b.isSafe(g)?d+a[c]:d+b.escapeHtmlChar(g);return d};b.escapeJavaScriptChar=function(d){if(256<=d)return"\\u"+b.padLeft(""+d,4);d=(new a(String.fromCharCode(d),"ascii")).toString("hex");return"\\x"+b.padLeft(d,2)};b.escapeHtmlChar=function(d){var c=b.namedHtml[d];if("undefined"!==
typeof c)return c;if(256<=d)return"&#"+d+";";d=(new a(String.fromCharCode(d),"ascii")).toString("hex");return"&#x"+b.padLeft(d,2)+";"};b.padLeft=function(a,d){for(;a.length<d;)a="0"+a;return a};b.isSafe=function(a){return"undefined"!==typeof b.safeCharCodes[a]};b.namedHtml={38:"&amp;",60:"&lt;",62:"&gt;",34:"&quot;",160:"&nbsp;",162:"&cent;",163:"&pound;",164:"&curren;",169:"&copy;",174:"&reg;"};b.safeCharCodes=function(){for(var a={},d=32;123>d;++d)if(97<=d||65<=d&&90>=d||48<=d&&57>=d||32===d||46===
d||44===d||45===d||58===d||95===d)a[d]=null;return a}()}).call(d,b(3).Buffer)},function(a,d,b){var c=Object.assign||function(a){for(var d=1;d<arguments.length;d++){var b=arguments[d],c;for(c in b)Object.prototype.hasOwnProperty.call(b,c)&&(a[c]=b[c])}return a},g="function"===typeof Symbol&&"symbol"===H(Symbol.iterator)?function(a){return"undefined"===typeof a?"undefined":H(a)}:function(a){return a&&"function"===typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":"undefined"===typeof a?
"undefined":H(a)},k=b(2),l=b(12),m=b(13),n=null,r=null,v={Set:b(15),defaults:{abortEarly:!0,convert:!0,allowUnknown:!1,skipFunctions:!1,stripUnknown:!1,language:{},presence:"optional",strip:!1,noDefaults:!1}};a.exports=v.Any=function(){function a(){if(!(this instanceof a))throw new TypeError("Cannot call a class as a function");r=r||b(16);this.isJoi=!0;this._type="any";this._settings=null;this._valids=new v.Set;this._invalids=new v.Set;this._tests=[];this._refs=[];this._flags={};this._unit=this._description=
null;this._notes=[];this._tags=[];this._examples=[];this._meta=[];this._inner={}}a.prototype.createError=function(a,d,b,c){return m.create(a,d,b,c,this._flags)};a.prototype.createOverrideError=function(a,d,b,c,g,e){return m.create(a,d,b,c,this._flags,g,e)};a.prototype.checkOptions=function(a){a=b(28).options.validate(a);if(a.error)throw Error(a.error.details[0].message);};a.prototype.clone=function(){var a=Object.create(Object.getPrototypeOf(this));a.isJoi=!0;a._type=this._type;a._settings=v.concatSettings(this._settings);
a._baseType=this._baseType;a._valids=k.clone(this._valids);a._invalids=k.clone(this._invalids);a._tests=this._tests.slice();a._refs=this._refs.slice();a._flags=k.clone(this._flags);a._description=this._description;a._unit=this._unit;a._notes=this._notes.slice();a._tags=this._tags.slice();a._examples=this._examples.slice();a._meta=this._meta.slice();a._inner={};for(var d=Object.keys(this._inner),b=0;b<d.length;++b){var c=d[b];a._inner[c]=this._inner[c]?this._inner[c].slice():null}return a};a.prototype.concat=
function(a){k.assert(a instanceof v.Any,"Invalid schema object");k.assert("any"===this._type||"any"===a._type||a._type===this._type,"Cannot merge type",this._type,"with another type:",a._type);var d=this.clone();if("any"===this._type&&"any"!==a._type){for(var b=a.clone(),c="_settings _valids _invalids _tests _refs _flags _description _unit _notes _tags _examples _meta _inner".split(" "),g=0;g<c.length;++g)b[c[g]]=d[c[g]];d=b}d._settings=d._settings?v.concatSettings(d._settings,a._settings):a._settings;
d._valids.merge(a._valids,a._invalids);d._invalids.merge(a._invalids,a._valids);d._tests=d._tests.concat(a._tests);d._refs=d._refs.concat(a._refs);k.merge(d._flags,a._flags);d._description=a._description||d._description;d._unit=a._unit||d._unit;d._notes=d._notes.concat(a._notes);d._tags=d._tags.concat(a._tags);d._examples=d._examples.concat(a._examples);d._meta=d._meta.concat(a._meta);b=Object.keys(a._inner);c="object"===d._type;for(g=0;g<b.length;++g){var e=b[g],f=a._inner[e];if(f){var l=d._inner[e];
if(l)if(c&&"children"===e){for(var e={},n=0;n<l.length;++n)e[l[n].key]=n;for(n=0;n<f.length;++n){var m=f[n].key;0<=e[m]?l[e[m]]={key:m,schema:l[e[m]].schema.concat(f[n].schema)}:l.push(f[n])}}else d._inner[e]=d._inner[e].concat(f);else d._inner[e]=f.slice()}}return d};a.prototype._test=function(a,d,b,c){var g=this.clone();g._tests.push({func:b,name:a,arg:d,options:c});return g};a.prototype.options=function(a){k.assert(!a.context,"Cannot override context");this.checkOptions(a);var d=this.clone();d._settings=
v.concatSettings(d._settings,a);return d};a.prototype.strict=function(a){var d=this.clone();d._settings=d._settings||{};d._settings.convert=void 0===a?!1:!a;return d};a.prototype.raw=function(a){a=void 0===a?!0:a;if(this._flags.raw===a)return this;var d=this.clone();d._flags.raw=a;return d};a.prototype.error=function(a){k.assert(a&&(a instanceof Error||"function"===typeof a),"Must provide a valid Error object or a function");var d=this.clone();d._flags.error=a;return d};a.prototype.allow=function(){for(var a=
this.clone(),d=k.flatten(Array.prototype.slice.call(arguments)),b=0;b<d.length;++b){var c=d[b];k.assert(void 0!==c,"Cannot call allow/valid/invalid with undefined");a._invalids.remove(c);a._valids.add(c,a._refs)}return a};a.prototype.valid=function(){var a=this.allow.apply(this,arguments);a._flags.allowOnly=!0;return a};a.prototype.invalid=function(a){for(var d=this.clone(),b=k.flatten(Array.prototype.slice.call(arguments)),c=0;c<b.length;++c)a=b[c],k.assert(void 0!==a,"Cannot call allow/valid/invalid with undefined"),
d._valids.remove(a),d._invalids.add(a,this._refs);return d};a.prototype.required=function(){if("required"===this._flags.presence)return this;var a=this.clone();a._flags.presence="required";return a};a.prototype.optional=function(){if("optional"===this._flags.presence)return this;var a=this.clone();a._flags.presence="optional";return a};a.prototype.forbidden=function(){if("forbidden"===this._flags.presence)return this;var a=this.clone();a._flags.presence="forbidden";return a};a.prototype.strip=function(){if(this._flags.strip)return this;
var a=this.clone();a._flags.strip=!0;return a};a.prototype.applyFunctionToChildren=function(a,d,b,c){a=[].concat(a);if(1!==a.length||""!==a[0])throw c=c?c+".":"",a=(""===a[0]?a.slice(1):a).map(function(a){return c+a}),Error("unknown key(s) "+a.join(", "));return this[d].apply(this,b)};a.prototype.default=function(a,d){"function"!==typeof a||l.isRef(a)||(!a.description&&d&&(a.description=d),this._flags.func||k.assert("string"===typeof a.description&&0<a.description.length,"description must be provided when default value is a function"));
d=this.clone();d._flags.default=a;l.push(d._refs,a);return d};a.prototype.empty=function(a){var d=this.clone();d._flags.empty=void 0===a?void 0:r.schema(a);return d};a.prototype.when=function(a,d){k.assert(d&&"object"===("undefined"===typeof d?"undefined":g(d)),"Invalid options");k.assert(void 0!==d.then||void 0!==d.otherwise,'options must have at least one of "then" or "otherwise"');var c=d.hasOwnProperty("then")?this.concat(r.schema(d.then)):void 0,e=d.hasOwnProperty("otherwise")?this.concat(r.schema(d.otherwise)):
void 0;n=n||b(25);a=n.when(a,{is:d.is,then:c,otherwise:e});a._flags.presence="ignore";a._baseType=this;return a};a.prototype.description=function(a){k.assert(a&&"string"===typeof a,"Description must be a non-empty string");var d=this.clone();d._description=a;return d};a.prototype.notes=function(a){k.assert(a&&("string"===typeof a||Array.isArray(a)),"Notes must be a non-empty string or array");var d=this.clone();d._notes=d._notes.concat(a);return d};a.prototype.tags=function(a){k.assert(a&&("string"===
typeof a||Array.isArray(a)),"Tags must be a non-empty string or array");var d=this.clone();d._tags=d._tags.concat(a);return d};a.prototype.meta=function(a){k.assert(void 0!==a,"Meta cannot be undefined");var d=this.clone();d._meta=d._meta.concat(a);return d};a.prototype.example=function(a){k.assert(arguments.length,"Missing example");var d=this._validate(a,null,v.defaults);k.assert(!d.errors,"Bad example:",d.errors&&m.process(d.errors,a));d=this.clone();d._examples.push(a);return d};a.prototype.unit=
function(a){k.assert(a&&"string"===typeof a,"Unit name must be a non-empty string");var d=this.clone();d._unit=a;return d};a.prototype._prepareEmptyValue=function(a){return"string"===typeof a&&this._flags.trim?a.trim():a};a.prototype._validate=function(a,d,b,c){var g=this,e=a;d=d||{key:"",path:"",parent:null,reference:c};this._settings&&(b=v.concatSettings(b,this._settings));var f=[];c=function(){var c=void 0;if(void 0!==a)c=g._flags.raw?e:a;else if(b.noDefaults)c=a;else if(l.isRef(g._flags.default))c=
g._flags.default(d.parent,b);else if("function"!==typeof g._flags.default||g._flags.func&&!g._flags.default.description)c=k.clone(g._flags.default);else{c=void 0;null!==d.parent&&0<g._flags.default.length&&(c=[k.clone(d.parent),b]);var n=v._try(g._flags.default,c),c=n.value;n.error&&f.push(g.createError("any.default",n.error,d,b))}f.length&&"function"===typeof g._flags.error&&(n=g._flags.error.call(g,f),f="string"===typeof n?[g.createOverrideError("override",{reason:f},d,b,n)]:[].concat(n).map(function(a){return a instanceof
Error?a:g.createOverrideError(a.type||"override",a.context,d,b,a.message,a.template)}));return{value:g._flags.strip?void 0:c,finalValue:c,errors:f.length?f:null}};if(this._coerce){var n=this._coerce.call(this,a,d,b);if(n.errors)return a=n.value,f=f.concat(n.errors),c();a=n.value}this._flags.empty&&!this._flags.empty._validate(this._prepareEmptyValue(a),null,v.defaults).errors&&(a=void 0);n=this._flags.presence||b.presence;if("optional"===n){if(void 0===a)if(this._flags.hasOwnProperty("default")&&
void 0===this._flags.default&&"object"===this._type)a={};else return c()}else{if("required"===n&&void 0===a)return f.push(this.createError("any.required",null,d,b)),c();if("forbidden"===n){if(void 0===a)return c();f.push(this.createError("any.unknown",null,d,b));return c()}}if(this._valids.has(a,d,b,this._flags.insensitive)||this._invalids.has(a,d,b,this._flags.insensitive)&&(f.push(this.createError(""===a?"any.empty":"any.invalid",null,d,b)),b.abortEarly||void 0===a))return c();if(this._base){n=
this._base.call(this,a,d,b);if(n.errors)return a=n.value,f=f.concat(n.errors),c();if(n.value!==a&&(a=n.value,this._valids.has(a,d,b,this._flags.insensitive)||this._invalids.has(a,d,b,this._flags.insensitive)&&(f.push(this.createError(""===a?"any.empty":"any.invalid",null,d,b)),b.abortEarly)))return c()}if(this._flags.allowOnly&&(f.push(this.createError("any.allowOnly",{valids:this._valids.values({stripUndefined:!0})},d,b)),b.abortEarly))return c();for(n=0;n<this._tests.length;++n){var r=this._tests[n].func.call(this,
a,d,b);if(r instanceof m.Err){if(f.push(r),b.abortEarly)break}else a=r}return c()};a.prototype._validateWithOptions=function(a,d,b){d&&this.checkOptions(d);d=v.concatSettings(v.defaults,d);d=this._validate(a,null,d);a=m.process(d.errors,a);return b?b(a,d.value):{error:a,value:d.value}};a.prototype.validate=function(a,d,b){return"function"===typeof d?this._validateWithOptions(a,null,d):this._validateWithOptions(a,d,b)};a.prototype.describe=function(){var a=this,d={type:this._type},b=Object.keys(this._flags);
if(b.length)if(["empty","default","lazy","label"].some(function(d){return a._flags.hasOwnProperty(d)})){d.flags={};for(var c=0;c<b.length;++c){var g=b[c];"empty"===g?d.flags[g]=this._flags[g].describe():"default"===g?l.isRef(this._flags[g])?d.flags[g]=this._flags[g].toString():d.flags[g]="function"===typeof this._flags[g]?this._flags[g].description:this._flags[g]:"lazy"!==g&&"label"!==g&&(d.flags[g]=this._flags[g])}}else d.flags=this._flags;this._settings&&(d.options=k.clone(this._settings));this._baseType&&
(d.base=this._baseType.describe());this._description&&(d.description=this._description);this._notes.length&&(d.notes=this._notes);this._tags.length&&(d.tags=this._tags);this._meta.length&&(d.meta=this._meta);this._examples.length&&(d.examples=this._examples);this._unit&&(d.unit=this._unit);b=this._valids.values();b.length&&(d.valids=b.map(function(a){return l.isRef(a)?a.toString():a}));b=this._invalids.values();b.length&&(d.invalids=b.map(function(a){return l.isRef(a)?a.toString():a}));d.rules=[];
for(b=0;b<this._tests.length;++b){c=this._tests[b];g={name:c.name};void 0!==c.arg&&(g.arg=l.isRef(c.arg)?c.arg.toString():c.arg);var e=c.options;if(e){if(e.hasRef){g.arg={};for(var f=Object.keys(c.arg),n=0;n<f.length;++n){var m=f[n],r=c.arg[m];g.arg[m]=l.isRef(r)?r.toString():r}}"string"===typeof e.description?g.description=e.description:"function"===typeof e.description&&(g.description=e.description(g.arg))}d.rules.push(g)}d.rules.length||delete d.rules;if(b=this._getLabel())d.label=b;return d};
a.prototype.label=function(a){k.assert(a&&"string"===typeof a,"Label name must be a non-empty string");var d=this.clone();d._flags.label=a;return d};a.prototype._getLabel=function(a){return this._flags.label||a};return a}();v.Any.prototype.isImmutable=!0;v.Any.prototype.only=v.Any.prototype.equal=v.Any.prototype.valid;v.Any.prototype.disallow=v.Any.prototype.not=v.Any.prototype.invalid;v.Any.prototype.exist=v.Any.prototype.required;v._try=function(a,d){var b=void 0,c=void 0;try{c=a.apply(null,d)}catch(D){b=
D}return{value:c,error:b}};v.concatSettings=function(a,d){if(!a&&!d)return null;var b={};a&&c(b,a);if(d){a=Object.keys(d);for(var g=0;g<a.length;++g){var e=a[g];"language"===e&&b.hasOwnProperty(e)?b[e]=k.applyToDefaults(b[e],d[e]):b[e]=d[e]}}return b}},function(a,d,b){var c=b(2);d.create=function(a,d){c.assert("string"===typeof a,"Invalid reference key:",a);var b=c.clone(d),g=function r(a,d){return c.reach(r.isContext?d.context:a,r.key,b)};g.isContext=a[0]===(b&&b.contextPrefix||"$");g.key=g.isContext?
a.slice(1):a;g.path=g.key.split(b&&b.separator||".");g.depth=g.path.length;g.root=g.path[0];g.isJoi=!0;g.toString=function(){return(g.isContext?"context:":"ref:")+g.key};return g};d.isRef=function(a){return"function"===typeof a&&a.isJoi};d.push=function(a,b){d.isRef(b)&&!b.isContext&&a.push(b.root)}},function(a,d,b){var c="function"===typeof Symbol&&"symbol"===H(Symbol.iterator)?function(a){return"undefined"===typeof a?"undefined":H(a)}:function(a){return a&&"function"===typeof Symbol&&a.constructor===
Symbol&&a!==Symbol.prototype?"symbol":"undefined"===typeof a?"undefined":H(a)},g=b(2),k=b(14),l={annotations:Symbol("joi-annotations"),stringify:function(a,b){var g="undefined"===typeof a?"undefined":c(a);if(null===a)return"null";if("string"===g)return a;if(a instanceof d.Err||"function"===g)return a.toString();if("object"===g){if(Array.isArray(a)){for(var g="",e=0;e<a.length;++e)g=g+(g.length?", ":"")+l.stringify(a[e],b);return b?"["+g+"]":g}return a.toString()}return JSON.stringify(a)}};d.Err=function(){function a(d,
b,c,g,e,f,k){if(!(this instanceof a))throw new TypeError("Cannot call a class as a function");this.isJoi=!0;this.type=d;this.context=b||{};this.context.key=c.key;this.path=c.path;this.options=g;this.flags=e;this.message=f;this.template=k}a.prototype.toString=function(){var a=this;if(this.message)return this.message;var d=void 0;this.template&&(d=this.template);var b=this.options.language;if(this.flags.label)this.context.key=this.flags.label;else if(""===this.context.key||null===this.context.key)this.context.key=
b.root||k.errors.root;var d=d||g.reach(b,this.type)||g.reach(k.errors,this.type),c=g.reach(b,"messages.wrapArrays");"boolean"!==typeof c&&(c=k.errors.messages.wrapArrays);if(null===d)return d=l.stringify(this.context.reason,c),c?d.slice(1,-1):d;var e=/\{\{\!?key\}\}/.test(d),f=2<d.length&&"!"===d[0]&&"!"===d[1];f&&(d=d.slice(2));e||f||(d=(g.reach(b,"key")||g.reach(k.errors,"key"))+d);return d.replace(/\{\{(\!?)([^}]+)\}\}/g,function(d,b,e){d=g.reach(a.context,e);d=l.stringify(d,c);return b?g.escapeHtml(d):
d})};return a}();d.create=function(a,b,c,g,e,f,k){return new d.Err(a,b,c,g,e,f,k)};d.process=function(a,d){if(!a||!a.length)return null;var b="",c=[];if(a=function t(a,d){for(var g=0;g<a.length;++g){var e=a[g];if(e instanceof Error)return e;if(e.flags.error&&"function"!==typeof e.flags.error)return e.flags.error;var f=void 0;void 0===d&&(f=e.toString(),b=b+(b?". ":"")+f);if(e.context.reason&&e.context.reason.length){if(e=t(e.context.reason,e.path))return e}else c.push({message:f||e.toString(),path:l.getPath(e),
type:e.type,context:e.context})}}(a))return a;a=Error(b);a.isJoi=!0;a.name="ValidationError";a.details=c;a._object=d;a.annotate=l.annotate;return a};l.getPath=function(a){return a.path||a.context.key};l.safeStringify=function(a,d){return JSON.stringify(a,l.serializer(),d)};l.serializer=function(){var a=[],d=[];return function(b,g){if(0<d.length){var e=d.indexOf(this);~e?(d.length=e+1,a.length=e+1,a[e]=b):(d.push(this),a.push(b));~d.indexOf(g)&&(g=d[0]===g?"[Circular ~]":"[Circular ~."+a.slice(0,d.indexOf(g)).join(".")+
"]")}else d.push(g);if(g&&(b=g[l.annotations])){if(Array.isArray(g)){for(var e=[],f=0;f<g.length;++f)b.errors[f]&&e.push("_$idx$_"+b.errors[f].sort().join(", ")+"_$end$_"),e.push(g[f]);g=e}else{e=Object.keys(b.errors);for(f=0;f<e.length;++f){var k=e[f];g[k+"_$key$_"+b.errors[k].sort().join(", ")+"_$end$_"]=g[k];g[k]=void 0}e=Object.keys(b.missing);for(f=0;f<e.length;++f)k=e[f],g["_$miss$_"+k+"|"+b.missing[k]+"_$end$_"]="__missing__"}return g}return Infinity===g||-Infinity===g||Number.isNaN(g)||"function"===
typeof g||"symbol"===("undefined"===typeof g?"undefined":c(g))?"["+g.toString()+"]":g}};l.annotate=function(a){var d=a?"":"\u001b[31m",b=a?"":"\u001b[41m",e=a?"":"\u001b[0m";if("object"!==c(this._object))return this.details[0].message;a=g.clone(this._object||{});for(var f=this.details.length-1;0<=f;--f)for(var k=f+1,m=this.details[f].path.split("."),x=a,D=0;;++D){var w=m[D];x.isImmutable&&(x=x.clone());if(D+1<m.length&&x[w]&&"string"!==typeof x[w])x=x[w];else{m=x[l.annotations]=x[l.annotations]||
{errors:{},missing:{}};void 0!==x[w]?(m.errors[w]=m.errors[w]||[],m.errors[w].push(k)):m.missing[w]=k;break}}a=l.safeStringify(a,2).replace(/_\$key\$_([, \d]+)_\$end\$_\"/g,function(a,b){return'" '+d+"["+b+"]"+e}).replace(/\"_\$miss\$_([^\|]+)\|(\d+)_\$end\$_\"\: \"__missing__\"/g,function(a,c,g){return b+'"'+c+'"'+e+d+" ["+g+"]: -- missing --"+e}).replace(/\s*\"_\$idx\$_([, \d]+)_\$end\$_\",?\n(.*)/g,function(a,b,c){return"\n"+c+" "+d+"["+b+"]"+e}).replace(/"\[(NaN|Symbol.*|-?Infinity|function.*|\(.*)\]"/g,
function(a,d){return d});a=a+"\n"+d;for(f=0;f<this.details.length;++f)a=a+"\n["+(f+1)+"] "+this.details[f].message;return a+e}},function(a,d){d.errors={root:"value",key:'"{{!key}}" ',messages:{wrapArrays:!0},any:{unknown:"is not allowed",invalid:"contains an invalid value",empty:"is not allowed to be empty",required:"is required",allowOnly:"must be one of {{valids}}",default:"threw an error when running default method"},alternatives:{base:"not matching any of the allowed alternatives",child:null},
array:{base:"must be an array",includes:"at position {{pos}} does not match any of the allowed types",includesSingle:'single value of "{{!key}}" does not match any of the allowed types',includesOne:"at position {{pos}} fails because {{reason}}",includesOneSingle:'single value of "{{!key}}" fails because {{reason}}',includesRequiredUnknowns:"does not contain {{unknownMisses}} required value(s)",includesRequiredKnowns:"does not contain {{knownMisses}}",includesRequiredBoth:"does not contain {{knownMisses}} and {{unknownMisses}} other required value(s)",
excludes:"at position {{pos}} contains an excluded value",excludesSingle:'single value of "{{!key}}" contains an excluded value',min:"must contain at least {{limit}} items",max:"must contain less than or equal to {{limit}} items",length:"must contain {{limit}} items",ordered:"at position {{pos}} fails because {{reason}}",orderedLength:"at position {{pos}} fails because array must contain at most {{limit}} items",ref:'references "{{ref}}" which is not a positive integer',sparse:"must not be a sparse array",
unique:"position {{pos}} contains a duplicate value"},boolean:{base:"must be a boolean"},binary:{base:"must be a buffer or a string",min:"must be at least {{limit}} bytes",max:"must be less than or equal to {{limit}} bytes",length:"must be {{limit}} bytes"},date:{base:"must be a number of milliseconds or valid date string",format:"must be a string with one of the following formats {{format}}",strict:"must be a valid date",min:'must be larger than or equal to "{{limit}}"',max:'must be less than or equal to "{{limit}}"',
isoDate:"must be a valid ISO 8601 date",timestamp:{javascript:"must be a valid timestamp or number of milliseconds",unix:"must be a valid timestamp or number of seconds"},ref:'references "{{ref}}" which is not a date'},function:{base:"must be a Function",arity:"must have an arity of {{n}}",minArity:"must have an arity greater or equal to {{n}}",maxArity:"must have an arity lesser or equal to {{n}}",ref:"must be a Joi reference"},lazy:{base:"!!schema error: lazy schema must be set",schema:"!!schema error: lazy schema function must return a schema"},
object:{base:"must be an object",child:'!!child "{{!child}}" fails because {{reason}}',min:"must have at least {{limit}} children",max:"must have less than or equal to {{limit}} children",length:"must have {{limit}} children",allowUnknown:'!!"{{!child}}" is not allowed',with:'!!"{{mainWithLabel}}" missing required peer "{{peerWithLabel}}"',without:'!!"{{mainWithLabel}}" conflict with forbidden peer "{{peerWithLabel}}"',missing:"must contain at least one of {{peersWithLabels}}",xor:"contains a conflict between exclusive peers {{peersWithLabels}}",
or:"must contain at least one of {{peersWithLabels}}",and:"contains {{presentWithLabels}} without its required peers {{missingWithLabels}}",nand:'!!"{{mainWithLabel}}" must not exist simultaneously with {{peersWithLabels}}',assert:'!!"{{ref}}" validation failed because "{{ref}}" failed to {{message}}',rename:{multiple:'cannot rename child "{{from}}" because multiple renames are disabled and another key was already renamed to "{{to}}"',override:'cannot rename child "{{from}}" because override is disabled and target "{{to}}" exists'},
type:'must be an instance of "{{type}}"',schema:"must be a Joi instance"},number:{base:"must be a number",min:"must be larger than or equal to {{limit}}",max:"must be less than or equal to {{limit}}",less:"must be less than {{limit}}",greater:"must be greater than {{limit}}",float:"must be a float or double",integer:"must be an integer",negative:"must be a negative number",positive:"must be a positive number",precision:"must have no more than {{limit}} decimal places",ref:'references "{{ref}}" which is not a number',
multiple:"must be a multiple of {{multiple}}"},string:{base:"must be a string",min:"length must be at least {{limit}} characters long",max:"length must be less than or equal to {{limit}} characters long",length:"length must be {{limit}} characters long",alphanum:"must only contain alpha-numeric characters",token:"must only contain alpha-numeric and underscore characters",regex:{base:'with value "{{!value}}" fails to match the required pattern: {{pattern}}',name:'with value "{{!value}}" fails to match the {{name}} pattern',
invert:{base:'with value "{{!value}}" matches the inverted pattern: {{pattern}}',name:'with value "{{!value}}" matches the inverted {{name}} pattern'}},email:"must be a valid email",uri:"must be a valid uri",uriRelativeOnly:"must be a valid relative uri",uriCustomScheme:"must be a valid uri with a scheme matching the {{scheme}} pattern",isoDate:"must be a valid ISO 8601 date",guid:"must be a valid GUID",hex:"must only contain hexadecimal characters",base64:"must be a valid base64 string",hostname:"must be a valid hostname",
lowercase:"must only contain lowercase characters",uppercase:"must only contain uppercase characters",trim:"must not have leading or trailing whitespace",creditCard:"must be a credit card",ref:'references "{{ref}}" which is not a number',ip:"must be a valid ip address with a {{cidr}} CIDR",ipVersion:"must be a valid ip address of one of the following versions {{version}} with a {{cidr}} CIDR"}}},function(a,d,b){(function(d){var c="function"===typeof Symbol&&"symbol"===H(Symbol.iterator)?function(a){return"undefined"===
typeof a?"undefined":H(a)}:function(a){return a&&"function"===typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":"undefined"===typeof a?"undefined":H(a)},g=b(12);a.exports=function(){function a(){if(!(this instanceof a))throw new TypeError("Cannot call a class as a function");this._set=[]}a.prototype.add=function(a,d){if(g.isRef(a)||!this.has(a,null,null,!1))return void 0!==d&&g.push(d,a),this._set.push(a),this};a.prototype.merge=function(a,d){for(var b=0;b<a._set.length;++b)this.add(a._set[b]);
for(a=0;a<d._set.length;++a)this.remove(d._set[a]);return this};a.prototype.remove=function(a){this._set=this._set.filter(function(d){return a!==d});return this};a.prototype.has=function(a,b,e,f){for(var k=0;k<this._set.length;++k){var n=this._set[k];b&&g.isRef(n)&&(n=n(b.reference||b.parent,e));Array.isArray(n)||(n=[n]);for(var l=0;l<n.length;++l){var m=n[l];if(("undefined"===typeof a?"undefined":c(a))===("undefined"===typeof m?"undefined":c(m))&&(a===m||a instanceof Date&&m instanceof Date&&a.getTime()===
m.getTime()||f&&"string"===typeof a&&a.toLowerCase()===m.toLowerCase()||d.isBuffer(a)&&d.isBuffer(m)&&a.length===m.length&&a.toString("binary")===m.toString("binary")))return!0}}return!1};a.prototype.values=function(a){if(a&&a.stripUndefined){a=[];for(var d=0;d<this._set.length;++d){var b=this._set[d];void 0!==b&&a.push(b)}return a}return this._set.slice()};a.prototype.slice=function(){var d=new a;d._set=this._set.slice();return d};a.prototype.concat=function(d){var b=new a;b._set=this._set.concat(d._set);
return b};return a}()}).call(d,b(3).Buffer)},function(a,d,b){var c="function"===typeof Symbol&&"symbol"===H(Symbol.iterator)?function(a){return"undefined"===typeof a?"undefined":H(a)}:function(a){return a&&"function"===typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":"undefined"===typeof a?"undefined":H(a)},g=b(2),k=b(12),l=null,m=b(17),n=b(18),r=b(23),v=b(24),q=null,t=null;d.schema=function(a){l=l||new (b(11));q=q||b(25);t=t||b(26);if(void 0!==a&&null!==a&&"object"===("undefined"===
typeof a?"undefined":c(a)))return a.isJoi?a:Array.isArray(a)?q.try(a):a instanceof RegExp?n.regex(a):a instanceof Date?m.valid(a):t.keys(a);if("string"===typeof a)return n.valid(a);if("number"===typeof a)return r.valid(a);if("boolean"===typeof a)return v.valid(a);if(k.isRef(a))return l.valid(a);g.assert(null===a,"Invalid schema content:",a);return l.valid(null)};d.ref=function(a){return k.isRef(a)?a:k.create(a)}},function(a,d,b){function c(a,d){if("function"!==typeof d&&null!==d)throw new TypeError("Super expression must either be null or a function, not "+
("undefined"===typeof d?"undefined":H(d)));a.prototype=Object.create(d&&d.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}});if(d)if(Object.setPrototypeOf)Object.setPrototypeOf(a,d);else for(var b=Object.getOwnPropertyNames(d),c=0;c<b.length;c++){var g=b[c],e=Object.getOwnPropertyDescriptor(d,g);e&&e.configurable&&void 0===a[g]&&Object.defineProperty(a,g,e)}}d=b(11);var g=b(12),k=b(2),l={isoDate:/^(?:[-+]\d{2})?(?:\d{4}(?!\d{2}\b))(?:(-?)(?:(?:0[1-9]|1[0-2])(?:\1(?:[12]\d|0[1-9]|3[01]))?|W(?:[0-4]\d|5[0-2])(?:-?[1-7])?|(?:00[1-9]|0[1-9]\d|[12]\d{2}|3(?:[0-5]\d|6[1-6])))(?![T]$|[T][\d]+Z$)(?:[T\s](?:(?:(?:[01]\d|2[0-3])(?:(:?)[0-5]\d)?|24\:?00)(?:[.,]\d+(?!:))?)(?:\2[0-5]\d(?:[.,]\d+)?)?(?:[Z]|(?:[+-])(?:[01]\d|2[0-3])(?::?[0-5]\d)?)?)?)?$/};
l.invalidDate=new Date("");l.isIsoDate=function(){var a=l.isoDate.toString();return function(d){return d&&d.toString()===a}}();l.Date=function(a){function d(){if(!(this instanceof d))throw new TypeError("Cannot call a class as a function");var b;b=a.call(this);if(!this)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");b=!b||"object"!==("undefined"===typeof b?"undefined":H(b))&&"function"!==typeof b?this:b;b._type="date";return b}c(d,a);d.prototype._base=function(a,
d,b){a={value:b.convert&&l.Date.toDate(a,this._flags.format,this._flags.timestamp,this._flags.multiplier)||a};if(a.value instanceof Date&&!isNaN(a.value.getTime()))a.errors=null;else if(b.convert){var c;c=l.isIsoDate(this._flags.format)?"isoDate":this._flags.timestamp?"timestamp."+this._flags.timestamp:"base";a.errors=this.createError("date."+c,null,d,b)}else a.errors=this.createError("date.strict",null,d,b);return a};d.toDate=function(a,d,b,c){if(a instanceof Date)return a;if("string"===typeof a||
"number"===typeof a&&!isNaN(a)&&isFinite(a))if("string"===typeof a&&/^[+-]?\d+(\.\d+)?$/.test(a)&&(a=parseFloat(a)),a=d&&l.isIsoDate(d)?d.test(a)?new Date(a):l.invalidDate:b&&c?new Date(a*c):new Date(a),!isNaN(a.getTime()))return a;return null};d.prototype.iso=function(){if(this._flags.format===l.isoDate)return this;var a=this.clone();a._flags.format=l.isoDate;return a};d.prototype.timestamp=function(a){a=a||"javascript";var d=["javascript","unix"];k.assert(-1!==d.indexOf(a),'"type" must be one of "'+
d.join('", "')+'"');if(this._flags.timestamp===a)return this;d=this.clone();d._flags.timestamp=a;d._flags.multiplier="unix"===a?1E3:1;return d};d.prototype._isIsoDate=function(a){return l.isoDate.test(a)};return d}(d);l.compare=function(a,d){return function(b){var c="now"===b,e=g.isRef(b);c||e||(b=l.Date.toDate(b));k.assert(b,"Invalid date format");return this._test(a,b,function(g,f,k){var n;if(c)n=Date.now();else if(e){n=l.Date.toDate(b(f.reference||f.parent,k));if(!n)return this.createError("date.ref",
{ref:b.key},f,k);n=n.getTime()}else n=b.getTime();return d(g.getTime(),n)?g:this.createError("date."+a,{limit:new Date(n)},f,k)})}};l.Date.prototype.min=l.compare("min",function(a,d){return a>=d});l.Date.prototype.max=l.compare("max",function(a,d){return a<=d});a.exports=new l.Date},function(a,d,b){(function(d){function c(a,d){if("function"!==typeof d&&null!==d)throw new TypeError("Super expression must either be null or a function, not "+("undefined"===typeof d?"undefined":H(d)));a.prototype=Object.create(d&&
d.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}});if(d)if(Object.setPrototypeOf)Object.setPrototypeOf(a,d);else for(var b=Object.getOwnPropertyNames(d),c=0;c<b.length;c++){var g=b[c],e=Object.getOwnPropertyDescriptor(d,g);e&&e.configurable&&void 0===a[g]&&Object.defineProperty(a,g,e)}}var g="function"===typeof Symbol&&"symbol"===H(Symbol.iterator)?function(a){return"undefined"===typeof a?"undefined":H(a)}:function(a){return a&&"function"===typeof Symbol&&a.constructor===
Symbol&&a!==Symbol.prototype?"symbol":"undefined"===typeof a?"undefined":H(a)},e=b(5),m=b(2),n=void 0,r=b(11),v=b(12),q=b(17),t=b(19),F=b(21),x={uriRegex:t.createUriRegex(),ipRegex:F.createIpRegex(["ipv4","ipv6","ipvfuture"],"optional"),guidBrackets:{"{":"}","[":"]","(":")","":""},guidVersions:{uuidv1:"1",uuidv2:"2",uuidv3:"3",uuidv4:"4",uuidv5:"5"}};x.String=function(a){function d(){if(!(this instanceof d))throw new TypeError("Cannot call a class as a function");var b;b=a.call(this);if(!this)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
b=!b||"object"!==("undefined"===typeof b?"undefined":H(b))&&"function"!==typeof b?this:b;b._type="string";b._invalids.add("");return b}c(d,a);d.prototype._base=function(a,d,b){if("string"===typeof a&&b.convert){this._flags.case&&(a="upper"===this._flags.case?a.toLocaleUpperCase():a.toLocaleLowerCase());this._flags.trim&&(a=a.trim());if(this._inner.replacements)for(var c=0;c<this._inner.replacements.length;++c){var g=this._inner.replacements[c];a=a.replace(g.pattern,g.replacement)}if(this._flags.truncate)for(c=
0;c<this._tests.length;++c)if(g=this._tests[c],"max"===g.name){a=a.slice(0,g.arg);break}}return{value:a,errors:"string"===typeof a?null:this.createError("string.base",{value:a},d,b)}};d.prototype.insensitive=function(){if(this._flags.insensitive)return this;var a=this.clone();a._flags.insensitive=!0;return a};d.prototype.creditCard=function(){return this._test("creditCard",void 0,function(a,d,b){for(var c=a.length,g=0,e=1;c--;)var f=a.charAt(c)*e,g=g+(f-9*(9<f)),e=e^3;return 0===g%10&&0<g?a:this.createError("string.creditCard",
{value:a},d,b)})};d.prototype.regex=function(a,d){m.assert(a instanceof RegExp,"pattern must be a RegExp");var b={pattern:new RegExp(a.source,a.ignoreCase?"i":void 0)};"string"===typeof d?b.name=d:"object"===("undefined"===typeof d?"undefined":g(d))&&(b.invert=!!d.invert,d.name&&(b.name=d.name));var c=["string.regex",b.invert?".invert":"",b.name?".name":".base"].join("");return this._test("regex",b,function(a,d,g){return b.pattern.test(a)^b.invert?a:this.createError(c,{name:b.name,pattern:b.pattern,
value:a},d,g)})};d.prototype.alphanum=function(){return this._test("alphanum",void 0,function(a,d,b){return/^[a-zA-Z0-9]+$/.test(a)?a:this.createError("string.alphanum",{value:a},d,b)})};d.prototype.token=function(){return this._test("token",void 0,function(a,d,b){return/^\w+$/.test(a)?a:this.createError("string.token",{value:a},d,b)})};d.prototype.email=function(a){a&&(m.assert("object"===("undefined"===typeof a?"undefined":g(a)),"email options must be an object"),m.assert("undefined"===typeof a.checkDNS,
"checkDNS option is not supported"),m.assert("undefined"===typeof a.tldWhitelist||"object"===g(a.tldWhitelist),"tldWhitelist must be an array or object"),m.assert("undefined"===typeof a.minDomainAtoms||Number.isSafeInteger(a.minDomainAtoms)&&0<a.minDomainAtoms,"minDomainAtoms must be a positive integer"),m.assert("undefined"===typeof a.errorLevel||"boolean"===typeof a.errorLevel||Number.isSafeInteger(a.errorLevel)&&0<=a.errorLevel,"errorLevel must be a non-negative integer or boolean"));return this._test("email",
a,function(d,c,g){n=n||b(22);try{var e=n.validate(d,a);if(!0===e||0===e)return d}catch(W){}return this.createError("string.email",{value:d},c,g)})};d.prototype.ip=function(a){var d=x.ipRegex;a=a||{};m.assert("object"===("undefined"===typeof a?"undefined":g(a)),"options must be an object");a.cidr?(m.assert("string"===typeof a.cidr,"cidr must be a string"),a.cidr=a.cidr.toLowerCase(),m.assert(a.cidr in F.cidrs,"cidr must be one of "+Object.keys(F.cidrs).join(", ")),a.version||"optional"===a.cidr||(d=
F.createIpRegex(["ipv4","ipv6","ipvfuture"],a.cidr))):a.cidr="optional";var b=void 0;if(a.version){Array.isArray(a.version)||(a.version=[a.version]);m.assert(1<=a.version.length,"version must have at least 1 version specified");for(var b=[],c=0;c<a.version.length;++c){var e=a.version[c];m.assert("string"===typeof e,"version at position "+c+" must be a string");e=e.toLowerCase();m.assert(F.versions[e],"version at position "+c+" must be one of "+Object.keys(F.versions).join(", "));b.push(e)}b=m.unique(b);
d=F.createIpRegex(b,a.cidr)}return this._test("ip",a,function(c,g,e){return d.test(c)?c:b?this.createError("string.ipVersion",{value:c,cidr:a.cidr,version:b},g,e):this.createError("string.ip",{value:c,cidr:a.cidr},g,e)})};d.prototype.uri=function(a){var d="",b=!1,c=!1,e=x.uriRegex;if(a){m.assert("object"===("undefined"===typeof a?"undefined":g(a)),"options must be an object");if(a.scheme){m.assert(a.scheme instanceof RegExp||"string"===typeof a.scheme||Array.isArray(a.scheme),"scheme must be a RegExp, String, or Array");
Array.isArray(a.scheme)||(a.scheme=[a.scheme]);m.assert(1<=a.scheme.length,"scheme must have at least 1 scheme specified");for(var f=0;f<a.scheme.length;++f){var k=a.scheme[f];m.assert(k instanceof RegExp||"string"===typeof k,"scheme at position "+f+" must be a RegExp or String");d+=d?"|":"";k instanceof RegExp?d+=k.source:(m.assert(/[a-zA-Z][a-zA-Z0-9+-\.]*/.test(k),"scheme at position "+f+" must be a valid scheme"),d+=m.escapeRegex(k))}}a.allowRelative&&(b=!0);a.relativeOnly&&(c=!0)}if(d||b||c)e=
t.createUriRegex(d,b,c);return this._test("uri",a,function(a,b,g){return e.test(a)?a:c?this.createError("string.uriRelativeOnly",{value:a},b,g):d?this.createError("string.uriCustomScheme",{scheme:d,value:a},b,g):this.createError("string.uri",{value:a},b,g)})};d.prototype.isoDate=function(){return this._test("isoDate",void 0,function(a,d,b){return q._isIsoDate(a)?a:this.createError("string.isoDate",{value:a},d,b)})};d.prototype.guid=function(a){var d="";if(a&&a.version){Array.isArray(a.version)||(a.version=
[a.version]);m.assert(1<=a.version.length,"version must have at least 1 valid version specified");for(var b=new Set,c=0;c<a.version.length;++c){var g=a.version[c];m.assert("string"===typeof g,"version at position "+c+" must be a string");g=g.toLowerCase();g=x.guidVersions[g];m.assert(g,"version at position "+c+" must be one of "+Object.keys(x.guidVersions).join(", "));m.assert(!b.has(g),"version at position "+c+" must not be a duplicate.");d+=g;b.add(g)}}var e=new RegExp("^([\\[{\\(]?)[0-9A-F]{8}([:-]?)[0-9A-F]{4}\\2?["+
(d||"0-9A-F")+"][0-9A-F]{3}\\2?["+(d?"89AB":"0-9A-F")+"][0-9A-F]{3}\\2?[0-9A-F]{12}([\\]}\\)]?)$","i");return this._test("guid",a,function(a,d,b){var c=e.exec(a);return c&&x.guidBrackets[c[1]]===c[c.length-1]?a:this.createError("string.guid",{value:a},d,b)})};d.prototype.hex=function(){var a=/^[a-f0-9]+$/i;return this._test("hex",a,function(d,b,c){return a.test(d)?d:this.createError("string.hex",{value:d},b,c)})};d.prototype.base64=function(a){a=a||{};m.assert("object"===("undefined"===typeof a?"undefined":
g(a)),"base64 options must be an object");m.assert("undefined"===typeof a.paddingRequired||"boolean"===typeof a.paddingRequired,"paddingRequired must be boolean");var d=(!1===a.paddingRequired?a.paddingRequired:1)?/^(?:[A-Za-z0-9+\/]{4})*(?:[A-Za-z0-9+\/]{2}==|[A-Za-z0-9+\/]{3}=)?$/:/^(?:[A-Za-z0-9+\/]{4})*(?:[A-Za-z0-9+\/]{2}(==)?|[A-Za-z0-9+\/]{3}=?)?$/;return this._test("base64",d,function(a,b,c){return d.test(a)?a:this.createError("string.base64",{value:a},b,c)})};d.prototype.hostname=function(){var a=
/^(([a-zA-Z0-9]|[a-zA-Z0-9][a-zA-Z0-9\-]*[a-zA-Z0-9])\.)*([A-Za-z0-9]|[A-Za-z0-9][A-Za-z0-9\-]*[A-Za-z0-9])$/;return this._test("hostname",void 0,function(d,b,c){return 255>=d.length&&a.test(d)||e.isIPv6(d)?d:this.createError("string.hostname",{value:d},b,c)})};d.prototype.lowercase=function(){var a=this._test("lowercase",void 0,function(a,d,b){return b.convert||a===a.toLocaleLowerCase()?a:this.createError("string.lowercase",{value:a},d,b)});a._flags.case="lower";return a};d.prototype.uppercase=function(){var a=
this._test("uppercase",void 0,function(a,d,b){return b.convert||a===a.toLocaleUpperCase()?a:this.createError("string.uppercase",{value:a},d,b)});a._flags.case="upper";return a};d.prototype.trim=function(){var a=this._test("trim",void 0,function(a,d,b){return b.convert||a===a.trim()?a:this.createError("string.trim",{value:a},d,b)});a._flags.trim=!0;return a};d.prototype.replace=function(a,d){"string"===typeof a&&(a=new RegExp(m.escapeRegex(a),"g"));m.assert(a instanceof RegExp,"pattern must be a RegExp");
m.assert("string"===typeof d,"replacement must be a String");var b=this.clone();b._inner.replacements||(b._inner.replacements=[]);b._inner.replacements.push({pattern:a,replacement:d});return b};d.prototype.truncate=function(a){a=void 0===a?!0:!!a;if(this._flags.truncate===a)return this;var d=this.clone();d._flags.truncate=a;return d};return d}(r);x.compare=function(a,b){return function(c,g){var e=v.isRef(c);m.assert(Number.isSafeInteger(c)&&0<=c||e,"limit must be a positive integer or reference");
m.assert(!g||d.isEncoding(g),"Invalid encoding:",g);return this._test(a,c,function(d,f,k){var l;if(e){if(l=c(f.reference||f.parent,k),!Number.isSafeInteger(l))return this.createError("string.ref",{ref:c.key},f,k)}else l=c;return b(d,l,g)?d:this.createError("string."+a,{limit:l,value:d,encoding:g},f,k)})}};x.String.prototype.min=x.compare("min",function(a,b,c){return(c?d.byteLength(a,c):a.length)>=b});x.String.prototype.max=x.compare("max",function(a,b,c){return(c?d.byteLength(a,c):a.length)<=b});
x.String.prototype.length=x.compare("length",function(a,b,c){return(c?d.byteLength(a,c):a.length)===b});x.String.prototype.uuid=x.String.prototype.guid;a.exports=new x.String}).call(d,b(3).Buffer)},function(a,d,b){var c=b(20);a.exports={createUriRegex:function(a,d,b){var g=c.scheme;b?d="(?:"+c.relativeRef+")":(a&&(g="(?:"+a+")"),a="(?:"+g+":"+c.hierPart+")",d=d?"(?:"+a+"|"+c.relativeRef+")":a);return new RegExp("^"+d+"(?:\\?"+c.query+")?(?:#"+c.fragment+")?$")}}},function(a,d){var b={rfc3986:{},generate:function(){b.rfc3986.cidr=
"[0-9]|[1-2][0-9]|3[0-2]";var a="[a-zA-Z0-9-\\._~%0-9A-Fa-f!\\$&'\\(\\)\\*\\+,;=:@]";b.rfc3986.IPv4address="(?:(?:0?0?[0-9]|0?[1-9][0-9]|1[0-9][0-9]|2[0-4][0-9]|25[0-5])\\.){3}(?:0?0?[0-9]|0?[1-9][0-9]|1[0-9][0-9]|2[0-4][0-9]|25[0-5])";var d="(?:[0-9A-Fa-f]{1,4}:[0-9A-Fa-f]{1,4}|"+b.rfc3986.IPv4address+")";b.rfc3986.IPv6address="(?:(?:[0-9A-Fa-f]{1,4}:){6}"+d+"|"+("::(?:[0-9A-Fa-f]{1,4}:){5}"+d)+"|"+("(?:[0-9A-Fa-f]{1,4})?::(?:[0-9A-Fa-f]{1,4}:){4}"+d)+"|"+("(?:(?:[0-9A-Fa-f]{1,4}:){0,1}[0-9A-Fa-f]{1,4})?::(?:[0-9A-Fa-f]{1,4}:){3}"+
d)+"|"+("(?:(?:[0-9A-Fa-f]{1,4}:){0,2}[0-9A-Fa-f]{1,4})?::(?:[0-9A-Fa-f]{1,4}:){2}"+d)+"|"+("(?:(?:[0-9A-Fa-f]{1,4}:){0,3}[0-9A-Fa-f]{1,4})?::[0-9A-Fa-f]{1,4}:"+d)+"|"+("(?:(?:[0-9A-Fa-f]{1,4}:){0,4}[0-9A-Fa-f]{1,4})?::"+d)+"|(?:(?:[0-9A-Fa-f]{1,4}:){0,5}[0-9A-Fa-f]{1,4})?::[0-9A-Fa-f]{1,4}|(?:(?:[0-9A-Fa-f]{1,4}:){0,6}[0-9A-Fa-f]{1,4})?::)";b.rfc3986.IPvFuture="v[0-9A-Fa-f]+\\.[a-zA-Z0-9-\\._~!\\$&'\\(\\)\\*\\+,;=:]+";b.rfc3986.scheme="[a-zA-Z][a-zA-Z0-9+-\\.]*";var d="(?:[a-zA-Z0-9-\\._~%0-9A-Fa-f!\\$&'\\(\\)\\*\\+,;=:]*@)?"+
("(?:"+("\\[(?:"+b.rfc3986.IPv6address+"|"+b.rfc3986.IPvFuture+")\\]")+"|"+b.rfc3986.IPv4address+"|[a-zA-Z0-9-\\._~%0-9A-Fa-f!\\$&'\\(\\)\\*\\+,;=]{0,255})")+"(?::[0-9]*)?",c=a+"+",a="(?:\\/"+(a+"*")+")*",g="\\/(?:"+c+a+")?";b.rfc3986.hierPart="(?:(?:\\/\\/"+d+a+")|"+g+"|"+(c+a)+")";b.rfc3986.relativeRef="(?:(?:\\/\\/"+d+a+")|"+g+"|"+("[a-zA-Z0-9-\\._~%0-9A-Fa-f!\\$&'\\(\\)\\*\\+,;=@]+"+a)+"|)";b.rfc3986.query="[a-zA-Z0-9-\\._~%0-9A-Fa-f!\\$&'\\(\\)\\*\\+,;=:@\\/\\?]*(?=#|$)";b.rfc3986.fragment="[a-zA-Z0-9-\\._~%0-9A-Fa-f!\\$&'\\(\\)\\*\\+,;=:@\\/\\?]*"}};
b.generate();a.exports=b.rfc3986},function(a,d,b){d=b(20);var c={cidrs:{required:"\\/(?:"+d.cidr+")",optional:"(?:\\/(?:"+d.cidr+"))?",forbidden:""},versions:{ipv4:d.IPv4address,ipv6:d.IPv6address,ipvfuture:d.IPvFuture},createIpRegex:function(a,d){for(var b=void 0,g=0;g<a.length;++g){var e=a[g];b||(b="^(?:"+c.versions[e]);b=b+"|"+c.versions[e]}return new RegExp(b+")"+c.cidrs[d]+"$")}};a.exports=c},function(a,d,b){(function(a){var c="function"===typeof Symbol&&"symbol"===H(Symbol.iterator)?function(a){return"undefined"===
typeof a?"undefined":H(a)}:function(a){return a&&"function"===typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":"undefined"===typeof a?"undefined":H(a)},g=b(5),e={hasOwn:Object.prototype.hasOwnProperty,indexOf:Array.prototype.indexOf,defaultThreshold:16,maxIPv6Groups:8,categories:{valid:1,dnsWarn:7,rfc5321:15,cfws:31,deprecated:63,rfc5322:127,error:255},diagnoses:{valid:0,dnsWarnNoMXRecord:5,dnsWarnNoRecord:6,rfc5321TLD:9,rfc5321TLDNumeric:10,rfc5321QuotedString:11,rfc5321AddressLiteral:12,
cfwsComment:17,cfwsFWS:18,deprecatedLocalPart:33,deprecatedFWS:34,deprecatedQTEXT:35,deprecatedQP:36,deprecatedComment:37,deprecatedCTEXT:38,deprecatedIPv6:39,deprecatedCFWSNearAt:49,rfc5322Domain:65,rfc5322TooLong:66,rfc5322LocalTooLong:67,rfc5322DomainTooLong:68,rfc5322LabelTooLong:69,rfc5322DomainLiteral:70,rfc5322DomainLiteralOBSDText:71,rfc5322IPv6GroupCount:72,rfc5322IPv62x2xColon:73,rfc5322IPv6BadCharacter:74,rfc5322IPv6MaxGroups:75,rfc5322IPv6ColonStart:76,rfc5322IPv6ColonEnd:77,errExpectingDTEXT:129,
errNoLocalPart:130,errNoDomain:131,errConsecutiveDots:132,errATEXTAfterCFWS:133,errATEXTAfterQS:134,errATEXTAfterDomainLiteral:135,errExpectingQPair:136,errExpectingATEXT:137,errExpectingQTEXT:138,errExpectingCTEXT:139,errBackslashEnd:140,errDotStart:141,errDotEnd:142,errDomainHyphenStart:143,errDomainHyphenEnd:144,errUnclosedQuotedString:145,errUnclosedComment:146,errUnclosedDomainLiteral:147,errFWSCRLFx2:148,errFWSCRLFEnd:149,errCRNoLF:150,errUnknownTLD:160,errDomainTooShort:161},components:{localpart:0,
domain:1,literal:2,contextComment:3,contextFWS:4,contextQuotedString:5,contextQuotedPair:6}};e.defer="undefined"!==typeof a&&a&&"function"===typeof a.nextTick?a.nextTick.bind(a):function(a){return setTimeout(a,0)};e.specials=function(){for(var a=Array(256),d=255;0<=d;--d)a[d]=!1;for(d=0;13>d;++d)a['()<>[]:;@\\,."'.charCodeAt(d)]=!0;return function(d){return a[d]}}();e.regex={ipV4:/\b(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?)$/,ipV6:/^[a-fA-F\d]{0,4}$/};e.checkIpV6=function(a){return a.every(function(a){return e.regex.ipV6.test(a)})};
e.validDomain=function(a,d){return d.tldBlacklist?Array.isArray(d.tldBlacklist)?-1===e.indexOf.call(d.tldBlacklist,a):!e.hasOwn.call(d.tldBlacklist,a):Array.isArray(d.tldWhitelist)?-1!==e.indexOf.call(d.tldWhitelist,a):e.hasOwn.call(d.tldWhitelist,a)};d.validate=e.validate=function(a,d,b){d=d||{};"function"===typeof d&&(b=d,d={});if("function"!==typeof b){if(d.checkDNS)throw new TypeError("expected callback function for checkDNS option");b=null}var f=void 0,k=void 0;"number"===typeof d.errorLevel?
(f=!0,k=d.errorLevel):(f=!!d.errorLevel,k=e.diagnoses.valid);if(d.tldWhitelist)if("string"===typeof d.tldWhitelist)d.tldWhitelist=[d.tldWhitelist];else if("object"!==c(d.tldWhitelist))throw new TypeError("expected array or object tldWhitelist");if(d.tldBlacklist)if("string"===typeof d.tldBlacklist)d.tldBlacklist=[d.tldBlacklist];else if("object"!==c(d.tldBlacklist))throw new TypeError("expected array or object tldBlacklist");if(d.minDomainAtoms&&(d.minDomainAtoms!==(+d.minDomainAtoms|0)||0>d.minDomainAtoms))throw new TypeError("expected positive integer minDomainAtoms");
for(var n=e.diagnoses.valid,l=function(a){a>n&&(n=a)},m=e.components.localpart,r=e.components.localpart,w=[e.components.localpart],A="",I="",p="",La,K=[""],W=0,L=0,u=0,J=void 0,E=!1,Y=!1,B=a.length,y=void 0,z=0;z<B;++z){y=a[z];switch(m){case e.components.localpart:switch(y){case "(":0===L?l(0===W?e.diagnoses.cfwsComment:e.diagnoses.deprecatedComment):(l(e.diagnoses.cfwsComment),Y=!0);w.push(m);m=e.components.contextComment;break;case ".":0===L?l(0===W?e.diagnoses.errDotStart:e.diagnoses.errConsecutiveDots):
(Y&&l(e.diagnoses.deprecatedLocalPart),Y=!1,L=0,++W,I+=y);break;case '"':0===L?(l(0===W?e.diagnoses.rfc5321QuotedString:e.diagnoses.deprecatedLocalPart),I+=y,++L,Y=!0,w.push(m),m=e.components.contextQuotedString):l(e.diagnoses.errExpectingATEXT);break;case "\r":if(B===++z||"\n"!==a[z]){l(e.diagnoses.errCRNoLF);break}case " ":case "\t":0===L?l(0===W?e.diagnoses.cfwsFWS:e.diagnoses.deprecatedFWS):Y=!0;w.push(m);m=e.components.contextFWS;A=y;break;case "@":if(1!==w.length)throw Error("unexpected item on context stack");
0===I.length?l(e.diagnoses.errNoLocalPart):0===L?l(e.diagnoses.errDotEnd):64<I.length?l(e.diagnoses.rfc5322LocalTooLong):r!==e.components.contextComment&&r!==e.components.contextFWS||l(e.diagnoses.deprecatedCFWSNearAt);m=e.components.domain;w[0]=e.components.domain;L=W=0;Y=!1;break;default:if(Y)switch(r){case e.components.contextComment:case e.components.contextFWS:l(e.diagnoses.errATEXTAfterCFWS);break;case e.components.contextQuotedString:l(e.diagnoses.errATEXTAfterQS);break;default:throw Error("more atext found where none is allowed, but unrecognized prev context: "+
r);}else r=m,J=y.charCodeAt(0),(33>J||126<J||e.specials(J))&&l(e.diagnoses.errExpectingATEXT),I+=y,++L}break;case e.components.domain:switch(y){case "(":0===L?l(0===W?e.diagnoses.deprecatedCFWSNearAt:e.diagnoses.deprecatedComment):(Y=!0,l(e.diagnoses.cfwsComment));w.push(m);m=e.components.contextComment;break;case ".":0===L?l(0===W?e.diagnoses.errDotStart:e.diagnoses.errConsecutiveDots):E?l(e.diagnoses.errDomainHyphenEnd):63<L&&l(e.diagnoses.rfc5322LabelTooLong);Y=!1;L=0;++W;K[W]="";p+=y;break;case "[":0===
p.length?(Y=!0,++L,w.push(m),m=e.components.literal,p+=y,K[W]+=y,La=""):l(e.diagnoses.errExpectingATEXT);break;case "\r":if(B===++z||"\n"!==a[z]){l(e.diagnoses.errCRNoLF);break}case " ":case "\t":0===L?l(0===W?e.diagnoses.deprecatedCFWSNearAt:e.diagnoses.deprecatedFWS):(l(e.diagnoses.cfwsFWS),Y=!0);w.push(m);m=e.components.contextFWS;A=y;break;default:if(Y)switch(r){case e.components.contextComment:case e.components.contextFWS:l(e.diagnoses.errATEXTAfterCFWS);break;case e.components.literal:l(e.diagnoses.errATEXTAfterDomainLiteral);
break;default:throw Error("more atext found where none is allowed, but unrecognized prev context: "+r);}J=y.charCodeAt(0);E=!1;33>J||126<J||e.specials(J)?l(e.diagnoses.errExpectingATEXT):"-"===y?(0===L&&l(e.diagnoses.errDomainHyphenStart),E=!0):(48>J||122<J||57<J&&65>J||90<J&&97>J)&&l(e.diagnoses.rfc5322Domain);p+=y;K[W]+=y;++L}break;case e.components.literal:switch(y){case "]":if(n<e.categories.deprecated){var r=-1,J=La,C=e.regex.ipV4.exec(J);C&&(r=C.index,0!==r&&(J=J.slice(0,r)+"0:0"));if(0===r)l(e.diagnoses.rfc5321AddressLiteral);
else if("ipv6:"!==J.slice(0,5).toLowerCase())l(e.diagnoses.rfc5322DomainLiteral);else{var J=J.slice(5),C=e.maxIPv6Groups,H=J.split(":"),r=J.indexOf("::");~r?r!==J.lastIndexOf("::")?l(e.diagnoses.rfc5322IPv62x2xColon):(0!==r&&r!==J.length-2||++C,H.length>C?l(e.diagnoses.rfc5322IPv6MaxGroups):H.length===C&&l(e.diagnoses.deprecatedIPv6)):H.length!==C&&l(e.diagnoses.rfc5322IPv6GroupCount);":"===J[0]&&":"!==J[1]?l(e.diagnoses.rfc5322IPv6ColonStart):":"===J[J.length-1]&&":"!==J[J.length-2]?l(e.diagnoses.rfc5322IPv6ColonEnd):
e.checkIpV6(H)?l(e.diagnoses.rfc5321AddressLiteral):l(e.diagnoses.rfc5322IPv6BadCharacter)}}else l(e.diagnoses.rfc5322DomainLiteral);p+=y;K[W]+=y;++L;r=m;m=w.pop();break;case "\\":l(e.diagnoses.rfc5322DomainLiteralOBSDText);w.push(m);m=e.components.contextQuotedPair;break;case "\r":if(B===++z||"\n"!==a[z]){l(e.diagnoses.errCRNoLF);break}case " ":case "\t":l(e.diagnoses.cfwsFWS);w.push(m);m=e.components.contextFWS;A=y;break;default:J=y.charCodeAt(0),127<J||0===J||"["===y?l(e.diagnoses.errExpectingDTEXT):
((33>J||127===J)&&l(e.diagnoses.rfc5322DomainLiteralOBSDText),La+=y,p+=y,K[W]+=y,++L)}break;case e.components.contextQuotedString:switch(y){case "\\":w.push(m);m=e.components.contextQuotedPair;break;case "\r":if(B===++z||"\n"!==a[z]){l(e.diagnoses.errCRNoLF);break}case "\t":I+=" ";++L;l(e.diagnoses.cfwsFWS);w.push(m);m=e.components.contextFWS;A=y;break;case '"':I+=y;++L;r=m;m=w.pop();break;default:J=y.charCodeAt(0),127<J||0===J||10===J?l(e.diagnoses.errExpectingQTEXT):(32>J||127===J)&&l(e.diagnoses.deprecatedQTEXT),
I+=y,++L}break;case e.components.contextQuotedPair:J=y.charCodeAt(0);127<J?l(e.diagnoses.errExpectingQPair):(31>J&&9!==J||127===J)&&l(e.diagnoses.deprecatedQP);r=m;m=w.pop();y="\\"+y;switch(m){case e.components.contextComment:break;case e.components.contextQuotedString:I+=y;L+=2;break;case e.components.literal:p+=y;K[W]+=y;L+=2;break;default:throw Error("quoted pair logic invoked in an invalid context: "+m);}break;case e.components.contextComment:switch(y){case "(":w.push(m);m=e.components.contextComment;
break;case ")":r=m;m=w.pop();break;case "\\":w.push(m);m=e.components.contextQuotedPair;break;case "\r":if(B===++z||"\n"!==a[z]){l(e.diagnoses.errCRNoLF);break}case " ":case "\t":l(e.diagnoses.cfwsFWS);w.push(m);m=e.components.contextFWS;A=y;break;default:J=y.charCodeAt(0),127<J||0===J||10===J?l(e.diagnoses.errExpectingCTEXT):(32>J||127===J)&&l(e.diagnoses.deprecatedCTEXT)}break;case e.components.contextFWS:if("\r"===A){if("\r"===y){l(e.diagnoses.errFWSCRLFx2);break}1<++u?l(e.diagnoses.deprecatedFWS):
u=1}switch(y){case "\r":B!==++z&&"\n"===a[z]||l(e.diagnoses.errCRNoLF);break;case " ":case "\t":break;default:"\r"===A&&l(e.diagnoses.errFWSCRLFEnd),u=0,r=m,m=w.pop(),--z}A=y;break;default:throw Error("unknown context: "+m);}if(n>e.categories.rfc5322)break}if(n<e.categories.rfc5322)if(m===e.components.contextQuotedString)l(e.diagnoses.errUnclosedQuotedString);else if(m===e.components.contextQuotedPair)l(e.diagnoses.errBackslashEnd);else if(m===e.components.contextComment)l(e.diagnoses.errUnclosedComment);
else if(m===e.components.literal)l(e.diagnoses.errUnclosedDomainLiteral);else if("\r"===y)l(e.diagnoses.errFWSCRLFEnd);else if(0===p.length)l(e.diagnoses.errNoDomain);else if(0===L)l(e.diagnoses.errDotEnd);else if(E)l(e.diagnoses.errDomainHyphenEnd);else if(255<p.length)l(e.diagnoses.rfc5322DomainTooLong);else if(254<I.length+p.length+1)l(e.diagnoses.rfc5322TooLong);else if(63<L)l(e.diagnoses.rfc5322LabelTooLong);else if(d.minDomainAtoms&&K.length<d.minDomainAtoms)l(e.diagnoses.errDomainTooShort);
else if(d.tldWhitelist||d.tldBlacklist)e.validDomain(K[W],d)||l(e.diagnoses.errUnknownTLD);var N=!1,O=!1,M=function(){!N&&n<e.categories.dnsWarn&&(57>=K[W].charCodeAt(0)?l(e.diagnoses.rfc5321TLDNumeric):0===W&&l(e.diagnoses.rfc5321TLD));n<k&&(n=e.diagnoses.valid);var a=f?n:n<e.defaultThreshold;b&&(O?b(a):e.defer(b.bind(null,a)));return a};if(d.checkDNS&&n<e.categories.dnsWarn)(function(){0===W&&(p+=".");var a=p;g.resolveMx(a,function(d,b){if(d&&d.code!==g.NODATA)return l(e.diagnoses.dnsWarnNoRecord),
M();if(b&&b.length)return N=!0,M();var c=3,f=!1;l(e.diagnoses.dnsWarnNoMXRecord);d=function(a,d){if(!f){--c;if(d&&d.length)return f=!0,M();0===c&&(l(e.diagnoses.dnsWarnNoRecord),f=!0,M())}};g.resolveCname(a,d);g.resolve4(a,d);g.resolve6(a,d)});O=!0})();else return a=M(),O=!0,a};d.diagnoses=e.validate.diagnoses=function(){for(var a={},d=Object.keys(e.diagnoses),b=0;b<d.length;++b){var c=d[b];a[c]=e.diagnoses[c]}return a}()}).call(d,b(4))},function(a,d,b){function c(a,d){if("function"!==typeof d&&null!==
d)throw new TypeError("Super expression must either be null or a function, not "+("undefined"===typeof d?"undefined":H(d)));a.prototype=Object.create(d&&d.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}});if(d)if(Object.setPrototypeOf)Object.setPrototypeOf(a,d);else for(var b=Object.getOwnPropertyNames(d),c=0;c<b.length;c++){var g=b[c],e=Object.getOwnPropertyDescriptor(d,g);e&&e.configurable&&void 0===a[g]&&Object.defineProperty(a,g,e)}}d=b(11);var g=b(12),k=b(2),l={precisionRx:/(?:\.(\d+))?(?:[eE]([+-]?\d+))?$/};
l.Number=function(a){function d(){if(!(this instanceof d))throw new TypeError("Cannot call a class as a function");var b;b=a.call(this);if(!this)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");b=!b||"object"!==("undefined"===typeof b?"undefined":H(b))&&"function"!==typeof b?this:b;b._type="number";b._invalids.add(Infinity);b._invalids.add(-Infinity);return b}c(d,a);d.prototype._base=function(a,d,b){var c={errors:null,value:a};if("string"===typeof a&&b.convert){var g=
parseFloat(a);c.value=isNaN(g)||!isFinite(a)?NaN:g}a="number"===typeof c.value&&!isNaN(c.value);b.convert&&"precision"in this._flags&&a&&(g=Math.pow(10,this._flags.precision),c.value=Math.round(c.value*g)/g);c.errors=a?null:this.createError("number.base",null,d,b);return c};d.prototype.multiple=function(a){var d=g.isRef(a);d||(k.assert("number"===typeof a&&isFinite(a),"multiple must be a number"),k.assert(0<a,"multiple must be greater than 0"));return this._test("multiple",a,function(b,c,g){var e=
d?a(c.reference||c.parent,g):a;return!d||"number"===typeof e&&isFinite(e)?0===b%e?b:this.createError("number.multiple",{multiple:a,value:b},c,g):this.createError("number.ref",{ref:a.key},c,g)})};d.prototype.integer=function(){return this._test("integer",void 0,function(a,d,b){return Number.isSafeInteger(a)?a:this.createError("number.integer",{value:a},d,b)})};d.prototype.negative=function(){return this._test("negative",void 0,function(a,d,b){return 0>a?a:this.createError("number.negative",{value:a},
d,b)})};d.prototype.positive=function(){return this._test("positive",void 0,function(a,d,b){return 0<a?a:this.createError("number.positive",{value:a},d,b)})};d.prototype.precision=function(a){k.assert(Number.isSafeInteger(a),"limit must be an integer");k.assert(!("precision"in this._flags),"precision already set");var d=this._test("precision",a,function(d,b,c){var g=d.toString().match(l.precisionRx);return Math.max((g[1]?g[1].length:0)-(g[2]?parseInt(g[2],10):0),0)<=a?d:this.createError("number.precision",
{limit:a,value:d},b,c)});d._flags.precision=a;return d};return d}(d);l.compare=function(a,d){return function(b){var c=g.isRef(b),e="number"===typeof b&&!isNaN(b);k.assert(e||c,"limit must be a number or reference");return this._test(a,b,function(g,e,f){var k;if(c){if(k=b(e.reference||e.parent,f),"number"!==typeof k||isNaN(k))return this.createError("number.ref",{ref:b.key},e,f)}else k=b;return d(g,k)?g:this.createError("number."+a,{limit:k,value:g},e,f)})}};l.Number.prototype.min=l.compare("min",
function(a,d){return a>=d});l.Number.prototype.max=l.compare("max",function(a,d){return a<=d});l.Number.prototype.greater=l.compare("greater",function(a,d){return a>d});l.Number.prototype.less=l.compare("less",function(a,d){return a<d});a.exports=new l.Number},function(a,d,b){function c(a,d){if("function"!==typeof d&&null!==d)throw new TypeError("Super expression must either be null or a function, not "+("undefined"===typeof d?"undefined":H(d)));a.prototype=Object.create(d&&d.prototype,{constructor:{value:a,
enumerable:!1,writable:!0,configurable:!0}});if(d)if(Object.setPrototypeOf)Object.setPrototypeOf(a,d);else for(var b=Object.getOwnPropertyNames(d),c=0;c<b.length;c++){var g=b[c],e=Object.getOwnPropertyDescriptor(d,g);e&&e.configurable&&void 0===a[g]&&Object.defineProperty(a,g,e)}}var g=b(11),k=b(2),l=b(15);d=function(a){function d(){if(!(this instanceof d))throw new TypeError("Cannot call a class as a function");var b;b=a.call(this);if(!this)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
b=!b||"object"!==("undefined"===typeof b?"undefined":H(b))&&"function"!==typeof b?this:b;b._type="boolean";b._flags.insensitive=!0;b._inner.truthySet=new l;b._inner.falsySet=new l;return b}c(d,a);d.prototype._base=function(a,d,b){var c={value:a};if("string"===typeof a&&b.convert){var g=this._flags.insensitive?a.toLowerCase():a;c.value="true"===g?!0:"false"===g?!1:a}"boolean"!==typeof c.value&&(c.value=this._inner.truthySet.has(a,null,null,this._flags.insensitive)?!0:this._inner.falsySet.has(a,null,
null,this._flags.insensitive)?!1:a);c.errors="boolean"===typeof c.value?null:this.createError("boolean.base",null,d,b);return c};d.prototype.truthy=function(){for(var a=this.clone(),d=k.flatten(Array.prototype.slice.call(arguments)),b=0;b<d.length;++b){var c=d[b];k.assert(void 0!==c,"Cannot call truthy with undefined");a._inner.truthySet.add(c)}return a};d.prototype.falsy=function(){for(var a=this.clone(),d=k.flatten(Array.prototype.slice.call(arguments)),b=0;b<d.length;++b){var c=d[b];k.assert(void 0!==
c,"Cannot call falsy with undefined");a._inner.falsySet.add(c)}return a};d.prototype.insensitive=function(a){a=void 0===a?!0:!!a;if(this._flags.insensitive===a)return this;var d=this.clone();d._flags.insensitive=a;return d};d.prototype.describe=function(){var a=g.prototype.describe.call(this);a.truthy=[!0].concat(this._inner.truthySet.values());a.falsy=[!1].concat(this._inner.falsySet.values());return a};return d}(g);a.exports=new d},function(a,d,b){function c(a,d){if("function"!==typeof d&&null!==
d)throw new TypeError("Super expression must either be null or a function, not "+("undefined"===typeof d?"undefined":H(d)));a.prototype=Object.create(d&&d.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}});if(d)if(Object.setPrototypeOf)Object.setPrototypeOf(a,d);else for(var b=Object.getOwnPropertyNames(d),c=0;c<b.length;c++){var g=b[c],e=Object.getOwnPropertyDescriptor(d,g);e&&e.configurable&&void 0===a[g]&&Object.defineProperty(a,g,e)}}var g="function"===typeof Symbol&&
"symbol"===H(Symbol.iterator)?function(a){return"undefined"===typeof a?"undefined":H(a)}:function(a){return a&&"function"===typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":"undefined"===typeof a?"undefined":H(a)},k=b(2),l=b(11),m=b(16),n=b(12);d=function(a){function d(){if(!(this instanceof d))throw new TypeError("Cannot call a class as a function");var b;b=a.call(this);if(!this)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");b=!b||"object"!==
("undefined"===typeof b?"undefined":H(b))&&"function"!==typeof b?this:b;b._type="alternatives";b._invalids.remove(null);b._inner.matches=[];return b}c(d,a);d.prototype._base=function(a,d,b){for(var c=[],g=this._inner.matches.length,e=this._baseType,f=0;f<g;++f){var k=this._inner.matches[f],l=k.schema;if(l){k=l._validate(a,d,b);if(!k.errors)return k;c=c.concat(k.errors)}else{if(k.is._validate(k.ref(d.reference||d.parent,b),null,b,d.parent).errors){if(k.otherwise)return k.otherwise._validate(a,d,b)}else if(k.then)return k.then._validate(a,
d,b);if(f===g-1&&e)return e._validate(a,d,b)}}return c.length?{errors:this.createError("alternatives.child",{reason:c},d,b)}:{errors:this.createError("alternatives.base",null,d,b)}};d.prototype.try=function(){var a=k.flatten(Array.prototype.slice.call(arguments));k.assert(a.length,"Cannot add other alternatives without at least one schema");for(var d=this.clone(),b=0;b<a.length;++b){var c=m.schema(a[b]);c._refs.length&&(d._refs=d._refs.concat(c._refs));d._inner.matches.push({schema:c})}return d};
d.prototype.when=function(a,d){k.assert(n.isRef(a)||"string"===typeof a,"Invalid reference:",a);k.assert(d,"Missing options");k.assert("object"===("undefined"===typeof d?"undefined":g(d)),"Invalid options");k.assert(d.hasOwnProperty("is"),'Missing "is" directive');k.assert(void 0!==d.then||void 0!==d.otherwise,'options must have at least one of "then" or "otherwise"');var b=this.clone(),c=m.schema(d.is);null!==d.is&&(n.isRef(d.is)||d.is instanceof l)||(c=c.required());a={ref:m.ref(a),is:c,then:void 0!==
d.then?m.schema(d.then):void 0,otherwise:void 0!==d.otherwise?m.schema(d.otherwise):void 0};b._baseType&&(a.then=a.then&&b._baseType.concat(a.then),a.otherwise=a.otherwise&&b._baseType.concat(a.otherwise));n.push(b._refs,a.ref);b._refs=b._refs.concat(a.is._refs);a.then&&a.then._refs&&(b._refs=b._refs.concat(a.then._refs));a.otherwise&&a.otherwise._refs&&(b._refs=b._refs.concat(a.otherwise._refs));b._inner.matches.push(a);return b};d.prototype.describe=function(){for(var a=l.prototype.describe.call(this),
d=[],b=0;b<this._inner.matches.length;++b){var c=this._inner.matches[b];if(c.schema)d.push(c.schema.describe());else{var g={ref:c.ref.toString(),is:c.is.describe()};c.then&&(g.then=c.then.describe());c.otherwise&&(g.otherwise=c.otherwise.describe());d.push(g)}}a.alternatives=d;return a};return d}(l);a.exports=new d},function(a,d,b){function c(a,d){if("function"!==typeof d&&null!==d)throw new TypeError("Super expression must either be null or a function, not "+("undefined"===typeof d?"undefined":H(d)));
a.prototype=Object.create(d&&d.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}});if(d)if(Object.setPrototypeOf)Object.setPrototypeOf(a,d);else for(var b=Object.getOwnPropertyNames(d),c=0;c<b.length;c++){var g=b[c],e=Object.getOwnPropertyDescriptor(d,g);e&&e.configurable&&void 0===a[g]&&Object.defineProperty(a,g,e)}}var g="function"===typeof Symbol&&"symbol"===H(Symbol.iterator)?function(a){return"undefined"===typeof a?"undefined":H(a)}:function(a){return a&&"function"===
typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":"undefined"===typeof a?"undefined":H(a)},k=b(2),l=b(27),m=b(11),n=b(13),r=b(16),v=b(12),q={};q.Object=function(a){function d(){if(!(this instanceof d))throw new TypeError("Cannot call a class as a function");var b;b=a.call(this);if(!this)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");b=!b||"object"!==("undefined"===typeof b?"undefined":H(b))&&"function"!==typeof b?this:b;b._type="object";b._inner.children=
null;b._inner.renames=[];b._inner.dependencies=[];b._inner.patterns=[];return b}c(d,a);d.prototype._base=function(a,d,b){var c=a,e=[],f=function(){return{value:c,errors:e.length?e:null}};"string"===typeof a&&b.convert&&(a=q.safeParse(a));var l=this._flags.func?"function":"object";if(!a||("undefined"===typeof a?"undefined":g(a))!==l||Array.isArray(a))return e.push(this.createError(l+".base",null,d,b)),f();if(!(this._inner.renames.length||this._inner.dependencies.length||this._inner.children||this._inner.patterns.length))return c=
a,f();if(c===a){"object"===l?c=Object.create(Object.getPrototypeOf(a)):(c=function(){return a.apply(this,arguments)},c.prototype=k.clone(a.prototype));for(var l=Object.keys(a),m=0;m<l.length;++m)c[l[m]]=a[l[m]]}else c=a;l={};for(m=0;m<this._inner.renames.length;++m){var r=this._inner.renames[m];if(!r.options.ignoreUndefined||void 0!==c[r.from]){if(!r.options.multiple&&l[r.to]&&(e.push(this.createError("object.rename.multiple",{from:r.from,to:r.to},d,b)),b.abortEarly)||Object.prototype.hasOwnProperty.call(c,
r.to)&&!r.options.override&&!l[r.to]&&(e.push(this.createError("object.rename.override",{from:r.from,to:r.to},d,b)),b.abortEarly))return f();void 0===c[r.from]?delete c[r.to]:c[r.to]=c[r.from];l[r.to]=!0;r.options.alias||delete c[r.from]}}if(!this._inner.children&&!this._inner.patterns.length&&!this._inner.dependencies.length)return f();l=k.mapToObject(Object.keys(c));if(this._inner.children){m=[];for(r=0;r<this._inner.children.length;++r){var v=this._inner.children[r],x=v.key,t=c[x];delete l[x];
var D={key:x,path:(d.path||"")+(d.path&&x?".":"")+x,parent:c,reference:d.reference},w=v.schema._validate(t,D,b);if(w.errors){if(e.push(this.createError("object.child",{key:x,child:v.schema._getLabel(x),reason:w.errors},D,b)),b.abortEarly)return f()}else v.schema._flags.strip||void 0===w.value&&w.value!==t?(m.push(x),c[x]=w.finalValue):void 0!==w.value&&(c[x]=w.value)}for(r=0;r<m.length;++r)delete c[m[r]]}m=Object.keys(l);if(m.length&&this._inner.patterns.length){for(r=0;r<m.length;++r)for(v=m[r],
x={key:v,path:(d.path?d.path+".":"")+v,parent:c,reference:d.reference},t=c[v],D=0;D<this._inner.patterns.length;++D)if(w=this._inner.patterns[D],w.regex.test(v)){delete l[v];var F=w.rule._validate(t,x,b);if(F.errors&&(e.push(this.createError("object.child",{key:v,child:w.rule._getLabel(v),reason:F.errors},x,b)),b.abortEarly))return f();void 0!==F.value&&(c[v]=F.value)}m=Object.keys(l)}if((this._inner.children||this._inner.patterns.length)&&m.length){if(b.stripUnknown&&!0!==this._flags.allowUnknown||
b.skipFunctions){r=b.stripUnknown?!0===b.stripUnknown?!0:!!b.stripUnknown.objects:!1;for(v=0;v<m.length;++v)x=m[v],r?(delete c[x],delete l[x]):"function"===typeof c[x]&&delete l[x];m=Object.keys(l)}if(m.length&&(void 0!==this._flags.allowUnknown?!this._flags.allowUnknown:!b.allowUnknown))for(l=0;l<m.length;++l)r=m[l],e.push(this.createError("object.allowUnknown",{child:r},{key:r,path:d.path+(d.path?".":"")+r},b))}for(l=0;l<this._inner.dependencies.length&&!(m=this._inner.dependencies[l],m=q[m.type].call(this,
null!==m.key&&c[m.key],m.peers,c,{key:m.key,path:(d.path||"")+(m.key?"."+m.key:"")},b),m instanceof n.Err&&(e.push(m),b.abortEarly));++l);return f()};d.prototype._func=function(){var a=this.clone();a._flags.func=!0;return a};d.prototype.keys=function(a){k.assert(null===a||void 0===a||"object"===("undefined"===typeof a?"undefined":g(a)),"Object schema must be a valid object");k.assert(!a||!(a instanceof m),"Object schema cannot be a joi schema");var d=this.clone();if(!a)return d._inner.children=null,
d;var b=Object.keys(a);if(!b.length)return d._inner.children=[],d;var c=new l;if(d._inner.children)for(var e=0;e<d._inner.children.length;++e){var f=d._inner.children[e];-1===b.indexOf(f.key)&&c.add(f,{after:f._refs,group:f.key})}for(e=0;e<b.length;++e){var f=b[e],n=a[f];try{var q=r.schema(n);c.add({key:f,schema:q},{after:q._refs,group:f})}catch(W){throw W.hasOwnProperty("path")?W.path=f+"."+W.path:W.path=f,W;}}d._inner.children=c.nodes;return d};d.prototype.unknown=function(a){a=!1!==a;if(this._flags.allowUnknown===
a)return this;var d=this.clone();d._flags.allowUnknown=a;return d};d.prototype.length=function(a){k.assert(Number.isSafeInteger(a)&&0<=a,"limit must be a positive integer");return this._test("length",a,function(d,b,c){return Object.keys(d).length===a?d:this.createError("object.length",{limit:a},b,c)})};d.prototype.arity=function(a){k.assert(Number.isSafeInteger(a)&&0<=a,"n must be a positive integer");return this._test("arity",a,function(d,b,c){return d.length===a?d:this.createError("function.arity",
{n:a},b,c)})};d.prototype.minArity=function(a){k.assert(Number.isSafeInteger(a)&&0<a,"n must be a strict positive integer");return this._test("minArity",a,function(d,b,c){return d.length>=a?d:this.createError("function.minArity",{n:a},b,c)})};d.prototype.maxArity=function(a){k.assert(Number.isSafeInteger(a)&&0<=a,"n must be a positive integer");return this._test("maxArity",a,function(d,b,c){return d.length<=a?d:this.createError("function.maxArity",{n:a},b,c)})};d.prototype.min=function(a){k.assert(Number.isSafeInteger(a)&&
0<=a,"limit must be a positive integer");return this._test("min",a,function(d,b,c){return Object.keys(d).length>=a?d:this.createError("object.min",{limit:a},b,c)})};d.prototype.max=function(a){k.assert(Number.isSafeInteger(a)&&0<=a,"limit must be a positive integer");return this._test("max",a,function(d,b,c){return Object.keys(d).length<=a?d:this.createError("object.max",{limit:a},b,c)})};d.prototype.pattern=function(a,d){k.assert(a instanceof RegExp,"Invalid regular expression");k.assert(void 0!==
d,"Invalid rule");a=new RegExp(a.source,a.ignoreCase?"i":void 0);try{d=r.schema(d)}catch(A){throw A.hasOwnProperty("path")&&(A.message=A.message+"("+A.path+")"),A;}var b=this.clone();b._inner.patterns.push({regex:a,rule:d});return b};d.prototype.schema=function(){return this._test("schema",null,function(a,d,b){return a instanceof m?a:this.createError("object.schema",null,d,b)})};d.prototype.with=function(a,d){return this._dependency("with",a,d)};d.prototype.without=function(a,d){return this._dependency("without",
a,d)};d.prototype.xor=function(){var a=k.flatten(Array.prototype.slice.call(arguments));return this._dependency("xor",null,a)};d.prototype.or=function(){var a=k.flatten(Array.prototype.slice.call(arguments));return this._dependency("or",null,a)};d.prototype.and=function(){var a=k.flatten(Array.prototype.slice.call(arguments));return this._dependency("and",null,a)};d.prototype.nand=function(){var a=k.flatten(Array.prototype.slice.call(arguments));return this._dependency("nand",null,a)};d.prototype.requiredKeys=
function(a){a=k.flatten(Array.prototype.slice.call(arguments));return this.applyFunctionToChildren(a,"required")};d.prototype.optionalKeys=function(a){a=k.flatten(Array.prototype.slice.call(arguments));return this.applyFunctionToChildren(a,"optional")};d.prototype.forbiddenKeys=function(a){a=k.flatten(Array.prototype.slice.call(arguments));return this.applyFunctionToChildren(a,"forbidden")};d.prototype.rename=function(a,d,b){k.assert("string"===typeof a,"Rename missing the from argument");k.assert("string"===
typeof d,"Rename missing the to argument");k.assert(d!==a,"Cannot rename key to same name:",a);for(var c=0;c<this._inner.renames.length;++c)k.assert(this._inner.renames[c].from!==a,"Cannot rename the same key multiple times");c=this.clone();c._inner.renames.push({from:a,to:d,options:k.applyToDefaults(q.renameDefaults,b||{})});return c};d.prototype.applyFunctionToChildren=function(a,d,b,c){a=[].concat(a);k.assert(0<a.length,"expected at least one children");var g=q.groupChildren(a);""in g?(a=this[d].apply(this,
b),delete g[""]):a=this.clone();if(a._inner.children){c=c?c+".":"";for(var e=0;e<a._inner.children.length;++e){var f=a._inner.children[e],l=g[f.key];l&&(a._inner.children[e]={key:f.key,_refs:f._refs,schema:f.schema.applyFunctionToChildren(l,d,b,c+f.key)},delete g[f.key])}}d=Object.keys(g);k.assert(0===d.length,"unknown key(s)",d.join(", "));return a};d.prototype._dependency=function(a,d,b){b=[].concat(b);for(var c=0;c<b.length;++c)k.assert("string"===typeof b[c],a,"peers must be a string or array of strings");
c=this.clone();c._inner.dependencies.push({type:a,key:d,peers:b});return c};d.prototype.describe=function(a){var d=m.prototype.describe.call(this);if(d.rules)for(var b=0;b<d.rules.length;++b){var c=d.rules[b];c.arg&&"object"===g(c.arg)&&c.arg.schema&&c.arg.ref&&(c.arg={schema:c.arg.schema.describe(),ref:c.arg.ref.toString()})}if(this._inner.children&&!a)for(d.children={},a=0;a<this._inner.children.length;++a)b=this._inner.children[a],d.children[b.key]=b.schema.describe();this._inner.dependencies.length&&
(d.dependencies=k.clone(this._inner.dependencies));if(this._inner.patterns.length)for(d.patterns=[],a=0;a<this._inner.patterns.length;++a)b=this._inner.patterns[a],d.patterns.push({regex:b.regex.toString(),rule:b.rule.describe()});0<this._inner.renames.length&&(d.renames=k.clone(this._inner.renames));return d};d.prototype.assert=function(a,d,b){a=r.ref(a);k.assert(a.isContext||1<a.depth,"Cannot use assertions for root level references - use direct key rules instead");b=b||"pass the assertion test";
try{d=r.schema(d)}catch(G){throw G.hasOwnProperty("path")&&(G.message=G.message+"("+G.path+")"),G;}var c=a.path[a.path.length-1],g=a.path.join(".");return this._test("assert",{schema:d,ref:a},function(e,f,l){if(!d._validate(a(e),null,l,e).errors)return e;e=k.merge({},f);e.key=c;e.path=g;return this.createError("object.assert",{ref:e.path,message:b},e,l)})};d.prototype.type=function(a,d){k.assert("function"===typeof a,"type must be a constructor function");var b={name:d||a.name,ctor:a};return this._test("type",
b,function(d,c,g){return d instanceof a?d:this.createError("object.type",{type:b.name},c,g)})};d.prototype.ref=function(){return this._test("ref",null,function(a,d,b){return v.isRef(a)?a:this.createError("function.ref",null,d,b)})};return d}(m);q.safeParse=function(a){try{return JSON.parse(a)}catch(F){}return a};q.renameDefaults={alias:!1,multiple:!1,override:!1};q.groupChildren=function(a){a.sort();for(var d={},b=0;b<a.length;++b){var c=a[b];k.assert("string"===typeof c,"children must be strings");
var g=c.split(".")[0];(d[g]=d[g]||[]).push(c.substring(g.length+1))}return d};q.keysToLabels=function(a,d){var b=a._inner.children;if(!b)return d;a=function(a){var d=b.find(function(d){return d.key===a});return d?d.schema._getLabel(a):a};return Array.isArray(d)?d.map(a):a(d)};q.with=function(a,d,b,c,g){if(void 0===a)return a;for(var e=0;e<d.length;++e){var f=d[e];if(!Object.prototype.hasOwnProperty.call(b,f)||void 0===b[f])return this.createError("object.with",{main:c.key,mainWithLabel:q.keysToLabels(this,
c.key),peer:f,peerWithLabel:q.keysToLabels(this,f)},c,g)}return a};q.without=function(a,d,b,c,g){if(void 0===a)return a;for(var e=0;e<d.length;++e){var f=d[e];if(Object.prototype.hasOwnProperty.call(b,f)&&void 0!==b[f])return this.createError("object.without",{main:c.key,mainWithLabel:q.keysToLabels(this,c.key),peer:f,peerWithLabel:q.keysToLabels(this,f)},c,g)}return a};q.xor=function(a,d,b,c,g){for(var e=[],f=0;f<d.length;++f){var k=d[f];Object.prototype.hasOwnProperty.call(b,k)&&void 0!==b[k]&&
e.push(k)}if(1===e.length)return a;a={peers:d,peersWithLabels:q.keysToLabels(this,d)};return 0===e.length?this.createError("object.missing",a,c,g):this.createError("object.xor",a,c,g)};q.or=function(a,d,b,c,g){for(var e=0;e<d.length;++e){var f=d[e];if(Object.prototype.hasOwnProperty.call(b,f)&&void 0!==b[f])return a}return this.createError("object.missing",{peers:d,peersWithLabels:q.keysToLabels(this,d)},c,g)};q.and=function(a,d,b,c,g){a=[];for(var e=[],f=d.length,k=0;k<f;++k){var l=d[k];Object.prototype.hasOwnProperty.call(b,
l)&&void 0!==b[l]?e.push(l):a.push(l)}if(a.length!==f&&e.length!==f)return this.createError("object.and",{present:e,presentWithLabels:q.keysToLabels(this,e),missing:a,missingWithLabels:q.keysToLabels(this,a)},c,g)};q.nand=function(a,d,b,c,g){a=[];for(var e=0;e<d.length;++e){var f=d[e];Object.prototype.hasOwnProperty.call(b,f)&&void 0!==b[f]&&a.push(f)}b=k.clone(d);e=b.splice(0,1)[0];return a.length===d.length?this.createError("object.nand",{main:e,mainWithLabel:q.keysToLabels(this,e),peers:b,peersWithLabels:q.keysToLabels(this,
b)},c,g):null};a.exports=new q.Object},function(a,d,b){var c=b(2),g={};a.exports=g.Topo=function(){this._items=[];this.nodes=[]};g.Topo.prototype.add=function(a,d){var b=this;d=d||{};var g=[].concat(d.before||[]),e=[].concat(d.after||[]),f=d.group||"?",k=d.sort||0;c.assert(-1===g.indexOf(f),"Item cannot come before itself:",f);c.assert(-1===g.indexOf("?"),"Item cannot come before unassociated items");c.assert(-1===e.indexOf(f),"Item cannot come after itself:",f);c.assert(-1===e.indexOf("?"),"Item cannot come after unassociated items");
[].concat(a).forEach(function(a,d){b._items.push({seq:b._items.length,sort:k,before:g,after:e,group:f,node:a})});a=this._sort();c.assert(!a,"item","?"!==f?"added into group "+f:"","created a dependencies error");return this.nodes};g.Topo.prototype.merge=function(a){a=[].concat(a);for(var d=0;d<a.length;++d){var b=a[d];if(b)for(var e=0;e<b._items.length;++e){var f=c.shallow(b._items[e]);this._items.push(f)}}this._items.sort(g.mergeSort);for(a=0;a<this._items.length;++a)this._items[a].seq=a;a=this._sort();
c.assert(!a,"merge created a dependencies error");return this.nodes};g.mergeSort=function(a,d){return a.sort===d.sort?0:a.sort<d.sort?-1:1};g.Topo.prototype._sort=function(){for(var a={},d=Object.create(null),b=Object.create(null),c=0;c<this._items.length;++c){var g=this._items[c],e=g.seq,f=g.group;b[f]=b[f]||[];b[f].push(e);a[e]=g.before;g=g.after;for(f=0;f<g.length;++f)d[g[f]]=(d[g[f]]||[]).concat(e)}c=Object.keys(a);for(e=0;e<c.length;++e){for(var g=c[e],f=[],t=Object.keys(a[g]),F=0;F<t.length;++F){var x=
a[g][t[F]];b[x]=b[x]||[];for(var D=0;D<b[x].length;++D)f.push(b[x][D])}a[g]=f}c=Object.keys(d);for(e=0;e<c.length;++e)if(g=c[e],b[g])for(f=0;f<b[g].length;++f)t=b[g][f],a[t]=a[t].concat(d[g]);b=void 0;d={};c=Object.keys(a);for(e=0;e<c.length;++e)for(g=c[e],b=a[g],f=0;f<b.length;++f)d[b[f]]=(d[b[f]]||[]).concat(g);b={};a=[];for(c=0;c<this._items.length;++c){e=c;if(d[c])for(e=null,g=0;g<this._items.length;++g)if(!0!==b[g]){d[g]||(d[g]=[]);f=d[g].length;for(F=t=0;F<f;++F)0<=a.indexOf(d[g][F])&&++t;if(t===
f){e=g;break}}null!==e&&(e=e.toString(),b[e]=!0,a.push(e))}if(a.length!==this._items.length)return Error("Invalid dependencies");for(var w={},d=0;d<this._items.length;++d)b=this._items[d],w[b.seq]=b;var A=[];this._items=a.map(function(a){a=w[a];A.push(a.node);return a});this.nodes=A}},function(a,d,b){a=b(1);d.options=a.object({abortEarly:a.boolean(),convert:a.boolean(),allowUnknown:a.boolean(),skipFunctions:a.boolean(),stripUnknown:[a.boolean(),a.object({arrays:a.boolean(),objects:a.boolean()}).or("arrays",
"objects")],language:a.object(),presence:a.string().only("required","optional","forbidden","ignore"),raw:a.boolean(),context:a.object(),strip:a.boolean(),noDefaults:a.boolean()}).strict()},function(a,d,b){function c(a,d){if("function"!==typeof d&&null!==d)throw new TypeError("Super expression must either be null or a function, not "+("undefined"===typeof d?"undefined":H(d)));a.prototype=Object.create(d&&d.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}});if(d)if(Object.setPrototypeOf)Object.setPrototypeOf(a,
d);else for(var b=Object.getOwnPropertyNames(d),c=0;c<b.length;c++){var g=b[c],e=Object.getOwnPropertyDescriptor(d,g);e&&e.configurable&&void 0===a[g]&&Object.defineProperty(a,g,e)}}var g=b(11),k=b(2);d=function(a){function d(){if(!(this instanceof d))throw new TypeError("Cannot call a class as a function");var b;b=a.call(this);if(!this)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");b=!b||"object"!==("undefined"===typeof b?"undefined":H(b))&&"function"!==typeof b?
this:b;b._type="lazy";return b}c(d,a);d.prototype._base=function(a,d,b){var c={value:a},e=this._flags.lazy;if(!e)return c.errors=this.createError("lazy.base",null,d,b),c;e=e();return e instanceof g?e._validate(a,d,b):(c.errors=this.createError("lazy.schema",null,d,b),c)};d.prototype.set=function(a){k.assert("function"===typeof a,"You must provide a function as first argument");var d=this.clone();d._flags.lazy=a;return d};return d}(g);a.exports=new d},function(a,d,b){function c(a,d){if("function"!==
typeof d&&null!==d)throw new TypeError("Super expression must either be null or a function, not "+("undefined"===typeof d?"undefined":H(d)));a.prototype=Object.create(d&&d.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}});if(d)if(Object.setPrototypeOf)Object.setPrototypeOf(a,d);else for(var b=Object.getOwnPropertyNames(d),c=0;c<b.length;c++){var g=b[c],e=Object.getOwnPropertyDescriptor(d,g);e&&e.configurable&&void 0===a[g]&&Object.defineProperty(a,g,e)}}var g="function"===
typeof Symbol&&"symbol"===H(Symbol.iterator)?function(a){return"undefined"===typeof a?"undefined":H(a)}:function(a){return a&&"function"===typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":"undefined"===typeof a?"undefined":H(a)},k=b(11),l=b(16),m=b(12),n=b(2),r={fastSplice:function(a,d){for(;d<a.length;)a[d++]=a[d];--a.length}};r.Array=function(a){function d(){if(!(this instanceof d))throw new TypeError("Cannot call a class as a function");var b;b=a.call(this);if(!this)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
b=!b||"object"!==("undefined"===typeof b?"undefined":H(b))&&"function"!==typeof b?this:b;b._type="array";b._inner.items=[];b._inner.ordereds=[];b._inner.inclusions=[];b._inner.exclusions=[];b._inner.requireds=[];b._flags.sparse=!1;return b}c(d,a);d.prototype._base=function(a,d,b){var c={value:a};"string"===typeof a&&b.convert&&r.safeParse(a,c);var g=Array.isArray(c.value);a=g;b.convert&&this._flags.single&&!g&&(c.value=[c.value],g=!0);if(!g)return c.errors=this.createError("array.base",null,d,b),
c;if(this._inner.inclusions.length||this._inner.exclusions.length||this._inner.requireds.length||this._inner.ordereds.length||!this._flags.sparse)a&&(c.value=c.value.slice(0)),c.errors=this._checkItems.call(this,c.value,a,d,b),c.errors&&a&&b.convert&&this._flags.single&&(g=c.errors,c.value=[c.value],c.errors=this._checkItems.call(this,c.value,a,d,b),c.errors&&(c.errors=g,c.value=c.value[0]));return c};d.prototype._checkItems=function(a,d,b,c){for(var g=[],e,f=this._inner.requireds.slice(),k=this._inner.ordereds.slice(),
l=this._inner.inclusions.concat(f),n=a.length,m=0;m<n;++m){e=!1;var q=a[m],v=!1,t={key:d?m:b.key,path:d?(b.path?b.path+".":"")+m:b.path,parent:b.parent,reference:b.reference},x;if(this._flags.sparse||void 0!==q){for(var D=0;D<this._inner.exclusions.length;++D)if(x=this._inner.exclusions[D]._validate(q,t,{}),!x.errors){g.push(this.createError(d?"array.excludes":"array.excludesSingle",{pos:m,value:q},{key:b.key,path:t.path},c));e=!0;if(c.abortEarly)return g;break}if(!e){if(this._inner.ordereds.length)if(0<
k.length){e=k.shift();x=e._validate(q,t,c);if(x.errors){if(g.push(this.createError("array.ordered",{pos:m,reason:x.errors,value:q},{key:b.key,path:t.path},c)),c.abortEarly)return g}else if(e._flags.strip)r.fastSplice(a,m),--m,--n;else if(this._flags.sparse||void 0!==x.value)a[m]=x.value;else{g.push(this.createError("array.sparse",null,{key:b.key,path:t.path,pos:m},c));if(c.abortEarly)return g;continue}continue}else if(!this._inner.items.length){g.push(this.createError("array.orderedLength",{pos:m,
limit:this._inner.ordereds.length},{key:b.key,path:t.path},c));if(c.abortEarly)return g;continue}for(var D=[],F=f.length,p=0;p<F;++p)if(x=D[p]=f[p]._validate(q,t,c),!x.errors){a[m]=x.value;v=!0;r.fastSplice(f,p);if(!this._flags.sparse&&void 0===x.value&&(g.push(this.createError("array.sparse",null,{key:b.key,path:t.path,pos:m},c)),c.abortEarly))return g;break}if(!v){for(var p=c.stripUnknown?!0===c.stripUnknown?!0:!!c.stripUnknown.arrays:!1,F=l.length,u=0;u<F;++u){var y=l[u];x=f.indexOf(y);if(-1!==
x)x=D[x];else if(x=y._validate(q,t,c),!x.errors){y._flags.strip?(r.fastSplice(a,m),--m,--n):this._flags.sparse||void 0!==x.value?a[m]=x.value:(g.push(this.createError("array.sparse",null,{key:b.key,path:t.path,pos:m},c)),e=!0);v=!0;break}if(1===F){if(p){r.fastSplice(a,m);--m;--n;v=!0;break}g.push(this.createError(d?"array.includesOne":"array.includesOneSingle",{pos:m,reason:x.errors,value:q},{key:b.key,path:t.path},c));e=!0;if(c.abortEarly)return g;break}}if(!e&&this._inner.inclusions.length&&!v)if(p)r.fastSplice(a,
m),--m,--n;else if(g.push(this.createError(d?"array.includes":"array.includesSingle",{pos:m,value:q},{key:b.key,path:t.path},c)),c.abortEarly)return g}}}else if(g.push(this.createError("array.sparse",null,{key:b.key,path:t.path,pos:m},c)),c.abortEarly)return g}f.length&&this._fillMissedErrors.call(this,g,f,b,c);k.length&&this._fillOrderedErrors.call(this,g,k,b,c);return g.length?g:null};d.prototype.describe=function(){var a=k.prototype.describe.call(this);if(this._inner.ordereds.length){a.orderedItems=
[];for(var d=0;d<this._inner.ordereds.length;++d)a.orderedItems.push(this._inner.ordereds[d].describe())}if(this._inner.items.length)for(a.items=[],d=0;d<this._inner.items.length;++d)a.items.push(this._inner.items[d].describe());return a};d.prototype.items=function(){var a=this.clone();n.flatten(Array.prototype.slice.call(arguments)).forEach(function(d,b){try{d=l.schema(d)}catch(D){throw D.hasOwnProperty("path")?D.path=b+"."+D.path:D.path=b,D.message=D.message+"("+D.path+")",D;}a._inner.items.push(d);
"required"===d._flags.presence?a._inner.requireds.push(d):"forbidden"===d._flags.presence?a._inner.exclusions.push(d.optional()):a._inner.inclusions.push(d)});return a};d.prototype.ordered=function(){var a=this.clone();n.flatten(Array.prototype.slice.call(arguments)).forEach(function(d,b){try{d=l.schema(d)}catch(D){throw D.hasOwnProperty("path")?D.path=b+"."+D.path:D.path=b,D.message=D.message+"("+D.path+")",D;}a._inner.ordereds.push(d)});return a};d.prototype.min=function(a){var d=m.isRef(a);n.assert(Number.isSafeInteger(a)&&
0<=a||d,"limit must be a positive integer or reference");return this._test("min",a,function(b,c,g){var e;if(d){if(e=a(c.reference||c.parent,g),!(Number.isSafeInteger(e)&&0<=e))return this.createError("array.ref",{ref:a.key},c,g)}else e=a;return b.length>=e?b:this.createError("array.min",{limit:a,value:b},c,g)})};d.prototype.max=function(a){var d=m.isRef(a);n.assert(Number.isSafeInteger(a)&&0<=a||d,"limit must be a positive integer or reference");return this._test("max",a,function(b,c,g){var e;if(d){if(e=
a(c.reference||c.parent,g),!(Number.isSafeInteger(e)&&0<=e))return this.createError("array.ref",{ref:a.key},c,g)}else e=a;return b.length<=e?b:this.createError("array.max",{limit:a,value:b},c,g)})};d.prototype.length=function(a){var d=m.isRef(a);n.assert(Number.isSafeInteger(a)&&0<=a||d,"limit must be a positive integer or reference");return this._test("length",a,function(b,c,g){var e;if(d){if(e=a(c.reference||c.parent,g),!(Number.isSafeInteger(e)&&0<=e))return this.createError("array.ref",{ref:a.key},
c,g)}else e=a;return b.length===e?b:this.createError("array.length",{limit:a,value:b},c,g)})};d.prototype.unique=function(a){n.assert(void 0===a||"function"===typeof a||"string"===typeof a,"comparator must be a function or a string");var d={};"string"===typeof a?d.path=a:"function"===typeof a&&(d.comparator=a);return this._test("unique",d,function(a,b,c){for(var e={string:{},number:{},undefined:{},boolean:{},object:new Map,function:new Map,custom:new Map},f=d.comparator||n.deepEqual,k=0;k<a.length;++k){var l=
d.path?n.reach(a[k],d.path):a[k],m=d.comparator?e.custom:e["undefined"===typeof l?"undefined":g(l)];if(m)if(m instanceof Map){for(var r=m.entries(),q;!(q=r.next()).done;)if(f(q.value[0],l))return l={key:b.key,path:(b.path?b.path+".":"")+k,parent:b.parent,reference:b.reference},a={pos:k,value:a[k],dupePos:q.value[1],dupeValue:a[q.value[1]]},d.path&&(a.path=d.path),this.createError("array.unique",a,l,c);m.set(l,k)}else{if(void 0!==m[l])return q={key:b.key,path:(b.path?b.path+".":"")+k,parent:b.parent,
reference:b.reference},a={pos:k,value:a[k],dupePos:m[l],dupeValue:a[m[l]]},d.path&&(a.path=d.path),this.createError("array.unique",a,q,c);m[l]=k}}return a})};d.prototype.sparse=function(a){a=void 0===a?!0:!!a;if(this._flags.sparse===a)return this;var d=this.clone();d._flags.sparse=a;return d};d.prototype.single=function(a){a=void 0===a?!0:!!a;if(this._flags.single===a)return this;var d=this.clone();d._flags.single=a;return d};d.prototype._fillMissedErrors=function(a,d,b,c){for(var g=[],e=0,f=0;f<
d.length;++f){var k=d[f]._getLabel();k?g.push(k):++e}g.length?e?a.push(this.createError("array.includesRequiredBoth",{knownMisses:g,unknownMisses:e},{key:b.key,path:b.path},c)):a.push(this.createError("array.includesRequiredKnowns",{knownMisses:g},{key:b.key,path:b.path},c)):a.push(this.createError("array.includesRequiredUnknowns",{unknownMisses:e},{key:b.key,path:b.path},c))};d.prototype._fillOrderedErrors=function(a,d,b,c){for(var g=[],e=0;e<d.length;++e)"required"===n.reach(d[e],"_flags.presence")&&
g.push(d[e]);g.length&&this._fillMissedErrors.call(this,a,g,b,c)};return d}(k);r.safeParse=function(a,d){try{var b=JSON.parse(a);Array.isArray(b)&&(d.value=b)}catch(F){}};a.exports=new r.Array},function(a,d,b){(function(d){function c(a,d){if("function"!==typeof d&&null!==d)throw new TypeError("Super expression must either be null or a function, not "+("undefined"===typeof d?"undefined":H(d)));a.prototype=Object.create(d&&d.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}});
if(d)if(Object.setPrototypeOf)Object.setPrototypeOf(a,d);else for(var b=Object.getOwnPropertyNames(d),c=0;c<b.length;c++){var g=b[c],e=Object.getOwnPropertyDescriptor(d,g);e&&e.configurable&&void 0===a[g]&&Object.defineProperty(a,g,e)}}var g=b(11),e=b(2),g=function(a){function b(){if(!(this instanceof b))throw new TypeError("Cannot call a class as a function");var d;d=a.call(this);if(!this)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");d=!d||"object"!==("undefined"===
typeof d?"undefined":H(d))&&"function"!==typeof d?this:d;d._type="binary";return d}c(b,a);b.prototype._base=function(a,b,c){var g={value:a};if("string"===typeof a&&c.convert)try{g.value=new d(a,this._flags.encoding)}catch(F){}g.errors=d.isBuffer(g.value)?null:this.createError("binary.base",null,b,c);return g};b.prototype.encoding=function(a){e.assert(d.isEncoding(a),"Invalid encoding:",a);if(this._flags.encoding===a)return this;var b=this.clone();b._flags.encoding=a;return b};b.prototype.min=function(a){e.assert(Number.isSafeInteger(a)&&
0<=a,"limit must be a positive integer");return this._test("min",a,function(d,b,c){return d.length>=a?d:this.createError("binary.min",{limit:a,value:d},b,c)})};b.prototype.max=function(a){e.assert(Number.isSafeInteger(a)&&0<=a,"limit must be a positive integer");return this._test("max",a,function(d,b,c){return d.length<=a?d:this.createError("binary.max",{limit:a,value:d},b,c)})};b.prototype.length=function(a){e.assert(Number.isSafeInteger(a)&&0<=a,"limit must be a positive integer");return this._test("length",
a,function(d,b,c){return d.length===a?d:this.createError("binary.length",{limit:a,value:d},b,c)})};return b}(g);a.exports=new g}).call(d,b(3).Buffer)},function(a,d){a.exports={_args:[[{raw:"joi@10.6.0",scope:null,escapedName:"joi",name:"joi",rawSpec:"10.6.0",spec:"10.6.0",type:"version"},"/Users/jeff/projects/joi-browser"]],_from:"joi@10.6.0",_id:"joi@10.6.0",_inCache:!0,_location:"/joi",_nodeVersion:"6.11.0",_npmOperationalInternal:{host:"s3://npm-registry-packages",tmp:"tmp/joi-10.6.0.tgz_1497548465053_0.7665833418723196"},
_npmUser:{name:"marsup",email:"nicolas@morel.io"},_npmVersion:"5.0.3",_phantomChildren:{},_requested:{raw:"joi@10.6.0",scope:null,escapedName:"joi",name:"joi",rawSpec:"10.6.0",spec:"10.6.0",type:"version"},_requiredBy:["#DEV:/"],_resolved:"https://registry.npmjs.org/joi/-/joi-10.6.0.tgz",_shasum:"52587f02d52b8b75cdb0c74f0b164a191a0e1fc2",_shrinkwrap:null,_spec:"joi@10.6.0",_where:"/Users/jeff/projects/joi-browser",bugs:{url:"https://github.com/hapijs/joi/issues"},dependencies:{hoek:"4.x.x",isemail:"2.x.x",
items:"2.x.x",topo:"2.x.x"},description:"Object schema validation",devDependencies:{code:"4.x.x",hapitoc:"1.x.x",lab:"13.x.x"},directories:{},dist:{integrity:"sha512-hBF3LcqyAid+9X/pwg+eXjD2QBZI5eXnBFJYaAkH4SK3mp9QSRiiQnDYlmlz5pccMvnLcJRS4whhDOTCkmsAdQ==",shasum:"52587f02d52b8b75cdb0c74f0b164a191a0e1fc2",tarball:"https://registry.npmjs.org/joi/-/joi-10.6.0.tgz"},engines:{node:">=4.0.0"},gitHead:"069bb6c04063cba202544dacf9da3bbe21fa3074",homepage:"https://github.com/hapijs/joi",keywords:["hapi","schema",
"validation"],license:"BSD-3-Clause",main:"lib/index.js",maintainers:[{name:"hueniverse",email:"eran@hammer.io"},{name:"marsup",email:"nicolas@morel.io"},{name:"nlf",email:"quitlahok@gmail.com"},{name:"wyatt",email:"wpreul@gmail.com"}],name:"joi",optionalDependencies:{},readme:"ERROR: No README data found!",repository:{type:"git",url:"git://github.com/hapijs/joi.git"},scripts:{test:"lab -t 100 -a code -L","test-cov-html":"lab -r html -o coverage.html -a code","test-debug":"lab -a code",toc:"hapitoc",
version:"npm run toc && git add API.md README.md"},version:"10.6.0"}}])})}),pd=function(){function c(){N(this,c);this._uuid="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(b){var a=16*Math.random()|0;return("x"==b?a:a&3|8).toString(16)});this._metadata={};this._metadataSchema=this._buildMetadataSchema();this._type=c.TYPE();this._timer={}}O(c,[{key:"isOfType",value:function(b){return!this._type.localeCompare(b)}},{key:"getType",value:function(){this._type}},{key:"getUuid",value:function(){return this._uuid.slice()}},
{key:"setMetadata",value:function(b,a){"string"===typeof b||b instanceof String?this._metadata[b]=a:console.warn("The given key must be a String Object.")}},{key:"getMetadata",value:function(b){if(b in this._metadata)return this._metadata[b];console.warn("The metadata with key: "+b+" doe not exist.");return null}},{key:"hasMetadata",value:function(b){return b in this._metadata}},{key:"getMetadataKeys",value:function(){return Object.keys(this._metadata)}},{key:"copyMetadataFrom",value:function(b){var a=
this;b.getMetadataKeys().forEach(function(d){try{var c=JSON.parse(JSON.stringify(b.getMetadata(d)));a.setMetadata(d,c)}catch(e){console.error(e)}})}},{key:"getMetadataCopy",value:function(){return JSON.parse(JSON.stringify(this._metadata))}},{key:"setRawMetadata",value:function(b){this._metadata=b;this._metadataRawCopied()}},{key:"_metadataRawCopied",value:function(){}},{key:"_getOption",value:function(b,a,d){return b?b[a]||d:d}},{key:"isMetadataCyclic",value:function(){return!1}},{key:"addTimeRecord",
value:function(b){this._timer[b]=performance.now()}},{key:"getTime",value:function(b,a){var d=2<arguments.length&&void 0!==arguments[2]?arguments[2]:!1;if(b in this._timer&&a in this._timer){var c=Math.abs(this._timer[a]-this._timer[b]);d&&console.log("> Time: ["+b+" , "+a+"] is "+c+" millisec.");return c}console.warn("The two given record name must exist in the time record table.");return-1}},{key:"_buildMetadataSchema",value:function(){return null}},{key:"metadataIntegrityCheck",value:function(){var b=
0<arguments.length&&void 0!==arguments[0]?arguments[0]:null;null==b&&(b=this._metadata);if(b){if(b=ea.validate(b,this._metadataSchema),b.error)return console.warn("SCHEMA VALIDATION: "+b.error),!1}else console.warn("Validation schema not available. Metadata considered to be valid.");return!0}},{key:"getMetadataClone",value:function(){return this.metadataIntegrityCheck()?JSON.parse(JSON.stringify(this._metadata)):null}},{key:"metadataToString",value:function(){var b="__metadata__\n",a;for(a in this._metadata)b+=
"\t["+a+"]\n\t"+JSON.stringify(this._metadata[a])+"\n\n";return b}}],[{key:"TYPE",value:function(){return"GENERIC"}}]);return c}(),V=function(c){function b(){N(this,b);var a=P(this,(b.__proto__||Object.getPrototypeOf(b)).call(this));a._type=b.TYPE();a._events={};a._inputValidator={};a._allValidator=null;a._input={};a._output={};a._isOutputReady=!1;a.setMetadata("time",!0);return a}M(b,c);O(b,[{key:"addInput",value:function(a){var d=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0;a?(d in this._input||
(this._input[d]=null),this._input[d]=a,this._isOutputReady=!1):console.warn("A null input cannot be added.")}},{key:"getOutput",value:function(){var a=0<arguments.length&&void 0!==arguments[0]?arguments[0]:0;return a in this._output?this._output[a]:null}},{key:"forEachOutput",value:function(a){if(a)for(var d=this.getOutputCategories(),b=0;b<d.length;b++)a.call(this,d[b],this.getOutput(d[b]));else console.warn("forEachOutput requires a callback.")}},{key:"_forEachInput",value:function(a){if(a)for(var d=
this.getInputCategories(),b=0;b<d.length;b++)a.call(this,d[b],this._getInput(d[b]));else console.warn("forEachOutput requires a callback.")}},{key:"_addOutput",value:function(a){var d=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,b=null;d in this._output?console.warn("An output of category "+d+" was already defined. Nothing to be done."):(b=new a,this._output[d]=b,console.log("filter "+this.constructor.name+" creates a new output."));return b}},{key:"_getInput",value:function(){var a=0<
arguments.length&&void 0!==arguments[0]?arguments[0]:0;return a in this._input?this._input[a]:null}},{key:"hasInputOfCategory",value:function(a){return a in this._input}},{key:"getInputCategories",value:function(){return Object.keys(this._input)}},{key:"getOutputCategories",value:function(){return Object.keys(this._output)}},{key:"setMetadata",value:function(a,d){aj(b.prototype.__proto__||Object.getPrototypeOf(b.prototype),"setMetadata",this).call(this,a,d);this._isOutputReady=!1}},{key:"hasOutputReady",
value:function(){return this._isOutputReady}},{key:"setOutputAsReady",value:function(){this._isOutputReady=!0}},{key:"addInputValidator",value:function(a,d){"TYPE"in d?"ALL"===a?this._allValidator=d.TYPE():this._inputValidator[a]=d.TYPE():"ALL"===a?this._allValidator=d:this._inputValidator[a]=d}},{key:"hasValidInput",value:function(){var a=this,d=this.getInputCategories(),b=!0;0===d.length&&(b=!1,console.warn("No input validator was added. Filter cannot run. Use addInputValidator(...) to specify input types."));
d.forEach(function(d){var c=a._getInput(d);if(c)if("isOfType"in c)a._inputValidator[d]&&(b=b&&c.isOfType(a._inputValidator[d])),a._allValidator&&(b=b&&c.isOfType(a._allValidator));else try{a._inputValidator[d]&&(b=b&&c instanceof a._inputValidator[d]),a._allValidator&&(b=b&&c instanceof a._allValidator)}catch(k){b=!1}else b=!1});b||console.warn("The input is not valid.");return b}},{key:"update",value:function(){this._output={};this._metadata.time?(this.addTimeRecord("begin"),this._run(),this.addTimeRecord("end"),
console.log("Running time for filter "+this.constructor.name+": "+this.getTime("begin","end")+"ms.")):this._run();this.getNumberOfOutputs()&&this.setOutputAsReady()}},{key:"_run",value:function(){console.error("The update() method has not been written, this filter is not valid.")}},{key:"on",value:function(a,d){this._events[a]=d}},{key:"triggerEvent",value:function(a){var d=null;if(this.hasEvent(a))if(1<arguments.length){for(var d=[],b=1;b<arguments.length;b++)d.push(arguments[b]);d=this._events[a].apply(this,
d)}else d=this._events[a].call(this);else console.warn("The event "+a+" does not exist.");return d}},{key:"hasEvent",value:function(a){return a in this._events}},{key:"getNumberOfInputs",value:function(){return Object.keys(this._input).length}},{key:"getNumberOfOutputs",value:function(){return Object.keys(this._output).length}},{key:"clearAllInputs",value:function(){this._input={}}}],[{key:"TYPE",value:function(){return"FILTER"}}]);return b}(pd),cc=function(c){function b(){N(this,b);var a=P(this,
(b.__proto__||Object.getPrototypeOf(b)).call(this));a._data=null;return a}M(b,c);O(b,[{key:"setRawData",value:function(a){this._data=a}}]);return b}(pd),za=function(c){function b(){N(this,b);var a=P(this,(b.__proto__||Object.getPrototypeOf(b)).call(this));a._type=b.TYPE();a.setMetadata("length",0);a.setMetadata("min",Infinity);a.setMetadata("max",-Infinity);a.setMetadata("samplingFrequency",100);return a}M(b,c);O(b,[{key:"getData",value:function(){return this._data}},{key:"setData",value:function(a){this._data=
1<arguments.length&&void 0!==arguments[1]&&arguments[1]?new a.constructor(a):a;this.setMetadata("length",a.length);this._computeStatistics()}},{key:"clone",value:function(){var a=new b;a.copyMetadataFrom(this);this._data&&a.setData(this._data,!0);return a}},{key:"hollowClone",value:function(){var a=new b;a.copyMetadataFrom(this);var d=this.getMetadata("length");a.setData((new this._data.constructor(d)).fill(0));return a}},{key:"dataToString",value:function(){var a=this._data.slice(0,Math.min(10,this._data.length)),
d;d="__data__\n"+("\t"+this._data.constructor.name+"["+this._data.length+"] ");return d+=a.toString()+" "+(10<this._data.length?" ...":"")}},{key:"toString",value:function(){var a=this.constructor.name+"\n",a=a+this.metadataToString();return a+=this.dataToString()}},{key:"_computeStatistics",value:function(){for(var a=Infinity,d=-Infinity,b=0;b<this._data.length;b++)a=Math.min(a,this._data[b]),d=Math.max(d,this._data[b]);this.setMetadata("min",a);this.setMetadata("max",d)}}],[{key:"TYPE",value:function(){return"SIGNAL1D"}}]);
return b}(cc);cb.addCoreType(za);var S=function(c){function b(){var a=0<arguments.length&&void 0!==arguments[0]?arguments[0]:null;N(this,b);var d=P(this,(b.__proto__||Object.getPrototypeOf(b)).call(this));d._type=b.TYPE();d.setMetadata("ncpp",4);if(a&&"width"in a&&"height"in a&&0<a.width&&0<a.height){d.setMetadata("width",a.width);d.setMetadata("height",a.height);"color"in a&&d.setMetadata("ncpp",a.color.length);d._data=new Float32Array(a.width*a.height*d.getMetadata("ncpp"));var c=d.getMetadata("ncpp");
if("color"in a)for(var a=a.color,e=0;e<d._data.length;e++)d._data[e]=a[e%c];else d._data.fill(0)}return d}M(b,c);O(b,[{key:"clone",value:function(){var a=new b;a.setData(this._data,this.getMetadata("width"),this.getMetadata("height"),this.getMetadata("ncpp"),!0);a.copyMetadataFrom(this);return a}},{key:"hollowClone",value:function(){var a=new b,d=this.getMetadata("ncpp"),c=this.getMetadata("width"),e=this.getMetadata("height");a.setData((new Float32Array(c*e*d)).fill(0),c,e,d);return a}},{key:"float32Clone",
value:function(){var a=new b,d=this.getMetadata("ncpp"),c=this.getMetadata("width"),e=this.getMetadata("height");a.copyMetadataFrom(this);a.setData(new Float32Array(this._data),c,e,d);return a}},{key:"setData",value:function(a,d,b){var c=3<arguments.length&&void 0!==arguments[3]?arguments[3]:4,g=4<arguments.length&&void 0!==arguments[4]?arguments[4]:!1;this.setMetadata("ncpp",c);a.length!=d*b*c?console.warn("The array size does not match the width and height. Cannot init the Image2D."):(this._data=
g?new a.constructor(a):a,this.setMetadata("width",d),this.setMetadata("height",b),this.computeSimpleStat())}},{key:"setPixel",value:function(a,d){var b=2<arguments.length&&void 0!==arguments[2]?arguments[2]:!1;if(this._data){var c=this._metadata.ncpp;if("x"in a&&0<=a.x&&a.x<this._metadata.width&&"y"in a&&0<=a.y&&a.y<this._metadata.height){if(d.length==c){var f=this.get1dIndexFrom2dPosition(a);if(1==c)this._data[f]=d[0];else for(var f=f*c,k=0;k<c;k++)this._data[f+k]=d[k]}else if(3==d.length&&4==c)for(f=
this.get1dIndexFrom2dPosition(a),f*=c,k=0;k<d.length;k++)this._data[f+k]=d[k];b&&this.computeSimpleStat()}}else console.warn("The image is empty")}},{key:"getPixel",value:function(a){if(this._data){if("x"in a&&0<=a.x&&a.x<this._metadata.width&&"y"in a&&0<=a.y&&a.y<this._metadata.height){var d=this._metadata.ncpp;a=this.get1dIndexFrom2dPosition(a);1==d?d=[this._data[a]]:(a*=d,d=this._data.slice(a,a+d));return d}console.warn("The requested position is outside the image.");return null}console.warn("The image is empty")}},
{key:"getWidth",value:function(){return this._metadata.width}},{key:"getHeight",value:function(){return this._metadata.height}},{key:"getComponentsPerPixel",value:function(){return this._metadata.ncpp}},{key:"getNcpp",value:function(){return this.getComponentsPerPixel()}},{key:"getData",value:function(){return this._data}},{key:"getDataCopy",value:function(){return new this._data.constructor(this._data)}},{key:"getDataAsUInt8Array",value:function(){if(this._data){for(var a=this.getMin(),d=this.getMax(),
b=new Uint8Array(this._data.length),c=0;c<this._data.length;c++)b[c]=(this._data[c]-a)/d*256;return b}console.warn("No data, cannot make a copy of it.")}},{key:"getDataAsFloat32Array",value:function(){if(this._data)return new Float32Array(this._data);console.warn("No data, cannot make a copy of it.")}},{key:"get2dPositionFrom1dIndex",value:function(a){return{x:a%this._metadata.width,y:Math.floor(a/this._metadata.width)}}},{key:"get1dIndexFrom2dPosition",value:function(a){return a.x+a.y*this._metadata.width}},
{key:"computeSimpleStat",value:function(){if(this._data){for(var a=Infinity,d=-Infinity,b=0,c=0;c<this._data.length;c++)a=Math.min(a,this._data[c]),d=Math.max(a,this._data[c]),b+=this._data[c];this.setMetadata("min",a);this.setMetadata("max",d);this.setMetadata("avg",b/this._data.length)}else console.warn("The image is empty")}},{key:"getMin",value:function(){this.hasMetadata("min")||this.computeSimpleStat();return this.getMetadata("min")}},{key:"getMax",value:function(){this.hasMetadata("max")||
this.computeSimpleStat();return this.getMetadata("max")}},{key:"getAvg",value:function(){this.hasMetadata("avg")||this.computeSimpleStat();return this.getMetadata("avg")}},{key:"isInside",value:function(a){return 0<=a.x&&a.x<this._metadata.width&&0<=a.y&&a.y<this._metadata.height}},{key:"getSegmentSample",value:function(a,d){if(!this.isInside(a)||!this.isInside(d))return null;var b=d.x-a.x,c=d.y-a.y,f=Math.sqrt(Math.pow(b,2)+Math.pow(c,2));d=Math.floor(f+1);for(var b=b/f,c=c/f,f=this._metadata.ncpp,
k=Array(d).fill(0),l=Array(f).fill(0),m=Array(d).fill(0),n=0;n<f;n++)l[n]=Array(d).fill(0);for(var r=0;r<d;r++){n={x:Math.round(a.x+r*b),y:Math.round(a.y+r*c)};k[r]=n;m[r]="("+n.x+", "+n.y+")";for(var v=this.getPixel(n),n=0;n<f;n++)l[n][r]=v[n]}return{positions:k,labels:m,colors:l}}}],[{key:"TYPE",value:function(){return"IMAGE2D"}}]);return b}(cc);cb.addCoreType(S);var Hc=function(c){function b(){var a=0<arguments.length&&void 0!==arguments[0]?arguments[0]:null;N(this,b);var d=P(this,(b.__proto__||
Object.getPrototypeOf(b)).call(this));d._type=b.TYPE();d.setMetadata("ncpp",1);a&&"order"in a?d.setMetadata("order",a.order):d.setMetadata("order",["zspace","yspace","xspace"]);var c={offset:1,step:1},e={step:1},f={step:1};d.setMetadata("xspace",c);d.setMetadata("yspace",e);d.setMetadata("zspace",f);d.setMetadata("time",{offset:0,space_length:1});a&&"ncpp"in a&&d.setMetadata("ncpp",a.ncpp);a&&"xSize"in a&&"ySize"in a&&"zSize"in a&&0<a.xSize&&0<a.ySize&&0<a.zSize&&(c.space_length=a.xSize,e.space_length=
a.ySize,f.space_length=a.zSize,e.offset=c.space_length,f.offset=c.space_length*e.space_length,d._data=new Float32Array(a.xSize*a.ySize*a.zSize*d.getMetadata("ncpp")),d._data.fill(0),d._scanDataRange(),d._finishHeader());return d}M(b,c);O(b,[{key:"clone",value:function(){var a=new b;a.setData(this._data,this.getMetadata("xspace").space_length,this.getMetadata("yspace").space_length,this.getMetadata("zspace").space_length,{ncpp:this.getMetadata("ncpp"),order:this.getMetadata("order").slice(),deepCopy:!0});
a.copyMetadataFrom(this);return a}},{key:"setData",value:function(a,d,b,c,f){var g=1;f&&"ncpp"in f&&(g=f.ncpp);a.length!=d*b*c*g?console.warn("The array size does not match the width and height. Cannot init the Image3D."):(f&&"ncpp"in f&&this.setMetadata("ncpp",f.ncpp),f&&"order"in f&&this.setMetadata("order",f.order),this._data=f&&"deepCopy"in f&&f.deepCopy?new a.constructor(a):a,a=this.getMetadata("xspace"),f=this.getMetadata("yspace"),g=this.getMetadata("zspace"),a.space_length=d,f.space_length=
b,g.space_length=c,f.offset=a.space_length,g.offset=a.space_length*f.space_length,this._scanDataRange(),this._finishHeader())}},{key:"_finishHeader",value:function(){var a=this.getMetadata("xspace"),d=this.getMetadata("yspace"),b=this.getMetadata("zspace");a.name="xspace";d.name="yspace";b.name="zspace";a.width_space=JSON.parse(JSON.stringify(d));a.width=d.space_length;a.height_space=JSON.parse(JSON.stringify(b));a.height=b.space_length;d.width_space=JSON.parse(JSON.stringify(a));d.width=a.space_length;
d.height_space=JSON.parse(JSON.stringify(b));d.height=b.space_length;b.width_space=JSON.parse(JSON.stringify(a));b.width=a.space_length;b.height_space=JSON.parse(JSON.stringify(d));b.height=d.space_length}},{key:"_scanDataRange",value:function(){for(var a=Infinity,d=-Infinity,b=0;b<this._data.length;b++)a=Math.min(a,this._data[b]),d=Math.max(d,this._data[b]);this.setMetadata("voxel_min",a);this.setMetadata("voxel_max",d)}},{key:"setPixel",value:function(a,d){}},{key:"getPixel",value:function(a){return this.getIntensity_xyz(a.x,
a.y,a.z)}},{key:"getSize",value:function(a){if(this.hasMetadata(a))return this.getMetadata(a).space_length;console.warn('The space must be "xspace", "yspace" or "zspace".');return null}},{key:"getData",value:function(){return this._data}},{key:"getDataCopy",value:function(){return new this._data.constructor(this._data)}},{key:"get1dIndexFrom3dPosition",value:function(a){}},{key:"getSlice",value:function(a){var d=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,b=2<arguments.length&&void 0!==
arguments[2]?arguments[2]:0;if(!this.hasMetadata(a))return console.warn("The axis "+a+" does not exist."),null;var c=this.hasMetadata("time")?b*this.getMetadata("time").offset:0,f=this.getMetadata(a),k=f.width_space,l=f.height_space,b=f.width,m=f.height,n=f.offset,r=k.offset,v=l.offset,q=new this._data.constructor(b*m),t,k=0<k.step,F=0<l.step;t=0<f.step;var x=l=0,D=Infinity,w=-Infinity;this.getMetadata("voxel_max");d=t?d:f.space_length-d-1;if(0<=d&&d<f.space_length)for(c+=d*n,d=m-1;0<=d;d--)for(f=
F?d:m-d-1,n=c+f*v,f=0;f<b;f++)t=k?f:b-f-1,t=n+t*r,t=this._data[t],D=Math.min(D,t),w=Math.max(w,t),x+=t,q[l++]=t;r=new S;r.setData(q,b,m,1);r.setMetadata("min",D);r.setMetadata("max",w);r.setMetadata("avg",x/(l-1));return r}},{key:"getIntensity_ijk",value:function(a,d,b){var c=3<arguments.length&&void 0!==arguments[3]?arguments[3]:0,g=this.getMetadata("order");if(0>a||a>=this.getMetadata(g[0]).space_length||0>d||d>=this.getMetadata(g[1]).space_length||0>b||b>=this.getMetadata(g[2]).space_length)return console.warn("getIntensity_ijk position is out of range."),
0;c*=this._metadata.time.offset;g=a*this.getMetadata(g[0]).offset+d*this.getMetadata(g[1]).offset+b*this.getMetadata(g[2]).offset+c;return this._data[g]}},{key:"getIntensity_xyz",value:function(a,d,b){var c=3<arguments.length&&void 0!==arguments[3]?arguments[3]:0;return 0>a||a>=this._metadata.xspace.space_length||0>d||d>=this._metadata.yspace.space_length||0>b||b>=this._metadata.zspace.space_length?(console.warn("getIntensity_xyz position is out of range."),0):this._data[a*this._metadata.xspace.offset+
d*this._metadata.yspace.offset+b*this._metadata.zspace.offset+this._metadata.time.offset*c]}},{key:"getIntensity_xyzOrientation",value:function(a,d,b){var c=3<arguments.length&&void 0!==arguments[3]?arguments[3]:0,c=this.hasMetadata("time")?c*this.getMetadata("time").offset:0;10==a&&30==d&&20==b&&console.log("stop");var g=this.getMetadata("xspace"),k=this.getMetadata("yspace"),l=this.getMetadata("zspace"),m=0<g.step?a:g.space_length-a-1,n=0<k.step?d:k.space_length-d-1,r=0<l.step?b:l.space_length-
b-1;return 0<=a&&a<g.space_length&&0<=d&&d<k.space_length&&0<=b&&b<l.space_length?this._data[c+m*g.offset+n*k.offset+r*l.offset]:null}},{key:"getTimeLength",value:function(){return this.hasMetadata("time")?this.getMetadata("time").space_length:1}},{key:"isInside",value:function(a){return!(0>a.x||a.x>=this._metadata.xspace.space_length||0>a.y||a.y>=this._metadata.yspace.space_length||0>a.z||a.z>=this._metadata.zspace.space_length)}},{key:"getSegmentSample",value:function(a,d){if(!this.isInside(a)||
!this.isInside(d))return null;var b=d.x-a.x,c=d.y-a.y,f=d.z-a.z,k=Math.sqrt(Math.pow(b,2)+Math.pow(c,2)+Math.pow(f,2));d=Math.floor(k+1);for(var b=b/k,c=c/k,f=f/k,k=this._metadata.ncpp,l=Array(d).fill(0),m=Array(k).fill(0),n=Array(d).fill(0),r=0;r<k;r++)m[r]=Array(d).fill(0);for(var v=0;v<d;v++){r={x:Math.round(a.x+v*b),y:Math.round(a.y+v*c),z:Math.round(a.z+v*f)};l[v]=r;n[v]="("+r.x+", "+r.y+", "+r.z+")";for(var q=[this.getIntensity_xyz(r.x,r.y,r.z)],r=0;r<k;r++)m[r][v]=q[r]}return{positions:l,labels:n,
colors:m}}}],[{key:"TYPE",value:function(){return"IMAGE3D"}}]);return b}(cc);cb.addCoreType(Hc);var ra=function(c){function b(){N(this,b);return P(this,(b.__proto__||Object.getPrototypeOf(b)).call(this))}M(b,c);O(b,[{key:"hasSameSizeInput",value:function(){var a=this,d=!0,b=[],c=[];Object.keys(this._input).forEach(function(d){b.push(a._getInput(d).getWidth());c.push(a._getInput(d).getHeight())});b.length&&(b.sort(),c.sort(),(d=b[0]==b[b.length-1]&&c[0]==c[c.length-1])||console.warn("Input image do not all have the same size. Filter not valid"));
return d}},{key:"hasSameNcppInput",value:function(){var a=Object.keys(this._input);if(!a.length)return!1;for(var d=this._getInput(a[0]).getComponentsPerPixel(),b=0;b<a.length;b++)if(d!=this._getInput(a[b]).getComponentsPerPixel())return console.warn("Input image do not all have the same number of components per pixel. Filter not valid"),!1;return!0}}]);return b}(V),db=function(c){function b(){N(this,b);return P(this,(b.__proto__||Object.getPrototypeOf(b)).call(this))}M(b,c);O(b,[{key:"setData",value:function(a,
d){var b=this;this._data=a;this.setMetadata("position",{});this.setMetadata("current_time",0);Object.keys(d).forEach(function(a){b.setMetadata(a,d[a])});this._scanDataRange();this._saveOriginAndTransform();this._finishHeader();console.log(this)}},{key:"_saveOriginAndTransform",value:function(){var a=this.getMetadata("xspace"),d=this.getMetadata("yspace"),b=this.getMetadata("zspace"),c=a.start,f=d.start,k=b.start,l=a.direction_cosines,m=d.direction_cosines,n=b.direction_cosines,a=a.step,d=d.step,b=
b.step,c={x:c*l[0]+f*m[0]+k*n[0],y:c*l[1]+f*m[1]+k*n[1],z:c*l[2]+f*m[2]+k*n[2]};this.setMetadata("voxel_origin",c);this.setMetadata("w2v",[[l[0]/a,l[1]/a,l[2]/a,(-c.x*l[0]-c.y*l[1]-c.z*l[2])/a],[m[0]/d,m[1]/d,m[2]/d,(-c.x*m[0]-c.y*m[1]-c.z*m[2])/d],[n[0]/b,n[1]/b,n[2]/b,(-c.x*n[0]-c.y*n[1]-c.z*n[2])/b]])}}],[{key:"transformToMinc",value:function(a,d){function b(a){a=a[0]*a[0]+a[1]*a[1]+a[2]*a[2];0>=a&&(a=1);return Math.sqrt(a)}function c(a,d,b){return a[0]*(d[1]*b[2]-d[2]*b[1])-a[1]*(d[0]*b[2]-d[2]*
b[0])+a[2]*(d[0]*b[1]-d[1]*b[0])}for(var f=[],k=[],l=[],m=b(a[0]),n=b(a[1]),r=b(a[2]),m=0>a[0][0]?-m:m,n=0>a[1][1]?-n:n,r=0>a[2][2]?-r:r,v=0;3>v;v++)f[v]=a[v][0]/m,k[v]=a[v][1]/n,l[v]=a[v][2]/r;d.xspace.step=m;d.yspace.step=n;d.zspace.step=r;n=[a[0][3],a[1][3],a[2][3]];a=c(f,k,l);m=c(n,k,l);r=c(f,n,l);n=c(f,k,n);d.xspace.start=m/a;d.yspace.start=r/a;d.zspace.start=n/a;d.xspace.direction_cosines=f;d.yspace.direction_cosines=k;d.zspace.direction_cosines=l}},{key:"swapn",value:function(a,d){for(var b=
0;b<a.length;b+=d)for(var c=d-1,f=0;c>f;){var k=a[b+c];a[b+c]=a[b+f];a[b+f]=k;c--;f++}}}]);return b}(Hc);cb.addCoreType(db);var Ic=function(c){function b(){N(this,b);var a=P(this,(b.__proto__||Object.getPrototypeOf(b)).call(this));a.setMetadata("closed",!1);a.setMetadata("defaultNod",2);a.setMetadata("nod",2);a._type=b.TYPE();a._lastPoint=null;return a}M(b,c);O(b,[{key:"setData",value:function(a){var d=1<arguments.length&&void 0!==arguments[1]?arguments[1]:-1,b=2<arguments.length&&void 0!==arguments[2]?
arguments[2]:!1;-1!=d&&this.setMetadata("nod",d);0!=a.length%this.getMetadata("nod")?console.warn("The number of points is not compatible with the number of dimensions (nod)."):(this._data=b?new a.constructor(a):a,this._setLastPoint())}},{key:"setNod",value:function(a){this._data&&this._data.length?this.setMetadata("nod",a):console.warn("The number of dimension can be set only when this LineString is empty.")}},{key:"getNod",value:function(){return this.getMetadata("nod")}},{key:"getData",value:function(){return this._data}},
{key:"getDataCopy",value:function(){return new this._data.constructor(this._data)}},{key:"getNumberOfPoints",value:function(){return this._data?this._data.length/this.getMetadata("nod"):0}},{key:"getPoint",value:function(a){if(0<=a&&a<getNumberOfPoints){var d=this._metadata.nod;return this._data.slice(a*d,a*d+d)}console.warn("Index of point is out of range.");return null}},{key:"close",value:function(){this.setMetadata("closed",!0)}},{key:"open",value:function(){this.setMetadata("closed",!1)}},{key:"addPoint",
value:function(a){if(a.length!=this._metadata.nod)console.warn("Cannot add the point becase it has a diferent number of dimensions.");else{this._data||(this._data=[]);for(var d=0;d<a.length;d++)this._data.push(a[d]);this._lastPoint=a}}},{key:"peekPoint",value:function(){if(!this._data)return null;if(this._lastPoint)return this._lastPoint;this._setLastPoint();return this._lastPoint}},{key:"_setLastPoint",value:function(){this._lastPoint=this._data.slice(-this._metadata.nod);0==this._lastPoint.length&&
(this._lastPoint=null)}},{key:"popPoint",value:function(){if(!this._data)return console.warn("This LineString was not added any point."),null;if(!this._data.length)return console.warn("No more point in this LineString."),null;this._lastPoint.length-=this._metadata.nod;this._setLastPoint()}},{key:"hasPoint",value:function(a){var d=this.getMetadata("nod");if(a.length!=d)return console.warn("The given point does not have the same number of dimensions as the LineString."),!1;for(d=0;d<this._data.length-
1;d+=2)if(this._data[d]==a[0]&&this._data[d+1]==a[1])return!0;return!1}}],[{key:"TYPE",value:function(){return"LINESTRING"}}]);return b}(cc);cb.addCoreType(Ic);var Nb=function(){function c(){N(this,c)}O(c,null,[{key:"setValueMatrix44",value:function(b,a,d,g){c.setValueSquareMatrix(b,4,a,d,g)}},{key:"setValueMatrix33",value:function(b,a,d,g){c.setValueSquareMatrix(b,3,a,d,g)}},{key:"setValueSquareMatrix",value:function(b,a,d,c,e){b[d*a+c]=e}},{key:"getValueMatrix44",value:function(b,a,d){return c.getValueSquareMatrix(b,
4,a,d)}},{key:"getValueMatrix33",value:function(b,a,d){return c.getValueSquareMatrix(b,3,a,d)}},{key:"getValueSquareMatrix",value:function(b,a,d,c){return b[d*a+c]}},{key:"getHorizontalFlipMatrix44",value:function(b){return c.getHorizontalFlipSquareMatrix(b,4)}},{key:"getHorizontalFlipMatrix33",value:function(b){return c.getHorizontalFlipSquareMatrix(b,3)}},{key:"getHorizontalFlipSquareMatrix",value:function(b,a){for(var d=Array(a*a).fill(0),g=0;g<a;g++)for(var e=0;e<a;e++){var f=c.getValueSquareMatrix(b,
a,e,g);c.setValueSquareMatrix(d,a,a-1-e,g,f)}return d}},{key:"getExpandedMatrix3x3To4x4",value:function(b){for(var a="RIGHT"===(1<arguments.length&&void 0!==arguments[1]?arguments[1]:"LEFT")?1:0,d="BOTTOM"===(2<arguments.length&&void 0!==arguments[2]?arguments[2]:"TOP")?1:0,g=Array(16).fill(0),e=0;3>e;e++)for(var f=0;3>f;f++){var k=c.getValueMatrix33(b,f,e);c.setValueMatrix44(g,a+f,d+e,k)}return g}}]);return c}(),dc=function(c){function b(){var a=0<arguments.length&&void 0!==arguments[0]?arguments[0]:
null;N(this,b);var d=P(this,(b.__proto__||Object.getPrototypeOf(b)).call(this));d._type=b.TYPE();d._initMetadata();d._dimensionsWorldLUT={};d._dimensionsVoxelLUT={};d._initData(a);return d}M(b,c);O(b,[{key:"_buildMetadataSchema",value:function(){return ea.object({ncpp:ea.number().integer().min(1).required(),dimensions:ea.array().min(3).max(4).items(ea.object({length:ea.number().integer().min(1).required(),widthDimension:ea.number().integer().min(-1).max(2).required(),heightDimension:ea.number().integer().min(-1).max(2).required(),
nameVoxelSpace:ea.string().regex(/(i|j|k|t)/).required(),nameWorldSpace:ea.string().regex(/(x|y|z|t)/).required(),worldUnitSize:ea.number().required(),stride:ea.number().integer().min(1).required(),step:ea.number().required()}).unknown()),statistics:ea.object({upToDate:ea.boolean().required(),min:ea.number().required(),max:ea.number().required()}).required().unknown(),transformations:ea.object().unknown().pattern(/.+/,ea.array().length(16).items(ea.number())).required(),description:ea.string().allow(""),
spatialUnit:ea.string().allow(""),temporalUnit:ea.string().allow(""),format:ea.string().allow(""),formatSpecific:ea.object().unknown()}).unknown()}},{key:"_metadataRawCopied",value:function(){this._buildDimensionsLUT()}},{key:"_buildDimensionsLUT",value:function(){this._dimensionsWorldLUT={};this._dimensionsVoxelLUT={};var a=["x","y","z"],d=this._metadata.dimensions;this._worldPositionIndex=Array(3);this._worldPositionOrder=Array(3);var b=[0,1,2];this._hasNativeCorrectOrder=!0;for(var c=0;c<d.length;c++){this._dimensionsWorldLUT[d[c].nameWorldSpace]=
c;this._dimensionsVoxelLUT[d[c].nameVoxelSpace]=c;var f=a[c];this._worldPositionIndex[c]=d[0].nameWorldSpace===f?0:d[1].nameWorldSpace===f?1:d[2].nameWorldSpace===f?2:-1;this._worldPositionOrder[c]=a.indexOf(d[c].nameWorldSpace);this._hasNativeCorrectOrder=this._hasNativeCorrectOrder&&this._worldPositionIndex[c]===b[c]}}},{key:"getDimensionIndexFromName",value:function(a){return a in this._dimensionsWorldLUT?this._dimensionsWorldLUT[a]:a in this._dimensionsVoxelLUT?this._dimensionsVoxelLUT[a]:-1}},
{key:"_initMetadata",value:function(){this.setMetadata("description","");this.setMetadata("statistics",{upToDate:!0,min:NaN,max:NaN});this.setMetadata("ncpp",1);this.setMetadata("spatialUnit","Voxel");this.setMetadata("temporalUnit","Time");this.setMetadata("format","generic");this.setMetadata("formatSpecific",{});this.setMetadata("transformations",{})}},{key:"clone",value:function(){var a=new b;a.setRawData(new this._data.constructor(this._data));a.copyMetadataFrom(this);return a}},{key:"setData",
value:function(a,d){this._initData(d,a);this.scanDataRange()}},{key:"_get4x4IdentityMatrix",value:function(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}},{key:"_initData",value:function(a){var d=1<arguments.length&&void 0!==arguments[1]?arguments[1]:null;if(a){"ncpp"in a&&this.setMetadata("ncpp",a.ncpp);if("xSize"in a&&"ySize"in a&&"zSize"in a){var b=[{length:xSize,widthDimension:1,heightDimension:2,nameVoxelSpace:"k",nameWorldSpace:"x",worldUnitSize:1,stride:1},{length:ySize,widthDimension:0,heightDimension:2,
nameVoxelSpace:"j",nameWorldSpace:"y",worldUnitSize:1,stride:xSize},{length:zSize,widthDimension:0,heightDimension:1,nameVoxelSpace:"i",nameWorldSpace:"z",worldUnitSize:1,stride:xSize*ySize}],c=xSize*ySize*zSize*this.getMetadata("ncpp");if("tSize"in a){var f={length:tSize,widthDimension:-1,heightDimension:-1,nameVoxelSpace:"l",worldSpaceName:"t",worldUnitSize:"",stride:xSize*ySize*zSize,step:1},c=c*tSize;b.push(f);this.setMetadata("dimensions",b)}b={v2w:this._get4x4IdentityMatrix(),w2v:this._get4x4IdentityMatrix()};
this.setMetadata("transformations",b);if(d)if(d.length==c)this._data="deepCopy"in a&&a.deepCopy?new d.constructor(d):d;else return console.warn("The buffer provided has a wrong size."),!1;else this._data=new Float32Array(c),d=this.getMetadata("statistics"),d.min=0,d.max=0;this._buildDimensionsLUT();return this.metadataIntegrityCheck()}console.warn("The necessary options xSize, ySize and zSize were not provided.")}return!1}},{key:"scanDataRange",value:function(){for(var a=Infinity,d=-Infinity,b=0;b<
this._data.length;b++)a=Math.min(a,this._data[b]),d=Math.max(d,this._data[b]);b=this.getMetadata("statistics");b||(this.setMetadata("statistics",{}),b=this.getMetadata("statistics"));b.min=a;b.max=d;b.upToDate=!0}},{key:"getMinValue",value:function(){this._metadata.statistics.upToDate||this.scanDataRange();return this._metadata.statistics.min}},{key:"getMaxValue",value:function(){this._metadata.statistics.upToDate||this.scanDataRange();return this._metadata.statistics.max}},{key:"getVoxel",value:function(a){var d=
1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,b=this._metadata.dimensions,c=a.i,f=a.j,k=a.k;return 0>c||0>f||0>k||0>d||c>=b[2].length||f>=b[1].length||k>=b[0].length||3<b.length&&d>=b[3].length?(console.warn("Voxel {i:"+a.i+", j:"+a.j+", k:"+a.k+"} is out of bound."),null):this._data[((3<b.length?d*b[3].stride*d:0)+c*b[2].stride+f*b[1].stride+k*b[0].stride)*this._metadata.ncpp]}},{key:"setVoxel",value:function(a,d){var b=2<arguments.length&&void 0!==arguments[2]?arguments[2]:0,c=this._metadata.dimensions,
f=a.i,k=a.j,l=a.k;if(0>f||0>k||0>l||0>b||f>=c[0].length||k>=c[1].length||l>=c[2].length||3<c.length&&b>=c[3].length)return console.warn("Voxel query is out of bound."),null;this._data[((3<c.length?b*c[3].stride*b:0)+f*c[2].stride+k*c[1].stride+l*c[0].stride)*this._metadata.ncpp]=d;d>this._metadata.statistics.max?this._metadata.statistics.max=d:d<this._metadata.statistics.min&&(this._metadata.statistics.min=d)}},{key:"getVoxelSafe",value:function(a){var d=1<arguments.length&&void 0!==arguments[1]?
arguments[1]:0,b=this._metadata.dimensions,c=a.i,f=a.j,k=a.k;return 0>c||0>f||0>k||0>d||c>=b[0].length||f>=b[1].length||k>=b[2].length||3<b.length&&d>=b[3].length?(console.warn("Voxel query is out of bound."),null):this._data[(3<b.length?d*b[3].stride*d:0)+(0>b[2].step?b[2].length-c-1:c)*b[2].stride+(0>b[1].step?b[1].length-f-1:f)*b[1].stride+(0>b[0].step?b[0].length-k-1:k)*b[0].stride]}},{key:"getDimensionSize",value:function(a){if("string"===typeof a&&(a=this.getDimensionIndexFromName(a),-1==a)){console.warn("dimensions "+
a+" does not exist.");return}var d=this._metadata.dimensions;if(a<d.length)return d[a].length;console.warn("A dimensions of such index does not exist.");return null}},{key:"getData",value:function(){return this._data}},{key:"getDataCopy",value:function(){return new this._data.constructor(this._data)}},{key:"getDataUint8",value:function(){for(var a=this._data,d=this.getMinValue(),b=this.getMaxValue()-d,c=new Uint8Array(a.length),f=0;f<c.length;f++)c[f]=Math.round((a[f]-d)/b*256);return c}},{key:"hasTransform",
value:function(a){return a in this._metadata.transformations}},{key:"_getTransformedPosition",value:function(a,d){var b=this._metadata.transformations;if(!(d in b))return console.warn("No transform named "+d),null;d=b[d];var b=a[0],c=a[1],f=a[2];a=new Na(4);a[0]=b;a[1]=c;a[2]=f;a[3]=1;var b=Ob(),c=a[0],f=a[1],k=a[2];a=a[3];b[0]=d[0]*c+d[4]*f+d[8]*k+d[12]*a;b[1]=d[1]*c+d[5]*f+d[9]*k+d[13]*a;b[2]=d[2]*c+d[6]*f+d[10]*k+d[14]*a;b[3]=d[3]*c+d[7]*f+d[11]*k+d[15]*a;return b}},{key:"getPositionFromVoxelSpaceToTransfoSpace",
value:function(a,d){a=[a.i,a.j,a.k];d=this._getTransformedPosition([a[this._worldPositionOrder[2]],a[this._worldPositionOrder[1]],a[this._worldPositionOrder[0]]],d);return{x:d[0],y:d[1],z:d[2]}}},{key:"getPositionFromTransfoSpaceToVoxelSpace",value:function(a,d){var b=2<arguments.length&&void 0!==arguments[2]?arguments[2]:!0,c=this._getTransformedPosition([a.x,a.y,a.z],d),c={i:c[this._worldPositionOrder[2]],j:c[this._worldPositionOrder[1]],k:c[this._worldPositionOrder[0]]};b&&(c.i=Math.round(c.i),
c.j=Math.round(c.j),c.k=Math.round(c.k));return c}},{key:"getVoxelCoordinatesSwapMatrix",value:function(){var a=0<arguments.length&&void 0!==arguments[0]?arguments[0]:!0,d=1<arguments.length&&void 0!==arguments[1]?arguments[1]:!1,b=Array(9).fill(0);Nb.setValueMatrix33(b,0,this._worldPositionOrder[0],1);Nb.setValueMatrix33(b,1,this._worldPositionOrder[1],1);Nb.setValueMatrix33(b,2,this._worldPositionOrder[2],1);var c=b;if(a)var f=Nb.getHorizontalFlipMatrix33(b),c=f;d&&(c=Nb.getExpandedMatrix3x3To4x4(f),
Nb.setValueMatrix33(c,3,3,1));return c}},{key:"getVoxelTransfoSpace",value:function(a,d){var b=2<arguments.length&&void 0!==arguments[2]?arguments[2]:0,c=this.getPositionFromTransfoSpaceToVoxelSpace(d,a);return this.getVoxel(c,b)}},{key:"setVoxelTransfoSpace",value:function(a,d,b){var c=3<arguments.length&&void 0!==arguments[3]?arguments[3]:0,g=this.getPositionFromTransfoSpaceToVoxelSpace(d,a);this.setVoxel(g,b,c)}},{key:"addTransformation",value:function(a,d){var b=this._metadata.transformations,
c=ea.array().length(16).items(ea.number()),c=ea.validate(a,c);c.error?console.warn("Invalid transformation: "+c.error):b[d]=a}},{key:"getSlice",value:function(a){var d=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,b=2<arguments.length&&void 0!==arguments[2]?arguments[2]:0;if("string"===typeof a&&(a=this.getDimensionIndexFromName(a),-1==a)){console.warn("dimensions "+a+" does not exist.");return}var c=this._metadata.dimensions;if(2<a)return console.warn("The dimension of a slice should be lower than 3."),
null;var f=c[a],k=c[f.widthDimension],l=c[f.heightDimension];if(0>d||d>=f.length)return console.warn("The slice required is out of bound."),null;for(var m=new this._data.constructor(k.length*l.length),b=3<c.length?c[3].stride*b:0,d=(0>f.step?f.length-d-1:d)*f.stride,f=0,c=l.length-1;0<=c;c--)for(var n=(0>l.step?l.length-c-1:c)*l.stride,r=0;r<k.length;r++)m[f]=this._data[d+b+n+(0>k.step?k.length-r-1:r)*k.stride],f++;b=new S;b.setData(m,k.length,l.length,1);return b}},{key:"getSliceSize",value:function(a){if("string"===
typeof a&&(a=this.getDimensionIndexFromName(a),-1==a)){console.warn("dimensions "+a+" does not exist.");return}var d=this._metadata.dimensions;if(2<a)return console.warn("The dimension of a slice should be lower than 3."),null;a=d[a];return{w:d[a.widthDimension].length,h:d[a.heightDimension].length}}},{key:"getNumberOfSlices",value:function(a){if("string"===typeof a&&(a=this.getDimensionIndexFromName(a),-1==a)){console.warn("dimensions "+a+" does not exist.");return}var d=this._metadata.dimensions;
return 2<a?(console.warn("The dimension of a slice should be lower than 3."),null):d[a].length}},{key:"getTimeLength",value:function(){var a=this._metadata.dimensions;return 4==a.length?a[3].length:1}},{key:"isInsideVoxelSpace",value:function(a){var d=this._metadata.dimensions,b=!1;try{b=!(0>a.i||a.i>=d[2].length||0>a.j||a.j>=d[1].length||0>a.k||a.k>=d[0].length)}catch(e){console.warn(e)}return b}},{key:"isInsideTransfoSpace",value:function(a,d){a=this.getPositionFromTransfoSpaceToVoxelSpace(a,d);
return this.isInsideVoxelSpace(a)}},{key:"getSegmentSampleVoxelSpace",value:function(a,d){for(var b=2<arguments.length&&void 0!==arguments[2]?arguments[2]:0,c=d.i-a.i,f=d.j-a.j,k=d.k-a.k,l=Math.sqrt(Math.pow(c,2)+Math.pow(f,2)+Math.pow(k,2)),m=Math.floor(l+1),c=c/l,f=f/l,k=k/l,l=this._metadata.ncpp,n=Array(m).fill(0),r=Array(l).fill(0),v=Array(m).fill(0),q=0;q<l;q++)r[q]=Array(m).fill(0);for(var t=0;t<m;t++){q={i:Math.round(a.i+t*c),j:Math.round(a.j+t*f),k:Math.round(a.k+t*k)};n[t]=q;v[t]="("+q.i+
", "+q.j+", "+q.k+")";for(var F=[this.getVoxel(q,b)],q=0;q<l;q++)r[q][t]=F[q]}return{positions:n,labels:v,colors:r}}},{key:"getSegmentSampleTransfoSpace",value:function(a,d,b,c){var g=4<arguments.length&&void 0!==arguments[4]?arguments[4]:0;if(!this.hasTransform(a))return console.warn("The transform "+a+" is not available."),null;var e=this.getPositionFromTransfoSpaceToVoxelSpace(b,a,!1),l=this.getPositionFromTransfoSpaceToVoxelSpace(c,a,!1);console.log("voxelFrom {"+e.i+", "+e.j+", "+e.k+"} voxelTo {"+
l.i+", "+l.j+", "+l.k+"}");g=this.getSegmentSampleVoxelSpace(e,l,g);if(!g)return null;for(e=0;e<g.positions.length;e++)l=this.getPositionFromVoxelSpaceToTransfoSpace(g.positions[e],d),g.positions[e]=l,g.labels[e]="("+Math.round(100*l.x)/100+", "+Math.round(100*l.y)/100+", "+Math.round(100*l.z)/100+")";return g}},{key:"getVoxelBox",value:function(){return{min:{i:0,j:0,k:0,t:0},max:{i:this.getDimensionSize("i"),j:this.getDimensionSize("j"),k:this.getDimensionSize("k"),t:this.getDimensionSize("t")}}}},
{key:"getTransfoVolumeCorners",value:function(a){return this.hasTransform(a)?[this.getPositionFromVoxelSpaceToTransfoSpace({i:0,j:0,k:0},a),this.getPositionFromVoxelSpaceToTransfoSpace({i:this.getDimensionSize("i")-1,j:0,k:0},a),this.getPositionFromVoxelSpaceToTransfoSpace({i:this.getDimensionSize("i")-1,j:this.getDimensionSize("j")-1,k:0},a),this.getPositionFromVoxelSpaceToTransfoSpace({i:0,j:this.getDimensionSize("j")-1,k:0},a),this.getPositionFromVoxelSpaceToTransfoSpace({i:0,j:0,k:this.getDimensionSize("j")-
1},a),this.getPositionFromVoxelSpaceToTransfoSpace({i:this.getDimensionSize("i")-1,j:0,k:this.getDimensionSize("k")-1},a),this.getPositionFromVoxelSpaceToTransfoSpace({i:this.getDimensionSize("i")-1,j:this.getDimensionSize("j")-1,k:this.getDimensionSize("k")-1},a),this.getPositionFromVoxelSpaceToTransfoSpace({i:0,j:this.getDimensionSize("j")-1,k:this.getDimensionSize("k")-1},a)]:(console.warn("The transform "+a+" is not available."),null)}},{key:"getTransfoBox",value:function(a){if(!this.hasTransform(space2voxelTransformName))return console.warn("The transform "+
a+" is not available."),null;a=this.getTransfoVolumeCorners();for(var d=Infinity,b=Infinity,c=Infinity,f=-Infinity,k=-Infinity,l=-Infinity,m=0;m<a.length;m++)d=Math.min(d,a[m].x),b=Math.min(b,a[m].y),c=Math.min(c,a[m].z),f=Math.max(f,a[m].x),k=Math.max(k,a[m].y),l=Math.max(l,a[m].z);return{min:{x:d,y:b,z:c,t:0},max:{x:f,y:k,z:l,t:this.getDimensionSize("t")}}}}],[{key:"TYPE",value:function(){return"IMAGE3DALT"}}]);return b}(cc);cb.addCoreType(dc);var me=function(c){function b(){N(this,b);var a=P(this,
(b.__proto__||Object.getPrototypeOf(b)).call(this));a._type=b.TYPE();a.setMetadata("verticesPerShapes",3);a.setMetadata("componentsPerColor",4);var d=a.getMetadata("mandatoryDataset");a._datasetNames={vertexPositions:"vertexPositions",polygonFaces:"polygonFaces",polygonNormals:"polygonNormals",vertexColors:"vertexColors"};d.push(a._datasetNames.vertexPositions);d.push(a._datasetNames.polygonFaces);d.push(a._datasetNames.polygonNormals);return a}M(b,c);O(b,[{key:"setVertexPositions",value:function(a){0!==
a.length%3?console.warn("The array of vertex positions has a non-multiple-of-three size."):this.setRawData(a,this._datasetNames.vertexPositions)}},{key:"getVertexPositions",value:function(){return this.getData(this._datasetNames.vertexPositions)}},{key:"getVertexPositionCopy",value:function(){return this.getDataCopy(this._datasetNames.vertexPositions)}},{key:"setPolygonFacesOrder",value:function(a){0!==a.length%this.getMetadata("verticesPerShapes")?console.warn("The array of vertext positions must have a size that is a multiple of the metadata 'verticesPerShapes'."):
this.setRawData(a,this._datasetNames.polygonFaces)}},{key:"getPolygonFacesOrder",value:function(){return this.getData(this._datasetNames.polygonFaces)}},{key:"getPolygonFacesOrderCopy",value:function(){return this.getDataCopy(this._datasetNames.polygonFaces)}},{key:"setPolygonFacesNormals",value:function(a){0!==a.length%3?console.warn("The array of vertext positions must have a size that is a multiple of 3."):this.setRawData(a,this._datasetNames.polygonNormals)}},{key:"getPolygonFacesNormals",value:function(){return this.getData(this._datasetNames.polygonNormals)}},
{key:"getPolygonFacesNormalsCopy",value:function(){return this.getDataCopy(this._datasetNames.polygonNormals)}},{key:"setVertexColors",value:function(a){0!==a.length%this.getMetadata("componentsPerColor")?console.warn("The array of vertext positions must have a size that is a multiple of the metadata 'componentsPerColor'."):this.setRawData(a,this._datasetNames.vertexColors)}},{key:"getVertexColors",value:function(){return this.getData(this._datasetNames.vertexColors)}},{key:"getVertexColorsCopy",
value:function(){return this.getDataCopy(this._datasetNames.vertexColors)}},{key:"getNumberOfVerticesPerShapes",value:function(){return this.getMetadata("verticesPerShapes")}},{key:"setNumberOfVerticesPerShapes",value:function(a){0>a&&console.warn("The number of vertice per shapes should be positive.");this.setMetadata("verticesPerShapes",a)}},{key:"getNumberOfComponentsPerColor",value:function(){return this.getMetadata("componentsPerColor")}},{key:"setNumberOfComponentsPerColor",value:function(a){0>
a&&console.warn("The number of components per pixel should be positive.");this.setMetadata("componentsPerColor",a)}},{key:"getNumberOfVertices",value:function(){var a=this.getVertexPositions();return a?a.length/3:null}},{key:"generateUniformVertexColor",value:function(a){}},{key:"generateFacesNormalsVectors",value:function(){}}],[{key:"TYPE",value:function(){return"MESH3D"}}]);return b}(function(c){function b(){N(this,b);var a=P(this,(b.__proto__||Object.getPrototypeOf(b)).call(this));a._data=[];
a.setMetadata("dataIndex",{});a.setMetadata("mandatoryDataset",[]);return a}M(b,c);O(b,[{key:"getData",value:function(a){a=this.getDataIndex(a);return-1!==a?this._data[a]:null}},{key:"getDataCopy",value:function(a){return(a=this.getData(a))?new a.constructor(a):null}},{key:"getDataIndex",value:function(a){var d=-1,b=this._metadata.dataIndex;a in b&&(d=b[a]);return d}},{key:"doesDataExist",value:function(a){return-1!==this.getDataIndex(a)}},{key:"setRawData",value:function(a,d){if(a){var b=this.getDataIndex(d),
c=this._metadata.dataIndex;-1!==b?this._data[b]=a:(b=this._data.length,this._data.push(a),c[d]=b)}else console.warn("Cannot add null as a dataset.")}},{key:"checkIntegrity",value:function(){for(var a=!0,d=this.getMetadata("mandatoryDataset"),b=0;b<d.length;b++){var c=this.doesDataExist(d[b]),a=a&&c;c||console.warn("The sub-data of name: "+d[b]+" is missing")}return a}},{key:"clone",value:function(){var a=this.getMetadataClone();if(!a)return console.warn("The metadata object is invalid, cloning is impossible."),
null;var d=this._metadata.dataIndex,b=new this.constructor;b.setRawMetadata(a);for(var c in d)b.setRawData(this.getDataCopy(c),c);return b}}]);return b}(cc));cb.addCoreType(me);var cj=function(c){function b(){N(this,b);var a=P(this,(b.__proto__||Object.getPrototypeOf(b)).call(this));a.addInputValidator(0,S);a.setMetadata("alpha",!1);a.setMetadata("min",0);a.setMetadata("max",255);a.setMetadata("reset",!0);a._canvas=null;a._ctx=null;return a}M(b,c);O(b,[{key:"getCanvas",value:function(){return this._canvas}},
{key:"_init",value:function(){var a=document.getElementById(this.getMetadata("parentDivID"));if(!a)return!1;if(this.getMetadata("reset"))for(;a.firstChild;)a.removeChild(a.firstChild);this._canvas=document.createElement("canvas");this._canvas.style="image-rendering: pixelated;";this._ctx=this._canvas.getContext("2d");this._ctx.imageSmoothingEnabled=!1;this._ctx.mozImageSmoothingEnabled=!1;this._ctx.webkitImageSmoothingEnabled=!1;this._ctx.ctxmsImageSmoothingEnabled=!1;document.getElementById(this.getMetadata("parentDivID")).appendChild(this._canvas);
return!0}},{key:"_run",value:function(){if(this.hasValidInput()){var a=this._input[0],d=a.getComponentsPerPixel();if(1!=d&&3!=d&&4!=d)console.warn("Cannot write Image in canvas if contains other than 1, 3 or 4 bands.");else if(this.getMetadata("parentDivID"))if(this._init()){var b=this.getMetadata("alpha");this._canvas.width=a.getWidth();this._canvas.height=a.getHeight();var c=this._ctx.getImageData(0,0,this._canvas.width,this._canvas.height),f=c.data,a=a.getData();if(4==d)for(d=0;d<a.length;d++)f[d]=
b||3!=d%4?this._stretchMinMax(a[d]):255;else if(1==d)for(d=0;d<a.length;d++){var b=4*d,k=this._stretchMinMax(a[d]);f[b]=k;f[b+1]=k;f[b+2]=k;f[b+3]=255}else if(3==d)for(d=b=0;d<f.length;d++)3==d%4?f[d]=255:(f[d]=this._stretchMinMax(a[b]),b++);this._ctx.putImageData(c,0,0)}else console.warn("The parent div was not specified or does not exist.");else console.error("The parent DIV ID to place the canvas element was not specified. Unable to display anything.")}}},{key:"_stretchMinMax",value:function(a){var d=
this._metadata.min,b=this._metadata.max;return 0==d&&255==b?a:(a-d)/(b-d)*255}}]);return b}(V),dj=function(c){function b(a){N(this,b);a=P(this,(b.__proto__||Object.getPrototypeOf(b)).call(this));a._loadedCounter=0;a._addOutput(S,0);return a}M(b,c);O(b,[{key:"_run",value:function(){var a=this;this.getInputCategories().forEach(function(d){a._addOutput(S,d);a._loadImage(d)})}},{key:"_loadImage",value:function(a){var d=this,b=new Image;b.src=this._getInput(a);b.onload=function(){var c=document.createElement("canvas");
c.width=b.width;c.height=b.height;var g=c.getContext("2d");g.drawImage(b,0,0);try{var k=g.getImageData(0,0,c.width,c.height),l=new Float32Array(k.data);d.getOutput(a).setData(l,b.width,b.height);d._loadedCounter++;d._loadedCounter==d.getNumberOfInputs()&&d.triggerEvent("ready")}catch(m){console.error(m)}}}}]);return b}(V),ej=function(c){function b(){N(this,b);var a=P(this,(b.__proto__||Object.getPrototypeOf(b)).call(this));a._allowedTypes=/image.*/;return a}M(b,c);O(b,[{key:"hasValidInput",value:function(){var a=
!1,d=this._getInput();d&&d.type.match(this._allowedTypes)?a=!0:console.error("The file must be an image (jpg/png). The type "+d.type+" is not compatible with FileImageReader.");return a}},{key:"_run",value:function(){if(this.hasValidInput()){var a=this,d=this._getInput(),b=new FileReader;b.onload=function(d){var c=new Image;c.onload=function(){var d=document.createElement("canvas");d.width=c.width;d.height=c.height;d=d.getContext("2d");d.drawImage(c,0,0);d=d.getImageData(0,0,c.width,c.height).data;
a._addOutput(S,0).setData(d,c.width,c.height);a.triggerEvent("ready")};c.src=b.result};b.readAsDataURL(d)}}}]);return b}(V),Ma="undefined"!==typeof global?global:"undefined"!==typeof self?self:"undefined"!==typeof window?window:{},ib=Sc,jb=Fe;"function"===typeof Ma.setTimeout&&(ib=setTimeout);"function"===typeof Ma.clearTimeout&&(jb=clearTimeout);var Ya=[],Pb=!1,wb,Tc=-1;Ie.prototype.run=function(){this.fun.apply(null,this.array)};var ec=Ma.performance||{},fj=ec.now||ec.mozNow||ec.msNow||ec.oNow||
ec.webkitNow||function(){return(new Date).getTime()},gj=new Date,fc={nextTick:function(c){var b=Array(arguments.length-1);if(1<arguments.length)for(var a=1;a<arguments.length;a++)b[a-1]=arguments[a];Ya.push(new Ie(c,b));1!==Ya.length||Pb||Ge(He)},title:"browser",browser:!0,env:{},argv:[],version:"",versions:{},on:xb,addListener:xb,once:xb,off:xb,removeListener:xb,removeAllListeners:xb,emit:xb,binding:function(c){throw Error("process.binding is not supported");},cwd:function(){return"/"},chdir:function(c){throw Error("process.chdir is not supported");
},umask:function(){return 0},hrtime:function(c){var b=.001*fj.call(ec),a=Math.floor(b),b=Math.floor(b%1*1E9);c&&(a-=c[0],b-=c[1],0>b&&(a--,b+=1E9));return[a,b]},platform:"browser",release:{},config:{},uptime:function(){return(new Date-gj)/1E3}},ch={},dh=Object.freeze({default:ch}),Oa=[],Fa=[],ji="undefined"!==typeof Uint8Array?Uint8Array:Array,Bd=!1,hj={}.toString,Pe=Array.isArray||function(c){return"[object Array]"==hj.call(c)};z.TYPED_ARRAY_SUPPORT=void 0!==Ma.TYPED_ARRAY_SUPPORT?Ma.TYPED_ARRAY_SUPPORT:
!0;var ij=z.TYPED_ARRAY_SUPPORT?2147483647:1073741823;z.poolSize=8192;z._augment=function(c){c.__proto__=z.prototype;return c};z.from=function(c,b,a){return Me(null,c,b,a)};z.TYPED_ARRAY_SUPPORT&&(z.prototype.__proto__=Uint8Array.prototype,z.__proto__=Uint8Array);z.alloc=function(c,b,a){Oe(c);c=0>=c?Za(null,c):void 0!==b?"string"===typeof a?Za(null,c).fill(b,a):Za(null,c).fill(b):Za(null,c);return c};z.allocUnsafe=function(c){return Cd(null,c)};z.allocUnsafeSlow=function(c){return Cd(null,c)};z.isBuffer=
Ze;z.compare=function(c,b){if(!Pa(c)||!Pa(b))throw new TypeError("Arguments must be Buffers");if(c===b)return 0;for(var a=c.length,d=b.length,g=0,e=Math.min(a,d);g<e;++g)if(c[g]!==b[g]){a=c[g];d=b[g];break}return a<d?-1:d<a?1:0};z.isEncoding=function(c){switch(String(c).toLowerCase()){case "hex":case "utf8":case "utf-8":case "ascii":case "latin1":case "binary":case "base64":case "ucs2":case "ucs-2":case "utf16le":case "utf-16le":return!0;default:return!1}};z.concat=function(c,b){if(!Pe(c))throw new TypeError('"list" argument must be an Array of Buffers');
if(0===c.length)return z.alloc(0);var a;if(void 0===b)for(a=b=0;a<c.length;++a)b+=c[a].length;b=z.allocUnsafe(b);var d=0;for(a=0;a<c.length;++a){var g=c[a];if(!Pa(g))throw new TypeError('"list" argument must be an Array of Buffers');g.copy(b,d);d+=g.length}return b};z.byteLength=Ne;z.prototype._isBuffer=!0;z.prototype.swap16=function(){var c=this.length;if(0!==c%2)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var b=0;b<c;b+=2)yb(this,b,b+1);return this};z.prototype.swap32=
function(){var c=this.length;if(0!==c%4)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var b=0;b<c;b+=4)yb(this,b,b+3),yb(this,b+1,b+2);return this};z.prototype.swap64=function(){var c=this.length;if(0!==c%8)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var b=0;b<c;b+=8)yb(this,b,b+7),yb(this,b+1,b+6),yb(this,b+2,b+5),yb(this,b+3,b+4);return this};z.prototype.toString=function(){var c=this.length|0;return 0===c?"":0===arguments.length?Re(this,0,c):hi.apply(this,
arguments)};z.prototype.equals=function(c){if(!Pa(c))throw new TypeError("Argument must be a Buffer");return this===c?!0:0===z.compare(this,c)};z.prototype.inspect=function(){var c="";0<this.length&&(c=this.toString("hex",0,50).match(/.{2}/g).join(" "),50<this.length&&(c+=" ... "));return"<Buffer "+c+">"};z.prototype.compare=function(c,b,a,d,g){if(!Pa(c))throw new TypeError("Argument must be a Buffer");void 0===b&&(b=0);void 0===a&&(a=c?c.length:0);void 0===d&&(d=0);void 0===g&&(g=this.length);if(0>
b||a>c.length||0>d||g>this.length)throw new RangeError("out of range index");if(d>=g&&b>=a)return 0;if(d>=g)return-1;if(b>=a)return 1;b>>>=0;a>>>=0;d>>>=0;g>>>=0;if(this===c)return 0;var e=g-d,f=a-b,k=Math.min(e,f);d=this.slice(d,g);c=c.slice(b,a);for(b=0;b<k;++b)if(d[b]!==c[b]){e=d[b];f=c[b];break}return e<f?-1:f<e?1:0};z.prototype.includes=function(c,b,a){return-1!==this.indexOf(c,b,a)};z.prototype.indexOf=function(c,b,a){return Se(this,c,b,a,!0)};z.prototype.lastIndexOf=function(c,b,a){return Se(this,
c,b,a,!1)};z.prototype.write=function(c,b,a,d){if(void 0===b)d="utf8",a=this.length,b=0;else if(void 0===a&&"string"===typeof b)d=b,a=this.length,b=0;else if(isFinite(b))b|=0,isFinite(a)?(a|=0,void 0===d&&(d="utf8")):(d=a,a=void 0);else throw Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");var g=this.length-b;if(void 0===a||a>g)a=g;if(0<c.length&&(0>a||0>b)||b>this.length)throw new RangeError("Attempt to write outside buffer bounds");d||(d="utf8");for(g=!1;;)switch(d){case "hex":a:{b=
Number(b)||0;d=this.length-b;a?(a=Number(a),a>d&&(a=d)):a=d;d=c.length;if(0!==d%2)throw new TypeError("Invalid hex string");a>d/2&&(a=d/2);for(d=0;d<a;++d){g=parseInt(c.substr(2*d,2),16);if(isNaN(g)){c=d;break a}this[b+d]=g}c=d}return c;case "utf8":case "utf-8":return kc(Vc(c,this.length-b),this,b,a);case "ascii":return kc(Ye(c),this,b,a);case "latin1":case "binary":return kc(Ye(c),this,b,a);case "base64":return kc(Qe(c),this,b,a);case "ucs2":case "ucs-2":case "utf16le":case "utf-16le":var e;d=c;
for(var g=this.length-b,f=[],k=0;k<d.length&&!(0>(g-=2));++k)e=d.charCodeAt(k),c=e>>8,e%=256,f.push(e),f.push(c);return kc(f,this,b,a);default:if(g)throw new TypeError("Unknown encoding: "+d);d=(""+d).toLowerCase();g=!0}};z.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var Ue=4096;z.prototype.slice=function(c,b){var a=this.length;c=~~c;b=void 0===b?a:~~b;0>c?(c+=a,0>c&&(c=0)):c>a&&(c=a);0>b?(b+=a,0>b&&(b=0)):b>a&&(b=a);b<c&&(b=c);if(z.TYPED_ARRAY_SUPPORT)b=
this.subarray(c,b),b.__proto__=z.prototype;else{a=b-c;b=new z(a,void 0);for(var d=0;d<a;++d)b[d]=this[d+c]}return b};z.prototype.readUIntLE=function(c,b,a){c|=0;b|=0;a||ha(c,b,this.length);a=this[c];for(var d=1,g=0;++g<b&&(d*=256);)a+=this[c+g]*d;return a};z.prototype.readUIntBE=function(c,b,a){c|=0;b|=0;a||ha(c,b,this.length);a=this[c+--b];for(var d=1;0<b&&(d*=256);)a+=this[c+--b]*d;return a};z.prototype.readUInt8=function(c,b){b||ha(c,1,this.length);return this[c]};z.prototype.readUInt16LE=function(c,
b){b||ha(c,2,this.length);return this[c]|this[c+1]<<8};z.prototype.readUInt16BE=function(c,b){b||ha(c,2,this.length);return this[c]<<8|this[c+1]};z.prototype.readUInt32LE=function(c,b){b||ha(c,4,this.length);return(this[c]|this[c+1]<<8|this[c+2]<<16)+16777216*this[c+3]};z.prototype.readUInt32BE=function(c,b){b||ha(c,4,this.length);return 16777216*this[c]+(this[c+1]<<16|this[c+2]<<8|this[c+3])};z.prototype.readIntLE=function(c,b,a){c|=0;b|=0;a||ha(c,b,this.length);a=this[c];for(var d=1,g=0;++g<b&&
(d*=256);)a+=this[c+g]*d;a>=128*d&&(a-=Math.pow(2,8*b));return a};z.prototype.readIntBE=function(c,b,a){c|=0;b|=0;a||ha(c,b,this.length);a=b;for(var d=1,g=this[c+--a];0<a&&(d*=256);)g+=this[c+--a]*d;g>=128*d&&(g-=Math.pow(2,8*b));return g};z.prototype.readInt8=function(c,b){b||ha(c,1,this.length);return this[c]&128?-1*(255-this[c]+1):this[c]};z.prototype.readInt16LE=function(c,b){b||ha(c,2,this.length);c=this[c]|this[c+1]<<8;return c&32768?c|4294901760:c};z.prototype.readInt16BE=function(c,b){b||
ha(c,2,this.length);c=this[c+1]|this[c]<<8;return c&32768?c|4294901760:c};z.prototype.readInt32LE=function(c,b){b||ha(c,4,this.length);return this[c]|this[c+1]<<8|this[c+2]<<16|this[c+3]<<24};z.prototype.readInt32BE=function(c,b){b||ha(c,4,this.length);return this[c]<<24|this[c+1]<<16|this[c+2]<<8|this[c+3]};z.prototype.readFloatLE=function(c,b){b||ha(c,4,this.length);return Uc(this,c,!0,23,4)};z.prototype.readFloatBE=function(c,b){b||ha(c,4,this.length);return Uc(this,c,!1,23,4)};z.prototype.readDoubleLE=
function(c,b){b||ha(c,8,this.length);return Uc(this,c,!0,52,8)};z.prototype.readDoubleBE=function(c,b){b||ha(c,8,this.length);return Uc(this,c,!1,52,8)};z.prototype.writeUIntLE=function(c,b,a,d){c=+c;b|=0;a|=0;d||ua(this,c,b,a,Math.pow(2,8*a)-1,0);d=1;var g=0;for(this[b]=c&255;++g<a&&(d*=256);)this[b+g]=c/d&255;return b+a};z.prototype.writeUIntBE=function(c,b,a,d){c=+c;b|=0;a|=0;d||ua(this,c,b,a,Math.pow(2,8*a)-1,0);d=a-1;var g=1;for(this[b+d]=c&255;0<=--d&&(g*=256);)this[b+d]=c/g&255;return b+a};
z.prototype.writeUInt8=function(c,b,a){c=+c;b|=0;a||ua(this,c,b,1,255,0);z.TYPED_ARRAY_SUPPORT||(c=Math.floor(c));this[b]=c&255;return b+1};z.prototype.writeUInt16LE=function(c,b,a){c=+c;b|=0;a||ua(this,c,b,2,65535,0);z.TYPED_ARRAY_SUPPORT?(this[b]=c&255,this[b+1]=c>>>8):Wc(this,c,b,!0);return b+2};z.prototype.writeUInt16BE=function(c,b,a){c=+c;b|=0;a||ua(this,c,b,2,65535,0);z.TYPED_ARRAY_SUPPORT?(this[b]=c>>>8,this[b+1]=c&255):Wc(this,c,b,!1);return b+2};z.prototype.writeUInt32LE=function(c,b,a){c=
+c;b|=0;a||ua(this,c,b,4,4294967295,0);z.TYPED_ARRAY_SUPPORT?(this[b+3]=c>>>24,this[b+2]=c>>>16,this[b+1]=c>>>8,this[b]=c&255):Xc(this,c,b,!0);return b+4};z.prototype.writeUInt32BE=function(c,b,a){c=+c;b|=0;a||ua(this,c,b,4,4294967295,0);z.TYPED_ARRAY_SUPPORT?(this[b]=c>>>24,this[b+1]=c>>>16,this[b+2]=c>>>8,this[b+3]=c&255):Xc(this,c,b,!1);return b+4};z.prototype.writeIntLE=function(c,b,a,d){c=+c;b|=0;d||(d=Math.pow(2,8*a-1),ua(this,c,b,a,d-1,-d));d=0;var g=1,e=0;for(this[b]=c&255;++d<a&&(g*=256);)0>
c&&0===e&&0!==this[b+d-1]&&(e=1),this[b+d]=(c/g>>0)-e&255;return b+a};z.prototype.writeIntBE=function(c,b,a,d){c=+c;b|=0;d||(d=Math.pow(2,8*a-1),ua(this,c,b,a,d-1,-d));d=a-1;var g=1,e=0;for(this[b+d]=c&255;0<=--d&&(g*=256);)0>c&&0===e&&0!==this[b+d+1]&&(e=1),this[b+d]=(c/g>>0)-e&255;return b+a};z.prototype.writeInt8=function(c,b,a){c=+c;b|=0;a||ua(this,c,b,1,127,-128);z.TYPED_ARRAY_SUPPORT||(c=Math.floor(c));0>c&&(c=255+c+1);this[b]=c&255;return b+1};z.prototype.writeInt16LE=function(c,b,a){c=+c;
b|=0;a||ua(this,c,b,2,32767,-32768);z.TYPED_ARRAY_SUPPORT?(this[b]=c&255,this[b+1]=c>>>8):Wc(this,c,b,!0);return b+2};z.prototype.writeInt16BE=function(c,b,a){c=+c;b|=0;a||ua(this,c,b,2,32767,-32768);z.TYPED_ARRAY_SUPPORT?(this[b]=c>>>8,this[b+1]=c&255):Wc(this,c,b,!1);return b+2};z.prototype.writeInt32LE=function(c,b,a){c=+c;b|=0;a||ua(this,c,b,4,2147483647,-2147483648);z.TYPED_ARRAY_SUPPORT?(this[b]=c&255,this[b+1]=c>>>8,this[b+2]=c>>>16,this[b+3]=c>>>24):Xc(this,c,b,!0);return b+4};z.prototype.writeInt32BE=
function(c,b,a){c=+c;b|=0;a||ua(this,c,b,4,2147483647,-2147483648);0>c&&(c=4294967295+c+1);z.TYPED_ARRAY_SUPPORT?(this[b]=c>>>24,this[b+1]=c>>>16,this[b+2]=c>>>8,this[b+3]=c&255):Xc(this,c,b,!1);return b+4};z.prototype.writeFloatLE=function(c,b,a){return We(this,c,b,!0,a)};z.prototype.writeFloatBE=function(c,b,a){return We(this,c,b,!1,a)};z.prototype.writeDoubleLE=function(c,b,a){return Xe(this,c,b,!0,a)};z.prototype.writeDoubleBE=function(c,b,a){return Xe(this,c,b,!1,a)};z.prototype.copy=function(c,
b,a,d){a||(a=0);d||0===d||(d=this.length);b>=c.length&&(b=c.length);b||(b=0);0<d&&d<a&&(d=a);if(d===a||0===c.length||0===this.length)return 0;if(0>b)throw new RangeError("targetStart out of bounds");if(0>a||a>=this.length)throw new RangeError("sourceStart out of bounds");if(0>d)throw new RangeError("sourceEnd out of bounds");d>this.length&&(d=this.length);c.length-b<d-a&&(d=c.length-b+a);var g=d-a;if(this===c&&a<b&&b<d)for(d=g-1;0<=d;--d)c[d+b]=this[d+a];else if(1E3>g||!z.TYPED_ARRAY_SUPPORT)for(d=
0;d<g;++d)c[d+b]=this[d+a];else Uint8Array.prototype.set.call(c,this.subarray(a,a+g),b);return g};z.prototype.fill=function(c,b,a,d){if("string"===typeof c){"string"===typeof b?(d=b,b=0,a=this.length):"string"===typeof a&&(d=a,a=this.length);if(1===c.length){var g=c.charCodeAt(0);256>g&&(c=g)}if(void 0!==d&&"string"!==typeof d)throw new TypeError("encoding must be a string");if("string"===typeof d&&!z.isEncoding(d))throw new TypeError("Unknown encoding: "+d);}else"number"===typeof c&&(c&=255);if(0>
b||this.length<b||this.length<a)throw new RangeError("Out of range index");if(a<=b)return this;b>>>=0;a=void 0===a?this.length:a>>>0;c||(c=0);if("number"===typeof c)for(d=b;d<a;++d)this[d]=c;else for(c=Pa(c)?c:Vc((new z(c,d)).toString()),g=c.length,d=0;d<a-b;++d)this[d+b]=c[d%g];return this};var ii=/[^+\/0-9A-Za-z-_]/g,jj=Object.freeze({INSPECT_MAX_BYTES:50,kMaxLength:ij,Buffer:z,SlowBuffer:function(c){+c!=c&&(c=0);return z.alloc(+c)},isBuffer:Ze}),eh=dh&&ch||dh,qd=qa(function(c){(function(){function b(a){a?
(n[0]=n[16]=n[1]=n[2]=n[3]=n[4]=n[5]=n[6]=n[7]=n[8]=n[9]=n[10]=n[11]=n[12]=n[13]=n[14]=n[15]=0,this.blocks=n,this.buffer8=r):e?(a=new ArrayBuffer(68),this.buffer8=new Uint8Array(a),this.blocks=new Uint32Array(a)):this.blocks=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];this.h0=this.h1=this.h2=this.h3=this.start=this.bytes=0;this.finalized=this.hashed=!1;this.first=!0}var a="object"===("undefined"===typeof window?"undefined":H(window))?window:{},d=!a.JS_MD5_NO_NODE_JS&&"object"===("undefined"===typeof fc?"undefined":
H(fc))&&fc.versions&&fc.versions.node;d&&(a=Mb);var g=!a.JS_MD5_NO_COMMON_JS&&!0&&c.exports,e=!a.JS_MD5_NO_ARRAY_BUFFER&&"undefined"!==typeof ArrayBuffer,f="0123456789abcdef".split(""),k=[128,32768,8388608,-2147483648],l=[0,8,16,24],m=["hex","array","digest","buffer","arrayBuffer"],n=[],r;if(e){var v=new ArrayBuffer(68);r=new Uint8Array(v);n=new Uint32Array(v)}var q=function(a){return function(d){return(new b(!0)).update(d)[a]()}},t=function(a){var d=jj.Buffer;return function(b){if("string"===typeof b)return eh.createHash("md5").update(b,
"utf8").digest("hex");if(b.constructor===ArrayBuffer)b=new Uint8Array(b);else if(void 0===b.length)return a(b);return eh.createHash("md5").update(new d(b)).digest("hex")}};b.prototype.update=function(d){if(!this.finalized){var b="string"!=typeof d;b&&d.constructor==a.ArrayBuffer&&(d=new Uint8Array(d));for(var c,g=0,f,k=d.length||0,m=this.blocks,n=this.buffer8;g<k;){this.hashed&&(this.hashed=!1,m[0]=m[16],m[16]=m[1]=m[2]=m[3]=m[4]=m[5]=m[6]=m[7]=m[8]=m[9]=m[10]=m[11]=m[12]=m[13]=m[14]=m[15]=0);if(b)if(e)for(f=
this.start;g<k&&64>f;++g)n[f++]=d[g];else for(f=this.start;g<k&&64>f;++g)m[f>>2]|=d[g]<<l[f++&3];else if(e)for(f=this.start;g<k&&64>f;++g)c=d.charCodeAt(g),128>c?n[f++]=c:(2048>c?n[f++]=192|c>>6:(55296>c||57344<=c?n[f++]=224|c>>12:(c=65536+((c&1023)<<10|d.charCodeAt(++g)&1023),n[f++]=240|c>>18,n[f++]=128|c>>12&63),n[f++]=128|c>>6&63),n[f++]=128|c&63);else for(f=this.start;g<k&&64>f;++g)c=d.charCodeAt(g),128>c?m[f>>2]|=c<<l[f++&3]:(2048>c?m[f>>2]|=(192|c>>6)<<l[f++&3]:(55296>c||57344<=c?m[f>>2]|=(224|
c>>12)<<l[f++&3]:(c=65536+((c&1023)<<10|d.charCodeAt(++g)&1023),m[f>>2]|=(240|c>>18)<<l[f++&3],m[f>>2]|=(128|c>>12&63)<<l[f++&3]),m[f>>2]|=(128|c>>6&63)<<l[f++&3]),m[f>>2]|=(128|c&63)<<l[f++&3]);this.lastByteIndex=f;this.bytes+=f-this.start;64<=f?(this.start=f-64,this.hash(),this.hashed=!0):this.start=f}return this}};b.prototype.finalize=function(){if(!this.finalized){this.finalized=!0;var a=this.blocks,d=this.lastByteIndex;a[d>>2]|=k[d&3];56<=d&&(this.hashed||this.hash(),a[0]=a[16],a[16]=a[1]=a[2]=
a[3]=a[4]=a[5]=a[6]=a[7]=a[8]=a[9]=a[10]=a[11]=a[12]=a[13]=a[14]=a[15]=0);a[14]=this.bytes<<3;this.hash()}};b.prototype.hash=function(){var a,d,b,c,g,e=this.blocks;this.first?(a=e[0]-680876937,a=(a<<7|a>>>25)-271733879<<0,c=(-1732584194^a&2004318071)+e[1]-117830708,c=(c<<12|c>>>20)+a<<0,b=(-271733879^c&(a^-271733879))+e[2]-1126478375,b=(b<<17|b>>>15)+c<<0,d=(a^b&(c^a))+e[3]-1316259209):(a=this.h0,d=this.h1,b=this.h2,c=this.h3,a+=(c^d&(b^c))+e[0]-680876936,a=(a<<7|a>>>25)+d<<0,c+=(b^a&(d^b))+e[1]-
389564586,c=(c<<12|c>>>20)+a<<0,b+=(d^c&(a^d))+e[2]+606105819,b=(b<<17|b>>>15)+c<<0,d+=(a^b&(c^a))+e[3]-1044525330);d=(d<<22|d>>>10)+b<<0;a+=(c^d&(b^c))+e[4]-176418897;a=(a<<7|a>>>25)+d<<0;c+=(b^a&(d^b))+e[5]+1200080426;c=(c<<12|c>>>20)+a<<0;b+=(d^c&(a^d))+e[6]-1473231341;b=(b<<17|b>>>15)+c<<0;d+=(a^b&(c^a))+e[7]-45705983;d=(d<<22|d>>>10)+b<<0;a+=(c^d&(b^c))+e[8]+1770035416;a=(a<<7|a>>>25)+d<<0;c+=(b^a&(d^b))+e[9]-1958414417;c=(c<<12|c>>>20)+a<<0;b+=(d^c&(a^d))+e[10]-42063;b=(b<<17|b>>>15)+c<<0;d+=
(a^b&(c^a))+e[11]-1990404162;d=(d<<22|d>>>10)+b<<0;a+=(c^d&(b^c))+e[12]+1804603682;a=(a<<7|a>>>25)+d<<0;c+=(b^a&(d^b))+e[13]-40341101;c=(c<<12|c>>>20)+a<<0;b+=(d^c&(a^d))+e[14]-1502002290;b=(b<<17|b>>>15)+c<<0;d+=(a^b&(c^a))+e[15]+1236535329;d=(d<<22|d>>>10)+b<<0;a+=(b^c&(d^b))+e[1]-165796510;a=(a<<5|a>>>27)+d<<0;c+=(d^b&(a^d))+e[6]-1069501632;c=(c<<9|c>>>23)+a<<0;b+=(a^d&(c^a))+e[11]+643717713;b=(b<<14|b>>>18)+c<<0;d+=(c^a&(b^c))+e[0]-373897302;d=(d<<20|d>>>12)+b<<0;a+=(b^c&(d^b))+e[5]-701558691;
a=(a<<5|a>>>27)+d<<0;c+=(d^b&(a^d))+e[10]+38016083;c=(c<<9|c>>>23)+a<<0;b+=(a^d&(c^a))+e[15]-660478335;b=(b<<14|b>>>18)+c<<0;d+=(c^a&(b^c))+e[4]-405537848;d=(d<<20|d>>>12)+b<<0;a+=(b^c&(d^b))+e[9]+568446438;a=(a<<5|a>>>27)+d<<0;c+=(d^b&(a^d))+e[14]-1019803690;c=(c<<9|c>>>23)+a<<0;b+=(a^d&(c^a))+e[3]-187363961;b=(b<<14|b>>>18)+c<<0;d+=(c^a&(b^c))+e[8]+1163531501;d=(d<<20|d>>>12)+b<<0;a+=(b^c&(d^b))+e[13]-1444681467;a=(a<<5|a>>>27)+d<<0;c+=(d^b&(a^d))+e[2]-51403784;c=(c<<9|c>>>23)+a<<0;b+=(a^d&(c^a))+
e[7]+1735328473;b=(b<<14|b>>>18)+c<<0;d+=(c^a&(b^c))+e[12]-1926607734;d=(d<<20|d>>>12)+b<<0;g=d^b;a+=(g^c)+e[5]-378558;a=(a<<4|a>>>28)+d<<0;c+=(g^a)+e[8]-2022574463;c=(c<<11|c>>>21)+a<<0;g=c^a;b+=(g^d)+e[11]+1839030562;b=(b<<16|b>>>16)+c<<0;d+=(g^b)+e[14]-35309556;d=(d<<23|d>>>9)+b<<0;g=d^b;a+=(g^c)+e[1]-1530992060;a=(a<<4|a>>>28)+d<<0;c+=(g^a)+e[4]+1272893353;c=(c<<11|c>>>21)+a<<0;g=c^a;b+=(g^d)+e[7]-155497632;b=(b<<16|b>>>16)+c<<0;d+=(g^b)+e[10]-1094730640;d=(d<<23|d>>>9)+b<<0;g=d^b;a+=(g^c)+e[13]+
681279174;a=(a<<4|a>>>28)+d<<0;c+=(g^a)+e[0]-358537222;c=(c<<11|c>>>21)+a<<0;g=c^a;b+=(g^d)+e[3]-722521979;b=(b<<16|b>>>16)+c<<0;d+=(g^b)+e[6]+76029189;d=(d<<23|d>>>9)+b<<0;g=d^b;a+=(g^c)+e[9]-640364487;a=(a<<4|a>>>28)+d<<0;c+=(g^a)+e[12]-421815835;c=(c<<11|c>>>21)+a<<0;g=c^a;b+=(g^d)+e[15]+530742520;b=(b<<16|b>>>16)+c<<0;d+=(g^b)+e[2]-995338651;d=(d<<23|d>>>9)+b<<0;a+=(b^(d|~c))+e[0]-198630844;a=(a<<6|a>>>26)+d<<0;c+=(d^(a|~b))+e[7]+1126891415;c=(c<<10|c>>>22)+a<<0;b+=(a^(c|~d))+e[14]-1416354905;
b=(b<<15|b>>>17)+c<<0;d+=(c^(b|~a))+e[5]-57434055;d=(d<<21|d>>>11)+b<<0;a+=(b^(d|~c))+e[12]+1700485571;a=(a<<6|a>>>26)+d<<0;c+=(d^(a|~b))+e[3]-1894986606;c=(c<<10|c>>>22)+a<<0;b+=(a^(c|~d))+e[10]-1051523;b=(b<<15|b>>>17)+c<<0;d+=(c^(b|~a))+e[1]-2054922799;d=(d<<21|d>>>11)+b<<0;a+=(b^(d|~c))+e[8]+1873313359;a=(a<<6|a>>>26)+d<<0;c+=(d^(a|~b))+e[15]-30611744;c=(c<<10|c>>>22)+a<<0;b+=(a^(c|~d))+e[6]-1560198380;b=(b<<15|b>>>17)+c<<0;d+=(c^(b|~a))+e[13]+1309151649;d=(d<<21|d>>>11)+b<<0;a+=(b^(d|~c))+e[4]-
145523070;a=(a<<6|a>>>26)+d<<0;c+=(d^(a|~b))+e[11]-1120210379;c=(c<<10|c>>>22)+a<<0;b+=(a^(c|~d))+e[2]+718787259;b=(b<<15|b>>>17)+c<<0;d+=(c^(b|~a))+e[9]-343485551;d=(d<<21|d>>>11)+b<<0;this.first?(this.h0=a+1732584193<<0,this.h1=d-271733879<<0,this.h2=b-1732584194<<0,this.h3=c+271733878<<0,this.first=!1):(this.h0=this.h0+a<<0,this.h1=this.h1+d<<0,this.h2=this.h2+b<<0,this.h3=this.h3+c<<0)};b.prototype.hex=function(){this.finalize();var a=this.h0,d=this.h1,b=this.h2,c=this.h3;return f[a>>4&15]+f[a&
15]+f[a>>12&15]+f[a>>8&15]+f[a>>20&15]+f[a>>16&15]+f[a>>28&15]+f[a>>24&15]+f[d>>4&15]+f[d&15]+f[d>>12&15]+f[d>>8&15]+f[d>>20&15]+f[d>>16&15]+f[d>>28&15]+f[d>>24&15]+f[b>>4&15]+f[b&15]+f[b>>12&15]+f[b>>8&15]+f[b>>20&15]+f[b>>16&15]+f[b>>28&15]+f[b>>24&15]+f[c>>4&15]+f[c&15]+f[c>>12&15]+f[c>>8&15]+f[c>>20&15]+f[c>>16&15]+f[c>>28&15]+f[c>>24&15]};b.prototype.toString=b.prototype.hex;b.prototype.digest=function(){this.finalize();var a=this.h0,d=this.h1,b=this.h2,c=this.h3;return[a&255,a>>8&255,a>>16&
255,a>>24&255,d&255,d>>8&255,d>>16&255,d>>24&255,b&255,b>>8&255,b>>16&255,b>>24&255,c&255,c>>8&255,c>>16&255,c>>24&255]};b.prototype.array=b.prototype.digest;b.prototype.arrayBuffer=function(){this.finalize();var a=new ArrayBuffer(16),d=new Uint32Array(a);d[0]=this.h0;d[1]=this.h1;d[2]=this.h2;d[3]=this.h3;return a};b.prototype.buffer=b.prototype.arrayBuffer;v=function(){var a=q("hex");d&&(a=t(a));a.create=function(){return new b};a.update=function(d){return a.create().update(d)};for(var c=0;c<m.length;++c){var e=
m[c];a[e]=q(e)}return a}();g?c.exports=v:a.md5=v})()}),T=qa(function(c,b){c="undefined"!==typeof Uint8Array&&"undefined"!==typeof Uint16Array&&"undefined"!==typeof Int32Array;b.assign=function(a){for(var d=Array.prototype.slice.call(arguments,1);d.length;){var b=d.shift();if(b){if("object"!==("undefined"===typeof b?"undefined":H(b)))throw new TypeError(b+"must be non-object");for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])}}return a};b.shrinkBuf=function(a,d){if(a.length===d)return a;if(a.subarray)return a.subarray(0,
d);a.length=d;return a};var a={arraySet:function(a,d,b,c,l){if(d.subarray&&a.subarray)a.set(d.subarray(b,b+c),l);else for(var e=0;e<c;e++)a[l+e]=d[b+e]},flattenChunks:function(a){var d,b,c,g,m;d=c=0;for(b=a.length;d<b;d++)c+=a[d].length;m=new Uint8Array(c);d=c=0;for(b=a.length;d<b;d++)g=a[d],m.set(g,c),c+=g.length;return m}},d={arraySet:function(a,d,b,c,l){for(var e=0;e<c;e++)a[l+e]=d[b+e]},flattenChunks:function(a){return[].concat.apply([],a)}};b.setTyped=function(c){c?(b.Buf8=Uint8Array,b.Buf16=
Uint16Array,b.Buf32=Int32Array,b.assign(b,a)):(b.Buf8=Array,b.Buf16=Array,b.Buf32=Array,b.assign(b,d))};b.setTyped(c)});"use strict";var Id=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],Yc=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],kj=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],fh=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],eb=Array(576);Qb(eb);var Jc=Array(60);Qb(Jc);var zb=Array(512);Qb(zb);var mc=Array(256);Qb(mc);var Jd=Array(29);Qb(Jd);var Zc=Array(30);
Qb(Zc);var gh,hh,ih,jh=!1,Ga={_tr_init:function(c){if(!jh){var b,a,d,g=Array(16);for(d=a=0;28>d;d++)for(Jd[d]=a,b=0;b<1<<Id[d];b++)mc[a++]=d;mc[a-1]=d;for(d=a=0;16>d;d++)for(Zc[d]=a,b=0;b<1<<Yc[d];b++)zb[a++]=d;for(a>>=7;30>d;d++)for(Zc[d]=a<<7,b=0;b<1<<Yc[d]-7;b++)zb[256+a++]=d;for(b=0;15>=b;b++)g[b]=0;for(b=0;143>=b;)eb[2*b+1]=8,b++,g[8]++;for(;255>=b;)eb[2*b+1]=9,b++,g[9]++;for(;279>=b;)eb[2*b+1]=7,b++,g[7]++;for(;287>=b;)eb[2*b+1]=8,b++,g[8]++;bf(eb,287,g);for(b=0;30>b;b++)Jc[2*b+1]=5,Jc[2*b]=
af(b,5);gh=new Fd(eb,Id,257,286,15);hh=new Fd(Jc,Yc,0,30,15);ih=new Fd([],kj,0,19,7);jh=!0}c.l_desc=new Gd(c.dyn_ltree,gh);c.d_desc=new Gd(c.dyn_dtree,hh);c.bl_desc=new Gd(c.bl_tree,ih);c.bi_buf=0;c.bi_valid=0;cf(c)},_tr_stored_block:jf,_tr_flush_block:function(c,b,a,d){var g,e,f=0;if(0<c.level){2===c.strm.data_type&&(c.strm.data_type=ki(c));Kd(c,c.l_desc);Kd(c,c.d_desc);gf(c,c.dyn_ltree,c.l_desc.max_code);gf(c,c.dyn_dtree,c.d_desc.max_code);Kd(c,c.bl_desc);for(f=18;3<=f&&0===c.bl_tree[2*fh[f]+1];f--);
c.opt_len+=3*(f+1)+14;g=c.opt_len+3+7>>>3;e=c.static_len+3+7>>>3;e<=g&&(g=e)}else g=e=a+5;if(a+4<=g&&-1!==b)jf(c,b,a,d);else if(4===c.strategy||e===g)va(c,2+(d?1:0),3),ff(c,eb,Jc);else{va(c,4+(d?1:0),3);b=c.l_desc.max_code+1;a=c.d_desc.max_code+1;f+=1;va(c,b-257,5);va(c,a-1,5);va(c,f-4,4);for(g=0;g<f;g++)va(c,c.bl_tree[2*fh[g]+1],3);hf(c,c.dyn_ltree,b-1);hf(c,c.dyn_dtree,a-1);ff(c,c.dyn_ltree,c.dyn_dtree)}cf(c);d&&df(c)},_tr_tally:function(c,b,a){c.pending_buf[c.d_buf+2*c.last_lit]=b>>>8&255;c.pending_buf[c.d_buf+
2*c.last_lit+1]=b&255;c.pending_buf[c.l_buf+c.last_lit]=a&255;c.last_lit++;0===b?c.dyn_ltree[2*a]++:(c.matches++,b--,c.dyn_ltree[2*(mc[a]+256+1)]++,c.dyn_dtree[2*(256>b?zb[b]:zb[256+(b>>>7)])]++);return c.last_lit===c.lit_bufsize-1},_tr_align:function(c){va(c,2,3);Qa(c,256,eb);16===c.bi_valid?(lc(c,c.bi_buf),c.bi_buf=0,c.bi_valid=0):8<=c.bi_valid&&(c.pending_buf[c.pending++]=c.bi_buf&255,c.bi_buf>>=8,c.bi_valid-=8)}};"use strict";var oc=function(c,b,a,d){var g=c&65535|0;c=c>>>16&65535|0;for(var e;0!==
a;){e=2E3<a?2E3:a;a-=e;do g=g+b[d++]|0,c=c+g|0;while(--e);g%=65521;c%=65521}return g|c<<16|0};"use strict";var lj=function(){for(var c,b=[],a=0;256>a;a++){c=a;for(var d=0;8>d;d++)c=c&1?3988292384^c>>>1:c>>>1;b[a]=c}return b}(),na=function(c,b,a,d){a=d+a;for(c^=-1;d<a;d++)c=c>>>8^lj[(c^b[d])&255];return c^-1};"use strict";var Rb={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"};
"use strict";var Tb;Tb=[new Ra(0,0,0,0,function(c,b){var a=65535;for(a>c.pending_buf_size-5&&(a=c.pending_buf_size-5);;){if(1>=c.lookahead){Ab(c);if(0===c.lookahead&&0===b)return 1;if(0===c.lookahead)break}c.strstart+=c.lookahead;c.lookahead=0;var d=c.block_start+a;if(0===c.strstart||c.strstart>=d)if(c.lookahead=c.strstart-d,c.strstart=d,ma(c,!1),0===c.strm.avail_out)return 1;if(c.strstart-c.block_start>=c.w_size-262&&(ma(c,!1),0===c.strm.avail_out))return 1}c.insert=0;if(4===b)return ma(c,!0),0===
c.strm.avail_out?3:4;c.strstart>c.block_start&&ma(c,!1);return 1}),new Ra(4,4,8,4,Ld),new Ra(4,5,16,8,Ld),new Ra(4,6,32,32,Ld),new Ra(4,4,16,16,Sb),new Ra(8,16,32,32,Sb),new Ra(8,16,128,128,Sb),new Ra(8,32,128,256,Sb),new Ra(32,128,258,1024,Sb),new Ra(32,258,258,4096,Sb)];var pc={deflateInit:function(c,b){return nf(c,b,8,15,8,0)},deflateInit2:nf,deflateReset:mf,deflateResetKeep:lf,deflateSetHeader:function(c,b){if(!c||!c.state||2!==c.state.wrap)return-2;c.state.gzhead=b;return 0},deflate:function(c,
b){var a,d,g,e;if(!c||!c.state||5<b||0>b)return c?kb(c,-2):-2;d=c.state;if(!c.output||!c.input&&0!==c.avail_in||666===d.status&&4!==b)return kb(c,0===c.avail_out?-5:-2);d.strm=c;a=d.last_flush;d.last_flush=b;42===d.status&&(2===d.wrap?(c.adler=0,da(d,31),da(d,139),da(d,8),d.gzhead?(da(d,(d.gzhead.text?1:0)+(d.gzhead.hcrc?2:0)+(d.gzhead.extra?4:0)+(d.gzhead.name?8:0)+(d.gzhead.comment?16:0)),da(d,d.gzhead.time&255),da(d,d.gzhead.time>>8&255),da(d,d.gzhead.time>>16&255),da(d,d.gzhead.time>>24&255),
da(d,9===d.level?2:2<=d.strategy||2>d.level?4:0),da(d,d.gzhead.os&255),d.gzhead.extra&&d.gzhead.extra.length&&(da(d,d.gzhead.extra.length&255),da(d,d.gzhead.extra.length>>8&255)),d.gzhead.hcrc&&(c.adler=na(c.adler,d.pending_buf,d.pending,0)),d.gzindex=0,d.status=69):(da(d,0),da(d,0),da(d,0),da(d,0),da(d,0),da(d,9===d.level?2:2<=d.strategy||2>d.level?4:0),da(d,3),d.status=113)):(g=8+(d.w_bits-8<<4)<<8,g|=(2<=d.strategy||2>d.level?0:6>d.level?1:6===d.level?2:3)<<6,0!==d.strstart&&(g|=32),d.status=113,
nc(d,g+(31-g%31)),0!==d.strstart&&(nc(d,c.adler>>>16),nc(d,c.adler&65535)),c.adler=1));if(69===d.status)if(d.gzhead.extra){for(g=d.pending;d.gzindex<(d.gzhead.extra.length&65535)&&(d.pending!==d.pending_buf_size||(d.gzhead.hcrc&&d.pending>g&&(c.adler=na(c.adler,d.pending_buf,d.pending-g,g)),mb(c),g=d.pending,d.pending!==d.pending_buf_size));)da(d,d.gzhead.extra[d.gzindex]&255),d.gzindex++;d.gzhead.hcrc&&d.pending>g&&(c.adler=na(c.adler,d.pending_buf,d.pending-g,g));d.gzindex===d.gzhead.extra.length&&
(d.gzindex=0,d.status=73)}else d.status=73;if(73===d.status)if(d.gzhead.name){g=d.pending;do{if(d.pending===d.pending_buf_size&&(d.gzhead.hcrc&&d.pending>g&&(c.adler=na(c.adler,d.pending_buf,d.pending-g,g)),mb(c),g=d.pending,d.pending===d.pending_buf_size)){e=1;break}e=d.gzindex<d.gzhead.name.length?d.gzhead.name.charCodeAt(d.gzindex++)&255:0;da(d,e)}while(0!==e);d.gzhead.hcrc&&d.pending>g&&(c.adler=na(c.adler,d.pending_buf,d.pending-g,g));0===e&&(d.gzindex=0,d.status=91)}else d.status=91;if(91===
d.status)if(d.gzhead.comment){g=d.pending;do{if(d.pending===d.pending_buf_size&&(d.gzhead.hcrc&&d.pending>g&&(c.adler=na(c.adler,d.pending_buf,d.pending-g,g)),mb(c),g=d.pending,d.pending===d.pending_buf_size)){e=1;break}e=d.gzindex<d.gzhead.comment.length?d.gzhead.comment.charCodeAt(d.gzindex++)&255:0;da(d,e)}while(0!==e);d.gzhead.hcrc&&d.pending>g&&(c.adler=na(c.adler,d.pending_buf,d.pending-g,g));0===e&&(d.status=103)}else d.status=103;103===d.status&&(d.gzhead.hcrc?(d.pending+2>d.pending_buf_size&&
mb(c),d.pending+2<=d.pending_buf_size&&(da(d,c.adler&255),da(d,c.adler>>8&255),c.adler=0,d.status=113)):d.status=113);if(0!==d.pending){if(mb(c),0===c.avail_out)return d.last_flush=-1,0}else if(0===c.avail_in&&(b<<1)-(4<b?9:0)<=(a<<1)-(4<a?9:0)&&4!==b)return kb(c,-5);if(666===d.status&&0!==c.avail_in)return kb(c,-5);if(0!==c.avail_in||0!==d.lookahead||0!==b&&666!==d.status){a=2===d.strategy?mi(d,b):3===d.strategy?li(d,b):Tb[d.level].func(d,b);if(3===a||4===a)d.status=666;if(1===a||3===a)return 0===
c.avail_out&&(d.last_flush=-1),0;if(2===a&&(1===b?Ga._tr_align(d):5!==b&&(Ga._tr_stored_block(d,0,0,!1),3===b&&(lb(d.head),0===d.lookahead&&(d.strstart=0,d.block_start=0,d.insert=0))),mb(c),0===c.avail_out))return d.last_flush=-1,0}if(4!==b)return 0;if(0>=d.wrap)return 1;2===d.wrap?(da(d,c.adler&255),da(d,c.adler>>8&255),da(d,c.adler>>16&255),da(d,c.adler>>24&255),da(d,c.total_in&255),da(d,c.total_in>>8&255),da(d,c.total_in>>16&255),da(d,c.total_in>>24&255)):(nc(d,c.adler>>>16),nc(d,c.adler&65535));
mb(c);0<d.wrap&&(d.wrap=-d.wrap);return 0!==d.pending?0:1},deflateEnd:function(c){var b;if(!c||!c.state)return-2;b=c.state.status;if(42!==b&&69!==b&&73!==b&&91!==b&&103!==b&&113!==b&&666!==b)return kb(c,-2);c.state=null;return 113===b?kb(c,-3):0},deflateSetDictionary:function(c,b){var a=b.length,d,g,e,f,k;if(!c||!c.state)return-2;d=c.state;g=d.wrap;if(2===g||1===g&&42!==d.status||d.lookahead)return-2;1===g&&(c.adler=oc(c.adler,b,a,0));d.wrap=0;a>=d.w_size&&(0===g&&(lb(d.head),d.strstart=0,d.block_start=
0,d.insert=0),e=new T.Buf8(d.w_size),T.arraySet(e,b,a-d.w_size,d.w_size,0),b=e,a=d.w_size);e=c.avail_in;f=c.next_in;k=c.input;c.avail_in=a;c.next_in=0;c.input=b;for(Ab(d);3<=d.lookahead;){b=d.strstart;a=d.lookahead-2;do d.ins_h=(d.ins_h<<d.hash_shift^d.window[b+3-1])&d.hash_mask,d.prev[b&d.w_mask]=d.head[d.ins_h],d.head[d.ins_h]=b,b++;while(--a);d.strstart=b;d.lookahead=2;Ab(d)}d.strstart+=d.lookahead;d.block_start=d.strstart;d.insert=d.lookahead;d.lookahead=0;d.match_length=d.prev_length=2;d.match_available=
0;c.next_in=f;c.input=k;c.avail_in=e;d.wrap=g;return 0},deflateInfo:"pako deflate (from Nodeca project)"};"use strict";var qf=!0,pf=!0;try{String.fromCharCode.apply(null,[0])}catch(c){qf=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch(c){pf=!1}for(var Kc=new T.Buf8(256),ub=0;256>ub;ub++)Kc[ub]=252<=ub?6:248<=ub?5:240<=ub?4:224<=ub?3:192<=ub?2:1;Kc[254]=Kc[254]=1;var Cb={string2buf:function(c){var b,a,d,g,e,f=c.length,k=0;for(g=0;g<f;g++)a=c.charCodeAt(g),55296===(a&64512)&&g+1<f&&(d=
c.charCodeAt(g+1),56320===(d&64512)&&(a=65536+(a-55296<<10)+(d-56320),g++)),k+=128>a?1:2048>a?2:65536>a?3:4;b=new T.Buf8(k);for(g=e=0;e<k;g++)a=c.charCodeAt(g),55296===(a&64512)&&g+1<f&&(d=c.charCodeAt(g+1),56320===(d&64512)&&(a=65536+(a-55296<<10)+(d-56320),g++)),128>a?b[e++]=a:(2048>a?b[e++]=192|a>>>6:(65536>a?b[e++]=224|a>>>12:(b[e++]=240|a>>>18,b[e++]=128|a>>>12&63),b[e++]=128|a>>>6&63),b[e++]=128|a&63);return b},buf2binstring:function(c){return of(c,c.length)},binstring2buf:function(c){for(var b=
new T.Buf8(c.length),a=0,d=b.length;a<d;a++)b[a]=c.charCodeAt(a);return b},buf2string:function(c,b){var a,d,g,e=b||c.length,f=Array(2*e);for(b=a=0;b<e;)if(d=c[b++],128>d)f[a++]=d;else if(g=Kc[d],4<g)f[a++]=65533,b+=g-1;else{for(d&=2===g?31:3===g?15:7;1<g&&b<e;)d=d<<6|c[b++]&63,g--;1<g?f[a++]=65533:65536>d?f[a++]=d:(d-=65536,f[a++]=55296|d>>10&1023,f[a++]=56320|d&1023)}return of(f,a)},utf8border:function(c,b){var a;b=b||c.length;b>c.length&&(b=c.length);for(a=b-1;0<=a&&128===(c[a]&192);)a--;return 0>
a||0===a?b:a+Kc[c[a]]>b?a:b}};"use strict";var rf=function(){this.input=null;this.total_in=this.avail_in=this.next_in=0;this.output=null;this.total_out=this.avail_out=this.next_out=0;this.msg="";this.state=null;this.data_type=2;this.adler=0};"use strict";var sf=Object.prototype.toString;Bb.prototype.push=function(c,b){var a=this.strm,d=this.options.chunkSize;if(this.ended)return!1;b=b===~~b?b:!0===b?4:0;"string"===typeof c?a.input=Cb.string2buf(c):"[object ArrayBuffer]"===sf.call(c)?a.input=new Uint8Array(c):
a.input=c;a.next_in=0;a.avail_in=a.input.length;do{0===a.avail_out&&(a.output=new T.Buf8(d),a.next_out=0,a.avail_out=d);c=pc.deflate(a,b);if(1!==c&&0!==c)return this.onEnd(c),this.ended=!0,!1;if(0===a.avail_out||0===a.avail_in&&(4===b||2===b))if("string"===this.options.to)this.onData(Cb.buf2binstring(T.shrinkBuf(a.output,a.next_out)));else this.onData(T.shrinkBuf(a.output,a.next_out))}while((0<a.avail_in||0===a.avail_out)&&1!==c);if(4===b)return c=pc.deflateEnd(this.strm),this.onEnd(c),this.ended=
!0,0===c;2===b&&(this.onEnd(0),a.avail_out=0);return!0};Bb.prototype.onData=function(c){this.chunks.push(c)};Bb.prototype.onEnd=function(c){0===c&&(this.result="string"===this.options.to?this.chunks.join(""):T.flattenChunks(this.chunks));this.chunks=[];this.err=c;this.msg=this.strm.msg};var mj={Deflate:Bb,deflate:Md,deflateRaw:function(c,b){b=b||{};b.raw=!0;return Md(c,b)},gzip:function(c,b){b=b||{};b.gzip=!0;return Md(c,b)}};"use strict";"use strict";var nj=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,
31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],oj=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],pj=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],qj=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64],Lc=function(c,b,a,d,g,e,f,k){var l=k.bits,m,n,r,v,q,t,p,x,D,w,A,I,G,u=0,K,y=new T.Buf16(16);q=new T.Buf16(16);var L,B=0,J,E,Y;for(m=
0;15>=m;m++)y[m]=0;for(n=0;n<d;n++)y[b[a+n]]++;v=l;for(r=15;1<=r&&0===y[r];r--);v>r&&(v=r);if(0===r)return g[e++]=20971520,g[e++]=20971520,k.bits=1,0;for(l=1;l<r&&0===y[l];l++);v<l&&(v=l);for(m=t=1;15>=m;m++)if(t<<=1,t-=y[m],0>t)return-1;if(0<t&&(0===c||1!==r))return-1;q[1]=0;for(m=1;15>m;m++)q[m+1]=q[m]+y[m];for(n=0;n<d;n++)0!==b[a+n]&&(f[q[b[a+n]]++]=n);0===c?(G=L=f,K=19):1===c?(G=nj,u-=257,L=oj,B-=257,K=256):(G=pj,L=qj,K=-1);n=x=0;m=l;I=e;d=v;q=0;w=-1;p=1<<v;A=p-1;if(1===c&&852<p||2===c&&592<p)return 1;
for(;;){J=m-q;f[n]<K?(E=0,Y=f[n]):f[n]>K?(E=L[B+f[n]],Y=G[u+f[n]]):(E=96,Y=0);t=1<<m-q;l=D=1<<d;do D-=t,g[I+(x>>q)+D]=J<<24|E<<16|Y|0;while(0!==D);for(t=1<<m-1;x&t;)t>>=1;0!==t?(x&=t-1,x+=t):x=0;n++;if(0===--y[m]){if(m===r)break;m=b[a+f[n]]}if(m>v&&(x&A)!==w){0===q&&(q=v);I+=l;d=m-q;for(t=1<<d;d+q<r;){t-=y[d+q];if(0>=t)break;d++;t<<=1}p+=1<<d;if(1===c&&852<p||2===c&&592<p)return 1;w=x&A;g[w]=v<<24|d<<16|I-e|0}}0!==x&&(g[I+x]=m-q<<24|4194304);k.bits=v;return 0};"use strict";var kh=!0,ne,oe,qc={inflateReset:vf,
inflateReset2:wf,inflateResetKeep:uf,inflateInit:function(c){return xf(c,15)},inflateInit2:xf,inflate:function(c,b){var a,d,g,e,f,k,l,m,n,r,v,q,t,p,x,D,w,A,I=new T.Buf8(4),G=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!c||!c.state||!c.output||!c.input&&0!==c.avail_in)return-2;a=c.state;12===a.mode&&(a.mode=13);f=c.next_out;g=c.output;l=c.avail_out;e=c.next_in;d=c.input;k=c.avail_in;m=a.hold;n=a.bits;r=k;v=l;A=0;a:for(;;)switch(a.mode){case 1:if(0===a.wrap){a.mode=13;break}for(;16>n;){if(0===
k)break a;k--;m+=d[e++]<<n;n+=8}if(a.wrap&2&&35615===m){a.check=0;I[0]=m&255;I[1]=m>>>8&255;a.check=na(a.check,I,2,0);n=m=0;a.mode=2;break}a.flags=0;a.head&&(a.head.done=!1);if(!(a.wrap&1)||(((m&255)<<8)+(m>>8))%31){c.msg="incorrect header check";a.mode=30;break}if(8!==(m&15)){c.msg="unknown compression method";a.mode=30;break}m>>>=4;n-=4;t=(m&15)+8;if(0===a.wbits)a.wbits=t;else if(t>a.wbits){c.msg="invalid window size";a.mode=30;break}a.dmax=1<<t;c.adler=a.check=1;a.mode=m&512?10:12;n=m=0;break;
case 2:for(;16>n;){if(0===k)break a;k--;m+=d[e++]<<n;n+=8}a.flags=m;if(8!==(a.flags&255)){c.msg="unknown compression method";a.mode=30;break}if(a.flags&57344){c.msg="unknown header flags set";a.mode=30;break}a.head&&(a.head.text=m>>8&1);a.flags&512&&(I[0]=m&255,I[1]=m>>>8&255,a.check=na(a.check,I,2,0));n=m=0;a.mode=3;case 3:for(;32>n;){if(0===k)break a;k--;m+=d[e++]<<n;n+=8}a.head&&(a.head.time=m);a.flags&512&&(I[0]=m&255,I[1]=m>>>8&255,I[2]=m>>>16&255,I[3]=m>>>24&255,a.check=na(a.check,I,4,0));n=
m=0;a.mode=4;case 4:for(;16>n;){if(0===k)break a;k--;m+=d[e++]<<n;n+=8}a.head&&(a.head.xflags=m&255,a.head.os=m>>8);a.flags&512&&(I[0]=m&255,I[1]=m>>>8&255,a.check=na(a.check,I,2,0));n=m=0;a.mode=5;case 5:if(a.flags&1024){for(;16>n;){if(0===k)break a;k--;m+=d[e++]<<n;n+=8}a.length=m;a.head&&(a.head.extra_len=m);a.flags&512&&(I[0]=m&255,I[1]=m>>>8&255,a.check=na(a.check,I,2,0));n=m=0}else a.head&&(a.head.extra=null);a.mode=6;case 6:if(a.flags&1024&&(q=a.length,q>k&&(q=k),q&&(a.head&&(t=a.head.extra_len-
a.length,a.head.extra||(a.head.extra=Array(a.head.extra_len)),T.arraySet(a.head.extra,d,e,q,t)),a.flags&512&&(a.check=na(a.check,d,q,e)),k-=q,e+=q,a.length-=q),a.length))break a;a.length=0;a.mode=7;case 7:if(a.flags&2048){if(0===k)break a;q=0;do t=d[e+q++],a.head&&t&&65536>a.length&&(a.head.name+=String.fromCharCode(t));while(t&&q<k);a.flags&512&&(a.check=na(a.check,d,q,e));k-=q;e+=q;if(t)break a}else a.head&&(a.head.name=null);a.length=0;a.mode=8;case 8:if(a.flags&4096){if(0===k)break a;q=0;do t=
d[e+q++],a.head&&t&&65536>a.length&&(a.head.comment+=String.fromCharCode(t));while(t&&q<k);a.flags&512&&(a.check=na(a.check,d,q,e));k-=q;e+=q;if(t)break a}else a.head&&(a.head.comment=null);a.mode=9;case 9:if(a.flags&512){for(;16>n;){if(0===k)break a;k--;m+=d[e++]<<n;n+=8}if(m!==(a.check&65535)){c.msg="header crc mismatch";a.mode=30;break}n=m=0}a.head&&(a.head.hcrc=a.flags>>9&1,a.head.done=!0);c.adler=a.check=0;a.mode=12;break;case 10:for(;32>n;){if(0===k)break a;k--;m+=d[e++]<<n;n+=8}c.adler=a.check=
tf(m);n=m=0;a.mode=11;case 11:if(0===a.havedict)return c.next_out=f,c.avail_out=l,c.next_in=e,c.avail_in=k,a.hold=m,a.bits=n,2;c.adler=a.check=1;a.mode=12;case 12:if(5===b||6===b)break a;case 13:if(a.last){m>>>=n&7;n-=n&7;a.mode=27;break}for(;3>n;){if(0===k)break a;k--;m+=d[e++]<<n;n+=8}a.last=m&1;m>>>=1;--n;switch(m&3){case 0:a.mode=14;break;case 1:t=a;if(kh){ne=new T.Buf32(512);oe=new T.Buf32(32);for(q=0;144>q;)t.lens[q++]=8;for(;256>q;)t.lens[q++]=9;for(;280>q;)t.lens[q++]=7;for(;288>q;)t.lens[q++]=
8;Lc(1,t.lens,0,288,ne,0,t.work,{bits:9});for(q=0;32>q;)t.lens[q++]=5;Lc(2,t.lens,0,32,oe,0,t.work,{bits:5});kh=!1}t.lencode=ne;t.lenbits=9;t.distcode=oe;t.distbits=5;a.mode=20;if(6===b){m>>>=2;n-=2;break a}break;case 2:a.mode=17;break;case 3:c.msg="invalid block type",a.mode=30}m>>>=2;n-=2;break;case 14:m>>>=n&7;for(n-=n&7;32>n;){if(0===k)break a;k--;m+=d[e++]<<n;n+=8}if((m&65535)!==(m>>>16^65535)){c.msg="invalid stored block lengths";a.mode=30;break}a.length=m&65535;n=m=0;a.mode=15;if(6===b)break a;
case 15:a.mode=16;case 16:if(q=a.length){q>k&&(q=k);q>l&&(q=l);if(0===q)break a;T.arraySet(g,d,e,q,f);k-=q;e+=q;l-=q;f+=q;a.length-=q;break}a.mode=12;break;case 17:for(;14>n;){if(0===k)break a;k--;m+=d[e++]<<n;n+=8}a.nlen=(m&31)+257;m>>>=5;n-=5;a.ndist=(m&31)+1;m>>>=5;n-=5;a.ncode=(m&15)+4;m>>>=4;n-=4;if(286<a.nlen||30<a.ndist){c.msg="too many length or distance symbols";a.mode=30;break}a.have=0;a.mode=18;case 18:for(;a.have<a.ncode;){for(;3>n;){if(0===k)break a;k--;m+=d[e++]<<n;n+=8}a.lens[G[a.have++]]=
m&7;m>>>=3;n-=3}for(;19>a.have;)a.lens[G[a.have++]]=0;a.lencode=a.lendyn;a.lenbits=7;q={bits:a.lenbits};A=Lc(0,a.lens,0,19,a.lencode,0,a.work,q);a.lenbits=q.bits;if(A){c.msg="invalid code lengths set";a.mode=30;break}a.have=0;a.mode=19;case 19:for(;a.have<a.nlen+a.ndist;){for(;;){x=a.lencode[m&(1<<a.lenbits)-1];q=x>>>24;x&=65535;if(q<=n)break;if(0===k)break a;k--;m+=d[e++]<<n;n+=8}if(16>x)m>>>=q,n-=q,a.lens[a.have++]=x;else{if(16===x){for(t=q+2;n<t;){if(0===k)break a;k--;m+=d[e++]<<n;n+=8}m>>>=q;
n-=q;if(0===a.have){c.msg="invalid bit length repeat";a.mode=30;break}t=a.lens[a.have-1];q=3+(m&3);m>>>=2;n-=2}else if(17===x){for(t=q+3;n<t;){if(0===k)break a;k--;m+=d[e++]<<n;n+=8}m>>>=q;n-=q;t=0;q=3+(m&7);m>>>=3;n-=3}else{for(t=q+7;n<t;){if(0===k)break a;k--;m+=d[e++]<<n;n+=8}m>>>=q;n-=q;t=0;q=11+(m&127);m>>>=7;n-=7}if(a.have+q>a.nlen+a.ndist){c.msg="invalid bit length repeat";a.mode=30;break}for(;q--;)a.lens[a.have++]=t}}if(30===a.mode)break;if(0===a.lens[256]){c.msg="invalid code -- missing end-of-block";
a.mode=30;break}a.lenbits=9;q={bits:a.lenbits};A=Lc(1,a.lens,0,a.nlen,a.lencode,0,a.work,q);a.lenbits=q.bits;if(A){c.msg="invalid literal/lengths set";a.mode=30;break}a.distbits=6;a.distcode=a.distdyn;q={bits:a.distbits};A=Lc(2,a.lens,a.nlen,a.ndist,a.distcode,0,a.work,q);a.distbits=q.bits;if(A){c.msg="invalid distances set";a.mode=30;break}a.mode=20;if(6===b)break a;case 20:a.mode=21;case 21:if(6<=k&&258<=l){c.next_out=f;c.avail_out=l;c.next_in=e;c.avail_in=k;a.hold=m;a.bits=n;var u,K,y,L,B,J,E,
Y,z,C,H=c;C=H.state;z=H.next_in;g=H.input;Y=z+(H.avail_in-5);E=H.next_out;d=H.output;J=E-(v-H.avail_out);B=E+(H.avail_out-257);L=C.dmax;x=C.wsize;w=C.whave;D=C.wnext;p=C.window;t=C.hold;q=C.bits;n=C.lencode;m=C.distcode;l=(1<<C.lenbits)-1;k=(1<<C.distbits)-1;b:do c:for(15>q&&(t+=g[z++]<<q,q+=8,t+=g[z++]<<q,q+=8),u=n[t&l];;){f=u>>>24;t>>>=f;q-=f;f=u>>>16&255;if(0===f)d[E++]=u&65535;else if(f&16){e=u&65535;if(f&=15)q<f&&(t+=g[z++]<<q,q+=8),e+=t&(1<<f)-1,t>>>=f,q-=f;15>q&&(t+=g[z++]<<q,q+=8,t+=g[z++]<<
q,q+=8);u=m[t&k];d:for(;;){f=u>>>24;t>>>=f;q-=f;f=u>>>16&255;if(f&16){y=u&65535;f&=15;q<f&&(t+=g[z++]<<q,q+=8,q<f&&(t+=g[z++]<<q,q+=8));y+=t&(1<<f)-1;if(y>L){H.msg="invalid distance too far back";C.mode=30;break b}t>>>=f;q-=f;f=E-J;if(y>f){f=y-f;if(f>w&&C.sane){H.msg="invalid distance too far back";C.mode=30;break b}K=0;u=p;if(0===D){if(K+=x-f,f<e){e-=f;do d[E++]=p[K++];while(--f);K=E-y;u=d}}else if(D<f){if(K+=x+D-f,f-=D,f<e){e-=f;do d[E++]=p[K++];while(--f);K=0;if(D<e){f=D;e-=f;do d[E++]=p[K++];
while(--f);K=E-y;u=d}}}else if(K+=D-f,f<e){e-=f;do d[E++]=p[K++];while(--f);K=E-y;u=d}for(;2<e;)d[E++]=u[K++],d[E++]=u[K++],d[E++]=u[K++],e-=3;e&&(d[E++]=u[K++],1<e&&(d[E++]=u[K++]))}else{K=E-y;do d[E++]=d[K++],d[E++]=d[K++],d[E++]=d[K++],e-=3;while(2<e);e&&(d[E++]=d[K++],1<e&&(d[E++]=d[K++]))}}else if(0===(f&64)){u=m[(u&65535)+(t&(1<<f)-1)];continue d}else{H.msg="invalid distance code";C.mode=30;break b}break}}else if(0===(f&64)){u=n[(u&65535)+(t&(1<<f)-1)];continue c}else{f&32?C.mode=12:(H.msg=
"invalid literal/length code",C.mode=30);break b}break}while(z<Y&&E<B);e=q>>3;z-=e;q-=e<<3;H.next_in=z;H.next_out=E;H.avail_in=z<Y?5+(Y-z):5-(z-Y);H.avail_out=E<B?257+(B-E):257-(E-B);C.hold=t&(1<<q)-1;C.bits=q;f=c.next_out;g=c.output;l=c.avail_out;e=c.next_in;d=c.input;k=c.avail_in;m=a.hold;n=a.bits;12===a.mode&&(a.back=-1);break}for(a.back=0;;){x=a.lencode[m&(1<<a.lenbits)-1];q=x>>>24;t=x>>>16&255;x&=65535;if(q<=n)break;if(0===k)break a;k--;m+=d[e++]<<n;n+=8}if(t&&0===(t&240)){p=q;D=t;for(w=x;;){x=
a.lencode[w+((m&(1<<p+D)-1)>>p)];q=x>>>24;t=x>>>16&255;x&=65535;if(p+q<=n)break;if(0===k)break a;k--;m+=d[e++]<<n;n+=8}m>>>=p;n-=p;a.back+=p}m>>>=q;n-=q;a.back+=q;a.length=x;if(0===t){a.mode=26;break}if(t&32){a.back=-1;a.mode=12;break}if(t&64){c.msg="invalid literal/length code";a.mode=30;break}a.extra=t&15;a.mode=22;case 22:if(a.extra){for(t=a.extra;n<t;){if(0===k)break a;k--;m+=d[e++]<<n;n+=8}a.length+=m&(1<<a.extra)-1;m>>>=a.extra;n-=a.extra;a.back+=a.extra}a.was=a.length;a.mode=23;case 23:for(;;){x=
a.distcode[m&(1<<a.distbits)-1];q=x>>>24;t=x>>>16&255;x&=65535;if(q<=n)break;if(0===k)break a;k--;m+=d[e++]<<n;n+=8}if(0===(t&240)){p=q;D=t;for(w=x;;){x=a.distcode[w+((m&(1<<p+D)-1)>>p)];q=x>>>24;t=x>>>16&255;x&=65535;if(p+q<=n)break;if(0===k)break a;k--;m+=d[e++]<<n;n+=8}m>>>=p;n-=p;a.back+=p}m>>>=q;n-=q;a.back+=q;if(t&64){c.msg="invalid distance code";a.mode=30;break}a.offset=x;a.extra=t&15;a.mode=24;case 24:if(a.extra){for(t=a.extra;n<t;){if(0===k)break a;k--;m+=d[e++]<<n;n+=8}a.offset+=m&(1<<
a.extra)-1;m>>>=a.extra;n-=a.extra;a.back+=a.extra}if(a.offset>a.dmax){c.msg="invalid distance too far back";a.mode=30;break}a.mode=25;case 25:if(0===l)break a;q=v-l;if(a.offset>q){q=a.offset-q;if(q>a.whave&&a.sane){c.msg="invalid distance too far back";a.mode=30;break}q>a.wnext?(q-=a.wnext,t=a.wsize-q):t=a.wnext-q;q>a.length&&(q=a.length);p=a.window}else p=g,t=f-a.offset,q=a.length;q>l&&(q=l);l-=q;a.length-=q;do g[f++]=p[t++];while(--q);0===a.length&&(a.mode=21);break;case 26:if(0===l)break a;g[f++]=
a.length;l--;a.mode=21;break;case 27:if(a.wrap){for(;32>n;){if(0===k)break a;k--;m|=d[e++]<<n;n+=8}v-=l;c.total_out+=v;a.total+=v;v&&(c.adler=a.check=a.flags?na(a.check,g,v,f-v):oc(a.check,g,v,f-v));v=l;if((a.flags?m:tf(m))!==a.check){c.msg="incorrect data check";a.mode=30;break}n=m=0}a.mode=28;case 28:if(a.wrap&&a.flags){for(;32>n;){if(0===k)break a;k--;m+=d[e++]<<n;n+=8}if(m!==(a.total&4294967295)){c.msg="incorrect length check";a.mode=30;break}n=m=0}a.mode=29;case 29:A=1;break a;case 30:A=-3;break a;
case 31:return-4;default:return-2}c.next_out=f;c.avail_out=l;c.next_in=e;c.avail_in=k;a.hold=m;a.bits=n;if((a.wsize||v!==c.avail_out&&30>a.mode&&(27>a.mode||4!==b))&&yf(c,c.output,c.next_out,v-c.avail_out))return a.mode=31,-4;r-=c.avail_in;v-=c.avail_out;c.total_in+=r;c.total_out+=v;a.total+=v;a.wrap&&v&&(c.adler=a.check=a.flags?na(a.check,g,v,c.next_out-v):oc(a.check,g,v,c.next_out-v));c.data_type=a.bits+(a.last?64:0)+(12===a.mode?128:0)+(20===a.mode||15===a.mode?256:0);(0===r&&0===v||4===b)&&0===
A&&(A=-5);return A},inflateEnd:function(c){if(!c||!c.state)return-2;var b=c.state;b.window&&(b.window=null);c.state=null;return 0},inflateGetHeader:function(c,b){if(!c||!c.state)return-2;c=c.state;if(0===(c.wrap&2))return-2;c.head=b;b.done=!1;return 0},inflateSetDictionary:function(c,b){var a=b.length,d,g;if(!c||!c.state)return-2;d=c.state;if(0!==d.wrap&&11!==d.mode)return-2;if(11===d.mode&&(g=oc(1,b,a,0),g!==d.check))return-3;if(yf(c,b,a,a))return d.mode=31,-4;d.havedict=1;return 0},inflateInfo:"pako inflate (from Nodeca project)"};
"use strict";var ia={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8};"use strict";var pi=function(){this.os=this.xflags=this.time=this.text=0;this.extra=null;this.extra_len=
0;this.comment=this.name="";this.hcrc=0;this.done=!1};"use strict";var lh=Object.prototype.toString;Db.prototype.push=function(c,b){var a=this.strm,d=this.options.chunkSize,g=this.options.dictionary,e,f,k,l=!1;if(this.ended)return!1;b=b===~~b?b:!0===b?ia.Z_FINISH:ia.Z_NO_FLUSH;"string"===typeof c?a.input=Cb.binstring2buf(c):"[object ArrayBuffer]"===lh.call(c)?a.input=new Uint8Array(c):a.input=c;a.next_in=0;a.avail_in=a.input.length;do{0===a.avail_out&&(a.output=new T.Buf8(d),a.next_out=0,a.avail_out=
d);c=qc.inflate(a,ia.Z_NO_FLUSH);c===ia.Z_NEED_DICT&&g&&(c="string"===typeof g?Cb.string2buf(g):"[object ArrayBuffer]"===lh.call(g)?new Uint8Array(g):g,c=qc.inflateSetDictionary(this.strm,c));c===ia.Z_BUF_ERROR&&!0===l&&(c=ia.Z_OK,l=!1);if(c!==ia.Z_STREAM_END&&c!==ia.Z_OK)return this.onEnd(c),this.ended=!0,!1;if(a.next_out&&(0===a.avail_out||c===ia.Z_STREAM_END||0===a.avail_in&&(b===ia.Z_FINISH||b===ia.Z_SYNC_FLUSH)))if("string"===this.options.to)e=Cb.utf8border(a.output,a.next_out),f=a.next_out-
e,k=Cb.buf2string(a.output,e),a.next_out=f,a.avail_out=d-f,f&&T.arraySet(a.output,a.output,e,f,0),this.onData(k);else this.onData(T.shrinkBuf(a.output,a.next_out));0===a.avail_in&&0===a.avail_out&&(l=!0)}while((0<a.avail_in||0===a.avail_out)&&c!==ia.Z_STREAM_END);c===ia.Z_STREAM_END&&(b=ia.Z_FINISH);if(b===ia.Z_FINISH)return c=qc.inflateEnd(this.strm),this.onEnd(c),this.ended=!0,c===ia.Z_OK;b===ia.Z_SYNC_FLUSH&&(this.onEnd(ia.Z_OK),a.avail_out=0);return!0};Db.prototype.onData=function(c){this.chunks.push(c)};
Db.prototype.onEnd=function(c){c===ia.Z_OK&&(this.result="string"===this.options.to?this.chunks.join(""):T.flattenChunks(this.chunks));this.chunks=[];this.err=c;this.msg=this.strm.msg};var mh={Inflate:Db,inflate:Nd,inflateRaw:function(c,b){b=b||{};b.raw=!0;return Nd(c,b)},ungzip:Nd};"use strict";var rj=T.assign,Da={};rj(Da,mj,mh,ia);var rd=function(c,b){return b={exports:{}},c(b,b.exports),b.exports}(function(c){function b(a){this.value=a}function a(a,b,c){var e=[],g=[],n=!0;return function D(a){function r(){if("object"===
H(F.node)&&null!==F.node){F.keys&&F.node_===F.node||(F.keys=f(F.node));F.isLeaf=0==F.keys.length;for(var d=0;d<g.length;d++)if(g[d].node_===a){F.circular=g[d];break}}else F.isLeaf=!0,F.keys=null;F.notLeaf=!F.isLeaf;F.notRoot=!F.isRoot}var q,v,t,w,p=!0,F={node:c?d(a):a,node_:a,path:[].concat(e),parent:g[g.length-1],parents:g,key:e.slice(-1)[0],isRoot:0===e.length,level:e.length,circular:null,update:function(a,d){F.isRoot||(F.parent.node[F.key]=a);F.node=a;d&&(p=!1)},"delete":function(a){delete F.parent.node[F.key];
a&&(p=!1)},remove:function(a){k(F.parent.node)?F.parent.node.splice(F.key,1):delete F.parent.node[F.key];a&&(p=!1)},keys:null,before:function(a){q=a},after:function(a){v=a},pre:function(a){t=a},post:function(a){w=a},stop:function(){n=!1},block:function(){p=!1}};if(!n)return F;r();var u=b.call(F,F.node);void 0!==u&&F.update&&F.update(u);q&&q.call(F,F.node);if(!p)return F;"object"!=H(F.node)||null===F.node||F.circular||(g.push(F),r(),l(F.keys,function(a,d){e.push(a);t&&t.call(F,F.node[a],a);var b=D(F.node[a]);
c&&m.call(F.node,a)&&(F.node[a]=b.node);b.isLast=d==F.keys.length-1;b.isFirst=0==d;w&&w.call(F,b);e.pop()}),g.pop());v&&v.call(F,F.node);return F}(a).node}function d(a){if("object"===("undefined"===typeof a?"undefined":H(a))&&null!==a){var d;if(k(a))d=[];else if("[object Date]"===g(a))d=new Date(a.getTime?a.getTime():a);else if("[object RegExp]"===g(a))d=new RegExp(a);else if("[object Error]"===g(a))d={message:a.message};else if("[object Boolean]"===g(a))d=new Boolean(a);else if("[object Number]"===
g(a))d=new Number(a);else if("[object String]"===g(a))d=new String(a);else if(Object.create&&Object.getPrototypeOf)d=Object.create(Object.getPrototypeOf(a));else if(a.constructor===Object)d={};else{var b=function(){};b.prototype=a.constructor&&a.constructor.prototype||a.__proto__||{};d=new b}l(f(a),function(b){d[b]=a[b]});return d}return a}function g(a){return Object.prototype.toString.call(a)}var e=c.exports=function(a){return new b(a)};b.prototype.get=function(a){for(var d=this.value,b=0;b<a.length;b++){var c=
a[b];if(!d||!m.call(d,c)){d=void 0;break}d=d[c]}return d};b.prototype.has=function(a){for(var d=this.value,b=0;b<a.length;b++){var c=a[b];if(!d||!m.call(d,c))return!1;d=d[c]}return!0};b.prototype.set=function(a,d){for(var b=this.value,c=0;c<a.length-1;c++){var e=a[c];m.call(b,e)||(b[e]={});b=b[e]}return b[a[c]]=d};b.prototype.map=function(d){return a(this.value,d,!0)};b.prototype.forEach=function(d){return this.value=a(this.value,d,!1)};b.prototype.reduce=function(a,d){var b=1===arguments.length,
c=b?this.value:d;this.forEach(function(d){this.isRoot&&b||(c=a.call(this,c,d))});return c};b.prototype.paths=function(){var a=[];this.forEach(function(d){a.push(this.path)});return a};b.prototype.nodes=function(){var a=[];this.forEach(function(d){a.push(this.node)});return a};b.prototype.clone=function(){var a=[],b=[];return function q(c){for(var e=0;e<a.length;e++)if(a[e]===c)return b[e];if("object"===("undefined"===typeof c?"undefined":H(c))&&null!==c){var g=d(c);a.push(c);b.push(g);l(f(c),function(a){g[a]=
q(c[a])});a.pop();b.pop();return g}return c}(this.value)};var f=Object.keys||function(a){var d=[],b;for(b in a)d.push(b);return d},k=Array.isArray||function(a){return"[object Array]"===Object.prototype.toString.call(a)},l=function(a,d){if(a.forEach)return a.forEach(d);for(var b=0;b<a.length;b++)d(a[b],b,a)};l(f(b.prototype),function(a){e[a]=function(d){var c=[].slice.call(arguments,1),e=new b(d);return e[a].apply(e,c)}});var m=Object.hasOwnProperty||function(a,d){return d in a}});(function(){function c(a){this.value=
a}function b(a){function d(e,g){try{var f=a[e](g),k=f.value;k instanceof c?Promise.resolve(k.value).then(function(a){d("next",a)},function(a){d("throw",a)}):b(f.done?"return":"normal",f.value)}catch(r){b("throw",r)}}function b(a,b){switch(a){case "return":e.resolve({value:b,done:!0});break;case "throw":e.reject(b);break;default:e.resolve({value:b,done:!1})}(e=e.next)?d(e.key,e.arg):f=null}var e,f;this._invoke=function(a,b){return new Promise(function(c,g){c={key:a,arg:b,resolve:c,reject:g,next:null};
f?f=f.next=c:(e=f=c,d(a,b))})};"function"!==typeof a.return&&(this.return=void 0)}"function"===typeof Symbol&&Symbol.asyncIterator&&(b.prototype[Symbol.asyncIterator]=function(){return this});b.prototype.next=function(a){return this._invoke("next",a)};b.prototype.throw=function(a){return this._invoke("throw",a)};b.prototype.return=function(a){return this._invoke("return",a)};return{wrap:function(a){return function(){return new b(a.apply(this,arguments))}},await:function(a){return new c(a)}}})();var sj=
function(){function c(b,a){for(var d=0;d<a.length;d++){var c=a[d];c.enumerable=c.enumerable||!1;c.configurable=!0;"value"in c&&(c.writable=!0);Object.defineProperty(b,c.key,c)}}return function(b,a,d){a&&c(b.prototype,a);d&&c(b,d);return b}}(),gc=function(){function c(){if(!(this instanceof c))throw new TypeError("Cannot call a class as a function");}sj(c,null,[{key:"isPlatformLittleEndian",value:function(){var b=new Uint32Array([305419896]);return 18!=(new Uint8Array(b.buffer,b.byteOffset,b.byteLength))[0]}},
{key:"arrayBufferToUnicode",value:function(b){b=new Uint8Array(b);for(var a=[],d=0,c=0;d<b.length;){var e=b[d++];if(128>e){if(32>e&&10!=e&&13!=e&&9!=e||127==e)return console.warn("Invalid string: non-printable characters"),null;a[c++]=String.fromCharCode(e)}else if(191<e&&224>e){var f=b[d++];a[c++]=String.fromCharCode((e&31)<<6|f&63)}else if(239<e&&365>e){var f=b[d++],k=b[d++],l=b[d++],e=((e&7)<<18|(f&63)<<12|(k&63)<<6|l&63)-65536;a[c++]=String.fromCharCode(55296+(e>>10));a[c++]=String.fromCharCode(56320+
(e&1023))}else{f=b[d++];k=b[d++];e=(e&15)<<12|(f&63)<<6|k&63;if(65533===e)return console.warn("Invalid string: a REPLACEMENT CHARACTER was spotted"),null;a[c++]=String.fromCharCode(e)}}return a.join("")}},{key:"unicodeToArrayBuffer",value:function(b){for(var a=[],d=0,c=0;c<b.length;c++){var e=b.charCodeAt(c);128>e?a[d++]=e:(2048>e?a[d++]=e>>6|192:(55296==(e&64512)&&c+1<b.length&&56320==(b.charCodeAt(c+1)&64512)?(e=65536+((e&1023)<<10)+(b.charCodeAt(++c)&1023),a[d++]=e>>18|240,a[d++]=e>>12&63|128):
a[d++]=e>>12|224,a[d++]=e>>6&63|128),a[d++]=e&63|128)}return(new Uint8Array(a)).buffer}},{key:"arrayBufferToString8",value:function(b){return String.fromCharCode.apply(null,new Uint8Array(b))}},{key:"string8ToArrayBuffer",value:function(b){for(var a=new ArrayBuffer(b.length),d=new Uint8Array(a),c=0;c<b.length;c++)d[c]=b.charCodeAt(c);return a}},{key:"setString8InBuffer",value:function(b,a){var d=2<arguments.length&&void 0!==arguments[2]?arguments[2]:0;if(0>d)console.warn("The byte offset cannot be negative.");
else if(a&&a instanceof ArrayBuffer)if(b.length+d>a.byteLength)console.warn("The string is too long to be writen in this buffer.");else for(var c=new Uint8Array(a),e=0;e<b.length;e++)c[e+d]=b.charCodeAt(e);else console.warn("The buffer must be a valid ArrayBuffer.")}},{key:"getString8FromBuffer",value:function(b,a){var d=2<arguments.length&&void 0!==arguments[2]?arguments[2]:0;return 0>d?(console.warn("The byte offset cannot be negative."),null):b&&b instanceof ArrayBuffer?a+d>b.byteLength?(console.warn("The string is too long to be writen in this buffer."),
null):String.fromCharCode.apply(null,new Uint8Array(b,d,a)):(console.warn("The buffer must be a valid ArrayBuffer."),null)}},{key:"objectToArrayBuffer",value:function(b){var a=null;b=c.makeSerializeFriendly(b);try{var d=JSON.stringify(b),a=c.unicodeToArrayBuffer(d)}catch(g){console.warn(g)}return a}},{key:"ArrayBufferToObject",value:function(b){var a=null;try{var d=c.arrayBufferToUnicode(b),a=JSON.parse(d)}catch(g){console.warn(g)}return a}},{key:"isTypedArray",value:function(b){return b instanceof
Int8Array||b instanceof Uint8Array||b instanceof Uint8ClampedArray||b instanceof Int16Array||b instanceof Uint16Array||b instanceof Int32Array||b instanceof Uint32Array||b instanceof Float32Array||b instanceof Float64Array}},{key:"mergeBuffers",value:function(b){for(var a=0,d=0;d<b.length;d++)a+=b[d].byteLength;for(var a=new Uint8Array(a),c=0,d=0;d<b.length;d++)a.set(new Uint8Array(b[d]),c),c+=b[d].byteLength;return a.buffer}},{key:"getGlobalObject",value:function(){var b=null;try{b=window}catch(a){try{b=
GLOBAL}catch(d){return console.warn("You are not in a Javascript environment?? Weird."),null}}return b}},{key:"extractTypedArray",value:function(b,a,d,c){if(!b)return console.warn("Input Buffer is null."),null;if(!(b instanceof ArrayBuffer))return console.warn("Buffer must be of type ArrayBuffer"),null;if(0>=c)return console.warn("The number of elements to fetch must be greater than 0"),null;if(0>a)return console.warn("The byte offset must be possitive or 0"),null;if(a>=b.byteLength)return console.warn("The offset cannot be larger than the size of the buffer."),
null;if(d instanceof Function&&!("BYTES_PER_ELEMENT"in d))return console.warn("ArrayType must be a typed array constructor function."),null;if(d.BYTES_PER_ELEMENT*c+a>b.byteLength)console.warn("The requested number of elements is too large for this buffer");else return b=b.slice(a,a+c*d.BYTES_PER_ELEMENT),new d(b)}},{key:"getTypedArrayInfo",value:function(b){var a=null,d=!1;b instanceof Int8Array?(a="int",d=!1):b instanceof Uint8Array?(a="int",d=!0):b instanceof Uint8ClampedArray?(a="int",d=!0):b instanceof
Int16Array?(a="int",d=!1):b instanceof Uint16Array?(a="int",d=!0):b instanceof Int32Array?(a="int",d=!1):b instanceof Uint32Array?(a="int",d=!0):b instanceof Float32Array?(a="float",d=!1):b instanceof Float64Array&&(a="float",d=!1);return{type:a,signed:d,bytesPerElements:b.BYTES_PER_ELEMENT,byteLength:b.byteLength,length:b.length}}},{key:"howManyTypedArrayAttributes",value:function(b){var a=0;rd(b).forEach(function(d){a+=c.isTypedArray(d)});return a}},{key:"hasCircularReference",value:function(b){var a=
!1;rd(b).forEach(function(d){this.circular&&(a=!0)});return a}},{key:"removeCircularReference",value:function(b){var a=!1;b=rd(b).map(function(d){this.circular&&(this.remove(),a=!0)});return a?b:null}},{key:"replaceTypedArrayAttributesByArrays",value:function(b){var a=!1;b=rd(b).map(function(d){if(c.isTypedArray(d)){for(var b=Object.keys(d).length,e=Array(b),f=0;f<b;f++)e[f]=d[f];this.update(e);a=!0}});return a?b:null}},{key:"makeSerializeFriendly",value:function(b){var a=c.removeCircularReference(b);
a&&(b=a);(a=c.replaceTypedArrayAttributesByArrays(b))&&(b=a);return b}},{key:"isValidString",value:function(b){for(var a=b.length,a=1<arguments.length&&void 0!==arguments[1]&&arguments[1]?a:Math.min(1E3,a),d=0,c=0;c<a;c++){var e=b.charCodeAt(Math.floor(Math.random()*a));(65533===e||32>e&&10!=e&&13!=e&&9!=e||127==e)&&d++}return!(0<d)}}]);return c}(),tj=function(c){function b(){N(this,b);var a=P(this,(b.__proto__||Object.getPrototypeOf(b)).call(this));a._outputCounter=0;a.setMetadata("filenames",{});
a.setMetadata("checksums",{});a.setMetadata("readAsText",!1);return a}M(b,c);O(b,[{key:"_run",value:function(){var a=this;this._outputCounter=0;this.getInputCategories().forEach(function(d){a._loadFile(d)})}},{key:"_loadFile",value:function(a){var d=this,b=new FileReader,c=this.getMetadata("readAsText"),f=function(c){d.addTimeRecord("startRead");c=c.target.result;if(gc.isValidString(c)){var e=d._getInput(a).name.split(/[\\/]/).pop();e.split(".").pop();var g=qd(c);console.log(g);d._metadata.filenames[a]=
e;d._metadata.checksums[a]=g;d.addTimeRecord("endRead");e=d.getTime("startRead","endRead");console.log("Reading file took "+e+"ms.");d._output[a]=c;d._fileLoadCount()}else b.onloadend=k,b.readAsArrayBuffer(d._getInput(a))},k=function(b){d.addTimeRecord("startRead");b=b.target.result;var e=d._getInput(a).name.split(/[\\/]/).pop(),g=e.split(".").pop(),f=qd(b);console.log(f);d._metadata.filenames[a]=e;d._metadata.checksums[a]=f;if(g.localeCompare("pixp"))try{b=Da.inflate(b).buffer,console.log("File was un-gziped successfully")}catch(v){console.log("Pako: not a gziped file ("+
v+")")}if(c&&(b=gc.arrayBufferToUnicode(b),!b)){console.warn("The content of this file is not a valid text. It could be read as a binary file if the metadata 'readAsText' is set to false.");return}d.addTimeRecord("endRead");e=d.getTime("startRead","endRead");console.log("Reading file took "+e+"ms.");d._output[a]=b;d._fileLoadCount()};b.onerror=function(a){console.warn("ERROR");console.warn(a)};c?(b.onloadend=f,b.readAsText(this._getInput(a))):(b.onloadend=k,b.readAsArrayBuffer(this._getInput(a)))}},
{key:"_fileLoadCount",value:function(){this._outputCounter++;this._outputCounter==this.getNumberOfInputs()&&this.triggerEvent("ready")}}]);return b}(V),uj=function(c){function b(){N(this,b);var a=P(this,(b.__proto__||Object.getPrototypeOf(b)).call(this));a._outputCounter=0;a.setMetadata("filenames",{});a.setMetadata("checksums",{});a.setMetadata("readAsText",!1);return a}M(b,c);O(b,[{key:"_run",value:function(){var a=this;this.getNumberOfInputs()?this._forEachInput(function(d,b){a._loadUrl(d,b)}):
console.warn("No input was specified, cannot run this filer.")}},{key:"_loadUrl",value:function(a,d){var b=this,c=this.getMetadata("readAsText"),f=new XMLHttpRequest;f.open("GET",d,!0);var k=function(e){e=e.target.response;var g=d.split(/[\\/]/).pop(),f=g.split(".").pop(),k=qd(e);b._metadata.filenames[a]=g;b._metadata.checksums[a]=k;if(f.localeCompare("pixp"))try{e=Da.inflate(e).buffer,console.log("File was un-gziped successfully")}catch(q){console.log("Pako: not a gziped file ("+q+")")}if(c&&(e=
gc.arrayBufferToUnicode(e),!e||!gc.isValidString(e))){console.warn("The content of this file is not a valid text. It could be read as a binary file if the metadata 'readAsText' is set to false.");return}b._output[a]=e;b._outputCounter++;b._outputCounter==b.getNumberOfInputs()&&b.triggerEvent("ready")},l=function(c){console.log("ooooooooo");var e=c.target.response,g=d.split(/[\\/]/).pop();g.split(".").pop();var f=qd(e);b._metadata.filenames[a]=g;b._metadata.checksums[a]=f;gc.isValidString(e)?(b._output[a]=
e,b._outputCounter++,b._outputCounter==b.getNumberOfInputs()&&b.triggerEvent("ready")):(c.target.abort(),c=new XMLHttpRequest,c.open("GET",d,!0),c.responseType="arraybuffer",c.onload=k,c.send())};f.error=function(){console.log("here go the error")};c?(f.responseType="text",f.onload=l):(f.responseType="arraybuffer",f.onload=k);f.send()}}]);return b}(V),nh=qa(function(c){var b=b||function(a){if(!("undefined"===typeof a||"undefined"!==typeof navigator&&/MSIE [1-9]\./.test(navigator.userAgent))){var d=
a.document.createElementNS("http://www.w3.org/1999/xhtml","a"),b="download"in d,c=/constructor/i.test(a.HTMLElement)||a.safari,f=/CriOS\/[\d]+/.test(navigator.userAgent),k=function(d){(a.setImmediate||a.setTimeout)(function(){throw d;},0)},l=function(d){setTimeout(function(){"string"===typeof d?(a.URL||a.webkitURL||a).revokeObjectURL(d):d.remove()},4E4)},m=function(a){return/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(a.type)?new Blob([String.fromCharCode(65279),
a],{type:a.type}):a},n=function(e,g,n){n||(e=m(e));var r=this,q="application/octet-stream"===e.type,v,t=function(){for(var a=["writestart","progress","write","writeend"],a=[].concat(a),d=a.length;d--;){var b=r["on"+a[d]];if("function"===typeof b)try{b.call(r,r)}catch(La){k(La)}}};r.readyState=r.INIT;b?(v=(a.URL||a.webkitURL||a).createObjectURL(e),setTimeout(function(){d.href=v;d.download=g;var a=new MouseEvent("click");d.dispatchEvent(a);t();l(v);r.readyState=r.DONE})):function(){if((f||q&&c)&&a.FileReader){var d=
new FileReader;d.onloadend=function(){var b=f?d.result:d.result.replace(/^data:[^;]*;/,"data:attachment/file;");a.open(b,"_blank")||(a.location.href=b);r.readyState=r.DONE;t()};d.readAsDataURL(e);r.readyState=r.INIT}else v||(v=(a.URL||a.webkitURL||a).createObjectURL(e)),q?a.location.href=v:a.open(v,"_blank")||(a.location.href=v),r.readyState=r.DONE,t(),l(v)}()},r=n.prototype;if("undefined"!==typeof navigator&&navigator.msSaveOrOpenBlob)return function(a,d,b){d=d||a.name||"download";b||(a=m(a));return navigator.msSaveOrOpenBlob(a,
d)};r.abort=function(){};r.readyState=r.INIT=0;r.WRITING=1;r.DONE=2;r.error=r.onwritestart=r.onprogress=r.onwrite=r.onabort=r.onerror=r.onwriteend=null;return function(a,d,b){return new n(a,d||a.name||"download",b)}}}("undefined"!==typeof self&&self||"undefined"!==typeof window&&window||Mb.content);c.exports&&(c.exports.saveAs=b)}),vj=function(c){function b(){N(this,b);var a=P(this,(b.__proto__||Object.getPrototypeOf(b)).call(this));a.addInputValidator(0,ArrayBuffer);a.setMetadata("filename",null);
return a}M(b,c);O(b,[{key:"_run",value:function(){if(this.hasValidInput()){var a=this.getMetadata("filename");if(a){var d=new Blob([this._getInput()],{type:"application/octet-binary"});nh.saveAs(d,a)}else console.warn("A filename must be specified. Use the method `.setMetadata('filename', 'theFile.ext')` on this filter.")}else console.warn("BrowserDownloadBuffer uses only ArrayBuffer.")}}]);return b}(V),oh=function(c){function b(){N(this,b);var a=P(this,(b.__proto__||Object.getPrototypeOf(b)).call(this));
a.addInputValidator(0,ArrayBuffer);a.setMetadata("debug",!1);a._type_enum={INT8:1,UINT8:2,INT16:3,UINT16:4,INT32:5,UINT32:6,FLT:7,DBL:8,STR:9};a._type_matching="int8 uint8 int16 uint16 int32 uint32 float32 float64 undef".split(" ");a.type_sizes=[0,1,1,2,2,4,4,4,8,0];a._dv_offset=0;a._align=8;a._little_endian=!0;a._continuation_queue=[];a._dv=null;a._superblk={};a._start_offset=0;a._huge_id=0;return a}M(b,c);O(b,[{key:"createLink",value:function(){return{hdr_offset:0,data_offset:0,data_length:0,n_filled:0,
chunk_size:0,sym_btree:0,sym_lheap:0,name:"",attributes:{},children:[],array:void 0,type:-1,inflate:!1,dims:[]}}},{key:"startAlignment",value:function(){this._start_offset=this._dv_offset}},{key:"checkAlignment",value:function(){var a=this._dv_offset-this._start_offset;if(0!==a%this._align){var d=this._align-a%this._align;this._dv_offset+=d;this.getMetadata("debug")&&console.log("skipping "+d+" bytes at "+a+" for alignmnent")}}},{key:"skip",value:function(a){this._dv_offset+=a}},{key:"seek",value:function(a){this._dv_offset=
a}},{key:"tell",value:function(){return this._dv_offset}},{key:"getU8",value:function(){var a=this._dv.getUint8(this._dv_offset);this._dv_offset+=1;return a}},{key:"getU16",value:function(){var a=this._dv.getUint16(this._dv_offset,this._little_endian);this._dv_offset+=2;return a}},{key:"getU32",value:function(){var a=this._dv.getUint32(this._dv_offset,this._little_endian);this._dv_offset+=4;return a}},{key:"getU64",value:function(){var a=this._dv.getUint64(this._dv_offset,this._little_endian);this._dv_offset+=
8;return a}},{key:"getF32",value:function(){var a=this._dv.getFloat32(this._dv_offset,this._little_endian);this._dv_offset+=4;return a}},{key:"getF64",value:function(){var a=this._dv.getFloat64(this._dv_offset,this._little_endian);this._dv_offset+=8;return a}},{key:"getOffset",value:function(a){var d;a=a||this._superblk.offsz;if(4===a)d=this._dv.getUint32(this._dv_offset,this._little_endian);else if(8===a)d=this._dv.getUint64(this._dv_offset,this._little_endian);else throw Error("Unsupported value for offset size "+
a);this._dv_offset+=a;return d}},{key:"getLength",value:function(){var a=this._dv.getUint64(this._dv_offset,this._little_endian);this._dv_offset+=this._superblk.lensz;return a}},{key:"getString",value:function(a){var d="",b,c;for(b=0;b<a;b+=1){c=this.getU8();if(0===c){this._dv_offset+=a-b-1;break}d+=String.fromCharCode(c)}return d}},{key:"getArray",value:function(a,d,b){var c=this._getInput(),g=this._dv_offset;b&&(this._dv_offset=b);switch(a){case this._type_enum.INT8:a=new Int8Array(c,this._dv_offset,
d);break;case this._type_enum.UINT8:a=new Uint8Array(c,this._dv_offset,d);break;case this._type_enum.INT16:if(0!==this._dv_offset%2)for(a=new ArrayBuffer(d),d/=2,a=new Int16Array(a),c=0;c<d;c+=1)a[c]=this.getU16();else a=new Int16Array(c,this._dv_offset,d/2),this._dv_offset+=d;break;case this._type_enum.UINT16:if(0!==this._dv_offset%2)for(a=new ArrayBuffer(d),d/=2,a=new Uint16Array(a),c=0;c<d;c+=1)a[c]=this.getU16();else a=new Uint16Array(c,this._dv_offset,d/2),this._dv_offset+=d;break;case this._type_enum.INT32:if(0!==
this._dv_offset%4)for(a=new ArrayBuffer(d),d/=4,a=new Int32Array(a),c=0;c<d;c+=1)a[c]=this.getU32();else a=new Int32Array(c,this._dv_offset,d/4),this._dv_offset+=d;break;case this._type_enum.UINT32:if(0!==this._dv_offset%4)for(a=new ArrayBuffer(d),d/=4,a=new Uint32Array(a),c=0;c<d;c+=1)a[c]=this.getU32();else a=new Uint32Array(c,this._dv_offset,d/4),this._dv_offset+=d;break;case this._type_enum.FLT:if(0!==this._dv_offset%4)for(a=new ArrayBuffer(d),d/=4,a=new Float32Array(a),c=0;c<d;c+=1)a[c]=this.getF32();
else a=new Float32Array(c,this._dv_offset,d/4),this._dv_offset+=d;break;case this._type_enum.DBL:if(0!==this._dv_offset%8)for(a=new ArrayBuffer(d),d/=8,a=new Float64Array(a),c=0;c<d;c+=1)a[c]=this.getF64();else a=new Float64Array(c,this._dv_offset,d/8),this._dv_offset+=d;break;default:throw Error("Bad type in this.getArray "+a);}b&&(this._dv_offset=g);return a}},{key:"getUXX",value:function(a){var d,b;switch(a){case 1:d=this._dv.getUint8(this._dv_offset);break;case 2:d=this._dv.getUint16(this._dv_offset,
this._little_endian);break;case 4:d=this._dv.getUint32(this._dv_offset,this._little_endian);break;case 8:d=this._dv.getUint64(this._dv_offset,this._little_endian);break;default:if(d=0,this._little_endian)for(b=a-1;0<=b;b--)d=(d<<8)+this._dv.getUint8(this._dv_offset+b);else for(b=0;b<a;b++)d=(d<<8)+this._dv.getUint8(this._dv_offset+b)}this._dv_offset+=a;return d}},{key:"checkSignature",value:function(a){var d;for(d=0;d<a.length;d+=1)if(this._dv.getUint8(this._dv_offset+d)!==a.charCodeAt(d))return!1;
this.skip(a.length);return!0}},{key:"hdf5Superblock",value:function(){var a={};if(!this.checkSignature("\u0089HDF\r\n\u001a\n"))throw Error("Bad magic string in HDF5");a.sbver=this.getU8();if(2<a.sbver)throw Error("Unsupported HDF5 superblock version "+a.sbver);1>=a.sbver?(a.fsver=this.getU8(),a.rgver=this.getU8(),this.skip(1),a.shver=this.getU8(),a.offsz=this.getU8(),a.lensz=this.getU8(),this.skip(1),a.gln_k=this.getU16(),a.gin_k=this.getU16(),a.cflags=this.getU32(),1===a.sbver&&(a.isin_k=this.getU16(),
this.skip(2)),a.base_addr=this.getOffset(a.offsz),a.gfsi_addr=this.getOffset(a.offsz),a.eof_addr=this.getOffset(a.offsz),a.dib_addr=this.getOffset(a.offsz),a.root_ln_offs=this.getOffset(a.offsz),a.root_addr=this.getOffset(a.offsz),a.root_cache_type=this.getU32(),this.skip(4),this.skip(16)):(a.offsz=this.getU8(),a.lensz=this.getU8(),a.cflags=this.getU8(),a.base_addr=this.getOffset(a.offsz),a.ext_addr=this.getOffset(a.offsz),a.eof_addr=this.getOffset(a.offsz),a.root_addr=this.getOffset(a.offsz),a.checksum=
this.getU32());this.getMetadata("debug")&&console.log("HDF5 SB "+a.sbver+" "+a.offsz+" "+a.lensz+" "+a.cflags);return a}},{key:"hdf5FractalHeapHeader",value:function(){var a={};if(!this.checkSignature("FRHP"))throw Error("Bad or missing FRHP signature");a.ver=this.getU8();a.idlen=this.getU16();a.iof_el=this.getU16();a.flags=this.getU8();a.objmax=this.getU32();a.objnid=this.getLength();a.objbta=this.getOffset();a.nf_blk=this.getLength();a.af_blk=this.getOffset();a.heap_total=this.getLength();a.heap_alloc=
this.getLength();a.bai_offset=this.getLength();a.heap_nobj=this.getLength();a.heap_chuge=this.getLength();a.heap_nhuge=this.getLength();a.heap_ctiny=this.getLength();a.heap_ntiny=this.getLength();a.table_width=this.getU16();a.start_blksz=this.getLength();a.max_blksz=this.getLength();a.max_heapsz=this.getU16();a.rib_srows=this.getU16();a.root_addr=this.getOffset();a.rib_crows=this.getU16();var d=Math.log2(a.max_blksz)-Math.log2(a.start_blksz)+2;a.K=Math.min(a.rib_crows,d)*a.table_width;a.N=a.rib_crows<
d?0:a.K-d*a.table_width;this.getMetadata("debug")&&(console.log("FRHP V"+a.ver+" F"+a.flags+" "+a.objbta+" Total:"+a.heap_total+" Alloc:"+a.heap_alloc+" #obj:"+a.heap_nobj+" width:"+a.table_width+" start_blksz:"+a.start_blksz+" max_blksz:"+a.max_blksz+" "+a.max_heapsz+" srows:"+a.rib_srows+" crows:"+a.rib_crows+" "+a.heap_nhuge),console.log("   K: "+a.K+" N: "+a.N));if(0<a.iof_el)throw Error("Filters present in fractal heap.");return a}},{key:"hdf5V2BtreeHeader",value:function(){var a={};if(!this.checkSignature("BTHD"))throw Error("Bad or missing BTHD signature");
a.ver=this.getU8();a.type=this.getU8();a.nodesz=this.getU32();a.recsz=this.getU16();a.depth=this.getU16();a.splitp=this.getU8();a.mergep=this.getU8();a.root_addr=this.getOffset();a.root_nrec=this.getU16();a.total_nrec=this.getLength();a.checksum=this.getU32();this.getMetadata("debug")&&console.log("BTHD V"+a.ver+" T"+a.type+" "+a.nodesz+" "+a.recsz+" "+a.depth+" "+a.root_addr+" "+a.root_nrec+" "+a.total_nrec);return a}},{key:"hdf5V2BtreeRecords",value:function(a,d,b,c){var e,g,l;if(1===d)for(d=0;d<
b;d++)g=this.getOffset(),l=this.getLength(),a=this.getLength(),this.getMetadata("debug")&&console.log("  -> "+g+" "+l+" "+a+" "+this._this._huge_id),e=this.tell(),a===this._this._huge_id&&(this.seek(g),this.hdf5MsgAttribute(l,c)),this.seek(e);else if(8===d){var m,n;m=a.max_heapsz/8;d=Math.min(a.objmax,a.max_blksz);n=256>=d?1:65536>=d?2:4;for(d=0;d<b;d++){e=this.getU8();if(0!==(e&192))throw Error("Bad Fractal Heap ID version "+e);var r=e&48,v;if(16===r)this._this._huge_id=this.getUXX(7);else if(0===
r)g=this.getUXX(m),l=this.getUXX(n);else throw Error("Can't handle this Heap ID: "+e);v=this.getU8();this.getU32();this.getU32();this.getMetadata("debug")&&console.log("  -> "+e+" "+g+" "+l+" "+v);e=this.tell();if(16===r)if(this.seek(a.objbta),r=this.hdf5V2BtreeHeader(),1===r.type)this.seek(r.root_addr),this.hdf5V2BtreeLeafNode(a,r.root_nrec,c);else throw Error("Can only handle type-1 btrees");else r=this.hdf5FractalHeapOffset(a,g),this.seek(r),this.hdf5MsgAttribute(l,c);this.seek(e)}}else throw Error("Unhandled V2 btree type.");
}},{key:"hdf5V2BtreeLeafNode",value:function(a,d,b){if(!this.checkSignature("BTLF"))throw Error("Bad or missing BTLF signature");var c=this.getU8(),g=this.getU8();this.getMetadata("debug")&&console.log("BTLF V"+c+" T"+g+" "+this.tell());this.hdf5V2BtreeRecords(a,g,d,b)}},{key:"hdf5V2BtreeInternalNode",value:function(a,d,b,c){if(!this.checkSignature("BTIN"))throw Error("Bad or missing BTIN signature");var e=this.getU8(),g=this.getU8();this.getMetadata("debug")&&console.log("BTIN V"+e+" T"+g);this.hdf5V2BtreeRecords(a,
g,d,c);for(a=0;a<=d;a++){c=this.getOffset();var e=this.getUXX(1),l;1<b&&(l=this.getUXX(1));this.getMetadata("debug")&&console.log(" child->"+c+" "+e+" "+l)}}},{key:"hdf5GetMsgName",value:function(a){var d="NIL;Dataspace;LinkInfo;Datatype;FillValue 1;FillValue 2;Link;ExternalFiles;Layout;BOGUS;GroupInfo;FilterPipeline;Attribute;ObjectComment;ObjectModTime 1;SharedMsgTable;ObjHdrContinue;SymbolTable;ObjectModTime 2;BtreeKValue;DriverInfo;AttrInfo;ObjectRefCnt;MESSAGE23;FileSpaceInfo".split(";");if(a<
d.length)return d[a];throw Error("Unknown message type "+a+" "+this.tell());}},{key:"hdf5V1BtreeNode",value:function(a){var d=this._getInput(),b,c={};if(!this.checkSignature("TREE"))throw Error("Bad TREE signature at "+this.tell());c.keys=[];c.node_type=this.getU8();c.node_level=this.getU8();c.entries_used=this.getU16();c.left_sibling=this.getOffset();c.right_sibling=this.getOffset();this.getMetadata("debug")&&console.log("BTREE type "+c.node_type+" lvl "+c.node_level+" n_used "+c.entries_used+" "+
c.left_sibling+" "+c.right_sibling);if(a){var f,k=[];for(b=0;b<c.entries_used;b+=1){c.keys[b]={};k[b]={};k[b].chunk_size=this.getU32();k[b].filter_mask=this.getU32();k[b].chunk_offsets=[];for(f=0;f<a.dims.length+1;f+=1)k[b].chunk_offsets.push(this.getU64());c.keys[b].child_address=this.getOffset();b<c.entries_used&&this.getMetadata("debug")&&console.log("  BTREE "+b+" chunk_size "+k[b].chunk_size+" filter_mask "+k[b].filter_mask+" addr "+c.keys[b].child_address)}k[b]={};k[b].chunk_size=this.getU32();
k[b].filter_mask=this.getU32();k[b].chunk_offsets=[];for(f=0;f<a.dims.length+1;f+=1)k[b].chunk_offsets.push(this.getU64());if(0===c.node_level){var l;for(b=0;b<c.entries_used;b+=1)if(f=k[b].chunk_size,l=c.keys[b].child_address,a.inflate){f=new Uint8Array(d,l,f);l=Da.inflate(f);switch(a.type){case this._type_enum.INT8:l=new Int8Array(l.buffer);break;case this._type_enum.UINT8:l=new Uint8Array(l.buffer);break;case this._type_enum.INT16:l=new Int16Array(l.buffer);break;case this._type_enum.UINT16:l=
new Uint16Array(l.buffer);break;case this._type_enum.INT32:l=new Int32Array(l.buffer);break;case this._type_enum.UINT32:l=new Uint32Array(l.buffer);break;case this._type_enum.FLT:l=new Float32Array(l.buffer);break;case this._type_enum.DBL:l=new Float64Array(l.buffer);break;default:throw Error("Unknown type code "+a.type);}a.array.length-a.n_filled<l.length&&(l=l.subarray(0,a.array.length-a.n_filled));a.array.set(l,a.n_filled);a.n_filled+=l.length;this.getMetadata("debug")&&console.log(a.name+" "+
f.length+" "+l.length+" "+a.n_filled+"/"+a.array.length)}else l=this.getArray(a.type,f,l),a.array.set(l,a.n_filled),a.n_filled+=l.length}else for(b=0;b<c.entries_used;b+=1)this.seek(c.keys[b].child_address),this.hdf5V1BtreeNode(a)}else for(b=0;b<c.entries_used;b+=1)c.keys[b]={},c.keys[b].key_value=this.getLength(),c.keys[b].child_address=this.getOffset(),this.getMetadata("debug")&&console.log("  BTREE "+b+" key "+c.keys[b].key_value+" adr "+c.keys[b].child_address);return c}},{key:"hdf5GroupSymbolTable",
value:function(a,d){if(!this.checkSignature("SNOD"))throw Error("Bad or missing SNOD signature");var b=this.getU8();this.skip(1);var c=this.getU16();this.getMetadata("debug")&&console.log("this.hdf5GroupSymbolTable V"+b+" #"+c+" '"+d.name+"'");for(var f,k,l,m,n,b=0;b<2*this._superblk.gln_k;b+=1)f=this.getOffset(),k=this.getOffset(),l=this.getU32(),this.skip(20),b<c&&(m=this.createLink(),m.hdr_offset=k,a&&(n=this.tell(),this.seek(a.lh_dseg_off+f),m.name=this.getString(a.lh_dseg_len),this.seek(n)),
this.getMetadata("debug")&&console.log("    "+b+" O "+f+" A "+k+" T "+l+" '"+m.name+"'"),d.children.push(m))}},{key:"hdf5LocalHeap",value:function(){var a={};if(!this.checkSignature("HEAP"))throw Error("Bad or missing HEAP signature");a.lh_ver=this.getU8();this.skip(3);a.lh_dseg_len=this.getLength();a.lh_flst_len=this.getLength();a.lh_dseg_off=this.getOffset();this.getMetadata("debug")&&console.log("LHEAP V"+a.lh_ver+" "+a.lh_dseg_len+" "+a.lh_flst_len+" "+a.lh_dseg_off);return a}},{key:"hdf5MsgDataspace",
value:function(a,d){var b,c=this.getU8(),f=this.getU8(),k=this.getU8();1>=c?this.skip(5):this.skip(1);var l=1,m=[],n;for(n=0;n<f;n+=1)m[n]=this.getLength(),l*=m[n];b=f*this._superblk.lensz+(1>=c?8:4);if(0!==(k&1))for(b+=f*this._superblk.lensz,n=0;n<f;n+=1)this.getLength();if(0!==(k&2))for(b+=f*this._superblk.lensz,n=0;n<f;n+=1)this.getLength();c="this.hdf5MsgDataspace V"+c+" N"+f+" F"+k;this.getMetadata("debug")&&(0!==f&&(c+="["+m.join(", ")+"]"),console.log(c));b<a&&this.skip(a-b);d&&(d.dims=m);
return l}},{key:"hdf5MsgLinkInfo",value:function(a){var d=this,b=this.getU8(),c=this.getU8();0!==(c&1)&&this.getU64();var f=this.getOffset(),k=this.getOffset();0!==(c&2)&&this.getOffset();this.getMetadata("debug")&&console.log("this.hdf5MsgLinkInfo V"+b+" F"+c+" FH "+f+" BT "+k);b=this.tell();if(f<this._superblk.eof_addr){this.seek(f);var l=this.hdf5FractalHeapHeader(),m=0;this.hdf5FractalHeapEnumerate(l,function(b,c,e,g){for(b=c+g;m<l.heap_nobj&&d.tell()<b;)d.hdf5MsgLink(a),m+=1;return!0})}this.seek(b)}},
{key:"dt_class_name",value:function(a){var d="Fixed-Point Floating-Point Time String BitField Opaque Compound Reference Enumerated Variable-Length Array".split(" ");if(a<d.length)return d[a];throw Error("Unknown datatype class: "+a);}},{key:"hdf5MsgDatatype",value:function(a){var d={},b=8,c,f,k,l,m,n,r,v,q=this.getU8();c=q>>4;f=q&15;l=[];for(q=0;3>q;q+=1)l[q]=this.getU8();q=this.getU32();this.getMetadata("debug")&&console.log("this.hdf5MsgDatatype V"+c+" C"+f+" "+this.dt_class_name(f)+" "+l[0]+"."+
l[1]+"."+l[2]+" "+q);switch(f){case 0:f=this.getU16();k=this.getU16();switch(q){case 4:d.typ_type=l[0]&8?this._type_enum.INT32:this._type_enum.UINT32;break;case 2:d.typ_type=l[0]&8?this._type_enum.INT16:this._type_enum.UINT16;break;case 1:d.typ_type=l[0]&8?this._type_enum.INT8:this._type_enum.UINT8;break;default:throw Error("Unknown type size "+q);}d.typ_length=q;b+=4;this.getMetadata("debug")&&console.log("  ("+f+" "+k+")");break;case 1:c="";if(this.getMetadata("debug"))switch(l[0]&65){case 0:c+=
"LE ";break;case 1:c+="BE ";break;case 65:c+="VX ";break;default:throw Error("Reserved fp byte order: "+l[0]);}f=this.getU16();k=this.getU16();l=this.getU8();m=this.getU8();n=this.getU8();r=this.getU8();v=this.getU32();this.getMetadata("debug")&&(c+=f+" "+k+" "+l+" "+m+" "+n+" "+r+" "+v);if(64===k&&0===f&&52===l&&11===m&&0===n&&52===r&&1023===v&&8===q)d.typ_type=this._type_enum.DBL;else if(32===k&&0===f&&23===l&&8===m&&0===n&&23===r&&127===v&&4===q)d.typ_type=this._type_enum.FLT;else throw Error("Unsupported floating-point type");
this.getMetadata("debug")&&console.log(c);d.typ_length=q;b+=12;break;case 3:d.typ_type=this._type_enum.STR;d.typ_length=q;break;default:throw Error("Unimplemented HDF5 data class "+f);}a>b&&this.skip(a-b);return d}},{key:"hdf5MsgLayout",value:function(a){var b="",c=this.getU8(),e,f,k,l=[];k=1;if(1===c||2===c){f=this.getU8();e=this.getU8();this.skip(5);this.getMetadata("debug")&&(b+="this.hdf5MsgLayout V"+c+" N"+f+" C"+e);if(1===e||2===e)c=this.getOffset(),this.getMetadata("debug")&&(b+=" A"+c),a.data_offset=
c;for(c=0;c<f;c+=1)l[c]=this.getU32(),k*=l[c];this.getMetadata("debug")&&(b+="["+l.join(", ")+"]");2===e&&(f=this.getU32(),a.chunk_size=k*f,this.getMetadata("debug")&&(b+=" E"+f));0===e?(k=this.getU32(),this.getMetadata("debug")&&(b+="("+k+")"),a.data_offset=this.tell(),a.data_length=k):1===e&&(a.data_length=k)}else if(3===c)if(e=this.getU8(),b="this.hdf5MsgLayout V"+c+" C"+e,0===e)k=this.getU16(),this.getMetadata("debug")&&(b+="("+k+")"),a.data_offset=this.tell(),a.data_length=k;else if(1===e)e=
this.getOffset(),k=this.getLength(),this.getMetadata("debug")&&(b+="("+e+", "+k+")"),a.data_offset=e,a.data_length=k;else{if(2===e){f=this.getU8();e=this.getOffset();a.data_offset=e;a.chunk_size=1;for(c=0;c<f-1;c+=1)l[c]=this.getU32(),k*=l[c];this.getMetadata("debug")&&(b+="(N"+f+", A"+e+" ["+l.join(",")+"]");f=this.getU32();a.chunk_size=k*f;this.getMetadata("debug")&&(b+=" E"+f)}}else throw Error("Illegal layout version "+c);this.getMetadata("debug")&&console.log(b)}},{key:"hdf5MsgPipeline",value:function(a){var b=
this.getU8(),c=this.getU8(),e="this.hdf5MsgPipeline V"+b+" N"+c;1===b&&this.skip(6);this.getMetadata("debug")&&console.log(e);for(var f,k,l,m,e=0;e<c;e+=1){f=this.getU16();if(1!==f)throw Error("Unimplemented HDF5 filter "+f);if("object"!==("undefined"===typeof Da?"undefined":H(Da)))throw Error("Need pako to inflate data.");a.inflate=!0;k=1===b||256<f?this.getU16():0;l=this.getU16();m=this.getU16();0!==(m&1)&&(m+=1);0!==k&&this.skip(k);this.skip(4*m);this.getMetadata("debug")&&console.log("  "+e+" ID"+
f+" F"+l+" "+m)}}},{key:"hdf5MsgAttribute",value:function(a,b){var d=this.getU8(),c=this.getU8(),f=this.getU16(),k=this.getU16(),l=this.getU16(),m="this.hdf5MsgAttribute V"+d+" F"+c+" "+a+": ";if(0!==(c&3))throw Error("Shared dataspaces and datatypes are not supported.");3===d&&(c=this.getU8(),this.getMetadata("debug")&&(m+=0===c?"ASCII":"UTF-8"));this.getMetadata("debug")&&(m+="("+f+" "+k+" "+l+")");3>d&&(f=8*Math.floor((f+7)/8),k=8*Math.floor((k+7)/8),l=8*Math.floor((l+7)/8),this.getMetadata("debug")&&
(m+="/("+f+" "+k+" "+l+")"));c=this.getString(f);this.getMetadata("debug")&&console.log(m+(" Name: "+c));var m=this.hdf5MsgDatatype(k),n=this.hdf5MsgDataspace(l);a=0<a?3>d?a-(8+f+k+l):a-(9+f+k+l):m.typ_length*n;this.getMetadata("debug")&&console.log("  attribute data size "+a+" "+this.tell());a=m.typ_type===this._type_enum.STR?this.getString(a):this.getArray(m.typ_type,a);b.attributes[c]=a}},{key:"hdf5MsgGroupInfo",value:function(){var a=4,b=8,c=this.getU8(),e=this.getU8();0!==(e&1)&&(this.getU16(),
this.getU16());0!==(e&2)&&(a=this.getU16(),b=this.getU16());this.getMetadata("debug")&&console.log("this.hdf5MsgGroupInfo V"+c+" F"+e+" ENT "+a+" LNL "+b)}},{key:"hdf5MsgLink",value:function(a){var b=this.getU8(),c=0;if(1!==b)throw Error("Bad link message version "+b);var e=this.getU8();0!==(e&8)&&(c=this.getU8());0!==(e&4)&&this.getU64();0!==(e&16)&&this.getU8();var f=this.getUXX(1<<(e&3)),k=this.createLink();k.name=this.getString(f);0===(e&8)&&(k.hdr_offset=this.getOffset());this.getMetadata("debug")&&
console.log("this.hdf5MsgLink V"+b+" F"+e+" T"+c+" NM "+k.name+" OF "+k.hdr_offset);a.children.push(k)}},{key:"hdf5FractalHeapDirectBlock",value:function(a,b,c,e){if(!this.checkSignature("FHDB"))throw Error("Bad or missing FHDB signature");var d=this.getU8();if(0!==d)throw Error("Bad FHDB version: "+d);this.getOffset();var g=this.getUXX(Math.ceil(a.max_heapsz/8));0!==(a.flags&2)&&this.getU32();this.getMetadata("debug")&&console.log("FHDB V:"+d+" R:"+b+" O:"+g+" A:"+c);a=1>=b?a.start_blksz:Math.pow(2,
b-1)*a.start_blksz;return e?e(b,c,g,a):!0}},{key:"hdf5FractalHeapIndirectBlock",value:function(a,b){if(!this.checkSignature("FHIB"))throw Error("Bad or missing FHIB signature");var d=this.getU8();if(0!==d)throw Error("Bad FHIB version: "+d);this.getOffset();var c=this.getUXX(Math.ceil(a.max_heapsz/8));this.getMetadata("debug")&&console.log("FHIB V:"+d+" O:"+c);for(var f=[],d=0;d<a.K;d+=1)c=this.getOffset(),c<this._superblk.eof_addr&&(this.getMetadata("debug")&&console.log("direct block at "+c),f.push(c));
for(var k=[],d=0;d<a.N;d+=1)c=this.getOffset(),c<this._superblk.eof_addr&&(this.getMetadata("debug")&&console.log("indirect block at "+c),k.push(c));this.getU32();for(d=0;d<f.length;d++)if(this.seek(f[d]),!this.hdf5FractalHeapDirectBlock(a,d/a.table_width,f[d],b))return!1;for(d=0;d<k.length;d++)if(this.seek(k[d]),!this.hdf5FractalHeapIndirectBlock(a,b))return!1;return!0}},{key:"hdf5FractalHeapEnumerate",value:function(a,b){this.seek(a.root_addr);0===a.K?this.hdf5FractalHeapDirectBlock(a,0,a.root_addr,
b):this.hdf5FractalHeapIndirectBlock(a,b)}},{key:"hdf5FractalHeapOffset",value:function(a,b){var d;this.hdf5FractalHeapEnumerate(a,function(a,c,g,l){return b>=g&&b<g+l?(d=c+(b-g),!1):!0});return d}},{key:"hdf5MsgAttrInfo",value:function(a){var b=this.getU8();if(0!==b)throw Error("Bad attribute information message version: "+b);var c=this.getU8();0!==(c&1)&&this.getU16();var e=this.getOffset(),f=this.getOffset();0!==(c&2)&&this.getOffset();this.getMetadata("debug")&&console.log("this.hdf5MsgAttrInfo V"+
b+" F"+c+" HP "+e+" AN "+f);var b=this.tell(),k;e<this._superblk.eof_addr&&(this.seek(e),k=this.hdf5FractalHeapHeader());if(f<this._superblk.eof_addr){this.seek(f);e=this.hdf5V2BtreeHeader();if(8!==e.type)throw Error("Can only handle indexed attributes.");this.seek(e.root_addr);0<e.depth?this.hdf5V2BtreeInternalNode(k,e.root_nrec,e.depth,a):this.hdf5V2BtreeLeafNode(k,e.root_nrec,a)}this.seek(b)}},{key:"hdf5ProcessMessage",value:function(a,b){var d={};switch(a.hm_type){case 1:this.hdf5MsgDataspace(a.hm_size,
b);break;case 2:this.hdf5MsgLinkInfo(b);break;case 3:a=this.hdf5MsgDatatype(a.hm_size);b&&(b.type=a.typ_type);break;case 6:this.hdf5MsgLink(b);break;case 8:this.hdf5MsgLayout(b);break;case 10:this.hdf5MsgGroupInfo();break;case 11:this.hdf5MsgPipeline(b);break;case 12:this.hdf5MsgAttribute(a.hm_size,b);break;case 16:d.cq_off=this.getOffset();d.cq_len=this.getLength();this._continuation_queue.push(d);this.getMetadata("debug")&&console.log("hdf5MsgObjHdrContinue "+d.cq_off+" "+d.cq_len);break;case 17:b.sym_btree=
this.getOffset();b.sym_lheap=this.getOffset();this.getMetadata("debug")&&console.log("hdf5MsgSymbolTable "+b.sym_btree+" "+b.sym_lheap);break;case 21:this.hdf5MsgAttrInfo(b);break;case 0:case 4:case 5:case 7:case 18:case 19:case 20:case 22:case 24:this.skip(a.hm_size);break;default:throw Error("Unknown message type: "+a.hm_type);}}},{key:"hdf5V2ObjectHeader",value:function(a){if(!this.checkSignature("OHDR"))throw Error("Bad or missing OHDR signature");var b=this,c=this.getU8(),e=this.getU8();0!==
(e&32)&&(this.getU32(),this.getU32(),this.getU32(),this.getU32());0!==(e&16)&&(this.getU16(),this.getU16());var f=this.getUXX(1<<(e&3)),k=0,l=0,m=f;for(this.getMetadata("debug")&&console.log("this.hdf5V2ObjectHeader V"+c+" F"+e+" HS"+f);;){for(;8<=m-l;)c={},c.hm_type=this.getU8(),c.hm_size=this.getU16(),c.hm_flags=this.getU8(),this.getMetadata("debug")&&console.log("  msg"+k+" F"+c.hm_flags+" T "+c.hm_type+" S "+c.hm_size+" ("+l+"/"+m+") "+this.hdf5GetMsgName(c.hm_type)),0!==(e&4)&&(c.hm_corder=this.getU16()),
f=this.tell(),this.hdf5ProcessMessage(c,a),this.seek(f+c.hm_size),l+=c.hm_size+4,k+=1;4<m-l&&this.skip(m-(l+4));this.getU32();if(0!==this._continuation_queue.length){if(c=this._continuation_queue.shift(),this.seek(c.cq_off),m=c.cq_len-4,l=0,this.getMetadata("debug")&&console.log("continuing with "+c.cq_len+" bytes at "+this.tell()),!this.checkSignature("OCHK"))throw Error("Bad v2 object continuation");}else break}a.children.forEach(function(a,d){b.seek(a.hdr_offset);b.getMetadata("debug")&&console.log(d+
" "+a.hdr_offset+" "+a.name);b.checkSignature("OHDR")?(b.seek(a.hdr_offset),b.hdf5V2ObjectHeader(a)):(b.seek(a.hdr_offset),b.hdf5V1ObjectHeader(a))})}},{key:"loadData",value:function(a){var b=this;if(0!==a.chunk_size){this.seek(a.data_offset);var c=1,e;for(e=0;e<a.dims.length;e+=1)c*=a.dims[e];c*=this.typeSize(a.type);this.getMetadata("debug")&&console.log("allocating "+c+" bytes");c=new ArrayBuffer(c);a.n_filled=0;switch(a.type){case this._type_enum.INT8:a.array=new Int8Array(c);break;case this._type_enum.UINT8:a.array=
new Uint8Array(c);break;case this._type_enum.INT16:a.array=new Int16Array(c);break;case this._type_enum.UINT16:a.array=new Uint16Array(c);break;case this._type_enum.INT32:a.array=new Int32Array(c);break;case this._type_enum.UINT32:a.array=new Uint32Array(c);break;case this._type_enum.FLT:a.array=new Float32Array(c);break;case this._type_enum.DBL:a.array=new Float64Array(c);break;default:throw Error("Illegal type: "+a.type);}this.hdf5V1BtreeNode(a)}else 0<a.data_offset&&a.data_offset<this._superblk.eof_addr?
(this.getMetadata("debug")&&console.log("loading "+a.data_length+" bytes from "+a.data_offset+" to "+a.name),a.array=this.getArray(a.type,a.data_length,a.data_offset)):this.getMetadata("debug")&&console.log("data not present for /"+a.name+"/");a.children.forEach(function(a){b.loadData(a)})}},{key:"hdf5V1ObjectHeader",value:function(a){var b=this,c,e,f,k;this.startAlignment();c=this.getU8();this.skip(1);e=this.getU16();f=this.getU32();k=this.getU32();if(1!==c)throw Error("Bad v1 object header version: "+
c);this.getMetadata("debug")&&console.log("this.hdf5V1ObjectHeader V"+c+" #M "+e+" RC "+f+" HS "+k);f=k;var l;for(c=0;c<e;c+=1){if(8>=f)if(0!==this._continuation_queue.length)f=this._continuation_queue.shift(),this.seek(f.cq_off),f=f.cq_len,this.getMetadata("debug")&&console.log("continuing with "+f+" bytes at "+this.tell()),this.startAlignment();else break;this.checkAlignment();k={};k.hm_type=this.getU16();k.hm_size=this.getU16();k.hm_flags=this.getU8();if(0!==k.hm_size%8)throw Error("Size is not 8-byte aligned: "+
k.hm_size);this.skip(3);f-=8+k.hm_size;this.getMetadata("debug")&&console.log("  msg"+c+" F "+k.hm_flags+" T "+k.hm_type+" S "+k.hm_size+"("+f+") "+this.hdf5GetMsgName(k.hm_type));l=this.tell();this.hdf5ProcessMessage(k,a);this.seek(l+k.hm_size)}if(0!==a.sym_btree&&0!==a.sym_lheap){this.seek(a.sym_btree);e=this.hdf5V1BtreeNode();this.seek(a.sym_lheap);c=this.hdf5LocalHeap();for(f=0;f<e.entries_used;f+=1)this.seek(e.keys[f].child_address),this.checkSignature("SNOD")?(this.seek(e.keys[f].child_address),
this.hdf5GroupSymbolTable(c,a)):(this.seek(e.keys[f].child_address),this.hdf5V1ObjectHeader(a));a.children.forEach(function(a){b.seek(a.hdr_offset);b.hdf5V1ObjectHeader(a)})}}},{key:"getTypeMatchMinc",value:function(a){return this._type_matching[a-1]}},{key:"defined",value:function(a){return"undefined"!==typeof a}},{key:"typeName",value:function(a){return this.defined(a)?a.constructor.name:"undefined"}},{key:"typeSize",value:function(a){if(a>=this._type_enum.INT8&&a<this.type_sizes.length)return this.type_sizes[a];
throw Error("Unknown type "+a);}},{key:"typeIsFloat",value:function(a){return a>=this._type_enum.FLT&&a<=this._type_enum.DBL}},{key:"join",value:function(a,b){var d="";if(a&&a.length){var c;for(c=0;c<a.length-1;c+=1)d+=a[c],d+=b;d+=a[c]}return d}},{key:"printStructure",value:function(a,b){var d=this,c,f="";for(c=0;c<2*b;c+=1)f+=" ";f+=a.name+(a.children.length?"/":"");0<a.type&&(f+=" "+this.typeName(a.array),a.dims.length&&(f+="["+a.dims.join(", ")+"]"),f=a.array?f+(":"+a.array.length):f+" NULL");
console.log(f);Object.keys(a.attributes).forEach(function(e){var g=a.attributes[e];f="";for(c=0;c<2*b+1;c+=1)f+=" ";f+=a.name+":"+e+" "+d.typeName(g)+"["+g.length+"] ";"string"===typeof g?f+=JSON.stringify(g):(f+="{"+d.join(g.slice(0,16),", "),16<g.length&&(f+=", ..."),f+="}");console.log(f)});a.children.forEach(function(a){d.printStructure(a,b+1)})}},{key:"findDataset",value:function(a,b,c){var d=this,g;a&&a.name===b&&0<a.type?g=a:a.children.find(function(a){g=d.findDataset(a,b,c+1);return d.defined(g)});
return g}},{key:"findAttribute",value:function(a,b,c){var d=this,g=a.attributes[b];if(g)return g;a.children.find(function(a){g=d.findAttribute(a,b,c+1);return d.defined(g)});return g}},{key:"scaleVoxels",value:function(a,b,c,e,f){var d,g;switch(this.getTypeMatchMinc(a.type)){case "int8":d=new ArrayBuffer(a.array.length*Int8Array.BYTES_PER_ELEMENT);g=new Int8Array(d);break;case "int16":d=new ArrayBuffer(a.array.length*Int16Array.BYTES_PER_ELEMENT);g=new Int16Array(d);break;case "int32":d=new ArrayBuffer(a.array.length*
Int32Array.BYTES_PER_ELEMENT);g=new Int32Array(d);break;case "float32":d=new ArrayBuffer(a.array.length*Float32Array.BYTES_PER_ELEMENT);g=new Float32Array(d);break;case "float64":d=new ArrayBuffer(a.array.length*Float64Array.BYTES_PER_ELEMENT);g=new Float64Array(d);break;case "uint8":d=new ArrayBuffer(a.array.length*Uint8Array.BYTES_PER_ELEMENT);g=new Uint8Array(d);break;case "uint16":d=new ArrayBuffer(a.array.length*Uint16Array.BYTES_PER_ELEMENT);g=new Uint16Array(d);break;case "uint32":d=new ArrayBuffer(a.array.length*
Uint32Array.BYTES_PER_ELEMENT);g=new Uint32Array(d);break;default:throw b="Unsupported data type: "+header.datatype,console.log({message:b}),Error(b);}if(1>a.dims.length-b.dims.length)throw Error("Too few slice dimensions: "+a.dims.length+" "+b.dims.length);var m=1,n;for(n=b.dims.length;n<a.dims.length;n+=1)m*=a.dims[n];f&&console.log(m+" voxels in slice.");var r=0,v=0,q=-Number.MAX_VALUE,t=Number.MAX_VALUE,p=a.array;c=c.array;var x=b.array;f&&console.log("valid range is "+e[0]+" to "+e[1]);var D,
w=e[0],A,I,G,u=this.typeIsFloat(a.type);for(n=0;n<b.array.length;n+=1)if(f&&console.log(n+" "+x[n]+" "+c[n]+" "+p[n*m]),u)for(I=0;I<m;I+=1)G=p[v],G<e[0]||G>e[1]?g[v]=0:(g[v]=G,r+=G,G>q&&(q=G),G<t&&(t=G)),v+=1;else for(a=e[1]-e[0],D=c[n]-x[n],A=x[n],I=0;I<m;I+=1)G=(p[v]-w)/a*D+A,G=G/c[n]*e[1],g[v]=G,r+=G,v+=1,G>q&&(q=G),G<t&&(t=G);f&&(console.log("Min: "+t),console.log("Max: "+q),console.log("Sum: "+r),console.log("Mean: "+r/v));return d}},{key:"isRgbVolume",value:function(a,b){var d=a.order;return"Uint8Array"===
b.array.constructor.name&&0<d.length&&"vector_dimension"===d[d.length-1]&&3===a.vector_dimension.space_length}},{key:"rgbVoxels",value:function(a){a=a.array;var b=a.length,c=new ArrayBuffer(b/3*4),e=new Uint8Array(c),f,k=0;for(f=0;f<b;f+=3)e[k+0]=a[f+0],e[k+1]=a[f+1],e[k+2]=a[f+2],e[k+3]=255,k+=4;return c}},{key:"parseHeader",value:function(a){var b;try{b=JSON.parse(a)}catch(g){throw a="server did not respond with valid JSON\nResponse was: \n"+a,console.log({message:a}),Error(a);}4===b.order.length&&
(b.order=b.order.slice(1));b.datatype=b.datatype||"uint8";b.xspace.space_length=parseFloat(b.xspace.space_length);b.yspace.space_length=parseFloat(b.yspace.space_length);b.zspace.space_length=parseFloat(b.zspace.space_length);b.xspace.start=parseFloat(b.xspace.start);b.yspace.start=parseFloat(b.yspace.start);b.zspace.start=parseFloat(b.zspace.start);b.xspace.step=parseFloat(b.xspace.step);b.yspace.step=parseFloat(b.yspace.step);b.zspace.step=parseFloat(b.zspace.step);b.xspace.direction_cosines=b.xspace.direction_cosines||
[1,0,0];b.yspace.direction_cosines=b.yspace.direction_cosines||[0,1,0];b.zspace.direction_cosines=b.zspace.direction_cosines||[0,0,1];b.xspace.direction_cosines=b.xspace.direction_cosines.map(parseFloat);b.yspace.direction_cosines=b.yspace.direction_cosines.map(parseFloat);b.zspace.direction_cosines=b.zspace.direction_cosines.map(parseFloat);b[b.order[0]].offset=b[b.order[1]].space_length*b[b.order[2]].space_length;b[b.order[1]].offset=b[b.order[2]].space_length;b[b.order[2]].offset=1;b.time&&(b.time.space_length=
parseFloat(b.time.space_length),b.time.start=parseFloat(b.time.start),b.time.step=parseFloat(b.time.step),b.time.offset=b.xspace.space_length*b.yspace.space_length*b.zspace.space_length);return b}},{key:"createMincData",value:function(a,b){switch(a.datatype){case "int8":a=new Int8Array(b);break;case "int16":a=new Int16Array(b);break;case "int32":a=new Int32Array(b);break;case "float32":a=new Float32Array(b);break;case "float64":a=new Float64Array(b);break;case "uint8":a=new Uint8Array(b);break;case "uint16":a=
new Uint16Array(b);break;case "uint32":case "rgb8":a=new Uint32Array(b);break;default:throw a="Unsupported data type: "+a.datatype,console.log({message:a}),Error(a);}return a}},{key:"_run",value:function(){var a=this,b=this._getInput(0);if(b){this._dv=new DataView(b);this._dv.getUint64=function(b,d){var c=a._dv.getUint32(b+0,d);b=a._dv.getUint32(b+4,d);return d?(b<<32)+c:(c<<32)+b};var c=this.createLink();try{this._superblk=this.hdf5Superblock()}catch(n){console.warn("The input file is not a Minc2 file.");
return}this.seek(this._superblk.root_addr);1>=this._superblk.sbver?this.hdf5V1ObjectHeader(c):this.hdf5V2ObjectHeader(c);this.loadData(c);this.getMetadata("debug")&&this.printStructure(c,0);b=this.findDataset(c,"image");if(!this.defined(b))throw Error("Can't find image dataset.");var e=this.findAttribute(b,"valid_range",0);if(!this.defined(e)){var f,k;switch(b.type){case this._type_enum.INT8:f=-128;k=127;break;case this._type_enum.UINT8:f=0;k=255;break;case this._type_enum.INT16:f=-32768;k=32767;
break;case this._type_enum.UINT16:f=0;k=65535;break;case this._type_enum.INT32:f=2147483648;k=-2147483649;break;case this._type_enum.UINT32:f=0,k=(1<<32)-1}e=Float32Array.of(f,k)}f=this.findDataset(c,"image-min");this.defined(f)||(f={array:Float32Array.of(0),dims:[]});k=this.findDataset(c,"image-max");this.defined(k)||(k={array:Float32Array.of(1),dims:[]});var l={},m=this.findAttribute(b,"dimorder",0);if("string"!==typeof m)throw Error("Can't find dimension order.");l.order=m.split(",");l.order.forEach(function(b){var d=
a.findDataset(c,b);if(!a.defined(d))throw Error("Can't find dimension variable "+b);l[b]={};m=a.findAttribute(d,"step",0);a.defined(m)||(m=Float32Array.of(1));l[b].step=m[0];m=a.findAttribute(d,"start",0);a.defined(m)||(m=Float32Array.of(0));l[b].start=m[0];m=a.findAttribute(d,"length",0);if(!a.defined(m))throw Error("Can't find length for "+b);l[b].space_length=m[0];m=a.findAttribute(d,"direction_cosines",0);a.defined(m)?l[b].direction_cosines=Array.prototype.slice.call(m):"xspace"===b?l[b].direction_cosines=
[1,0,0]:"yspace"===b?l[b].direction_cosines=[0,1,0]:"zspace"===b&&(l[b].direction_cosines=[0,0,1])});this.isRgbVolume(l,b)?(l.order.pop(),l.datatype="rgb8",e=this.rgbVoxels(b)):(l.datatype=this.getTypeMatchMinc(b.type),e=this.scaleVoxels(b,f,k,e,this.getMetadata("debug")));b=this.parseHeader(JSON.stringify(l));e=this.createMincData(b,e);this._addOutput(db);f=this.getOutput();f.setData(e,b);f.setMetadata("format","minc2")}else console.warn('Minc2Decoder requires an ArrayBuffer as input "0". Unable to continue.')}}]);
return b}(V),ph=function(c){function b(){N(this,b);var a=P(this,(b.__proto__||Object.getPrototypeOf(b)).call(this));a.addInputValidator(0,ArrayBuffer);a.setMetadata("debug",!1);return a}M(b,c);O(b,[{key:"parseNifti1Header",value:function(a){var b={order:[],xspace:{},yspace:{},zspace:{}},c=null,e=new DataView(a,0,348),f=new Uint8Array(a,0,348);a=!0;var k=e.getUint32(0,!0);348===k?a=!0:1543569408===k?a=!1:c="This does not look like a NIfTI-1 file.";k=e.getUint16(40,a);if(3>k||4<k)c="Cannot handle "+
k+"-dimensional images yet.";f=String.fromCharCode.apply(null,f.subarray(344,348));"n+1\x00"!==f&&(c="Bad magic number: '"+f+"'");if(c)return console.warn("The input file is not a NIfTI file."),null;b.xspace.space_length=e.getUint16(42,a);b.yspace.space_length=e.getUint16(44,a);b.zspace.space_length=e.getUint16(46,a);var c=e.getUint16(48,a),f=e.getUint16(70,a),l=e.getUint16(72,a),m=e.getFloat32(80,a),n=e.getFloat32(84,a),r=e.getFloat32(88,a),v=e.getFloat32(92,a),k=e.getFloat32(108,a);352>k&&(k=352);
var q=e.getFloat32(112,a),t=e.getFloat32(116,a),p=e.getUint16(252,a),x=e.getUint16(254,a),D=[[1,0,0,0],[0,1,0,0],[0,0,1,0],[0,0,0,1]];1<=c&&(b.time={},b.time.space_length=c,b.time.step=v,b.time.start=0,b.time.name="time");b.bytes_per_voxel=l/8;b.must_swap_data=!a&&1<b.bytes_per_voxel;if(0<x)D[0][0]=e.getFloat32(280,a),D[0][1]=e.getFloat32(284,a),D[0][2]=e.getFloat32(288,a),D[0][3]=e.getFloat32(292,a),D[1][0]=e.getFloat32(296,a),D[1][1]=e.getFloat32(300,a),D[1][2]=e.getFloat32(304,a),D[1][3]=e.getFloat32(308,
a),D[2][0]=e.getFloat32(312,a),D[2][1]=e.getFloat32(316,a),D[2][2]=e.getFloat32(320,a),D[2][3]=e.getFloat32(324,a);else if(0<p)var D=e.getFloat32(256,a),l=e.getFloat32(260,a),v=e.getFloat32(264,a),p=e.getFloat32(268,a),x=e.getFloat32(272,a),w=e.getFloat32(276,a),A=0>e.getFloat32(76,a)?-1:1,D=this.niftiQuaternToMat44(D,l,v,p,x,w,m,n,r,A);else D[0][0]=m,D[1][1]=n,D[2][2]=r;n=[0,1,2];r=[[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,1]];for(m=0;3>m;m++)l=Math.abs(D[0][m]),v=Math.abs(D[1][m]),p=Math.abs(D[2][m]),
l>v&&l>p?(b.order[2-m]="xspace",n[m]=0):v>l&&v>p?(b.order[2-m]="yspace",n[m]=1):(b.order[2-m]="zspace",n[m]=2);for(m=0;3>m;m++)for(l=0;4>l;l++)v=l,3>l&&(v=n[l]),r[m][v]=D[m][l];db.transformToMinc(r,b);b[b.order[2]].space_length=e.getUint16(42,a);b[b.order[1]].space_length=e.getUint16(44,a);b[b.order[0]].space_length=e.getUint16(46,a);1<=c&&b.order.unshift("time");b.datatype=f;b.vox_offset=k;b.scl_slope=q;b.scl_inter=t;return b}},{key:"niftiQuaternToMat44",value:function(a,b,c,e,f,k,l,m,n,r){var d=
[[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,1]],g;g=1-(a*a+b*b+c*c);1E-7>g?(g=1/Math.sqrt(a*a+b*b+c*c),a*=g,b*=g,c*=g,g=0):g=Math.sqrt(g);l=0<l?l:1;m=0<m?m:1;n=0<n?n:1;0>r&&(n=-n);d[0][0]=(g*g+a*a-b*b-c*c)*l;d[0][1]=2*(a*b-g*c)*m;d[0][2]=2*(a*c+g*b)*n;d[1][0]=2*(a*b+g*c)*l;d[1][1]=(g*g+b*b-a*a-c*c)*m;d[1][2]=2*(b*c-g*a)*n;d[2][0]=2*(a*c-g*b)*l;d[2][1]=2*(b*c+g*a)*m;d[2][2]=(g*g+c*c-b*b-a*a)*n;d[0][3]=e;d[1][3]=f;d[2][3]=k;return d}},{key:"createNifti1Data",value:function(a,b){a.must_swap_data&&db.swapn(new Uint8Array(b,
a.vox_offset),a.bytes_per_voxel);switch(a.datatype){case 2:b=new Uint8Array(b,a.vox_offset);break;case 4:b=new Int16Array(b,a.vox_offset);break;case 8:b=new Int32Array(b,a.vox_offset);break;case 16:b=new Float32Array(b,a.vox_offset);break;case 64:b=new Float64Array(b,a.vox_offset);break;case 256:b=new Int8Array(b,a.vox_offset);break;case 512:b=new Uint16Array(b,a.vox_offset);break;case 768:b=new Uint32Array(b,a.vox_offset);break;default:throw Error("Unsupported data type: "+a.datatype);}var d,c=a.scl_slope,
f=a.scl_inter;if(0!==c){var k=new Float32Array(b.length);for(d=0;d<b.length;d++)k[d]=b[d]*c+f;b=k}4===a.order.length&&(a.order=a.order.slice(1));a[a.order[0]].offset=a[a.order[1]].space_length*a[a.order[2]].space_length;a[a.order[1]].offset=a[a.order[2]].space_length;a[a.order[2]].offset=1;a.time&&(a.time.offset=a.xspace.space_length*a.yspace.space_length*a.zspace.space_length);return b}},{key:"_run",value:function(){var a=this._getInput(0);if(a){var b=null;try{b=this.parseNifti1Header(a)}catch(e){}if(b){a=
this.createNifti1Data(b,a);this._addOutput(db);var c=this.getOutput();c.setData(a,b);c.setMetadata("format","nifti")}else console.warn("This file is not a NIfTI file.")}else console.warn('NiftiDecoder requires an ArrayBuffer as input "0". Unable to continue.')}}]);return b}(V),pe=qa(function(c){var b=b||{};b.Utils=b.Utils||{};b.Utils.crcTable=null;b.Utils.GUNZIP_MAGIC_COOKIE1=31;b.Utils.GUNZIP_MAGIC_COOKIE2=139;b.Utils.getStringAt=function(a,b,c){for(var d="",g;b<c;b+=1)g=a.getUint8(b),0!==g&&(d+=
String.fromCharCode(g));return d};b.Utils.getByteAt=function(a,b){return a.getInt8(b)};b.Utils.getShortAt=function(a,b,c){return a.getInt16(b,c)};b.Utils.getIntAt=function(a,b,c){return a.getInt32(b,c)};b.Utils.getFloatAt=function(a,b,c){return a.getFloat32(b,c)};b.Utils.getDoubleAt=function(a,b,c){return a.getFloat64(b,c)};b.Utils.getLongAt=function(a,d,c){var e,g=[],k=0;for(e=0;8>e;e+=1)g[e]=b.Utils.getByteAt(a,d+e,c);for(e=g.length-1;0<=e;e--)k=256*k+g[e];return k};b.Utils.toArrayBuffer=function(a){var b,
c,e;b=new ArrayBuffer(a.length);c=new Uint8Array(b);for(e=0;e<a.length;e+=1)c[e]=a[e];return b};b.Utils.isString=function(a){return"string"===typeof a||a instanceof String};b.Utils.formatNumber=function(a,d){a=b.Utils.isString(a)?Number(a):a;a=d?a.toPrecision(5):a.toPrecision(7);return parseFloat(a)};b.Utils.makeCRCTable=function(){for(var a,b=[],c=0;256>c;c++){a=c;for(var e=0;8>e;e++)a=a&1?3988292384^a>>>1:a>>>1;b[c]=a}return b};b.Utils.crc32=function(a){for(var d=b.Utils.crcTable||(b.Utils.crcTable=
b.Utils.makeCRCTable()),c=-1,e=0;e<a.byteLength;e++)c=c>>>8^d[(c^a.getUint8(e))&255];return(c^-1)>>>0};c.exports&&(c.exports=b.Utils)}),qh=qa(function(c){var b=b||{};b.Utils=b.Utils||("undefined"!==typeof hb?pe:null);b.NIFTI1=b.NIFTI1||function(){this.littleEndian=!1;this.dim_info=0;this.dims=[];this.slice_code=this.slice_end=this.slice_start=this.numBitsPerVoxel=this.datatypeCode=this.intent_code=this.intent_p3=this.intent_p2=this.intent_p1=0;this.pixDims=[];this.vox_offset=0;this.scl_slope=1;this.toffset=
this.slice_duration=this.cal_min=this.cal_max=this.xyzt_units=this.scl_inter=0;this.intent_name=this.aux_file=this.description="";this.qoffset_z=this.qoffset_y=this.qoffset_x=this.quatern_d=this.quatern_c=this.quatern_b=this.sform_code=this.qform_code=0;this.affine=[[1,0,0,0],[0,1,0,0],[0,0,1,0],[0,0,0,1]];this.magic=0;this.isHDR=!1;this.extensionFlag=[0,0,0,0];this.extensionCode=this.extensionSize=0};b.NIFTI1.TYPE_NONE=0;b.NIFTI1.TYPE_BINARY=1;b.NIFTI1.TYPE_UINT8=2;b.NIFTI1.TYPE_INT16=4;b.NIFTI1.TYPE_INT32=
8;b.NIFTI1.TYPE_FLOAT32=16;b.NIFTI1.TYPE_COMPLEX64=32;b.NIFTI1.TYPE_FLOAT64=64;b.NIFTI1.TYPE_RGB24=128;b.NIFTI1.TYPE_INT8=256;b.NIFTI1.TYPE_UINT16=512;b.NIFTI1.TYPE_UINT32=768;b.NIFTI1.TYPE_INT64=1024;b.NIFTI1.TYPE_UINT64=1280;b.NIFTI1.TYPE_FLOAT128=1536;b.NIFTI1.TYPE_COMPLEX128=1792;b.NIFTI1.TYPE_COMPLEX256=2048;b.NIFTI1.XFORM_UNKNOWN=0;b.NIFTI1.XFORM_SCANNER_ANAT=1;b.NIFTI1.XFORM_ALIGNED_ANAT=2;b.NIFTI1.XFORM_TALAIRACH=3;b.NIFTI1.XFORM_MNI_152=4;b.NIFTI1.SPATIAL_UNITS_MASK=7;b.NIFTI1.TEMPORAL_UNITS_MASK=
56;b.NIFTI1.UNITS_UNKNOWN=0;b.NIFTI1.UNITS_METER=1;b.NIFTI1.UNITS_MM=2;b.NIFTI1.UNITS_MICRON=3;b.NIFTI1.UNITS_SEC=8;b.NIFTI1.UNITS_MSEC=16;b.NIFTI1.UNITS_USEC=24;b.NIFTI1.UNITS_HZ=32;b.NIFTI1.UNITS_PPM=40;b.NIFTI1.UNITS_RADS=48;b.NIFTI1.MAGIC_COOKIE=348;b.NIFTI1.STANDARD_HEADER_SIZE=348;b.NIFTI1.MAGIC_NUMBER_LOCATION=344;b.NIFTI1.MAGIC_NUMBER=[110,43,49];b.NIFTI1.MAGIC_NUMBER2=[110,105,49];b.NIFTI1.EXTENSION_HEADER_SIZE=8;b.NIFTI1.prototype.readHeader=function(a){a=new DataView(a);var d=b.Utils.getIntAt(a,
0,this.littleEndian),c,e;d!==b.NIFTI1.MAGIC_COOKIE&&(this.littleEndian=!0,d=b.Utils.getIntAt(a,0,this.littleEndian));if(d!==b.NIFTI1.MAGIC_COOKIE)throw Error("This does not appear to be a NIFTI file!");this.dim_info=b.Utils.getByteAt(a,39);for(c=0;8>c;c+=1)d=40+2*c,this.dims[c]=b.Utils.getShortAt(a,d,this.littleEndian);this.intent_p1=b.Utils.getFloatAt(a,56,this.littleEndian);this.intent_p2=b.Utils.getFloatAt(a,60,this.littleEndian);this.intent_p3=b.Utils.getFloatAt(a,64,this.littleEndian);this.intent_code=
b.Utils.getShortAt(a,68,this.littleEndian);this.datatypeCode=b.Utils.getShortAt(a,70,this.littleEndian);this.numBitsPerVoxel=b.Utils.getShortAt(a,72,this.littleEndian);this.slice_start=b.Utils.getShortAt(a,74,this.littleEndian);for(c=0;8>c;c+=1)d=76+4*c,this.pixDims[c]=b.Utils.getFloatAt(a,d,this.littleEndian);this.vox_offset=b.Utils.getFloatAt(a,108,this.littleEndian);this.scl_slope=b.Utils.getFloatAt(a,112,this.littleEndian);this.scl_inter=b.Utils.getFloatAt(a,116,this.littleEndian);this.slice_end=
b.Utils.getShortAt(a,120,this.littleEndian);this.slice_code=b.Utils.getByteAt(a,122);this.xyzt_units=b.Utils.getByteAt(a,123);this.cal_max=b.Utils.getFloatAt(a,124,this.littleEndian);this.cal_min=b.Utils.getFloatAt(a,128,this.littleEndian);this.slice_duration=b.Utils.getFloatAt(a,132,this.littleEndian);this.toffset=b.Utils.getFloatAt(a,136,this.littleEndian);this.description=b.Utils.getStringAt(a,148,228);this.aux_file=b.Utils.getStringAt(a,228,252);this.qform_code=b.Utils.getShortAt(a,252,this.littleEndian);
this.sform_code=b.Utils.getShortAt(a,254,this.littleEndian);this.quatern_b=b.Utils.getFloatAt(a,256,this.littleEndian);this.quatern_c=b.Utils.getFloatAt(a,260,this.littleEndian);this.quatern_d=b.Utils.getFloatAt(a,264,this.littleEndian);this.qoffset_x=b.Utils.getFloatAt(a,268,this.littleEndian);this.qoffset_y=b.Utils.getFloatAt(a,272,this.littleEndian);this.qoffset_z=b.Utils.getFloatAt(a,276,this.littleEndian);for(c=0;3>c;c+=1)for(e=0;4>e;e+=1)d=280+4*(4*c+e),this.affine[c][e]=b.Utils.getFloatAt(a,
d,this.littleEndian);this.affine[3][0]=0;this.affine[3][1]=0;this.affine[3][2]=0;this.affine[3][3]=1;this.intent_name=b.Utils.getStringAt(a,328,344);this.magic=b.Utils.getStringAt(a,344,348);this.isHDR=this.magic===b.NIFTI1.MAGIC_NUMBER2;a.byteLength>b.NIFTI1.MAGIC_COOKIE&&(this.extensionFlag[0]=b.Utils.getByteAt(a,348),this.extensionFlag[1]=b.Utils.getByteAt(a,349),this.extensionFlag[2]=b.Utils.getByteAt(a,350),this.extensionFlag[3]=b.Utils.getByteAt(a,351),this.extensionFlag[0]&&(this.extensionSize=
this.getExtensionSize(a),this.extensionCode=this.getExtensionCode(a)))};b.NIFTI1.prototype.toFormattedString=function(){var a=b.Utils.formatNumber,d;d=""+("Dim Info = "+this.dim_info+"\n");d+="Image Dimensions (1-8): "+this.dims[0]+", "+this.dims[1]+", "+this.dims[2]+", "+this.dims[3]+", "+this.dims[4]+", "+this.dims[5]+", "+this.dims[6]+", "+this.dims[7]+"\n";d+="Intent Parameters (1-3): "+this.intent_p1+", "+this.intent_p2+", "+this.intent_p3+"\n";d+="Intent Code = "+this.intent_code+"\n";d+="Datatype = "+
this.datatypeCode+" ("+this.getDatatypeCodeString(this.datatypeCode)+")\n";d+="Bits Per Voxel = "+this.numBitsPerVoxel+"\n";d+="Slice Start = "+this.slice_start+"\n";d+="Voxel Dimensions (1-8): "+a(this.pixDims[0])+", "+a(this.pixDims[1])+", "+a(this.pixDims[2])+", "+a(this.pixDims[3])+", "+a(this.pixDims[4])+", "+a(this.pixDims[5])+", "+a(this.pixDims[6])+", "+a(this.pixDims[7])+"\n";d+="Image Offset = "+this.vox_offset+"\n";d+="Data Scale:  Slope = "+a(this.scl_slope)+"  Intercept = "+a(this.scl_inter)+
"\n";d+="Slice End = "+this.slice_end+"\n";d+="Slice Code = "+this.slice_code+"\n";d+="Units Code = "+this.xyzt_units+" ("+this.getUnitsCodeString(b.NIFTI1.SPATIAL_UNITS_MASK&this.xyzt_units)+", "+this.getUnitsCodeString(b.NIFTI1.TEMPORAL_UNITS_MASK&this.xyzt_units)+")\n";d+="Display Range:  Max = "+a(this.cal_max)+"  Min = "+a(this.cal_min)+"\n";d+="Slice Duration = "+this.slice_duration+"\n";d+="Time Axis Shift = "+this.toffset+"\n";d+='Description: "'+this.description+'"\n';d+='Auxiliary File: "'+
this.aux_file+'"\n';d+="Q-Form Code = "+this.qform_code+" ("+this.getTransformCodeString(this.qform_code)+")\n";d+="S-Form Code = "+this.sform_code+" ("+this.getTransformCodeString(this.sform_code)+")\n";d+="Quaternion Parameters:  b = "+a(this.quatern_b)+"  c = "+a(this.quatern_c)+"  d = "+a(this.quatern_d)+"\n";d+="Quaternion Offsets:  x = "+this.qoffset_x+"  y = "+this.qoffset_y+"  z = "+this.qoffset_z+"\n";d+="S-Form Parameters X: "+a(this.affine[0][0])+", "+a(this.affine[0][1])+", "+a(this.affine[0][2])+
", "+a(this.affine[0][3])+"\n";d+="S-Form Parameters Y: "+a(this.affine[1][0])+", "+a(this.affine[1][1])+", "+a(this.affine[1][2])+", "+a(this.affine[1][3])+"\n";d+="S-Form Parameters Z: "+a(this.affine[2][0])+", "+a(this.affine[2][1])+", "+a(this.affine[2][2])+", "+a(this.affine[2][3])+"\n";d+='Intent Name: "'+this.intent_name+'"\n';this.extensionFlag[0]&&(d+="Extension: Size = "+this.extensionSize+"  Code = "+this.extensionCode+"\n");return d};b.NIFTI1.prototype.getDatatypeCodeString=function(a){return a===
b.NIFTI1.TYPE_UINT8?"1-Byte Unsigned Integer":a===b.NIFTI1.TYPE_INT16?"2-Byte Signed Integer":a===b.NIFTI1.TYPE_INT32?"4-Byte Signed Integer":a===b.NIFTI1.TYPE_FLOAT32?"4-Byte Float":a===b.NIFTI1.TYPE_FLOAT64?"8-Byte Float":a===b.NIFTI1.TYPE_RGB24?"RGB":a===b.NIFTI1.TYPE_INT8?"1-Byte Signed Integer":a===b.NIFTI1.TYPE_UINT16?"2-Byte Unsigned Integer":a===b.NIFTI1.TYPE_UINT32?"4-Byte Unsigned Integer":a===b.NIFTI1.TYPE_INT64?"8-Byte Signed Integer":a===b.NIFTI1.TYPE_UINT64?"8-Byte Unsigned Integer":
"Unknown"};b.NIFTI1.prototype.getTransformCodeString=function(a){return a===b.NIFTI1.XFORM_SCANNER_ANAT?"Scanner":a===b.NIFTI1.XFORM_ALIGNED_ANAT?"Aligned":a===b.NIFTI1.XFORM_TALAIRACH?"Talairach":a===b.NIFTI1.XFORM_MNI_152?"MNI":"Unknown"};b.NIFTI1.prototype.getUnitsCodeString=function(a){return a===b.NIFTI1.UNITS_METER?"Meters":a===b.NIFTI1.UNITS_MM?"Millimeters":a===b.NIFTI1.UNITS_MICRON?"Microns":a===b.NIFTI1.UNITS_SEC?"Seconds":a===b.NIFTI1.UNITS_MSEC?"Milliseconds":a===b.NIFTI1.UNITS_USEC?"Microseconds":
a===b.NIFTI1.UNITS_HZ?"Hz":a===b.NIFTI1.UNITS_PPM?"PPM":a===b.NIFTI1.UNITS_RADS?"Rads":"Unknown"};b.NIFTI1.prototype.getQformMat=function(){return this.convertNiftiQFormToNiftiSForm(this.quatern_b,this.quatern_c,this.quatern_d,this.qoffset_x,this.qoffset_y,this.qoffset_z,this.pixDims[1],this.pixDims[2],this.pixDims[3],this.pixDims[0])};b.NIFTI1.prototype.convertNiftiQFormToNiftiSForm=function(a,b,c,e,f,k,l,m,n,r){var d=[[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0]],g=c;d[3][0]=d[3][1]=d[3][2]=0;d[3][3]=
1;c=1-(a*a+b*b+g*g);1E-7>c?(c=1/Math.sqrt(a*a+b*b+g*g),a*=c,b*=c,g*=c,c=0):c=Math.sqrt(c);l=0<l?l:1;m=0<m?m:1;n=0<n?n:1;0>r&&(n=-n);d[0][0]=(c*c+a*a-b*b-g*g)*l;d[0][1]=2*(a*b-c*g)*m;d[0][2]=2*(a*g+c*b)*n;d[1][0]=2*(a*b+c*g)*l;d[1][1]=(c*c+b*b-a*a-g*g)*m;d[1][2]=2*(b*g-c*a)*n;d[2][0]=2*(a*g-c*b)*l;d[2][1]=2*(b*g+c*a)*m;d[2][2]=(c*c+g*g-b*b-a*a)*n;d[0][3]=e;d[1][3]=f;d[2][3]=k;return d};b.NIFTI1.prototype.convertNiftiSFormToNEMA=function(a){var b,c,e,f,k,l,m,n,r,v,q,t,p,x,D,w;D=[[0,0,0],[0,0,0],[0,
0,0]];w=[[0,0,0],[0,0,0],[0,0,0]];b=a[0][0];c=a[0][1];e=a[0][2];f=a[1][0];k=a[1][1];l=a[1][2];m=a[2][0];n=a[2][1];r=a[2][2];a=Math.sqrt(b*b+f*f+m*m);if(0===a)return null;b/=a;f/=a;m/=a;a=Math.sqrt(c*c+k*k+n*n);if(0===a)return null;c/=a;k/=a;n/=a;a=b*c+f*k+m*n;if(1E-4<Math.abs(a)){c-=a*b;k-=a*f;n-=a*m;a=Math.sqrt(c*c+k*k+n*n);if(0===a)return null;c/=a;k/=a;n/=a}a=Math.sqrt(e*e+l*l+r*r);0===a?(e=f*n-m*k,l=m*c-n*b,r=b*k-f*c):(e/=a,l/=a,r/=a);a=b*e+f*l+m*r;if(1E-4<Math.abs(a)){e-=a*b;l-=a*f;r-=a*m;a=
Math.sqrt(e*e+l*l+r*r);if(0===a)return null;e/=a;l/=a;r/=a}a=c*e+k*l+n*r;if(1E-4<Math.abs(a)){e-=a*c;l-=a*k;r-=a*n;a=Math.sqrt(e*e+l*l+r*r);if(0===a)return null;e/=a;l/=a;r/=a}D[0][0]=b;D[0][1]=c;D[0][2]=e;D[1][0]=f;D[1][1]=k;D[1][2]=l;D[2][0]=m;D[2][1]=n;D[2][2]=r;m=this.nifti_mat33_determ(D);if(0===m)return null;x=-666;b=f=k=l=1;c=2;e=3;for(n=1;3>=n;n+=1)for(r=1;3>=r;r+=1)if(n!==r)for(v=1;3>=v;v+=1)if(n!==v&&r!==v)for(w[0][0]=w[0][1]=w[0][2]=w[1][0]=w[1][1]=w[1][2]=w[2][0]=w[2][1]=w[2][2]=0,q=-1;1>=
q;q+=2)for(t=-1;1>=t;t+=2)for(p=-1;1>=p;p+=2)w[0][n-1]=q,w[1][r-1]=t,w[2][v-1]=p,a=this.nifti_mat33_determ(w),0<a*m&&(a=this.nifti_mat33_mul(w,D),a=a[0][0]+a[1][1]+a[2][2],a>x&&(x=a,b=n,c=r,e=v,f=q,k=t,l=p));D=w=a=m=n=r=0;switch(b*f){case 1:D="X";m="+";break;case -1:D="X";m="-";break;case 2:D="Y";m="+";break;case -2:D="Y";m="-";break;case 3:D="Z";m="+";break;case -3:D="Z",m="-"}switch(c*k){case 1:w="X";n="+";break;case -1:w="X";n="-";break;case 2:w="Y";n="+";break;case -2:w="Y";n="-";break;case 3:w=
"Z";n="+";break;case -3:w="Z",n="-"}switch(e*l){case 1:a="X";r="+";break;case -1:a="X";r="-";break;case 2:a="Y";r="+";break;case -2:a="Y";r="-";break;case 3:a="Z";r="+";break;case -3:a="Z",r="-"}return D+w+a+m+n+r};b.NIFTI1.prototype.nifti_mat33_mul=function(a,b){var d=[[0,0,0],[0,0,0],[0,0,0]],c,f;for(c=0;3>c;c+=1)for(f=0;3>f;f+=1)d[c][f]=a[c][0]*b[0][f]+a[c][1]*b[1][f]+a[c][2]*b[2][f];return d};b.NIFTI1.prototype.nifti_mat33_determ=function(a){var b,c,e,f,k,l,m,n;b=a[0][0];c=a[0][1];e=a[0][2];f=
a[1][0];k=a[1][1];l=a[1][2];m=a[2][0];n=a[2][1];a=a[2][2];return b*k*a-b*n*l-f*c*a+f*n*e+m*c*l-m*k*e};b.NIFTI1.prototype.getExtensionLocation=function(){return b.NIFTI1.MAGIC_COOKIE+4};b.NIFTI1.prototype.getExtensionSize=function(a){return b.Utils.getIntAt(a,this.getExtensionLocation(),this.littleEndian)};b.NIFTI1.prototype.getExtensionCode=function(a){return b.Utils.getIntAt(a,this.getExtensionLocation()+4,this.littleEndian)};c.exports&&(c.exports=b.NIFTI1)}),wj=qa(function(c){var b=b||{};b.Utils=
b.Utils||("undefined"!==typeof hb?pe:null);b.NIFTI1=b.NIFTI1||("undefined"!==typeof hb?qh:null);b.NIFTI2=b.NIFTI2||function(){this.littleEndian=!1;this.dim_info=0;this.dims=[];this.slice_code=this.slice_end=this.slice_start=this.numBitsPerVoxel=this.datatypeCode=this.intent_code=this.intent_p3=this.intent_p2=this.intent_p1=0;this.pixDims=[];this.vox_offset=0;this.scl_slope=1;this.toffset=this.slice_duration=this.cal_min=this.cal_max=this.xyzt_units=this.scl_inter=0;this.intent_name=this.aux_file=
this.description="";this.qoffset_z=this.qoffset_y=this.qoffset_x=this.quatern_d=this.quatern_c=this.quatern_b=this.sform_code=this.qform_code=0;this.affine=[[1,0,0,0],[0,1,0,0],[0,0,1,0],[0,0,0,1]];this.magic=0;this.extensionFlag=[0,0,0,0]};b.NIFTI2.MAGIC_COOKIE=540;b.NIFTI2.MAGIC_NUMBER_LOCATION=4;b.NIFTI2.MAGIC_NUMBER=[110,43,50,0,13,10,26,10];b.NIFTI2.prototype.readHeader=function(a){a=new DataView(a);var d=b.Utils.getIntAt(a,0,this.littleEndian),c,e;d!==b.NIFTI2.MAGIC_COOKIE&&(this.littleEndian=
!0,d=b.Utils.getIntAt(a,0,this.littleEndian));if(d!==b.NIFTI2.MAGIC_COOKIE)throw Error("This does not appear to be a NIFTI file!");this.datatypeCode=b.Utils.getShortAt(a,12,this.littleEndian);this.numBitsPerVoxel=b.Utils.getShortAt(a,14,this.littleEndian);for(c=0;8>c;c+=1)d=16+8*c,this.dims[c]=b.Utils.getLongAt(a,d,this.littleEndian);this.intent_p1=b.Utils.getDoubleAt(a,80,this.littleEndian);this.intent_p2=b.Utils.getDoubleAt(a,88,this.littleEndian);this.intent_p3=b.Utils.getDoubleAt(a,96,this.littleEndian);
for(c=0;8>c;c+=1)d=104+8*c,this.pixDims[c]=b.Utils.getDoubleAt(a,d,this.littleEndian);this.vox_offset=b.Utils.getLongAt(a,168,this.littleEndian);this.scl_slope=b.Utils.getDoubleAt(a,176,this.littleEndian);this.scl_inter=b.Utils.getDoubleAt(a,184,this.littleEndian);this.cal_max=b.Utils.getDoubleAt(a,192,this.littleEndian);this.cal_min=b.Utils.getDoubleAt(a,200,this.littleEndian);this.slice_duration=b.Utils.getDoubleAt(a,208,this.littleEndian);this.toffset=b.Utils.getDoubleAt(a,216,this.littleEndian);
this.slice_start=b.Utils.getLongAt(a,224,this.littleEndian);this.slice_end=b.Utils.getLongAt(a,232,this.littleEndian);this.description=b.Utils.getStringAt(a,240,320);this.aux_file=b.Utils.getStringAt(a,320,344);this.qform_code=b.Utils.getIntAt(a,344,this.littleEndian);this.sform_code=b.Utils.getIntAt(a,348,this.littleEndian);this.quatern_b=b.Utils.getDoubleAt(a,352,this.littleEndian);this.quatern_c=b.Utils.getDoubleAt(a,360,this.littleEndian);this.quatern_d=b.Utils.getDoubleAt(a,368,this.littleEndian);
this.qoffset_x=b.Utils.getDoubleAt(a,376,this.littleEndian);this.qoffset_y=b.Utils.getDoubleAt(a,384,this.littleEndian);this.qoffset_z=b.Utils.getDoubleAt(a,392,this.littleEndian);for(c=0;3>c;c+=1)for(e=0;4>e;e+=1)d=400+8*(4*c+e),this.affine[c][e]=b.Utils.getDoubleAt(a,d,this.littleEndian);this.affine[3][0]=0;this.affine[3][1]=0;this.affine[3][2]=0;this.affine[3][3]=1;this.slice_code=b.Utils.getIntAt(a,496,this.littleEndian);this.xyzt_units=b.Utils.getIntAt(a,500,this.littleEndian);this.intent_code=
b.Utils.getIntAt(a,504,this.littleEndian);this.intent_name=b.Utils.getStringAt(a,508,524);this.dim_info=b.Utils.getByteAt(a,524);a.byteLength>b.NIFTI2.MAGIC_COOKIE&&(this.extensionFlag[0]=b.Utils.getByteAt(a,540),this.extensionFlag[1]=b.Utils.getByteAt(a,541),this.extensionFlag[2]=b.Utils.getByteAt(a,542),this.extensionFlag[3]=b.Utils.getByteAt(a,543),this.extensionFlag[0]&&(this.extensionSize=this.getExtensionSize(a),this.extensionCode=this.getExtensionCode(a)))};b.NIFTI2.prototype.toFormattedString=
function(){var a=b.Utils.formatNumber,d;d=""+("Datatype = "+ +this.datatypeCode+" ("+this.getDatatypeCodeString(this.datatypeCode)+")\n");d+="Bits Per Voxel =  = "+this.numBitsPerVoxel+"\n";d+="Image Dimensions (1-8): "+this.dims[0]+", "+this.dims[1]+", "+this.dims[2]+", "+this.dims[3]+", "+this.dims[4]+", "+this.dims[5]+", "+this.dims[6]+", "+this.dims[7]+"\n";d+="Intent Parameters (1-3): "+this.intent_p1+", "+this.intent_p2+", "+this.intent_p3+"\n";d+="Voxel Dimensions (1-8): "+a(this.pixDims[0])+
", "+a(this.pixDims[1])+", "+a(this.pixDims[2])+", "+a(this.pixDims[3])+", "+a(this.pixDims[4])+", "+a(this.pixDims[5])+", "+a(this.pixDims[6])+", "+a(this.pixDims[7])+"\n";d+="Image Offset = "+this.vox_offset+"\n";d+="Data Scale:  Slope = "+a(this.scl_slope)+"  Intercept = "+a(this.scl_inter)+"\n";d+="Display Range:  Max = "+a(this.cal_max)+"  Min = "+a(this.cal_min)+"\n";d+="Slice Duration = "+this.slice_duration+"\n";d+="Time Axis Shift = "+this.toffset+"\n";d+="Slice Start = "+this.slice_start+
"\n";d+="Slice End = "+this.slice_end+"\n";d+='Description: "'+this.description+'"\n';d+='Auxiliary File: "'+this.aux_file+'"\n';d+="Q-Form Code = "+this.qform_code+" ("+this.getTransformCodeString(this.qform_code)+")\n";d+="S-Form Code = "+this.sform_code+" ("+this.getTransformCodeString(this.sform_code)+")\n";d+="Quaternion Parameters:  b = "+a(this.quatern_b)+"  c = "+a(this.quatern_c)+"  d = "+a(this.quatern_d)+"\n";d+="Quaternion Offsets:  x = "+this.qoffset_x+"  y = "+this.qoffset_y+"  z = "+
this.qoffset_z+"\n";d+="S-Form Parameters X: "+a(this.affine[0][0])+", "+a(this.affine[0][1])+", "+a(this.affine[0][2])+", "+a(this.affine[0][3])+"\n";d+="S-Form Parameters Y: "+a(this.affine[1][0])+", "+a(this.affine[1][1])+", "+a(this.affine[1][2])+", "+a(this.affine[1][3])+"\n";d+="S-Form Parameters Z: "+a(this.affine[2][0])+", "+a(this.affine[2][1])+", "+a(this.affine[2][2])+", "+a(this.affine[2][3])+"\n";d+="Slice Code = "+this.slice_code+"\n";d+="Units Code = "+this.xyzt_units+" ("+this.getUnitsCodeString(b.NIFTI1.SPATIAL_UNITS_MASK&
this.xyzt_units)+", "+this.getUnitsCodeString(b.NIFTI1.TEMPORAL_UNITS_MASK&this.xyzt_units)+")\n";d+="Intent Code = "+this.intent_code+"\n";d+='Intent Name: "'+this.intent_name+'"\n';return d+="Dim Info = "+this.dim_info+"\n"};b.NIFTI2.prototype.getExtensionLocation=function(){return b.NIFTI2.MAGIC_COOKIE+4};b.NIFTI2.prototype.getExtensionSize=b.NIFTI1.prototype.getExtensionSize;b.NIFTI2.prototype.getExtensionCode=b.NIFTI1.prototype.getExtensionCode;b.NIFTI2.prototype.getDatatypeCodeString=b.NIFTI1.prototype.getDatatypeCodeString;
b.NIFTI2.prototype.getTransformCodeString=b.NIFTI1.prototype.getTransformCodeString;b.NIFTI2.prototype.getUnitsCodeString=b.NIFTI1.prototype.getUnitsCodeString;b.NIFTI2.prototype.getQformMat=b.NIFTI1.prototype.getQformMat;b.NIFTI2.prototype.convertNiftiQFormToNiftiSForm=b.NIFTI1.prototype.convertNiftiQFormToNiftiSForm;b.NIFTI2.prototype.convertNiftiSFormToNEMA=b.NIFTI1.prototype.convertNiftiSFormToNEMA;b.NIFTI2.prototype.nifti_mat33_mul=b.NIFTI1.prototype.nifti_mat33_mul;b.NIFTI2.prototype.nifti_mat33_determ=
b.NIFTI1.prototype.nifti_mat33_determ;c.exports&&(c.exports=b.NIFTI2)}),aa=qa(function(c){var b=b||{};b.NIFTI1=b.NIFTI1||("undefined"!==typeof hb?qh:null);b.NIFTI2=b.NIFTI2||("undefined"!==typeof hb?wj:null);b.Utils=b.Utils||("undefined"!==typeof hb?pe:null);var a=a||("undefined"!==typeof hb?Da:null);b.isNIFTI1=function(a){var d,c;if(a.byteLength<b.NIFTI1.STANDARD_HEADER_SIZE)return!1;d=new DataView(a);a=d.getUint8(b.NIFTI1.MAGIC_NUMBER_LOCATION);c=d.getUint8(b.NIFTI1.MAGIC_NUMBER_LOCATION+1);d=d.getUint8(b.NIFTI1.MAGIC_NUMBER_LOCATION+
2);return!(a!==b.NIFTI1.MAGIC_NUMBER[0]||c!==b.NIFTI1.MAGIC_NUMBER[1]||d!==b.NIFTI1.MAGIC_NUMBER[2])};b.isNIFTI2=function(a){var d,c;if(a.byteLength<b.NIFTI1.STANDARD_HEADER_SIZE)return!1;d=new DataView(a);a=d.getUint8(b.NIFTI2.MAGIC_NUMBER_LOCATION);c=d.getUint8(b.NIFTI2.MAGIC_NUMBER_LOCATION+1);d=d.getUint8(b.NIFTI2.MAGIC_NUMBER_LOCATION+2);return!(a!==b.NIFTI2.MAGIC_NUMBER[0]||c!==b.NIFTI2.MAGIC_NUMBER[1]||d!==b.NIFTI2.MAGIC_NUMBER[2])};b.isNIFTI=function(a){return b.isNIFTI1(a)||b.isNIFTI2(a)};
b.isCompressed=function(a){var d;return a&&(d=new DataView(a),a=d.getUint8(0),d=d.getUint8(1),a===b.Utils.GUNZIP_MAGIC_COOKIE1||d===b.Utils.GUNZIP_MAGIC_COOKIE2)?!0:!1};b.decompress=function(b){return a.inflate(b).buffer};b.readHeader=function(a){var d=null;b.isCompressed(a)&&(a=b.decompress(a));b.isNIFTI1(a)?d=new b.NIFTI1:b.isNIFTI2(a)&&(d=new b.NIFTI2);d?d.readHeader(a):console.error("That file does not appear to be NIFTI!");return d};b.hasExtension=function(a){return 0!=a.extensionFlag[0]};b.readImage=
function(a,b){var d=a.vox_offset,c=1,g=1;a.dims[4]&&(c=a.dims[4]);a.dims[5]&&(g=a.dims[5]);return b.slice(d,d+a.numBitsPerVoxel/8*a.dims[2]*a.dims[3]*c*g*a.dims[1])};b.readExtension=function(a,b){var d=a.getExtensionLocation();return b.slice(d,d+a.extensionSize)};b.readExtensionData=function(a,b){var d=a.getExtensionLocation();return b.slice(d+8,d+a.extensionSize-8)};c.exports&&(c.exports=b)}),rh=function(c){function b(){N(this,b);var a=P(this,(b.__proto__||Object.getPrototypeOf(b)).call(this));a.addInputValidator(0,
ArrayBuffer);return a}M(b,c);O(b,[{key:"_run",value:function(){function a(a,b){var d=Math.abs(a[0][b]),c=Math.abs(a[1][b]);a=Math.abs(a[2][b]);return d>c&&d>a?0:c>d&&c>a?1:2}function b(a){return Math.sqrt(a[0]*a[0]+a[1]*a[1]+a[2]*a[2])}function c(a){for(var b=0;b<x.length;b++)if(x[b].nameWorldSpace===a)return x[b];return null}var e=this._getInput(0);if(e)if(aa.isNIFTI(e)){var f={},k=null,l=aa.readHeader(e),k=aa.readImage(l,e);if(k=this._fetchDataArray(l,k)){this._scaleData(k,l);var m=l.dims[0];f.formatSpecific=
l;f.statistics={upToDate:!0,min:"sdfsdf",max:NaN};f.ncpp=this._fetchNcpp(l);f.description=l.description;f.format="nifti";f.spatialUnit=l.getUnitsCodeString(aa.NIFTI1.SPATIAL_UNITS_MASK&l.xyzt_units);f.temporalUnit=l.getUnitsCodeString(aa.NIFTI1.TEMPORAL_UNITS_MASK&l.xyzt_units);var n=l.getQformMat();0==l.qform_code&&(n=l.affine);console.log(l);for(var r=["k","j","i","t"],e=["x","y","z","t"],v=[],q=0;q<m;q++){for(var t=1,p=0;p<q;p++)t*=l.dims[p+1];t={length:l.dims[q+1],widthDimension:-1,heightDimension:-1,
nameVoxelSpace:r[q],nameWorldSpace:e[q],worldUnitSize:l.pixDims[q+1],stride:t,step:l.pixDims[q+1]};v.push(t)}3<=v.length&&(v[0].widthDimension=1,v[0].heightDimension=2,v[1].widthDimension=0,v[1].heightDimension=2,v[2].widthDimension=0,v[2].heightDimension=1);var l=a(n,0),t=a(n,1),m=a(n,2),r=[l,t,m],t=[r.indexOf(0),r.indexOf(1),r.indexOf(2)],l=JSON.parse(JSON.stringify(n)),x=v;if(0!=r[0]||1!=r[1]||2!=r[2]){for(m=0;3>m;m++)for(q=0;4>q;q++)p=q,3>q&&(p=r[q]),l[m][p]=n[m][q];n=JSON.parse(JSON.stringify(v));
n[0].nameVoxelSpace="k";n[1].nameVoxelSpace="j";n[2].nameVoxelSpace="i";n[t[0]].nameWorldSpace="x";n[t[1]].nameWorldSpace="y";n[t[2]].nameWorldSpace="z";n[t[0]].widthDimension=t[1];n[t[0]].heightDimension=t[2];n[t[1]].widthDimension=t[0];n[t[1]].heightDimension=t[2];n[t[2]].widthDimension=t[0];n[t[2]].heightDimension=t[1];x=n}for(m=0;3>m;m++)n=b(l[m]),v=Math.sign(l[m][m]),t=c(e[m]),t.step=n*v;f.dimensions=x;e=y(l[0][0],l[1][0],l[2][0],l[3][0],l[0][1],l[1][1],l[2][1],l[3][1],l[0][2],l[1][2],l[2][2],
l[3][2],l[0][3],l[1][3],l[2][3],l[3][3]);n=B();Q(n,e);f.transformations={v2w:e,w2v:n};f.statistics={upToDate:!1,min:0,max:0};e=new dc;e.setRawData(k);e.setRawMetadata(f);console.log(f);e.metadataIntegrityCheck()&&(e.scanDataRange(),this._output[0]=e)}else console.warn("This NIfTI file is valid but does not contain any readable data.")}else console.warn("Not a NIfTI file");else console.warn('NiftiDecoderAlt requires an ArrayBuffer as input "0". Unable to continue.')}},{key:"_scaleData",value:function(a,
b){if(b.datatypeCode!=aa.NIFTI1.TYPE_RGB24&&(1!=b.scl_slope||0!=b.scl_inter)&&b.scl_slope)for(var d=0;d<a.length;d++)a[d]=a[d]*b.scl_slope+b.scl_inter}},{key:"_fetchNcpp",value:function(a){var b=0;switch(a.datatypeCode){case aa.NIFTI1.TYPE_BINARY:console.warn("The datatype nifti.TYPE_BINARY is not compatible yet.");break;case aa.NIFTI1.TYPE_COMPLEX64:console.warn("The datatype nifti.TYPE_COMPLEX64 is not compatible yet.");break;case aa.NIFTI1.TYPE_COMPLEX128:console.warn("The datatype nifti.TYPE_COMPLEX128 is not compatible yet.");
break;case aa.NIFTI1.TYPE_COMPLEX256:console.warn("The datatype nifti.TYPE_COMPLEX256 is not compatible yet.");break;case aa.NIFTI1.TYPE_FLOAT128:console.warn("The datatype nifti.TYPE_FLOAT128 is not compatible yet.");break;case aa.NIFTI1.TYPE_INT64:console.warn("The datatype nifti.TYPE_INT64 is not compatible yet.");break;case aa.NIFTI1.TYPE_NONE:console.warn("The datatype nifti.TYPE_NONE is not compatible.");break;case aa.NIFTI1.TYPE_UINT64:console.warn("The datatype nifti.TYPE_INT64 is not compatible yet.");
break;case aa.NIFTI1.TYPE_FLOAT32:b=1;break;case aa.NIFTI1.TYPE_FLOAT64:b=1;break;case aa.NIFTI1.TYPE_INT8:b=1;break;case aa.NIFTI1.TYPE_INT16:b=1;break;case aa.NIFTI1.TYPE_INT32:b=1;break;case aa.NIFTI1.TYPE_UINT8:b=1;break;case aa.NIFTI1.TYPE_UINT16:b=1;break;case aa.NIFTI1.TYPE_UINT32:b=1;break;case aa.NIFTI1.TYPE_RGB24:b=3;break;default:console.warn("The datatype is unknown.")}return b}},{key:"_fetchDataArray",value:function(a,b){var d=null;switch(a.datatypeCode){case aa.NIFTI1.TYPE_BINARY:console.warn("The datatype nifti.TYPE_BINARY is not compatible yet.");
break;case aa.NIFTI1.TYPE_COMPLEX64:console.warn("The datatype nifti.TYPE_COMPLEX64 is not compatible yet.");break;case aa.NIFTI1.TYPE_COMPLEX128:console.warn("The datatype nifti.TYPE_COMPLEX128 is not compatible yet.");break;case aa.NIFTI1.TYPE_COMPLEX256:console.warn("The datatype nifti.TYPE_COMPLEX256 is not compatible yet.");break;case aa.NIFTI1.TYPE_FLOAT128:console.warn("The datatype nifti.TYPE_FLOAT128 is not compatible yet.");break;case aa.NIFTI1.TYPE_INT64:console.warn("The datatype nifti.TYPE_INT64 is not compatible yet.");
break;case aa.NIFTI1.TYPE_NONE:console.warn("The datatype nifti.TYPE_NONE is not compatible.");break;case aa.NIFTI1.TYPE_UINT64:console.warn("The datatype nifti.TYPE_INT64 is not compatible yet.");break;case aa.NIFTI1.TYPE_FLOAT32:d=new Float32Array(b);break;case aa.NIFTI1.TYPE_FLOAT64:d=new Float64Array(b);break;case aa.NIFTI1.TYPE_INT8:d=new Int8Array(b);break;case aa.NIFTI1.TYPE_INT16:d=new Int16Array(b);break;case aa.NIFTI1.TYPE_INT32:d=new Int32Array(b);break;case aa.NIFTI1.TYPE_UINT8:d=new Uint8Array(b);
break;case aa.NIFTI1.TYPE_UINT16:d=new Uint16Array(b);break;case aa.NIFTI1.TYPE_UINT32:d=new Uint32Array(b);break;case aa.NIFTI1.TYPE_RGB24:d=new Uint8Array(b);break;default:console.warn("The datatype is unknown.")}return d}},{key:"_computeSubjsctBasedCoord",value:function(a){}}]);return b}(V),xj=function(c){function b(){N(this,b);var a=P(this,(b.__proto__||Object.getPrototypeOf(b)).call(this));a.setMetadata("filename","untitled.pixp");return a}M(b,c);O(b,[{key:"hasValidInput",value:function(){var a=
this._getInput();return a&&(a.isOfType(S.TYPE())||a.isOfType(Hc.TYPE()))}},{key:"_run",value:function(){if(this.hasValidInput()){var a=this._getInput(),a={dataType:a.getData().constructor.name,data:Array.prototype.slice.call(a.getData()),metadata:a.getMetadataCopy(),pixpipeType:a.constructor.name},a=JSON.stringify(a),b=new Da.Deflate({level:6,gzip:!0,header:{text:!0,time:+new Date,comment:"This file was created by Pixpipe.js"}});b.push(a,!0);this._output[0]=new Blob([b.result],{type:"application/gzip"})}else console.warn("PixpEncoder can only encode Image2D and Image3D.")}},
{key:"download",value:function(){this.getOutput()?nh.saveAs(this.getOutput(),this.getMetadata("filename")):console.warn("No output computed yet.")}}]);return b}(V),qe=function(c){function b(){N(this,b);var a=P(this,(b.__proto__||Object.getPrototypeOf(b)).call(this));a.addInputValidator(0,ArrayBuffer);return a}M(b,c);O(b,[{key:"_run",value:function(){if(this.hasValidInput()){var a=this._getInput(),b=new Da.Inflate({level:6,to:"string"});b.push(a,!0);if(b.err)console.warn("This file is not a Pixp file.");
else{a=null;try{a=JSON.parse(b.result)}catch(e){console.warn("Could not parse pixp file.");console.error(e);return}if(a.pixpipeType in pixpipe){b=null;try{b=window}catch(e){try{b=GLOBAL}catch(f){console.warn("You are not in a Javascript environment?? Weird.");return}}if(b[a.dataType]){var b=new b[a.dataType](a.data),c=new pixpipe[a.pixpipeType];c.setRawData(b);c.setRawMetadata(a.metadata);this._output[0]=c}else console.warn("Data array from pixp file is unknown: "+a.dataType)}else console.warn("Unknown type pixpipe."+
a.pixpipeType+", cannot create any output.")}}else console.warn("PixpDecoder can only decode ArrayBuffer.")}}]);return b}(V),sh=function(c){function b(){N(this,b);var a=P(this,(b.__proto__||Object.getPrototypeOf(b)).call(this));a.addInputValidator(0,ArrayBuffer);a.setMetadata("debug",!1);return a}M(b,c);O(b,[{key:"_parseMGHHeader",value:function(a,b){b={order:["xspace","yspace","zspace"],xspace:{},yspace:{},zspace:{}};var d=new DataView(a,0,284);a=d.getUint32(0,!0);if(1===a)a=!0;else if(16777216===
a)a=!1;else return console.warn("This does not look like an MGH file."),null;var c,f=[0,0,0,0],k=4,l=1;for(c=0;4>c;c++){f[c]=d.getUint32(k,a);if(1>=f[c])break;l*=f[c];k+=4}if(3>c||4<c)return console.warn("Cannot handle "+c+"-dimensional images yet."),null;var m=d.getUint32(20,a),n=[1,1,1],r,v,q=[[-1,0,0],[0,0,-1],[0,1,0],[0,0,0]];if(d.getUint16(28,a)){k=30;for(r=0;3>r;r++)n[r]=d.getFloat32(k,a),k+=4;for(r=0;4>r;r++)for(v=0;3>v;v++)q[r][v]=d.getFloat32(k,a),k+=4}if(this._metadata.debug)for(r=0;3>r;r++){d=
"";for(v=0;4>v;v++)d+="xyzc"[v]+"_"+"ras"[r]+" "+q[v][r]+" ";console.log(d)}d=[0,1,2];for(r=0;3>r;r++){v=0;var k=Math.abs(q[r][0]),t=Math.abs(q[r][1]),p=Math.abs(q[r][2]);b.order[r]="xspace";t>k&&t>p&&(v=1,b.order[r]="yspace");p>k&&p>t&&(v=2,b.order[r]="zspace");d[r]=v}4===c&&(this._metadata.debug&&console.log("Creating time dimension: "+f[3]),b.time={space_length:f[3],step:1,start:0,name:"time"},b.order.push("time"));c=[[0,0,0,0],[0,0,0,0],[0,0,0,0]];for(r=0;3>r;r++)for(v=0;3>v;v++)c[r][v]=q[v][r]*
n[r];for(r=0;3>r;r++){for(v=n=0;3>v;v++)n+=f[v]/2*c[r][v];c[r][3]=q[3][r]-n}q=[[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0]];for(r=0;3>r;r++)for(v=0;4>v;v++)n=v,3>v&&(n=d[v]),q[r][n]=c[r][v];db.transformToMinc(q,b);b.datatype=m;b.little_endian=a;b.nvoxels=l;for(r=0;3>r;r++)b[b.order[r]].space_length=f[r];return b}},{key:"_createMGHData",value:function(a,b){var d=null,c;switch(a.datatype){case 0:c=1;break;case 1:case 3:c=4;break;case 4:c=2;break;default:return console.warn("Unsupported data type: "+a.datatype),
null}var f=a.nvoxels*c;1<c&&!a.little_endian&&db.swapn(new Uint8Array(b,284,f),c);switch(a.datatype){case 0:d=new Uint8Array(b,284,a.nvoxels);break;case 1:d=new Int32Array(b,284,a.nvoxels);break;case 3:d=new Float32Array(b,284,a.nvoxels);break;case 4:d=new Int16Array(b,284,a.nvoxels)}b=1;for(c=0;c<a.order.length;c++)a[a.order[c]].offset=b,b*=a[a.order[c]].space_length;return d}},{key:"_run",value:function(){var a=this._getInput(0);if(a){var b=null;try{b=this._parseMGHHeader(a)}catch(e){}if(b){a=this._createMGHData(b,
a);if(!a)return null;this._addOutput(db);var c=this.getOutput();c.setData(a,b);c.setMetadata("format","mgh")}else console.log("The input file is not a MGH file.")}else console.warn('MghDecoder requires an ArrayBuffer as input "0". Unable to continue.')}}]);return b}(V),yj=function(c){function b(){N(this,b);var a=P(this,(b.__proto__||Object.getPrototypeOf(b)).call(this));a._decoders=[oh,ph,sh,qe];return a}M(b,c);O(b,[{key:"_run",value:function(){var a=this._getInput(0);if(a)for(var b=0;b<this._decoders.length;b++){var c=
new this._decoders[b];c.addInput(a);c.update();if(c.getNumberOfOutputs()){this._output[0]=c.getOutput();this.setMetadata("decoderConstructor",this._decoders[b]);this.setMetadata("decoderName",this._decoders[b].name);break}}else console.warn("The input buffer must not be null.")}}]);return b}(V),Mc=function(){function c(){N(this,c)}O(c,null,[{key:"convertOld2New",value:function(b){function a(a){for(var b=0;b<d.dimensions.length;b++)if(d.dimensions[b].nameWorldSpace===a)return b;return-1}for(var d=
{ncpp:1,dimensions:[]},c=["k","j","i","t"],e=0;e<b.order.length;e++){var f=b[b.order[e]],k={};k.length=f.space_length;k.nameWorldSpace=b.order[e][0];k.nameVoxelSpace="";k.worldUnitSize=Math.abs(f.step);k.step=f.step;k.worldStep=f.step;k.stride=f.offset;d.dimensions.push(k)}d.dimensions.sort(function(a,b){return a.stride>b.stride});for(e=0;e<b.order.length;e++)d.dimensions[e].nameVoxelSpace=c[e];for(e=0;e<d.dimensions.length;e++)c=d.dimensions[e].nameWorldSpace,d.dimensions[e].widthDimension=a("x"===
c?"y":"y"===c?"x":"z"===c?"x":null),d.dimensions[e].heightDimension=a("x"===c?"z":"y"===c?"z":"z"===c?"y":null);d.statistics={upToDate:!1,min:0,max:0};d.description="";d.spatialUnit="";d.temporalUnit="";d.format="format"in b?b.format:"generic";b=y(b.w2v[0][0],b.w2v[1][0],b.w2v[2][0],0,b.w2v[0][1],b.w2v[1][1],b.w2v[2][1],0,b.w2v[0][2],b.w2v[1][2],b.w2v[2][2],0,b.w2v[0][3],b.w2v[1][3],b.w2v[2][3],1);e=B();Q(e,b);d.transformations={v2w:e,w2v:b};return d}},{key:"convertImage3DMetadata",value:function(b){c.completeHeader(b);
return c.convertOld2New(b)}},{key:"completeHeader",value:function(b){var a=b.xspace,d=b.yspace,c=b.zspace,e=a.start,f=d.start,k=c.start,l=a.direction_cosines,m=d.direction_cosines,n=c.direction_cosines,r=a.step,v=d.step,q=c.step,e={x:e*l[0]+f*m[0]+k*n[0],y:e*l[1]+f*m[1]+k*n[1],z:e*l[2]+f*m[2]+k*n[2]};b.voxel_origin=e;b.w2v=[[l[0]/r,l[1]/r,l[2]/r,(-e.x*l[0]-e.y*l[1]-e.z*l[2])/r],[m[0]/v,m[1]/v,m[2]/v,(-e.x*m[0]-e.y*m[1]-e.z*m[2])/v],[n[0]/q,n[1]/q,n[2]/q,(-e.x*n[0]-e.y*n[1]-e.z*n[2])/q]];a.width_space=
JSON.parse(JSON.stringify(d));a.width=d.space_length;a.height_space=JSON.parse(JSON.stringify(c));a.height=c.space_length;d.width_space=JSON.parse(JSON.stringify(a));d.width=a.space_length;d.height_space=JSON.parse(JSON.stringify(c));d.height=c.space_length;c.width_space=JSON.parse(JSON.stringify(a));c.width=a.space_length;c.height_space=JSON.parse(JSON.stringify(d));c.height=d.space_length}},{key:"transformToMinc",value:function(b,a){function d(a){a=a[0]*a[0]+a[1]*a[1]+a[2]*a[2];0>=a&&(a=1);return Math.sqrt(a)}
function c(a,b,d){return a[0]*(b[1]*d[2]-b[2]*d[1])-a[1]*(b[0]*d[2]-b[2]*d[0])+a[2]*(b[0]*d[1]-b[1]*d[0])}for(var e=[],f=[],k=[],l=d(b[0]),m=d(b[1]),n=d(b[2]),l=0>b[0][0]?-l:l,m=0>b[1][1]?-m:m,n=0>b[2][2]?-n:n,r=0;3>r;r++)e[r]=b[r][0]/l,f[r]=b[r][1]/m,k[r]=b[r][2]/n;a.xspace.step=l;a.yspace.step=m;a.zspace.step=n;m=[b[0][3],b[1][3],b[2][3]];b=c(e,f,k);l=c(m,f,k);n=c(e,m,k);m=c(e,f,m);a.xspace.start=l/b;a.yspace.start=n/b;a.zspace.start=m/b;a.xspace.direction_cosines=e;a.yspace.direction_cosines=f;
a.zspace.direction_cosines=k}},{key:"swapn",value:function(b,a){for(var d=0;d<b.length;d+=a)for(var c=a-1,e=0;c>e;){var f=b[d+c];b[d+c]=b[d+e];b[d+e]=f;c--;e++}}}]);return c}(),th=function(c){function b(){N(this,b);var a=P(this,(b.__proto__||Object.getPrototypeOf(b)).call(this));a.addInputValidator(0,ArrayBuffer);a.setMetadata("debug",!1);a._type_enum={INT8:1,UINT8:2,INT16:3,UINT16:4,INT32:5,UINT32:6,FLT:7,DBL:8,STR:9};a._type_matching="int8 uint8 int16 uint16 int32 uint32 float32 float64 undef".split(" ");
a.type_sizes=[0,1,1,2,2,4,4,4,8,0];a._dv_offset=0;a._align=8;a._little_endian=!0;a._continuation_queue=[];a._dv=null;a._superblk={};a._start_offset=0;a._huge_id=0;return a}M(b,c);O(b,[{key:"createLink",value:function(){return{hdr_offset:0,data_offset:0,data_length:0,n_filled:0,chunk_size:0,sym_btree:0,sym_lheap:0,name:"",attributes:{},children:[],array:void 0,type:-1,inflate:!1,dims:[]}}},{key:"startAlignment",value:function(){this._start_offset=this._dv_offset}},{key:"checkAlignment",value:function(){var a=
this._dv_offset-this._start_offset;if(0!==a%this._align){var b=this._align-a%this._align;this._dv_offset+=b;this.getMetadata("debug")&&console.log("skipping "+b+" bytes at "+a+" for alignmnent")}}},{key:"skip",value:function(a){this._dv_offset+=a}},{key:"seek",value:function(a){this._dv_offset=a}},{key:"tell",value:function(){return this._dv_offset}},{key:"getU8",value:function(){var a=this._dv.getUint8(this._dv_offset);this._dv_offset+=1;return a}},{key:"getU16",value:function(){var a=this._dv.getUint16(this._dv_offset,
this._little_endian);this._dv_offset+=2;return a}},{key:"getU32",value:function(){var a=this._dv.getUint32(this._dv_offset,this._little_endian);this._dv_offset+=4;return a}},{key:"getU64",value:function(){var a=this._dv.getUint64(this._dv_offset,this._little_endian);this._dv_offset+=8;return a}},{key:"getF32",value:function(){var a=this._dv.getFloat32(this._dv_offset,this._little_endian);this._dv_offset+=4;return a}},{key:"getF64",value:function(){var a=this._dv.getFloat64(this._dv_offset,this._little_endian);
this._dv_offset+=8;return a}},{key:"getOffset",value:function(a){var b;a=a||this._superblk.offsz;if(4===a)b=this._dv.getUint32(this._dv_offset,this._little_endian);else if(8===a)b=this._dv.getUint64(this._dv_offset,this._little_endian);else throw Error("Unsupported value for offset size "+a);this._dv_offset+=a;return b}},{key:"getLength",value:function(){var a=this._dv.getUint64(this._dv_offset,this._little_endian);this._dv_offset+=this._superblk.lensz;return a}},{key:"getString",value:function(a){var b=
"",c,e;for(c=0;c<a;c+=1){e=this.getU8();if(0===e){this._dv_offset+=a-c-1;break}b+=String.fromCharCode(e)}return b}},{key:"getArray",value:function(a,b,c){var d=this._getInput(),g=this._dv_offset;c&&(this._dv_offset=c);switch(a){case this._type_enum.INT8:a=new Int8Array(d,this._dv_offset,b);break;case this._type_enum.UINT8:a=new Uint8Array(d,this._dv_offset,b);break;case this._type_enum.INT16:if(0!==this._dv_offset%2)for(a=new ArrayBuffer(b),b/=2,a=new Int16Array(a),d=0;d<b;d+=1)a[d]=this.getU16();
else a=new Int16Array(d,this._dv_offset,b/2),this._dv_offset+=b;break;case this._type_enum.UINT16:if(0!==this._dv_offset%2)for(a=new ArrayBuffer(b),b/=2,a=new Uint16Array(a),d=0;d<b;d+=1)a[d]=this.getU16();else a=new Uint16Array(d,this._dv_offset,b/2),this._dv_offset+=b;break;case this._type_enum.INT32:if(0!==this._dv_offset%4)for(a=new ArrayBuffer(b),b/=4,a=new Int32Array(a),d=0;d<b;d+=1)a[d]=this.getU32();else a=new Int32Array(d,this._dv_offset,b/4),this._dv_offset+=b;break;case this._type_enum.UINT32:if(0!==
this._dv_offset%4)for(a=new ArrayBuffer(b),b/=4,a=new Uint32Array(a),d=0;d<b;d+=1)a[d]=this.getU32();else a=new Uint32Array(d,this._dv_offset,b/4),this._dv_offset+=b;break;case this._type_enum.FLT:if(0!==this._dv_offset%4)for(a=new ArrayBuffer(b),b/=4,a=new Float32Array(a),d=0;d<b;d+=1)a[d]=this.getF32();else a=new Float32Array(d,this._dv_offset,b/4),this._dv_offset+=b;break;case this._type_enum.DBL:if(0!==this._dv_offset%8)for(a=new ArrayBuffer(b),b/=8,a=new Float64Array(a),d=0;d<b;d+=1)a[d]=this.getF64();
else a=new Float64Array(d,this._dv_offset,b/8),this._dv_offset+=b;break;default:throw Error("Bad type in this.getArray "+a);}c&&(this._dv_offset=g);return a}},{key:"getUXX",value:function(a){var b,c;switch(a){case 1:b=this._dv.getUint8(this._dv_offset);break;case 2:b=this._dv.getUint16(this._dv_offset,this._little_endian);break;case 4:b=this._dv.getUint32(this._dv_offset,this._little_endian);break;case 8:b=this._dv.getUint64(this._dv_offset,this._little_endian);break;default:if(b=0,this._little_endian)for(c=
a-1;0<=c;c--)b=(b<<8)+this._dv.getUint8(this._dv_offset+c);else for(c=0;c<a;c++)b=(b<<8)+this._dv.getUint8(this._dv_offset+c)}this._dv_offset+=a;return b}},{key:"checkSignature",value:function(a){var b;for(b=0;b<a.length;b+=1)if(this._dv.getUint8(this._dv_offset+b)!==a.charCodeAt(b))return!1;this.skip(a.length);return!0}},{key:"hdf5Superblock",value:function(){var a={};if(!this.checkSignature("\u0089HDF\r\n\u001a\n"))throw Error("Bad magic string in HDF5");a.sbver=this.getU8();if(2<a.sbver)throw Error("Unsupported HDF5 superblock version "+
a.sbver);1>=a.sbver?(a.fsver=this.getU8(),a.rgver=this.getU8(),this.skip(1),a.shver=this.getU8(),a.offsz=this.getU8(),a.lensz=this.getU8(),this.skip(1),a.gln_k=this.getU16(),a.gin_k=this.getU16(),a.cflags=this.getU32(),1===a.sbver&&(a.isin_k=this.getU16(),this.skip(2)),a.base_addr=this.getOffset(a.offsz),a.gfsi_addr=this.getOffset(a.offsz),a.eof_addr=this.getOffset(a.offsz),a.dib_addr=this.getOffset(a.offsz),a.root_ln_offs=this.getOffset(a.offsz),a.root_addr=this.getOffset(a.offsz),a.root_cache_type=
this.getU32(),this.skip(4),this.skip(16)):(a.offsz=this.getU8(),a.lensz=this.getU8(),a.cflags=this.getU8(),a.base_addr=this.getOffset(a.offsz),a.ext_addr=this.getOffset(a.offsz),a.eof_addr=this.getOffset(a.offsz),a.root_addr=this.getOffset(a.offsz),a.checksum=this.getU32());this.getMetadata("debug")&&console.log("HDF5 SB "+a.sbver+" "+a.offsz+" "+a.lensz+" "+a.cflags);return a}},{key:"hdf5FractalHeapHeader",value:function(){var a={};if(!this.checkSignature("FRHP"))throw Error("Bad or missing FRHP signature");
a.ver=this.getU8();a.idlen=this.getU16();a.iof_el=this.getU16();a.flags=this.getU8();a.objmax=this.getU32();a.objnid=this.getLength();a.objbta=this.getOffset();a.nf_blk=this.getLength();a.af_blk=this.getOffset();a.heap_total=this.getLength();a.heap_alloc=this.getLength();a.bai_offset=this.getLength();a.heap_nobj=this.getLength();a.heap_chuge=this.getLength();a.heap_nhuge=this.getLength();a.heap_ctiny=this.getLength();a.heap_ntiny=this.getLength();a.table_width=this.getU16();a.start_blksz=this.getLength();
a.max_blksz=this.getLength();a.max_heapsz=this.getU16();a.rib_srows=this.getU16();a.root_addr=this.getOffset();a.rib_crows=this.getU16();var b=Math.log2(a.max_blksz)-Math.log2(a.start_blksz)+2;a.K=Math.min(a.rib_crows,b)*a.table_width;a.N=a.rib_crows<b?0:a.K-b*a.table_width;this.getMetadata("debug")&&(console.log("FRHP V"+a.ver+" F"+a.flags+" "+a.objbta+" Total:"+a.heap_total+" Alloc:"+a.heap_alloc+" #obj:"+a.heap_nobj+" width:"+a.table_width+" start_blksz:"+a.start_blksz+" max_blksz:"+a.max_blksz+
" "+a.max_heapsz+" srows:"+a.rib_srows+" crows:"+a.rib_crows+" "+a.heap_nhuge),console.log("   K: "+a.K+" N: "+a.N));if(0<a.iof_el)throw Error("Filters present in fractal heap.");return a}},{key:"hdf5V2BtreeHeader",value:function(){var a={};if(!this.checkSignature("BTHD"))throw Error("Bad or missing BTHD signature");a.ver=this.getU8();a.type=this.getU8();a.nodesz=this.getU32();a.recsz=this.getU16();a.depth=this.getU16();a.splitp=this.getU8();a.mergep=this.getU8();a.root_addr=this.getOffset();a.root_nrec=
this.getU16();a.total_nrec=this.getLength();a.checksum=this.getU32();this.getMetadata("debug")&&console.log("BTHD V"+a.ver+" T"+a.type+" "+a.nodesz+" "+a.recsz+" "+a.depth+" "+a.root_addr+" "+a.root_nrec+" "+a.total_nrec);return a}},{key:"hdf5V2BtreeRecords",value:function(a,b,c,e){var d,g,l;if(1===b)for(b=0;b<c;b++)g=this.getOffset(),l=this.getLength(),a=this.getLength(),this.getMetadata("debug")&&console.log("  -> "+g+" "+l+" "+a+" "+this._this._huge_id),d=this.tell(),a===this._this._huge_id&&(this.seek(g),
this.hdf5MsgAttribute(l,e)),this.seek(d);else if(8===b){var m,n;m=a.max_heapsz/8;b=Math.min(a.objmax,a.max_blksz);n=256>=b?1:65536>=b?2:4;for(b=0;b<c;b++){d=this.getU8();if(0!==(d&192))throw Error("Bad Fractal Heap ID version "+d);var r=d&48,v;if(16===r)this._this._huge_id=this.getUXX(7);else if(0===r)g=this.getUXX(m),l=this.getUXX(n);else throw Error("Can't handle this Heap ID: "+d);v=this.getU8();this.getU32();this.getU32();this.getMetadata("debug")&&console.log("  -> "+d+" "+g+" "+l+" "+v);d=this.tell();
if(16===r)if(this.seek(a.objbta),r=this.hdf5V2BtreeHeader(),1===r.type)this.seek(r.root_addr),this.hdf5V2BtreeLeafNode(a,r.root_nrec,e);else throw Error("Can only handle type-1 btrees");else r=this.hdf5FractalHeapOffset(a,g),this.seek(r),this.hdf5MsgAttribute(l,e);this.seek(d)}}else throw Error("Unhandled V2 btree type.");}},{key:"hdf5V2BtreeLeafNode",value:function(a,b,c){if(!this.checkSignature("BTLF"))throw Error("Bad or missing BTLF signature");var d=this.getU8(),g=this.getU8();this.getMetadata("debug")&&
console.log("BTLF V"+d+" T"+g+" "+this.tell());this.hdf5V2BtreeRecords(a,g,b,c)}},{key:"hdf5V2BtreeInternalNode",value:function(a,b,c,e){if(!this.checkSignature("BTIN"))throw Error("Bad or missing BTIN signature");var d=this.getU8(),g=this.getU8();this.getMetadata("debug")&&console.log("BTIN V"+d+" T"+g);this.hdf5V2BtreeRecords(a,g,b,e);for(a=0;a<=b;a++){e=this.getOffset();var d=this.getUXX(1),l;1<c&&(l=this.getUXX(1));this.getMetadata("debug")&&console.log(" child->"+e+" "+d+" "+l)}}},{key:"hdf5GetMsgName",
value:function(a){var b="NIL;Dataspace;LinkInfo;Datatype;FillValue 1;FillValue 2;Link;ExternalFiles;Layout;BOGUS;GroupInfo;FilterPipeline;Attribute;ObjectComment;ObjectModTime 1;SharedMsgTable;ObjHdrContinue;SymbolTable;ObjectModTime 2;BtreeKValue;DriverInfo;AttrInfo;ObjectRefCnt;MESSAGE23;FileSpaceInfo".split(";");if(a<b.length)return b[a];throw Error("Unknown message type "+a+" "+this.tell());}},{key:"hdf5V1BtreeNode",value:function(a){var b=this._getInput(),c,e={};if(!this.checkSignature("TREE"))throw Error("Bad TREE signature at "+
this.tell());e.keys=[];e.node_type=this.getU8();e.node_level=this.getU8();e.entries_used=this.getU16();e.left_sibling=this.getOffset();e.right_sibling=this.getOffset();this.getMetadata("debug")&&console.log("BTREE type "+e.node_type+" lvl "+e.node_level+" n_used "+e.entries_used+" "+e.left_sibling+" "+e.right_sibling);if(a){var f,k=[];for(c=0;c<e.entries_used;c+=1){e.keys[c]={};k[c]={};k[c].chunk_size=this.getU32();k[c].filter_mask=this.getU32();k[c].chunk_offsets=[];for(f=0;f<a.dims.length+1;f+=
1)k[c].chunk_offsets.push(this.getU64());e.keys[c].child_address=this.getOffset();c<e.entries_used&&this.getMetadata("debug")&&console.log("  BTREE "+c+" chunk_size "+k[c].chunk_size+" filter_mask "+k[c].filter_mask+" addr "+e.keys[c].child_address)}k[c]={};k[c].chunk_size=this.getU32();k[c].filter_mask=this.getU32();k[c].chunk_offsets=[];for(f=0;f<a.dims.length+1;f+=1)k[c].chunk_offsets.push(this.getU64());if(0===e.node_level){var l;for(c=0;c<e.entries_used;c+=1)if(f=k[c].chunk_size,l=e.keys[c].child_address,
a.inflate){f=new Uint8Array(b,l,f);l=Da.inflate(f);switch(a.type){case this._type_enum.INT8:l=new Int8Array(l.buffer);break;case this._type_enum.UINT8:l=new Uint8Array(l.buffer);break;case this._type_enum.INT16:l=new Int16Array(l.buffer);break;case this._type_enum.UINT16:l=new Uint16Array(l.buffer);break;case this._type_enum.INT32:l=new Int32Array(l.buffer);break;case this._type_enum.UINT32:l=new Uint32Array(l.buffer);break;case this._type_enum.FLT:l=new Float32Array(l.buffer);break;case this._type_enum.DBL:l=
new Float64Array(l.buffer);break;default:throw Error("Unknown type code "+a.type);}a.array.length-a.n_filled<l.length&&(l=l.subarray(0,a.array.length-a.n_filled));a.array.set(l,a.n_filled);a.n_filled+=l.length;this.getMetadata("debug")&&console.log(a.name+" "+f.length+" "+l.length+" "+a.n_filled+"/"+a.array.length)}else l=this.getArray(a.type,f,l),a.array.set(l,a.n_filled),a.n_filled+=l.length}else for(c=0;c<e.entries_used;c+=1)this.seek(e.keys[c].child_address),this.hdf5V1BtreeNode(a)}else for(c=
0;c<e.entries_used;c+=1)e.keys[c]={},e.keys[c].key_value=this.getLength(),e.keys[c].child_address=this.getOffset(),this.getMetadata("debug")&&console.log("  BTREE "+c+" key "+e.keys[c].key_value+" adr "+e.keys[c].child_address);return e}},{key:"hdf5GroupSymbolTable",value:function(a,b){if(!this.checkSignature("SNOD"))throw Error("Bad or missing SNOD signature");var d=this.getU8();this.skip(1);var c=this.getU16();this.getMetadata("debug")&&console.log("this.hdf5GroupSymbolTable V"+d+" #"+c+" '"+b.name+
"'");for(var f,k,l,m,n,d=0;d<2*this._superblk.gln_k;d+=1)f=this.getOffset(),k=this.getOffset(),l=this.getU32(),this.skip(20),d<c&&(m=this.createLink(),m.hdr_offset=k,a&&(n=this.tell(),this.seek(a.lh_dseg_off+f),m.name=this.getString(a.lh_dseg_len),this.seek(n)),this.getMetadata("debug")&&console.log("    "+d+" O "+f+" A "+k+" T "+l+" '"+m.name+"'"),b.children.push(m))}},{key:"hdf5LocalHeap",value:function(){var a={};if(!this.checkSignature("HEAP"))throw Error("Bad or missing HEAP signature");a.lh_ver=
this.getU8();this.skip(3);a.lh_dseg_len=this.getLength();a.lh_flst_len=this.getLength();a.lh_dseg_off=this.getOffset();this.getMetadata("debug")&&console.log("LHEAP V"+a.lh_ver+" "+a.lh_dseg_len+" "+a.lh_flst_len+" "+a.lh_dseg_off);return a}},{key:"hdf5MsgDataspace",value:function(a,b){var d,c=this.getU8(),f=this.getU8(),k=this.getU8();1>=c?this.skip(5):this.skip(1);var l=1,m=[],n;for(n=0;n<f;n+=1)m[n]=this.getLength(),l*=m[n];d=f*this._superblk.lensz+(1>=c?8:4);if(0!==(k&1))for(d+=f*this._superblk.lensz,
n=0;n<f;n+=1)this.getLength();if(0!==(k&2))for(d+=f*this._superblk.lensz,n=0;n<f;n+=1)this.getLength();c="this.hdf5MsgDataspace V"+c+" N"+f+" F"+k;this.getMetadata("debug")&&(0!==f&&(c+="["+m.join(", ")+"]"),console.log(c));d<a&&this.skip(a-d);b&&(b.dims=m);return l}},{key:"hdf5MsgLinkInfo",value:function(a){var b=this,c=this.getU8(),e=this.getU8();0!==(e&1)&&this.getU64();var f=this.getOffset(),k=this.getOffset();0!==(e&2)&&this.getOffset();this.getMetadata("debug")&&console.log("this.hdf5MsgLinkInfo V"+
c+" F"+e+" FH "+f+" BT "+k);c=this.tell();if(f<this._superblk.eof_addr){this.seek(f);var l=this.hdf5FractalHeapHeader(),m=0;this.hdf5FractalHeapEnumerate(l,function(d,c,e,g){for(d=c+g;m<l.heap_nobj&&b.tell()<d;)b.hdf5MsgLink(a),m+=1;return!0})}this.seek(c)}},{key:"dt_class_name",value:function(a){var b="Fixed-Point Floating-Point Time String BitField Opaque Compound Reference Enumerated Variable-Length Array".split(" ");if(a<b.length)return b[a];throw Error("Unknown datatype class: "+a);}},{key:"hdf5MsgDatatype",
value:function(a){var b={},c=8,e,f,k,l,m,n,r,v,q=this.getU8();e=q>>4;f=q&15;l=[];for(q=0;3>q;q+=1)l[q]=this.getU8();q=this.getU32();this.getMetadata("debug")&&console.log("this.hdf5MsgDatatype V"+e+" C"+f+" "+this.dt_class_name(f)+" "+l[0]+"."+l[1]+"."+l[2]+" "+q);switch(f){case 0:f=this.getU16();k=this.getU16();switch(q){case 4:b.typ_type=l[0]&8?this._type_enum.INT32:this._type_enum.UINT32;break;case 2:b.typ_type=l[0]&8?this._type_enum.INT16:this._type_enum.UINT16;break;case 1:b.typ_type=l[0]&8?
this._type_enum.INT8:this._type_enum.UINT8;break;default:throw Error("Unknown type size "+q);}b.typ_length=q;c+=4;this.getMetadata("debug")&&console.log("  ("+f+" "+k+")");break;case 1:e="";if(this.getMetadata("debug"))switch(l[0]&65){case 0:e+="LE ";break;case 1:e+="BE ";break;case 65:e+="VX ";break;default:throw Error("Reserved fp byte order: "+l[0]);}f=this.getU16();k=this.getU16();l=this.getU8();m=this.getU8();n=this.getU8();r=this.getU8();v=this.getU32();this.getMetadata("debug")&&(e+=f+" "+
k+" "+l+" "+m+" "+n+" "+r+" "+v);if(64===k&&0===f&&52===l&&11===m&&0===n&&52===r&&1023===v&&8===q)b.typ_type=this._type_enum.DBL;else if(32===k&&0===f&&23===l&&8===m&&0===n&&23===r&&127===v&&4===q)b.typ_type=this._type_enum.FLT;else throw Error("Unsupported floating-point type");this.getMetadata("debug")&&console.log(e);b.typ_length=q;c+=12;break;case 3:b.typ_type=this._type_enum.STR;b.typ_length=q;break;default:throw Error("Unimplemented HDF5 data class "+f);}a>c&&this.skip(a-c);return b}},{key:"hdf5MsgLayout",
value:function(a){var b="",c=this.getU8(),e,f,k,l=[];k=1;if(1===c||2===c){f=this.getU8();e=this.getU8();this.skip(5);this.getMetadata("debug")&&(b+="this.hdf5MsgLayout V"+c+" N"+f+" C"+e);if(1===e||2===e)c=this.getOffset(),this.getMetadata("debug")&&(b+=" A"+c),a.data_offset=c;for(c=0;c<f;c+=1)l[c]=this.getU32(),k*=l[c];this.getMetadata("debug")&&(b+="["+l.join(", ")+"]");2===e&&(f=this.getU32(),a.chunk_size=k*f,this.getMetadata("debug")&&(b+=" E"+f));0===e?(k=this.getU32(),this.getMetadata("debug")&&
(b+="("+k+")"),a.data_offset=this.tell(),a.data_length=k):1===e&&(a.data_length=k)}else if(3===c)if(e=this.getU8(),b="this.hdf5MsgLayout V"+c+" C"+e,0===e)k=this.getU16(),this.getMetadata("debug")&&(b+="("+k+")"),a.data_offset=this.tell(),a.data_length=k;else if(1===e)e=this.getOffset(),k=this.getLength(),this.getMetadata("debug")&&(b+="("+e+", "+k+")"),a.data_offset=e,a.data_length=k;else{if(2===e){f=this.getU8();e=this.getOffset();a.data_offset=e;a.chunk_size=1;for(c=0;c<f-1;c+=1)l[c]=this.getU32(),
k*=l[c];this.getMetadata("debug")&&(b+="(N"+f+", A"+e+" ["+l.join(",")+"]");f=this.getU32();a.chunk_size=k*f;this.getMetadata("debug")&&(b+=" E"+f)}}else throw Error("Illegal layout version "+c);this.getMetadata("debug")&&console.log(b)}},{key:"hdf5MsgPipeline",value:function(a){var b=this.getU8(),c=this.getU8(),e="this.hdf5MsgPipeline V"+b+" N"+c;1===b&&this.skip(6);this.getMetadata("debug")&&console.log(e);for(var f,k,l,m,e=0;e<c;e+=1){f=this.getU16();if(1!==f)throw Error("Unimplemented HDF5 filter "+
f);if("object"!==("undefined"===typeof Da?"undefined":H(Da)))throw Error("Need pako to inflate data.");a.inflate=!0;k=1===b||256<f?this.getU16():0;l=this.getU16();m=this.getU16();0!==(m&1)&&(m+=1);0!==k&&this.skip(k);this.skip(4*m);this.getMetadata("debug")&&console.log("  "+e+" ID"+f+" F"+l+" "+m)}}},{key:"hdf5MsgAttribute",value:function(a,b){var d=this.getU8(),c=this.getU8(),f=this.getU16(),k=this.getU16(),l=this.getU16(),m="this.hdf5MsgAttribute V"+d+" F"+c+" "+a+": ";if(0!==(c&3))throw Error("Shared dataspaces and datatypes are not supported.");
3===d&&(c=this.getU8(),this.getMetadata("debug")&&(m+=0===c?"ASCII":"UTF-8"));this.getMetadata("debug")&&(m+="("+f+" "+k+" "+l+")");3>d&&(f=8*Math.floor((f+7)/8),k=8*Math.floor((k+7)/8),l=8*Math.floor((l+7)/8),this.getMetadata("debug")&&(m+="/("+f+" "+k+" "+l+")"));c=this.getString(f);this.getMetadata("debug")&&console.log(m+(" Name: "+c));var m=this.hdf5MsgDatatype(k),n=this.hdf5MsgDataspace(l);a=0<a?3>d?a-(8+f+k+l):a-(9+f+k+l):m.typ_length*n;this.getMetadata("debug")&&console.log("  attribute data size "+
a+" "+this.tell());a=m.typ_type===this._type_enum.STR?this.getString(a):this.getArray(m.typ_type,a);b.attributes[c]=a}},{key:"hdf5MsgGroupInfo",value:function(){var a=4,b=8,c=this.getU8(),e=this.getU8();0!==(e&1)&&(this.getU16(),this.getU16());0!==(e&2)&&(a=this.getU16(),b=this.getU16());this.getMetadata("debug")&&console.log("this.hdf5MsgGroupInfo V"+c+" F"+e+" ENT "+a+" LNL "+b)}},{key:"hdf5MsgLink",value:function(a){var b=this.getU8(),c=0;if(1!==b)throw Error("Bad link message version "+b);var e=
this.getU8();0!==(e&8)&&(c=this.getU8());0!==(e&4)&&this.getU64();0!==(e&16)&&this.getU8();var f=this.getUXX(1<<(e&3)),k=this.createLink();k.name=this.getString(f);0===(e&8)&&(k.hdr_offset=this.getOffset());this.getMetadata("debug")&&console.log("this.hdf5MsgLink V"+b+" F"+e+" T"+c+" NM "+k.name+" OF "+k.hdr_offset);a.children.push(k)}},{key:"hdf5FractalHeapDirectBlock",value:function(a,b,c,e){if(!this.checkSignature("FHDB"))throw Error("Bad or missing FHDB signature");var d=this.getU8();if(0!==d)throw Error("Bad FHDB version: "+
d);this.getOffset();var g=this.getUXX(Math.ceil(a.max_heapsz/8));0!==(a.flags&2)&&this.getU32();this.getMetadata("debug")&&console.log("FHDB V:"+d+" R:"+b+" O:"+g+" A:"+c);a=1>=b?a.start_blksz:Math.pow(2,b-1)*a.start_blksz;return e?e(b,c,g,a):!0}},{key:"hdf5FractalHeapIndirectBlock",value:function(a,b){if(!this.checkSignature("FHIB"))throw Error("Bad or missing FHIB signature");var d=this.getU8();if(0!==d)throw Error("Bad FHIB version: "+d);this.getOffset();var c=this.getUXX(Math.ceil(a.max_heapsz/
8));this.getMetadata("debug")&&console.log("FHIB V:"+d+" O:"+c);for(var f=[],d=0;d<a.K;d+=1)c=this.getOffset(),c<this._superblk.eof_addr&&(this.getMetadata("debug")&&console.log("direct block at "+c),f.push(c));for(var k=[],d=0;d<a.N;d+=1)c=this.getOffset(),c<this._superblk.eof_addr&&(this.getMetadata("debug")&&console.log("indirect block at "+c),k.push(c));this.getU32();for(d=0;d<f.length;d++)if(this.seek(f[d]),!this.hdf5FractalHeapDirectBlock(a,d/a.table_width,f[d],b))return!1;for(d=0;d<k.length;d++)if(this.seek(k[d]),
!this.hdf5FractalHeapIndirectBlock(a,b))return!1;return!0}},{key:"hdf5FractalHeapEnumerate",value:function(a,b){this.seek(a.root_addr);0===a.K?this.hdf5FractalHeapDirectBlock(a,0,a.root_addr,b):this.hdf5FractalHeapIndirectBlock(a,b)}},{key:"hdf5FractalHeapOffset",value:function(a,b){var d;this.hdf5FractalHeapEnumerate(a,function(a,c,g,l){return b>=g&&b<g+l?(d=c+(b-g),!1):!0});return d}},{key:"hdf5MsgAttrInfo",value:function(a){var b=this.getU8();if(0!==b)throw Error("Bad attribute information message version: "+
b);var c=this.getU8();0!==(c&1)&&this.getU16();var e=this.getOffset(),f=this.getOffset();0!==(c&2)&&this.getOffset();this.getMetadata("debug")&&console.log("this.hdf5MsgAttrInfo V"+b+" F"+c+" HP "+e+" AN "+f);var b=this.tell(),k;e<this._superblk.eof_addr&&(this.seek(e),k=this.hdf5FractalHeapHeader());if(f<this._superblk.eof_addr){this.seek(f);e=this.hdf5V2BtreeHeader();if(8!==e.type)throw Error("Can only handle indexed attributes.");this.seek(e.root_addr);0<e.depth?this.hdf5V2BtreeInternalNode(k,
e.root_nrec,e.depth,a):this.hdf5V2BtreeLeafNode(k,e.root_nrec,a)}this.seek(b)}},{key:"hdf5ProcessMessage",value:function(a,b){var d={};switch(a.hm_type){case 1:this.hdf5MsgDataspace(a.hm_size,b);break;case 2:this.hdf5MsgLinkInfo(b);break;case 3:a=this.hdf5MsgDatatype(a.hm_size);b&&(b.type=a.typ_type);break;case 6:this.hdf5MsgLink(b);break;case 8:this.hdf5MsgLayout(b);break;case 10:this.hdf5MsgGroupInfo();break;case 11:this.hdf5MsgPipeline(b);break;case 12:this.hdf5MsgAttribute(a.hm_size,b);break;
case 16:d.cq_off=this.getOffset();d.cq_len=this.getLength();this._continuation_queue.push(d);this.getMetadata("debug")&&console.log("hdf5MsgObjHdrContinue "+d.cq_off+" "+d.cq_len);break;case 17:b.sym_btree=this.getOffset();b.sym_lheap=this.getOffset();this.getMetadata("debug")&&console.log("hdf5MsgSymbolTable "+b.sym_btree+" "+b.sym_lheap);break;case 21:this.hdf5MsgAttrInfo(b);break;case 0:case 4:case 5:case 7:case 18:case 19:case 20:case 22:case 24:this.skip(a.hm_size);break;default:throw Error("Unknown message type: "+
a.hm_type);}}},{key:"hdf5V2ObjectHeader",value:function(a){if(!this.checkSignature("OHDR"))throw Error("Bad or missing OHDR signature");var b=this,c=this.getU8(),e=this.getU8();0!==(e&32)&&(this.getU32(),this.getU32(),this.getU32(),this.getU32());0!==(e&16)&&(this.getU16(),this.getU16());var f=this.getUXX(1<<(e&3)),k=0,l=0,m=f;for(this.getMetadata("debug")&&console.log("this.hdf5V2ObjectHeader V"+c+" F"+e+" HS"+f);;){for(;8<=m-l;)c={},c.hm_type=this.getU8(),c.hm_size=this.getU16(),c.hm_flags=this.getU8(),
this.getMetadata("debug")&&console.log("  msg"+k+" F"+c.hm_flags+" T "+c.hm_type+" S "+c.hm_size+" ("+l+"/"+m+") "+this.hdf5GetMsgName(c.hm_type)),0!==(e&4)&&(c.hm_corder=this.getU16()),f=this.tell(),this.hdf5ProcessMessage(c,a),this.seek(f+c.hm_size),l+=c.hm_size+4,k+=1;4<m-l&&this.skip(m-(l+4));this.getU32();if(0!==this._continuation_queue.length){if(c=this._continuation_queue.shift(),this.seek(c.cq_off),m=c.cq_len-4,l=0,this.getMetadata("debug")&&console.log("continuing with "+c.cq_len+" bytes at "+
this.tell()),!this.checkSignature("OCHK"))throw Error("Bad v2 object continuation");}else break}a.children.forEach(function(a,d){b.seek(a.hdr_offset);b.getMetadata("debug")&&console.log(d+" "+a.hdr_offset+" "+a.name);b.checkSignature("OHDR")?(b.seek(a.hdr_offset),b.hdf5V2ObjectHeader(a)):(b.seek(a.hdr_offset),b.hdf5V1ObjectHeader(a))})}},{key:"loadData",value:function(a){var b=this;if(0!==a.chunk_size){this.seek(a.data_offset);var c=1,e;for(e=0;e<a.dims.length;e+=1)c*=a.dims[e];c*=this.typeSize(a.type);
this.getMetadata("debug")&&console.log("allocating "+c+" bytes");c=new ArrayBuffer(c);a.n_filled=0;switch(a.type){case this._type_enum.INT8:a.array=new Int8Array(c);break;case this._type_enum.UINT8:a.array=new Uint8Array(c);break;case this._type_enum.INT16:a.array=new Int16Array(c);break;case this._type_enum.UINT16:a.array=new Uint16Array(c);break;case this._type_enum.INT32:a.array=new Int32Array(c);break;case this._type_enum.UINT32:a.array=new Uint32Array(c);break;case this._type_enum.FLT:a.array=
new Float32Array(c);break;case this._type_enum.DBL:a.array=new Float64Array(c);break;default:throw Error("Illegal type: "+a.type);}this.hdf5V1BtreeNode(a)}else 0<a.data_offset&&a.data_offset<this._superblk.eof_addr?(this.getMetadata("debug")&&console.log("loading "+a.data_length+" bytes from "+a.data_offset+" to "+a.name),a.array=this.getArray(a.type,a.data_length,a.data_offset)):this.getMetadata("debug")&&console.log("data not present for /"+a.name+"/");a.children.forEach(function(a){b.loadData(a)})}},
{key:"hdf5V1ObjectHeader",value:function(a){var b=this,c,e,f,k;this.startAlignment();c=this.getU8();this.skip(1);e=this.getU16();f=this.getU32();k=this.getU32();if(1!==c)throw Error("Bad v1 object header version: "+c);this.getMetadata("debug")&&console.log("this.hdf5V1ObjectHeader V"+c+" #M "+e+" RC "+f+" HS "+k);f=k;var l;for(c=0;c<e;c+=1){if(8>=f)if(0!==this._continuation_queue.length)f=this._continuation_queue.shift(),this.seek(f.cq_off),f=f.cq_len,this.getMetadata("debug")&&console.log("continuing with "+
f+" bytes at "+this.tell()),this.startAlignment();else break;this.checkAlignment();k={};k.hm_type=this.getU16();k.hm_size=this.getU16();k.hm_flags=this.getU8();if(0!==k.hm_size%8)throw Error("Size is not 8-byte aligned: "+k.hm_size);this.skip(3);f-=8+k.hm_size;this.getMetadata("debug")&&console.log("  msg"+c+" F "+k.hm_flags+" T "+k.hm_type+" S "+k.hm_size+"("+f+") "+this.hdf5GetMsgName(k.hm_type));l=this.tell();this.hdf5ProcessMessage(k,a);this.seek(l+k.hm_size)}if(0!==a.sym_btree&&0!==a.sym_lheap){this.seek(a.sym_btree);
e=this.hdf5V1BtreeNode();this.seek(a.sym_lheap);c=this.hdf5LocalHeap();for(f=0;f<e.entries_used;f+=1)this.seek(e.keys[f].child_address),this.checkSignature("SNOD")?(this.seek(e.keys[f].child_address),this.hdf5GroupSymbolTable(c,a)):(this.seek(e.keys[f].child_address),this.hdf5V1ObjectHeader(a));a.children.forEach(function(a){b.seek(a.hdr_offset);b.hdf5V1ObjectHeader(a)})}}},{key:"getTypeMatchMinc",value:function(a){return this._type_matching[a-1]}},{key:"defined",value:function(a){return"undefined"!==
typeof a}},{key:"typeName",value:function(a){return this.defined(a)?a.constructor.name:"undefined"}},{key:"typeSize",value:function(a){if(a>=this._type_enum.INT8&&a<this.type_sizes.length)return this.type_sizes[a];throw Error("Unknown type "+a);}},{key:"typeIsFloat",value:function(a){return a>=this._type_enum.FLT&&a<=this._type_enum.DBL}},{key:"join",value:function(a,b){var d="";if(a&&a.length){var c;for(c=0;c<a.length-1;c+=1)d+=a[c],d+=b;d+=a[c]}return d}},{key:"printStructure",value:function(a,
b){var d=this,c,f="";for(c=0;c<2*b;c+=1)f+=" ";f+=a.name+(a.children.length?"/":"");0<a.type&&(f+=" "+this.typeName(a.array),a.dims.length&&(f+="["+a.dims.join(", ")+"]"),f=a.array?f+(":"+a.array.length):f+" NULL");console.log(f);Object.keys(a.attributes).forEach(function(e){var g=a.attributes[e];f="";for(c=0;c<2*b+1;c+=1)f+=" ";f+=a.name+":"+e+" "+d.typeName(g)+"["+g.length+"] ";"string"===typeof g?f+=JSON.stringify(g):(f+="{"+d.join(g.slice(0,16),", "),16<g.length&&(f+=", ..."),f+="}");console.log(f)});
a.children.forEach(function(a){d.printStructure(a,b+1)})}},{key:"findDataset",value:function(a,b,c){var d=this,f;a&&a.name===b&&0<a.type?f=a:a.children.find(function(a){f=d.findDataset(a,b,c+1);return d.defined(f)});return f}},{key:"findAttribute",value:function(a,b,c){var d=this,f=a.attributes[b];if(f)return f;a.children.find(function(a){f=d.findAttribute(a,b,c+1);return d.defined(f)});return f}},{key:"scaleVoxels",value:function(a,b,c,e,f){var d,g;switch(this.getTypeMatchMinc(a.type)){case "int8":d=
new ArrayBuffer(a.array.length*Int8Array.BYTES_PER_ELEMENT);g=new Int8Array(d);break;case "int16":d=new ArrayBuffer(a.array.length*Int16Array.BYTES_PER_ELEMENT);g=new Int16Array(d);break;case "int32":d=new ArrayBuffer(a.array.length*Int32Array.BYTES_PER_ELEMENT);g=new Int32Array(d);break;case "float32":d=new ArrayBuffer(a.array.length*Float32Array.BYTES_PER_ELEMENT);g=new Float32Array(d);break;case "float64":d=new ArrayBuffer(a.array.length*Float64Array.BYTES_PER_ELEMENT);g=new Float64Array(d);break;
case "uint8":d=new ArrayBuffer(a.array.length*Uint8Array.BYTES_PER_ELEMENT);g=new Uint8Array(d);break;case "uint16":d=new ArrayBuffer(a.array.length*Uint16Array.BYTES_PER_ELEMENT);g=new Uint16Array(d);break;case "uint32":d=new ArrayBuffer(a.array.length*Uint32Array.BYTES_PER_ELEMENT);g=new Uint32Array(d);break;default:throw b="Unsupported data type: "+header.datatype,console.log({message:b}),Error(b);}if(1>a.dims.length-b.dims.length)throw Error("Too few slice dimensions: "+a.dims.length+" "+b.dims.length);
var m=1,n;for(n=b.dims.length;n<a.dims.length;n+=1)m*=a.dims[n];f&&console.log(m+" voxels in slice.");var r=0,v=0,q=-Number.MAX_VALUE,t=Number.MAX_VALUE,p=a.array;c=c.array;var x=b.array;f&&console.log("valid range is "+e[0]+" to "+e[1]);var D,w=e[0],A,I,G,u=this.typeIsFloat(a.type);for(n=0;n<b.array.length;n+=1)if(f&&console.log(n+" "+x[n]+" "+c[n]+" "+p[n*m]),u)for(I=0;I<m;I+=1)G=p[v],G<e[0]||G>e[1]?g[v]=0:(g[v]=G,r+=G,G>q&&(q=G),G<t&&(t=G)),v+=1;else for(a=e[1]-e[0],D=c[n]-x[n],A=x[n],I=0;I<m;I+=
1)G=(p[v]-w)/a*D+A,G=G/c[n]*e[1],g[v]=G,r+=G,v+=1,G>q&&(q=G),G<t&&(t=G);f&&(console.log("Min: "+t),console.log("Max: "+q),console.log("Sum: "+r),console.log("Mean: "+r/v));return d}},{key:"isRgbVolume",value:function(a,b){var d=a.order;return"Uint8Array"===b.array.constructor.name&&0<d.length&&"vector_dimension"===d[d.length-1]&&3===a.vector_dimension.space_length}},{key:"rgbVoxels",value:function(a){a=a.array;var b=a.length,c=new ArrayBuffer(b/3*4),e=new Uint8Array(c),f,k=0;for(f=0;f<b;f+=3)e[k+
0]=a[f+0],e[k+1]=a[f+1],e[k+2]=a[f+2],e[k+3]=255,k+=4;return c}},{key:"parseHeader",value:function(a){var b;try{b=JSON.parse(a)}catch(g){throw a="server did not respond with valid JSON\nResponse was: \n"+a,console.log({message:a}),Error(a);}4===b.order.length&&(b.order=b.order.slice(1));b.datatype=b.datatype||"uint8";b.xspace.space_length=parseFloat(b.xspace.space_length);b.yspace.space_length=parseFloat(b.yspace.space_length);b.zspace.space_length=parseFloat(b.zspace.space_length);b.xspace.start=
parseFloat(b.xspace.start);b.yspace.start=parseFloat(b.yspace.start);b.zspace.start=parseFloat(b.zspace.start);b.xspace.step=parseFloat(b.xspace.step);b.yspace.step=parseFloat(b.yspace.step);b.zspace.step=parseFloat(b.zspace.step);b.xspace.direction_cosines=b.xspace.direction_cosines||[1,0,0];b.yspace.direction_cosines=b.yspace.direction_cosines||[0,1,0];b.zspace.direction_cosines=b.zspace.direction_cosines||[0,0,1];b.xspace.direction_cosines=b.xspace.direction_cosines.map(parseFloat);b.yspace.direction_cosines=
b.yspace.direction_cosines.map(parseFloat);b.zspace.direction_cosines=b.zspace.direction_cosines.map(parseFloat);b[b.order[0]].offset=b[b.order[1]].space_length*b[b.order[2]].space_length;b[b.order[1]].offset=b[b.order[2]].space_length;b[b.order[2]].offset=1;b.time&&(b.time.space_length=parseFloat(b.time.space_length),b.time.start=parseFloat(b.time.start),b.time.step=parseFloat(b.time.step),b.time.offset=b.xspace.space_length*b.yspace.space_length*b.zspace.space_length);return b}},{key:"createMincData",
value:function(a,b){switch(a.datatype){case "int8":a=new Int8Array(b);break;case "int16":a=new Int16Array(b);break;case "int32":a=new Int32Array(b);break;case "float32":a=new Float32Array(b);break;case "float64":a=new Float64Array(b);break;case "uint8":a=new Uint8Array(b);break;case "uint16":a=new Uint16Array(b);break;case "uint32":case "rgb8":a=new Uint32Array(b);break;default:throw a="Unsupported data type: "+a.datatype,console.log({message:a}),Error(a);}return a}},{key:"_run",value:function(){var a=
this,b=this._getInput(0);if(b){this._dv=new DataView(b);this._dv.getUint64=function(b,c){var d=a._dv.getUint32(b+0,c);b=a._dv.getUint32(b+4,c);return c?(b<<32)+d:(d<<32)+b};var c=this.createLink();try{this._superblk=this.hdf5Superblock()}catch(n){console.warn("The input file is not a Minc2 file.");return}this.seek(this._superblk.root_addr);1>=this._superblk.sbver?this.hdf5V1ObjectHeader(c):this.hdf5V2ObjectHeader(c);this.loadData(c);this.getMetadata("debug")&&this.printStructure(c,0);b=this.findDataset(c,
"image");if(!this.defined(b))throw Error("Can't find image dataset.");var e=this.findAttribute(b,"valid_range",0);if(!this.defined(e)){var f,k;switch(b.type){case this._type_enum.INT8:f=-128;k=127;break;case this._type_enum.UINT8:f=0;k=255;break;case this._type_enum.INT16:f=-32768;k=32767;break;case this._type_enum.UINT16:f=0;k=65535;break;case this._type_enum.INT32:f=2147483648;k=-2147483649;break;case this._type_enum.UINT32:f=0,k=(1<<32)-1}e=Float32Array.of(f,k)}f=this.findDataset(c,"image-min");
this.defined(f)||(f={array:Float32Array.of(0),dims:[]});k=this.findDataset(c,"image-max");this.defined(k)||(k={array:Float32Array.of(1),dims:[]});var l={},m=this.findAttribute(b,"dimorder",0);if("string"!==typeof m)throw Error("Can't find dimension order.");l.order=m.split(",");l.order.forEach(function(b){var d=a.findDataset(c,b);if(!a.defined(d))throw Error("Can't find dimension variable "+b);l[b]={};m=a.findAttribute(d,"step",0);a.defined(m)||(m=Float32Array.of(1));l[b].step=m[0];m=a.findAttribute(d,
"start",0);a.defined(m)||(m=Float32Array.of(0));l[b].start=m[0];m=a.findAttribute(d,"length",0);if(!a.defined(m))throw Error("Can't find length for "+b);l[b].space_length=m[0];m=a.findAttribute(d,"direction_cosines",0);a.defined(m)?l[b].direction_cosines=Array.prototype.slice.call(m):"xspace"===b?l[b].direction_cosines=[1,0,0]:"yspace"===b?l[b].direction_cosines=[0,1,0]:"zspace"===b&&(l[b].direction_cosines=[0,0,1])});this.isRgbVolume(l,b)?(l.order.pop(),l.datatype="rgb8",b=this.rgbVoxels(b)):(l.datatype=
this.getTypeMatchMinc(b.type),b=this.scaleVoxels(b,f,k,e,this.getMetadata("debug")));e=this.parseHeader(JSON.stringify(l));e.format="minc2";b=this.createMincData(e,b);e=Mc.convertImage3DMetadata(e);f=new dc;f.setRawData(b);f.setRawMetadata(e);f.metadataIntegrityCheck()&&(f.scanDataRange(),this._output[0]=f)}else console.warn('Minc2DecoderAlt requires an ArrayBuffer as input "0". Unable to continue.')}}]);return b}(V),uh=function(c){function b(){N(this,b);var a=P(this,(b.__proto__||Object.getPrototypeOf(b)).call(this));
a.addInputValidator(0,ArrayBuffer);a.setMetadata("debug",!1);return a}M(b,c);O(b,[{key:"_parseMGHHeader",value:function(a,b){b={order:["xspace","yspace","zspace"],xspace:{},yspace:{},zspace:{}};var c=new DataView(a,0,284);a=c.getUint32(0,!0);if(1===a)a=!0;else if(16777216===a)a=!1;else return console.warn("This does not look like an MGH file."),null;var d,f=[0,0,0,0],k=4,l=1;for(d=0;4>d;d++){f[d]=c.getUint32(k,a);if(1>=f[d])break;l*=f[d];k+=4}if(3>d||4<d)return console.warn("Cannot handle "+d+"-dimensional images yet."),
null;var m=c.getUint32(20,a),n=[1,1,1],r,v,q=[[-1,0,0],[0,0,-1],[0,1,0],[0,0,0]];if(c.getUint16(28,a)){k=30;for(r=0;3>r;r++)n[r]=c.getFloat32(k,a),k+=4;for(r=0;4>r;r++)for(v=0;3>v;v++)q[r][v]=c.getFloat32(k,a),k+=4}if(this._metadata.debug)for(r=0;3>r;r++)for(v=0;4>v;v++);c=[0,1,2];for(r=0;3>r;r++){v=0;var k=Math.abs(q[r][0]),t=Math.abs(q[r][1]),p=Math.abs(q[r][2]);b.order[r]="xspace";t>k&&t>p&&(v=1,b.order[r]="yspace");p>k&&p>t&&(v=2,b.order[r]="zspace");c[r]=v}4===d&&(this._metadata.debug&&console.log("Creating time dimension: "+
f[3]),b.time={space_length:f[3],step:1,start:0,name:"time"},b.order.push("time"));d=[[0,0,0,0],[0,0,0,0],[0,0,0,0]];for(r=0;3>r;r++)for(v=0;3>v;v++)d[r][v]=q[v][r]*n[r];for(r=0;3>r;r++){for(v=n=0;3>v;v++)n+=f[v]/2*d[r][v];d[r][3]=q[3][r]-n}q=[[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0]];for(r=0;3>r;r++)for(v=0;4>v;v++)n=v,3>v&&(n=c[v]),q[r][n]=d[r][v];Mc.transformToMinc(q,b);b.datatype=m;b.little_endian=a;b.nvoxels=l;for(r=0;3>r;r++)b[b.order[r]].space_length=f[r];return b}},{key:"_createMGHData",value:function(a,
b){var c=null,d;switch(a.datatype){case 0:d=1;break;case 1:case 3:d=4;break;case 4:d=2;break;default:return console.warn("Unsupported data type: "+a.datatype),null}var f=a.nvoxels*d;1<d&&!a.little_endian&&Mc.swapn(new Uint8Array(b,284,f),d);switch(a.datatype){case 0:c=new Uint8Array(b,284,a.nvoxels);break;case 1:c=new Int32Array(b,284,a.nvoxels);break;case 3:c=new Float32Array(b,284,a.nvoxels);break;case 4:c=new Int16Array(b,284,a.nvoxels)}b=1;for(d=0;d<a.order.length;d++)a[a.order[d]].offset=b,b*=
a[a.order[d]].space_length;return c}},{key:"_run",value:function(){function a(a){for(var b=0;b<e.length;b++)if(e[b].nameWorldSpace===a)return b;return-1}var b=this._getInput(0);if(b){var c=null;try{c=this._parseMGHHeader(b)}catch(l){}if(c){b=this._createMGHData(c,b);if(!b)return null;var c=Mc.convertImage3DMetadata(c),e=c.dimensions;e.sort(function(a,b){return a.stride<b.stride});for(var f=0;f<e.length;f++){var k=e[f].nameWorldSpace;e[f].heightDimension=a("x"===k?"z":"y"===k?"z":"z"===k?"y":null);
e[f].widthDimension=a("x"===k?"y":"y"===k?"x":"z"===k?"x":null)}f=new dc;f.setRawData(b);f.setRawMetadata(c);f.metadataIntegrityCheck()&&(f.scanDataRange(),this._output[0]=f)}else console.log("The input file is not a MGH file.")}else console.warn('MghDecoderAlt requires an ArrayBuffer as input "0". Unable to continue.')}}]);return b}(V),zj=function(c){function b(){N(this,b);var a=P(this,(b.__proto__||Object.getPrototypeOf(b)).call(this));a._decoders=[th,rh,uh];return a}M(b,c);O(b,[{key:"_run",value:function(){var a=
this._getInput(0);if(a)for(var b=0;b<this._decoders.length;b++){var c=new this._decoders[b];c.addInput(a);c.update();if(c.getNumberOfOutputs()){this._output[0]=c.getOutput();console.log(this._output[0]);this.setMetadata("decoderConstructor",this._decoders[b]);this.setMetadata("decoderName",this._decoders[b].name);break}}else console.warn("The input buffer must not be null.")}}]);return b}(V),re=/[A-Z_a-z\xC0-\xD6\xD8-\xF6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]/,
vh=new RegExp("[\\-\\.0-9"+re.source.slice(1,-1)+"\\u00B7\\u0300-\\u036F\\u203F-\\u2040]"),wh=new RegExp("^"+re.source+vh.source+"*(?::"+re.source+vh.source+"*)?$");zf.prototype={parse:function(c,b,a){var d=this.domBuilder;d.startDocument();Df(b,b={});qi(c,b,a,d,this.errorHandler);d.endDocument()}};Af.prototype={setTagName:function(c){if(!wh.test(c))throw Error("invalid tagName:"+c);this.tagName=c},add:function(c,b,a){if(!wh.test(c))throw Error("invalid attribute:"+c);this[this.length++]={qName:c,
value:b,offset:a}},length:0,getLocalName:function(c){return this[c].localName},getLocator:function(c){return this[c].locator},getQName:function(c){return this[c].qName},getURI:function(c){return this[c].uri},getValue:function(c){return this[c].value}};$c({},$c.prototype)instanceof $c||($c=function(c,b){function a(){}a.prototype=b;a=new a;for(b in c)a[b]=c[b];return a});var Aa={},Sa=Aa.ELEMENT_NODE=1,Xb=Aa.ATTRIBUTE_NODE=2,ed=Aa.TEXT_NODE=3,Tf=Aa.CDATA_SECTION_NODE=4,Xf=Aa.ENTITY_REFERENCE_NODE=5,
Aj=Aa.ENTITY_NODE=6,Wf=Aa.PROCESSING_INSTRUCTION_NODE=7,Uf=Aa.COMMENT_NODE=8,Sf=Aa.DOCUMENT_NODE=9,Vf=Aa.DOCUMENT_TYPE_NODE=10,$a=Aa.DOCUMENT_FRAGMENT_NODE=11,Bj=Aa.NOTATION_NODE=12,sa={},ja={};sa.INDEX_SIZE_ERR=(ja[1]="Index size error",1);sa.DOMSTRING_SIZE_ERR=(ja[2]="DOMString size error",2);var Cj=sa.HIERARCHY_REQUEST_ERR=(ja[3]="Hierarchy request error",3);sa.WRONG_DOCUMENT_ERR=(ja[4]="Wrong document",4);sa.INVALID_CHARACTER_ERR=(ja[5]="Invalid character",5);sa.NO_DATA_ALLOWED_ERR=(ja[6]="No data allowed",
6);sa.NO_MODIFICATION_ALLOWED_ERR=(ja[7]="No modification allowed",7);var wi=sa.NOT_FOUND_ERR=(ja[8]="Not found",8);sa.NOT_SUPPORTED_ERR=(ja[9]="Not supported",9);var xh=sa.INUSE_ATTRIBUTE_ERR=(ja[10]="Attribute in use",10);sa.INVALID_STATE_ERR=(ja[11]="Invalid state",11);sa.SYNTAX_ERR=(ja[12]="Syntax error",12);sa.INVALID_MODIFICATION_ERR=(ja[13]="Invalid modification",13);sa.NAMESPACE_ERR=(ja[14]="Invalid namespace",14);sa.INVALID_ACCESS_ERR=(ja[15]="Invalid access",15);Ub.prototype=Error.prototype;
rc(sa,Ub);nb.prototype={length:0,item:function(c){return this[c]||null},toString:function(c,b){for(var a=[],d=0;d<this.length;d++)Wb(this[d],a,c,b);return a.join("")}};sc.prototype.item=function(c){Od(this);return this[c]};wa(sc,nb);ad.prototype={length:0,item:nb.prototype.item,getNamedItem:function(c){for(var b=this.length;b--;){var a=this[b];if(a.nodeName==c)return a}},setNamedItem:function(c){var b=c.ownerElement;if(b&&b!=this._ownerElement)throw new Ub(xh);b=this.getNamedItem(c.nodeName);Gf(this._ownerElement,
this,c,b);return b},setNamedItemNS:function(c){var b=c.ownerElement;if(b&&b!=this._ownerElement)throw new Ub(xh);b=this.getNamedItemNS(c.namespaceURI,c.localName);Gf(this._ownerElement,this,c,b);return b},removeNamedItem:function(c){c=this.getNamedItem(c);If(this._ownerElement,this,c);return c},removeNamedItemNS:function(c,b){c=this.getNamedItemNS(c,b);If(this._ownerElement,this,c);return c},getNamedItemNS:function(c,b){for(var a=this.length;a--;){var d=this[a];if(d.localName==b&&d.namespaceURI==
c)return d}return null}};Jf.prototype={hasFeature:function(c,b){return(c=this._features[c.toLowerCase()])&&(!b||b in c)?!0:!1},createDocument:function(c,b,a){var d=new tc;d.implementation=this;d.childNodes=new nb;(d.doctype=a)&&d.appendChild(a);b&&(c=d.createElementNS(c,b),d.appendChild(c));return d},createDocumentType:function(c,b,a){var d=new Td;d.name=c;d.nodeName=c;d.publicId=b;d.systemId=a;return d}};ta.prototype={firstChild:null,lastChild:null,previousSibling:null,nextSibling:null,attributes:null,
parentNode:null,childNodes:null,ownerDocument:null,nodeValue:null,namespaceURI:null,prefix:null,localName:null,insertBefore:function(c,b){return Mf(this,c,b)},replaceChild:function(c,b){this.insertBefore(c,b);b&&this.removeChild(b)},removeChild:function(c){return Lf(this,c)},appendChild:function(c){return this.insertBefore(c,null)},hasChildNodes:function(){return null!=this.firstChild},cloneNode:function(c){return Wd(this.ownerDocument||this,this,c)},normalize:function(){for(var c=this.firstChild;c;){var b=
c.nextSibling;b&&b.nodeType==ed&&c.nodeType==ed?(this.removeChild(b),c.appendData(b.data)):(c.normalize(),c=b)}},isSupported:function(c,b){return this.ownerDocument.implementation.hasFeature(c,b)},hasAttributes:function(){return 0<this.attributes.length},lookupPrefix:function(c){for(var b=this;b;){var a=b._nsMap;if(a)for(var d in a)if(a[d]==c)return d;b=b.nodeType==Xb?b.ownerDocument:b.parentNode}return null},lookupNamespaceURI:function(c){for(var b=this;b;){var a=b._nsMap;if(a&&c in a)return a[c];
b=b.nodeType==Xb?b.ownerDocument:b.parentNode}return null},isDefaultNamespace:function(c){return null==this.lookupPrefix(c)}};rc(Aa,ta);rc(Aa,ta.prototype);tc.prototype={nodeName:"#document",nodeType:Sf,doctype:null,documentElement:null,_inc:1,insertBefore:function(c,b){if(c.nodeType==$a){for(var a=c.firstChild;a;){var d=a.nextSibling;this.insertBefore(a,b);a=d}return c}null==this.documentElement&&c.nodeType==Sa&&(this.documentElement=c);return Mf(this,c,b),c.ownerDocument=this,c},removeChild:function(c){this.documentElement==
c&&(this.documentElement=null);return Lf(this,c)},importNode:function(c,b){return Yf(this,c,b)},getElementById:function(c){var b=null;bd(this.documentElement,function(a){if(a.nodeType==Sa&&a.getAttribute("id")==c)return b=a,!0});return b},createElement:function(c){var b=new Vb;b.ownerDocument=this;b.nodeName=c;b.tagName=c;b.childNodes=new nb;return(b.attributes=new ad)._ownerElement=b},createDocumentFragment:function(){var c=new dd;c.ownerDocument=this;c.childNodes=new nb;return c},createTextNode:function(c){var b=
new Qd;b.ownerDocument=this;b.appendData(c);return b},createComment:function(c){var b=new Rd;b.ownerDocument=this;b.appendData(c);return b},createCDATASection:function(c){var b=new Sd;b.ownerDocument=this;b.appendData(c);return b},createProcessingInstruction:function(c,b){var a=new Vd;a.ownerDocument=this;a.tagName=a.target=c;a.nodeValue=a.data=b;return a},createAttribute:function(c){var b=new cd;b.ownerDocument=this;b.name=c;b.nodeName=c;b.localName=c;b.specified=!0;return b},createEntityReference:function(c){var b=
new Ud;b.ownerDocument=this;b.nodeName=c;return b},createElementNS:function(c,b){var a=new Vb,d=b.split(":"),g=a.attributes=new ad;a.childNodes=new nb;a.ownerDocument=this;a.nodeName=b;a.tagName=b;a.namespaceURI=c;2==d.length?(a.prefix=d[0],a.localName=d[1]):a.localName=b;return g._ownerElement=a},createAttributeNS:function(c,b){var a=new cd,d=b.split(":");a.ownerDocument=this;a.nodeName=b;a.name=b;a.namespaceURI=c;a.specified=!0;2==d.length?(a.prefix=d[0],a.localName=d[1]):a.localName=b;return a}};
wa(tc,ta);Vb.prototype={nodeType:Sa,hasAttribute:function(c){return null!=this.getAttributeNode(c)},getAttribute:function(c){return(c=this.getAttributeNode(c))&&c.value||""},getAttributeNode:function(c){return this.attributes.getNamedItem(c)},setAttribute:function(c,b){c=this.ownerDocument.createAttribute(c);c.value=c.nodeValue=""+b;this.setAttributeNode(c)},removeAttribute:function(c){(c=this.getAttributeNode(c))&&this.removeAttributeNode(c)},appendChild:function(c){if(c.nodeType===$a)return this.insertBefore(c,
null);var b=c.parentNode;b&&b.removeChild(c);b=this.lastChild;c.parentNode=this;c.previousSibling=b;c.nextSibling=null;b?b.nextSibling=c:this.firstChild=c;this.lastChild=c;Pd(this.ownerDocument,this,c);return c},setAttributeNode:function(c){return this.attributes.setNamedItem(c)},setAttributeNodeNS:function(c){return this.attributes.setNamedItemNS(c)},removeAttributeNode:function(c){return this.attributes.removeNamedItem(c.nodeName)},removeAttributeNS:function(c,b){(c=this.getAttributeNodeNS(c,b))&&
this.removeAttributeNode(c)},hasAttributeNS:function(c,b){return null!=this.getAttributeNodeNS(c,b)},getAttributeNS:function(c,b){return(c=this.getAttributeNodeNS(c,b))&&c.value||""},setAttributeNS:function(c,b,a){c=this.ownerDocument.createAttributeNS(c,b);c.value=c.nodeValue=""+a;this.setAttributeNode(c)},getAttributeNodeNS:function(c,b){return this.attributes.getNamedItemNS(c,b)},getElementsByTagName:function(c){return new sc(this,function(b){var a=[];bd(b,function(d){d===b||d.nodeType!=Sa||"*"!==
c&&d.tagName!=c||a.push(d)});return a})},getElementsByTagNameNS:function(c,b){return new sc(this,function(a){var d=[];bd(a,function(g){g===a||g.nodeType!==Sa||"*"!==c&&g.namespaceURI!==c||"*"!==b&&g.localName!=b||d.push(g)});return d})}};tc.prototype.getElementsByTagName=Vb.prototype.getElementsByTagName;tc.prototype.getElementsByTagNameNS=Vb.prototype.getElementsByTagNameNS;wa(Vb,ta);cd.prototype.nodeType=Xb;wa(cd,ta);uc.prototype={data:"",substringData:function(c,b){return this.data.substring(c,
c+b)},appendData:function(c){this.nodeValue=this.data=c=this.data+c;this.length=c.length},insertData:function(c,b){this.replaceData(c,0,b)},appendChild:function(c){throw Error(ja[Cj]);},deleteData:function(c,b){this.replaceData(c,b,"")},replaceData:function(c,b,a){var d=this.data.substring(0,c);c=this.data.substring(c+b);this.nodeValue=this.data=a=d+a+c;this.length=a.length}};wa(uc,ta);Qd.prototype={nodeName:"#text",nodeType:ed,splitText:function(c){var b=this.data,a=b.substring(c);this.data=this.nodeValue=
b=b.substring(0,c);this.length=b.length;c=this.ownerDocument.createTextNode(a);this.parentNode&&this.parentNode.insertBefore(c,this.nextSibling);return c}};wa(Qd,uc);Rd.prototype={nodeName:"#comment",nodeType:Uf};wa(Rd,uc);Sd.prototype={nodeName:"#cdata-section",nodeType:Tf};wa(Sd,uc);Td.prototype.nodeType=Vf;wa(Td,ta);Nf.prototype.nodeType=Bj;wa(Nf,ta);Of.prototype.nodeType=Aj;wa(Of,ta);Ud.prototype.nodeType=Xf;wa(Ud,ta);dd.prototype.nodeName="#document-fragment";dd.prototype.nodeType=$a;wa(dd,ta);
Vd.prototype.nodeType=Wf;wa(Vd,ta);Pf.prototype.serializeToString=function(c,b,a){return Qf.call(c,b,a)};ta.prototype.toString=Qf;try{if(Object.defineProperty){var Dj=function b(a){switch(a.nodeType){case Sa:case $a:var d=[];for(a=a.firstChild;a;)7!==a.nodeType&&8!==a.nodeType&&d.push(b(a)),a=a.nextSibling;return d.join("");default:return a.nodeValue}};Object.defineProperty(sc.prototype,"length",{get:function(){Od(this);return this.$$length}});Object.defineProperty(ta.prototype,"textContent",{get:function(){return Dj(this)},
set:function(b){switch(this.nodeType){case Sa:case $a:for(;this.firstChild;)this.removeChild(this.firstChild);(b||String(b))&&this.appendChild(this.ownerDocument.createTextNode(b));break;default:this.nodeValue=this.value=this.data=b}}});Ef=function(b,a,d){b["$$"+a]=d}}}catch(c){}var Ej=qa(function(c,b){function a(a){this.options=a||{locator:{}}}function d(a,b,c){function d(b){var d=a[b];!d&&k&&(d=2==a.length?function(c){a(b,c)}:a);e[b]=d&&function(a){d("[xmldom "+b+"]\t"+a+f(c))}||function(){}}if(!a){if(b instanceof
g)return b;a=b}var e={},k=a instanceof Function;c=c||{};d("warning");d("error");d("fatalError");return e}function g(){this.cdata=!1}function e(a,b){b.lineNumber=a.lineNumber;b.columnNumber=a.columnNumber}function f(a){if(a)return"\n@"+(a.systemId||"")+"#[line:"+a.lineNumber+",col:"+a.columnNumber+"]"}function k(a,b,c){return"string"==typeof a?a.substr(b,c):a.length>=b+c||b?new java.lang.String(a,b,c)+"":a}function l(a,b){a.currentElement?a.currentElement.appendChild(b):a.doc.appendChild(b)}a.prototype.parseFromString=
function(a,b){var c=this.options,e=new m,f=c.domBuilder||new g,k=c.errorHandler,l=c.locator,n=c.xmlns||{},r={lt:"<",gt:">",amp:"&",quot:'"',apos:"'"};l&&f.setDocumentLocator(l);e.errorHandler=d(k,f,l);e.domBuilder=c.domBuilder||f;/\/x?html?$/.test(b)&&(r.nbsp="\u00a0",r.copy="\u00a9",n[""]="http://www.w3.org/1999/xhtml");n.xml=n.xml||"http://www.w3.org/XML/1998/namespace";a?e.parse(a,n,r):e.errorHandler.error("invalid doc source");return f.doc};g.prototype={startDocument:function(){this.doc=(new n).createDocument(null,
null,null);this.locator&&(this.doc.documentURI=this.locator.systemId)},startElement:function(a,b,c,d){var f=this.doc;b=f.createElementNS(a,c||b);var g=d.length;l(this,b);this.currentElement=b;this.locator&&e(this.locator,b);for(var k=0;k<g;k++){a=d.getURI(k);var m=d.getValue(k);c=d.getQName(k);a=f.createAttributeNS(a,c);this.locator&&e(d.getLocator(k),a);a.value=a.nodeValue=m;b.setAttributeNode(a)}},endElement:function(a,b,c){this.currentElement=this.currentElement.parentNode},startPrefixMapping:function(a,
b){},endPrefixMapping:function(a){},processingInstruction:function(a,b){a=this.doc.createProcessingInstruction(a,b);this.locator&&e(this.locator,a);l(this,a)},ignorableWhitespace:function(a,b,c){},characters:function(a,b,c){if(a=k.apply(this,arguments)){var d=this.cdata?this.doc.createCDATASection(a):this.doc.createTextNode(a);this.currentElement?this.currentElement.appendChild(d):/^\s*$/.test(a)&&this.doc.appendChild(d);this.locator&&e(this.locator,d)}},skippedEntity:function(a){},endDocument:function(){this.doc.normalize()},
setDocumentLocator:function(a){if(this.locator=a)a.lineNumber=0},comment:function(a,b,c){a=k.apply(this,arguments);var d=this.doc.createComment(a);this.locator&&e(this.locator,d);l(this,d)},startCDATA:function(){this.cdata=!0},endCDATA:function(){this.cdata=!1},startDTD:function(a,b,c){var d=this.doc.implementation;d&&d.createDocumentType&&(a=d.createDocumentType(a,b,c),this.locator&&e(this.locator,a),l(this,a))},warning:function(a){console.warn("[xmldom warning]\t"+a,f(this.locator))},error:function(a){console.error("[xmldom error]\t"+
a,f(this.locator))},fatalError:function(a){console.error("[xmldom fatalError]\t"+a,f(this.locator));throw a;}};"endDTD,startEntity,endEntity,attributeDecl,elementDecl,externalEntityDecl,internalEntityDecl,resolveEntity,getExternalSubset,notationDecl,unparsedEntityDecl".replace(/\w+/g,function(a){g.prototype[a]=function(){return null}});var m=zf,n=b.DOMImplementation=Jf;b.XMLSerializer=Pf;b.DOMParser=a});"use strict";var se={315:"Artist",258:"BitsPerSample",265:"CellLength",264:"CellWidth",320:"ColorMap",
259:"Compression",33432:"Copyright",306:"DateTime",338:"ExtraSamples",266:"FillOrder",289:"FreeByteCounts",288:"FreeOffsets",291:"GrayResponseCurve",290:"GrayResponseUnit",316:"HostComputer",270:"ImageDescription",257:"ImageLength",256:"ImageWidth",271:"Make",281:"MaxSampleValue",280:"MinSampleValue",272:"Model",254:"NewSubfileType",274:"Orientation",262:"PhotometricInterpretation",284:"PlanarConfiguration",296:"ResolutionUnit",278:"RowsPerStrip",277:"SamplesPerPixel",305:"Software",279:"StripByteCounts",
273:"StripOffsets",255:"SubfileType",263:"Threshholding",282:"XResolution",283:"YResolution",326:"BadFaxLines",327:"CleanFaxData",343:"ClipPath",328:"ConsecutiveBadFaxLines",433:"Decode",434:"DefaultImageColor",269:"DocumentName",336:"DotRange",321:"HalftoneHints",346:"Indexed",347:"JPEGTables",285:"PageName",297:"PageNumber",317:"Predictor",319:"PrimaryChromaticities",532:"ReferenceBlackWhite",339:"SampleFormat",340:"SMinSampleValue",341:"SMaxSampleValue",559:"StripRowCounts",330:"SubIFDs",292:"T4Options",
293:"T6Options",325:"TileByteCounts",323:"TileLength",324:"TileOffsets",322:"TileWidth",301:"TransferFunction",318:"WhitePoint",344:"XClipPathUnits",286:"XPosition",529:"YCbCrCoefficients",531:"YCbCrPositioning",530:"YCbCrSubSampling",345:"YClipPathUnits",287:"YPosition",37378:"ApertureValue",40961:"ColorSpace",36868:"DateTimeDigitized",36867:"DateTimeOriginal",34665:"Exif IFD",36864:"ExifVersion",33434:"ExposureTime",41728:"FileSource",37385:"Flash",40960:"FlashpixVersion",33437:"FNumber",42016:"ImageUniqueID",
37384:"LightSource",37500:"MakerNote",37377:"ShutterSpeedValue",37510:"UserComment",33723:"IPTC",34675:"ICC Profile",700:"XMP",42112:"GDAL_METADATA",42113:"GDAL_NODATA",34377:"Photoshop",33550:"ModelPixelScale",33922:"ModelTiepoint",34264:"ModelTransformation",34735:"GeoKeyDirectory",34736:"GeoDoubleParams",34737:"GeoAsciiParams"},fb,Xa={};for(fb in se)Xa[se[fb]]=parseInt(fb);var Fj=[Xa.BitsPerSample,Xa.ExtraSamples,Xa.SampleFormat,Xa.StripByteCounts,Xa.StripOffsets,Xa.StripRowCounts,Xa.TileByteCounts,
Xa.TileOffsets],te={1:"BYTE",2:"ASCII",3:"SHORT",4:"LONG",5:"RATIONAL",6:"SBYTE",7:"UNDEFINED",8:"SSHORT",9:"SLONG",10:"SRATIONAL",11:"FLOAT",12:"DOUBLE",16:"LONG8",17:"SLONG8",18:"IFD8"},yh={};for(fb in te)yh[te[fb]]=parseInt(fb);var ue={1024:"GTModelTypeGeoKey",1025:"GTRasterTypeGeoKey",1026:"GTCitationGeoKey",2048:"GeographicTypeGeoKey",2049:"GeogCitationGeoKey",2050:"GeogGeodeticDatumGeoKey",2051:"GeogPrimeMeridianGeoKey",2052:"GeogLinearUnitsGeoKey",2053:"GeogLinearUnitSizeGeoKey",2054:"GeogAngularUnitsGeoKey",
2055:"GeogAngularUnitSizeGeoKey",2056:"GeogEllipsoidGeoKey",2057:"GeogSemiMajorAxisGeoKey",2058:"GeogSemiMinorAxisGeoKey",2059:"GeogInvFlatteningGeoKey",2060:"GeogAzimuthUnitsGeoKey",2061:"GeogPrimeMeridianLongGeoKey",2062:"GeogTOWGS84GeoKey",3072:"ProjectedCSTypeGeoKey",3073:"PCSCitationGeoKey",3074:"ProjectionGeoKey",3075:"ProjCoordTransGeoKey",3076:"ProjLinearUnitsGeoKey",3077:"ProjLinearUnitSizeGeoKey",3078:"ProjStdParallel1GeoKey",3079:"ProjStdParallel2GeoKey",3080:"ProjNatOriginLongGeoKey",
3081:"ProjNatOriginLatGeoKey",3082:"ProjFalseEastingGeoKey",3083:"ProjFalseNorthingGeoKey",3084:"ProjFalseOriginLongGeoKey",3085:"ProjFalseOriginLatGeoKey",3086:"ProjFalseOriginEastingGeoKey",3087:"ProjFalseOriginNorthingGeoKey",3088:"ProjCenterLongGeoKey",3089:"ProjCenterLatGeoKey",3090:"ProjCenterEastingGeoKey",3091:"ProjCenterNorthingGeoKey",3092:"ProjScaleAtNatOriginGeoKey",3093:"ProjScaleAtCenterGeoKey",3094:"ProjAzimuthAngleGeoKey",3095:"ProjStraightVertPoleLongGeoKey",3096:"ProjRectifiedGridAngleGeoKey",
4096:"VerticalCSTypeGeoKey",4097:"VerticalCitationGeoKey",4098:"VerticalDatumGeoKey",4099:"VerticalUnitsGeoKey"},zh={};for(fb in ue)zh[ue[fb]]=parseInt(fb);var sd;"undefined"===typeof window?sd=function(c){return(new Ej.DOMParser).parseFromString(c,"text/xml")}:"undefined"!==typeof window.DOMParser?sd=function(c){return(new window.DOMParser).parseFromString(c,"text/xml")}:"undefined"!==typeof window.ActiveXObject&&new window.ActiveXObject("Microsoft.XMLDOM")&&(sd=function(c){var b=new window.ActiveXObject("Microsoft.XMLDOM");
b.async="false";b.loadXML(c);return b});var la={fieldTags:Xa,fieldTagNames:se,arrayFields:Fj,fieldTypes:yh,fieldTypeNames:te,photometricInterpretations:{WhiteIsZero:0,BlackIsZero:1,RGB:2,Palette:3,TransparencyMask:4,CMYK:5,YCbCr:6,CIELab:8,ICCLab:9},geoKeys:zh,geoKeyNames:ue,parseXml:sd};"use strict";var hc={fromWhiteIsZero:function(c,b,a,d){a=new Uint8Array(a*d*3);for(var g=0,e=0;g<c.length;++g,e+=3)d=256-c[g]/b*256,a[e]=d,a[e+1]=d,a[e+2]=d;return a},fromBlackIsZero:function(c,b,a,d){a=new Uint8Array(a*
d*3);for(var g=0,e=0;g<c.length;++g,e+=3)d=c[g]/b*256,a[e]=d,a[e+1]=d,a[e+2]=d;return a},fromPalette:function(c,b,a,d){a=new Uint8Array(a*d*3);d=b.length/3;for(var g=b.length/3*2,e=0,f=0;e<c.length;++e,f+=3){var k=c[e];a[f]=b[k]/65536*256;a[f+1]=b[k+d]/65536*256;a[f+2]=b[k+g]/65536*256}return a},fromCMYK:function(c,b,a){b=new Uint8Array(b*a*3);for(var d,g,e,f=0,k=0;f<c.length;f+=4,k+=3)a=c[f],d=c[f+1],g=c[f+2],e=c[f+3],b[k]=(255-a)/256*255*((255-e)/256),b[k+1]=(255-d)/256*255*((255-e)/256),b[k+2]=
(255-g)/256*255*((255-e)/256);return b},fromYCbCr:function(c,b,a){b=new Uint8Array(b*a*3);for(var d,g,e=0,f=0;e<c.length;e+=3,f+=3)a=c[e],d=c[e+1],g=c[e+2],b[f]=a+1.402*(g-128),b[f+1]=a-.34414*(d-128)-.71414*(g-128),b[f+2]=a+1.772*(d-128);return b},fromCIELab:function(c,b,a){var d=[3.240479,-1.53715,-.498535,-.969256,1.875992,.041556,.055648,-.204043,1.057311];b=new Uint8Array(b*a*3);for(var g,e,f,k,l,m=a=0;a<c.length;a+=3,m+=3)g=c[a],e=c[a+1],f=c[a+2],k=Math.pow((g+16)/116,3),l=.008856<k,g=k=g/903.3*
(0!==l)+l*k,k=l*Math.pow(k,1/3)+(0!==l)*(7.787*k+16/116),e=e/500+k,l=.206893<e,e=l*Math.pow(e,3)+(e-16/116)/7.787*(0!==l),f=k-f/200,k=.206893<f,f=k*Math.pow(f,3)+(f-16/116)/7.787*(0!==k),e*=.950456,f*=1.088754,b[m]=e*d[0]+g*d[1]+f*d[2],b[m+1]=e*d[3]+g*d[4]+f*d[5],b[m+2]=e*d[6]+g*d[7]+f*d[8];return b}};"use strict";vc.prototype={isAsync:function(){return"undefined"===typeof this.decodeBlock}};"use strict";wc.prototype=Object.create(vc.prototype);wc.prototype.constructor=wc;wc.prototype.decodeBlock=
function(c){return c};var xi=wc;"use strict";Xd.prototype={constructor:Xd,initDictionary:function(){this.dictionary=Array(258);this.entryLookup={};this.byteLength=9;for(var c=0;257>=c;c++)this.dictionary[c]=[c],this._makeEntryLookup&&(this.entryLookup[c]=c)},decompress:function(c){this._makeEntryLookup=!1;this.initDictionary();this.position=0;this.result=[];c.buffer||(c=new Uint8Array(c));c=new DataView(c.buffer);for(var b=this.getNext(c),a;257!==b;){if(256===b){this.initDictionary();for(b=this.getNext(c);256===
b;)b=this.getNext(c);if(256<b)throw"corrupted code at scanline "+b;if(257===b)break;else this.appendArray(this.result,this.dictionary[b]),a=b}else{if(void 0!==this.dictionary[b])this.appendArray(this.result,this.dictionary[b]),a=this.dictionary[a].concat(this.dictionary[b][0]);else{var d=this.dictionary[a];if(!d)throw"Bogus entry. Not in dictionary, "+a+" / "+this.dictionary.length+", position: "+this.position;a=d.concat(this.dictionary[a][0]);this.appendArray(this.result,a)}this.addToDictionary(a);
a=b}this.dictionary.length>=Math.pow(2,this.byteLength)-1&&this.byteLength++;b=this.getNext(c)}return new Uint8Array(this.result)},appendArray:function(c,b){for(var a=0;a<b.length;a++)c.push(b[a]);return c},haveBytesChanged:function(){return this.dictionary.length>=Math.pow(2,this.byteLength)?(this.byteLength++,!0):!1},addToDictionary:function(c){this.dictionary.push(c);this._makeEntryLookup&&(this.entryLookup[c]=this.dictionary.length-1);this.haveBytesChanged();return this.dictionary.length-1},getNext:function(c){c=
this.getByte(c,this.position,this.byteLength);this.position+=this.byteLength;return c},getByte:function(c,b,a){var d=b%8,g=Math.floor(b/8),e=8-d,f=b+a-8*(g+1),k,l=8*(g+2)-b;k=Math.max(0,8*(g+2)-(b+a));if(g>=c.byteLength)return console.warn("ran off the end of the buffer before finding EOI_CODE (end on input code)"),257;d=(c.getUint8(g,this.littleEndian)&Math.pow(2,8-d)-1)<<a-e;g+1<c.byteLength&&(k=c.getUint8(g+1,this.littleEndian)>>>k,k<<=Math.max(0,a-l),d+=k);8<f&&g+2<c.byteLength&&(b=8*(g+3)-(b+
a),c=c.getUint8(g+2,this.littleEndian)>>>b,d+=c);return d},compress:function(c){this._makeEntryLookup=!0;this.initDictionary();this.position=0;for(var b=[],a=[],b=this.appendArray(b,this.binaryFromByte(256,this.byteLength)),d=0;d<c.length;d++){var g=[c[d]],e=a.concat(g);void 0!==this.entryLookup[e]?a=e:(a=this.binaryFromByte(this.entryLookup[a],this.byteLength),b=this.appendArray(b,a),this.addToDictionary(e),a=g,this.dictionary.length>=Math.pow(2,12)&&(b=this.appendArray(b,this.binaryFromByte(256,
this.byteLength)),this.initDictionary()))}c=this.binaryFromByte(this.entryLookup[a],this.byteLength);b=this.appendArray(b,c);this.binary=b=b=this.appendArray(b,this.binaryFromByte(257,this.byteLength));return this.result=this.binaryToUint8(b)},byteFromCode:function(c){return this.dictionary[c]},binaryFromByte:function(c){for(var b=new Uint8Array(1<arguments.length&&void 0!==arguments[1]?arguments[1]:8),a=0;a<b.length;a++)b[b.length-1-a]=0<(c&Math.pow(2,a));return b},binaryToNumber:function(c){for(var b=
0,a=0;a<c.length;a++)b+=Math.pow(2,c.length-a-1)*c[a];return b},inputToBinary:function(c){for(var b=1<arguments.length&&void 0!==arguments[1]?arguments[1]:8,a=new Uint8Array(c.length*b),d=0;d<c.length;d++){var g=this.binaryFromByte(c[d],b);a.set(g,d*b)}return a},binaryToUint8:function(c){for(var b=new Uint8Array(Math.ceil(c.length/8)),a=0,d=0;d<c.length;d+=8){for(var g=0,e=0;8>e&&d+e<c.length;e++)g+=c[d+e]*Math.pow(2,8-e-1);b[a]=g;a++}return b}};xc.prototype=Object.create(vc.prototype);xc.prototype.constructor=
xc;xc.prototype.decodeBlock=function(c){return this.decompressor.decompress(c).buffer};var yi=xc;"use strict";var Gj=mh.inflate;yc.prototype=Object.create(vc.prototype);yc.prototype.constructor=yc;yc.prototype.decodeBlock=function(c){return Gj(new Uint8Array(c)).buffer};var zi=yc;"use strict";zc.prototype=Object.create(vc.prototype);zc.prototype.constructor=zc;zc.prototype.decodeBlock=function(c){var b=new DataView(c),a=[],d,g;for(d=0;d<c.byteLength;++d){var e=b.getInt8(d);if(0>e){var f=b.getUint8(d+
1),e=-e;for(g=0;g<=e;++g)a.push(f);d+=1}else{for(g=0;g<=e;++g)a.push(b.getUint8(d+g+1));d+=e+1}}return(new Uint8Array(a)).buffer};var Ai=zc;"use strict";var Ah=function(c,b,a){for(var d=0;b<a;++b)d+=c[b];return d},Bh=function(c,b,a){switch(c){case 1:switch(b){case 8:return new Uint8Array(a);case 16:return new Uint16Array(a);case 32:return new Uint32Array(a)}break;case 2:switch(b){case 8:return new Int8Array(a);case 16:return new Int16Array(a);case 32:return new Int32Array(a)}break;case 3:switch(b){case 32:return new Float32Array(a);
case 64:return new Float64Array(a)}}throw Error("Unsupported data format/bitsPerSample");};Zf.prototype={getFileDirectory:function(){return this.fileDirectory},getGeoKeys:function(){return this.geoKeys},getWidth:function(){return this.fileDirectory.ImageWidth},getHeight:function(){return this.fileDirectory.ImageLength},getSamplesPerPixel:function(){return this.fileDirectory.SamplesPerPixel},getTileWidth:function(){return this.isTiled?this.fileDirectory.TileWidth:this.getWidth()},getTileHeight:function(){return this.isTiled?
this.fileDirectory.TileLength:this.fileDirectory.RowsPerStrip},getBytesPerPixel:function(){for(var c=0,b=0;b<this.fileDirectory.BitsPerSample.length;++b){var a=this.fileDirectory.BitsPerSample[b];if(0!==a%8)throw Error("Sample bit-width of "+a+" is not supported.");if(a!==this.fileDirectory.BitsPerSample[0])throw Error("Differing size of samples in a pixel are not supported.");c+=a}return c/8},getSampleByteSize:function(c){if(c>=this.fileDirectory.BitsPerSample.length)throw new RangeError("Sample index "+
c+" is out of range.");c=this.fileDirectory.BitsPerSample[c];if(0!==c%8)throw Error("Sample bit-width of "+c+" is not supported.");return c/8},getReaderForSample:function(c){var b=this.fileDirectory.BitsPerSample[c];switch(this.fileDirectory.SampleFormat?this.fileDirectory.SampleFormat[c]:1){case 1:switch(b){case 8:return DataView.prototype.getUint8;case 16:return DataView.prototype.getUint16;case 32:return DataView.prototype.getUint32}break;case 2:switch(b){case 8:return DataView.prototype.getInt8;
case 16:return DataView.prototype.getInt16;case 32:return DataView.prototype.getInt32}break;case 3:switch(b){case 32:return DataView.prototype.getFloat32;case 64:return DataView.prototype.getFloat64}}},getArrayForSample:function(c,b){return Bh(this.fileDirectory.SampleFormat?this.fileDirectory.SampleFormat[c]:1,this.fileDirectory.BitsPerSample[c],b)},getDecoder:function(){return this.decoder},getTileOrStrip:function(c,b,a,d){var g=Math.ceil(this.getWidth()/this.getTileWidth()),e=Math.ceil(this.getHeight()/
this.getTileHeight()),f,k=this.tiles;1===this.planarConfiguration?f=b*g+c:2===this.planarConfiguration&&(f=a*g*e+b*g+c);if(null!==k&&f in k)return d?d(null,{x:c,y:b,sample:a,data:k[f]}):k[f];this.isTiled?(g=this.fileDirectory.TileOffsets[f],e=this.fileDirectory.TileByteCounts[f]):(g=this.fileDirectory.StripOffsets[f],e=this.fileDirectory.StripByteCounts[f]);g=this.dataView.buffer.slice(g,g+e);if(d)return this.getDecoder().decodeBlockAsync(g,function(e,g){e||null===k||(k[f]=g);d(e,{x:c,y:b,sample:a,
data:g})});g=this.getDecoder().decodeBlock(g);null!==k&&(k[f]=g);return g},_readRasterAsync:function(c,b,a,d,g,e){function f(){I&&0===G&&(K?e(K):g(a))}function k(e,g){if(e)K=e;else{e=new DataView(g.data);var k=g.y*m,n=g.x*l,r=(g.y+1)*m,q=(g.x+1)*l;g=g.sample;for(var v=Math.max(0,c[1]-k);v<Math.min(m,m-(r-c[3]));++v)for(var A=Math.max(0,c[0]-n);A<Math.min(l,l-(q-c[2]));++A){var F=w[g].call(e,(v*l+A)*p+D[g],u),I;d?(1!==x&&0<A&&(I=(v+k-c[1])*t*b.length+(A+n-c[0]-1)*b.length+g,F+=a[I]),I=(v+k-c[1])*t*
b.length+(A+n-c[0])*b.length+g,a[I]=F):(1!==x&&0<A&&(I=(v+k-c[1])*t+A-1+n-c[0],F+=a[g][I]),I=(v+k-c[1])*t+A+n-c[0],a[g][I]=F)}}--G;f()}var l=this.getTileWidth(),m=this.getTileHeight(),n=Math.floor(c[0]/l),r=Math.ceil(c[2]/l),v=Math.floor(c[1]/m),q=Math.ceil(c[3]/m);this.getWidth();var t=c[2]-c[0],p=this.getBytesPerPixel();this.getWidth();for(var x=this.fileDirectory.Predictor||1,D=[],w=[],A=0;A<b.length;++A)1===this.planarConfiguration?D.push(Ah(this.fileDirectory.BitsPerSample,0,b[A])/8):D.push(0),
w.push(this.getReaderForSample(b[A]));for(var I=!1,G=0,u=this.littleEndian,K=null;v<=q;++v)for(A=n;A<=r;++A)for(var y=0;y<b.length;++y){var L=b[y];2===this.planarConfiguration&&(p=this.getSampleByteSize(L));G+=1;this.getTileOrStrip(A,v,L,k)}I=!0;f()},_readRaster:function(c,b,a,d,g,e){try{var f=this.getTileWidth(),k=this.getTileHeight(),l=Math.floor(c[0]/f),m=Math.ceil(c[2]/f),n=Math.floor(c[1]/k),r=Math.ceil(c[3]/k);this.getWidth();var v=c[2]-c[0],q=this.getBytesPerPixel();this.getWidth();for(var t=
this.fileDirectory.Predictor||1,p=[],x=[],D=0;D<b.length;++D)1===this.planarConfiguration?p.push(Ah(this.fileDirectory.BitsPerSample,0,b[D])/8):p.push(0),x.push(this.getReaderForSample(b[D]));for(;n<r;++n)for(D=l;D<m;++D)for(var w=n*k,A=D*f,I=(n+1)*k,G=(D+1)*f,u=0;u<b.length;++u){var K=b[u];2===this.planarConfiguration&&(q=this.getSampleByteSize(K));var y=new DataView(this.getTileOrStrip(D,n,K)),L=x[u],B=Math.min(k,k-(I-c[3])),J=Math.min(f,f-(G-c[2])),E=(B*f+J)*q,Y=(new Uint8Array(y.buffer)).length;
2*Y!==E&&this._debugMessages&&console.warn("dimension mismatch",Y,E);for(var z=Math.max(0,c[1]-w);z<B;++z)for(var C=Math.max(0,c[0]-A);C<J;++C){var E=(z*f+C)*q,H=0;E<Y-1&&(H=L.call(y,E+p[u],this.littleEndian));var N;d?(1!==t&&0<C&&(N=(z+w-c[1])*v*b.length+(C+A-c[0]-1)*b.length+u,H+=a[N]),N=(z+w-c[1])*v*b.length+(C+A-c[0])*b.length+u,a[N]=H):(1!==t&&0<C&&(N=(z+w-c[1])*v+C-1+A-c[0],H+=a[u][N]),N=(z+w-c[1])*v+C+A-c[0],a[u][N]=H)}}g(a);return a}catch(md){return e(md)}},readRasters:function(){var c,b,
a;switch(arguments.length){case 0:break;case 1:"function"===typeof arguments[0]?b=arguments[0]:c=arguments[0];break;case 2:"function"===typeof arguments[0]?(b=arguments[0],a=arguments[1]):(c=arguments[0],b=arguments[1]);break;case 3:c=arguments[0];b=arguments[1];a=arguments[2];break;default:throw Error("Invalid number of arguments passed.");}c=c||{};a=a||function(a){console.error(a)};var d=c.window||[0,0,this.getWidth(),this.getHeight()],g=c.samples;c=c.interleave;if(0>d[0]||0>d[1]||d[2]>this.getWidth()||
d[3]>this.getHeight())throw Error("Select window is out of image bounds.");if(d[0]>d[2]||d[1]>d[3])throw Error("Invalid subsets");var e=(d[2]-d[0])*(d[3]-d[1]),f;if(g)for(f=0;f<g.length;++f){if(g[f]>=this.fileDirectory.SamplesPerPixel)throw new RangeError("Invalid sample index '"+g[f]+"'.");}else for(g=[],f=0;f<this.fileDirectory.SamplesPerPixel;++f)g.push(f);var k;if(c)f=this.fileDirectory.SampleFormat?Math.max.apply(null,this.fileDirectory.SampleFormat):1,k=Math.max.apply(null,this.fileDirectory.BitsPerSample),
k=Bh(f,k,e*g.length);else for(k=[],f=0;f<g.length;++f)k.push(this.getArrayForSample(g[f],e));if(this.getDecoder().isAsync()){if(!b)throw Error("No callback specified for asynchronous raster reading.");return this._readRasterAsync(d,g,k,c,b,a)}return this._readRaster(d,g,k,c,b||function(){},a)},readRGB:function(){var c=null,b=null,a=null;switch(arguments.length){case 0:break;case 1:"function"===typeof arguments[0]?b=arguments[0]:c=arguments[0];break;case 2:"function"===typeof arguments[0]?(b=arguments[0],
a=arguments[1]):(c=arguments[0],b=arguments[1]);break;case 3:c=arguments[0];b=arguments[1];a=arguments[2];break;default:throw Error("Invalid number of arguments passed.");}var c=c||{},a=a||function(a){console.error(a)},d=c.window||[0,0,this.getWidth(),this.getHeight()];if(0>d[0]||0>d[1]||d[2]>this.getWidth()||d[3]>this.getHeight())throw Error("Select window is out of image bounds.");if(d[0]>d[2]||d[1]>d[3])throw Error("Invalid subsets");var g=d[2]-d[0],e=d[3]-d[1],f=this.fileDirectory.PhotometricInterpretation,
k=Math.pow(2,this.fileDirectory.BitsPerSample[0]);if(f===la.photometricInterpretations.RGB)return this.readRasters({window:c.window,interleave:!0},b,a);switch(f){case la.photometricInterpretations.WhiteIsZero:case la.photometricInterpretations.BlackIsZero:case la.photometricInterpretations.Palette:d=[0];break;case la.photometricInterpretations.CMYK:d=[0,1,2,3];break;case la.photometricInterpretations.YCbCr:case la.photometricInterpretations.CIELab:d=[0,1,2];break;default:throw Error("Invalid or unsupported photometric interpretation.");
}var l=this.fileDirectory;return this.readRasters({window:c.window,interleave:!0,samples:d},function(a){switch(f){case la.photometricInterpretations.WhiteIsZero:return b(hc.fromWhiteIsZero(a,k,g,e));case la.photometricInterpretations.BlackIsZero:return b(hc.fromBlackIsZero(a,k,g,e));case la.photometricInterpretations.Palette:return b(hc.fromPalette(a,l.ColorMap,g,e));case la.photometricInterpretations.CMYK:return b(hc.fromCMYK(a,g,e));case la.photometricInterpretations.YCbCr:return b(hc.fromYCbCr(a,
g,e));case la.photometricInterpretations.CIELab:return b(hc.fromCIELab(a,g,e))}},a)},getTiePoints:function(){if(!this.fileDirectory.ModelTiepoint)return[];for(var c=[],b=0;b<this.fileDirectory.ModelTiepoint.length;b+=6)c.push({i:this.fileDirectory.ModelTiepoint[b],j:this.fileDirectory.ModelTiepoint[b+1],k:this.fileDirectory.ModelTiepoint[b+2],x:this.fileDirectory.ModelTiepoint[b+3],y:this.fileDirectory.ModelTiepoint[b+4],z:this.fileDirectory.ModelTiepoint[b+5]});return c},getGDALMetadata:function(){var c=
{};if(!this.fileDirectory.GDAL_METADATA)return null;for(var b=this.fileDirectory.GDAL_METADATA,b=la.parseXml(b.substring(0,b.length-1)),b=b.evaluate("GDALMetadata/Item",b,null,XPathResult.UNORDERED_NODE_SNAPSHOT_TYPE,null),a=0;a<b.snapshotLength;++a){var d=b.snapshotItem(a);c[d.getAttribute("name")]=d.textContent}return c},getOrigin:function(){var c=this.fileDirectory.ModelTiepoint;if(!c||6!==c.length)throw Error("The image does not have an affine transformation.");return[c[3],c[4],c[5]]},getResolution:function(){if(!this.fileDirectory.ModelPixelScale)throw Error("The image does not have an affine transformation.");
return[this.fileDirectory.ModelPixelScale[0],this.fileDirectory.ModelPixelScale[1],this.fileDirectory.ModelPixelScale[2]]},pixelIsArea:function(){return 1===this.geoKeys.GTRasterTypeGeoKey},getBoundingBox:function(){var c=this.getOrigin(),b=this.getResolution(),a=c[0],c=c[1],d=a+b[0]*this.getWidth(),b=c+b[1]*this.getHeight();return[Math.min(a,d),Math.min(c,b),Math.max(a,d),Math.max(c,b)]}};"use strict";var Hj=function(){function c(b,a){for(var c=0;c<a.length;c++){var g=a[c];g.enumerable=g.enumerable||
!1;g.configurable=!0;"value"in g&&(g.writable=!0);Object.defineProperty(b,g.key,g)}}return function(b,a,d){a&&c(b.prototype,a);d&&c(b,d);return b}}(),Bi=function(){function c(b){if(!(this instanceof c))throw new TypeError("Cannot call a class as a function");this._dataView=new DataView(b)}Hj(c,[{key:"getUint64",value:function(b,a){var c=this.getUint32(b,a);b=this.getUint32(b+4,a);return a?c<<32|b:b<<32|c}},{key:"getInt64",value:function(b,a){var c;if(a)return c=this.getInt32(b,a),b=this.getUint32(b+
4,a),c<<32|b;c=this.getUint32(b,a);b=this.getInt32(b+4,a);return b<<32|c}},{key:"getUint8",value:function(b,a){return this._dataView.getUint8(b,a)}},{key:"getInt8",value:function(b,a){return this._dataView.getInt8(b,a)}},{key:"getUint16",value:function(b,a){return this._dataView.getUint16(b,a)}},{key:"getInt16",value:function(b,a){return this._dataView.getInt16(b,a)}},{key:"getUint32",value:function(b,a){return this._dataView.getUint32(b,a)}},{key:"getInt32",value:function(b,a){return this._dataView.getInt32(b,
a)}},{key:"getFloat32",value:function(b,a){return this._dataView.getFloat32(b,a)}},{key:"getFloat64",value:function(b,a){return this._dataView.getFloat64(b,a)}},{key:"buffer",get:function(){return this._dataView.buffer}}]);return c}();"use strict";var ba=la.fieldTypes,Ch=la.fieldTagNames,Ij=la.arrayFields,Jj=la.geoKeyNames;$f.prototype={getOffset:function(c){return this.bigTiff?this.dataView.getUint64(c,this.littleEndian):this.dataView.getUint32(c,this.littleEndian)},getFieldTypeLength:function(c){switch(c){case ba.BYTE:case ba.ASCII:case ba.SBYTE:case ba.UNDEFINED:return 1;
case ba.SHORT:case ba.SSHORT:return 2;case ba.LONG:case ba.SLONG:case ba.FLOAT:return 4;case ba.RATIONAL:case ba.SRATIONAL:case ba.DOUBLE:case ba.LONG8:case ba.SLONG8:case ba.IFD8:return 8;default:throw new RangeError("Invalid field type: "+c);}},getValues:function(c,b,a){var d,g,e=this.getFieldTypeLength(c),f;switch(c){case ba.BYTE:case ba.ASCII:case ba.UNDEFINED:d=new Uint8Array(b);g=this.dataView.getUint8;break;case ba.SBYTE:d=new Int8Array(b);g=this.dataView.getInt8;break;case ba.SHORT:d=new Uint16Array(b);
g=this.dataView.getUint16;break;case ba.SSHORT:d=new Int16Array(b);g=this.dataView.getInt16;break;case ba.LONG:d=new Uint32Array(b);g=this.dataView.getUint32;break;case ba.SLONG:d=new Int32Array(b);g=this.dataView.getInt32;break;case ba.LONG8:case ba.IFD8:d=Array(b);g=this.dataView.getUint64;break;case ba.SLONG8:d=Array(b);g=this.dataView.getInt64;break;case ba.RATIONAL:d=new Uint32Array(2*b);g=this.dataView.getUint32;break;case ba.SRATIONAL:d=new Int32Array(2*b);g=this.dataView.getInt32;break;case ba.FLOAT:d=
new Float32Array(b);g=this.dataView.getFloat32;break;case ba.DOUBLE:d=new Float64Array(b);g=this.dataView.getFloat64;break;default:throw new RangeError("Invalid field type: "+c);}if(c!==ba.RATIONAL&&c!==ba.SRATIONAL)for(f=0;f<b;++f)d[f]=g.call(this.dataView,a+f*e,this.littleEndian);else for(f=0;f<b;f+=2)d[f]=g.call(this.dataView,a+f*e,this.littleEndian),d[f+1]=g.call(this.dataView,a+(f*e+4),this.littleEndian);return c===ba.ASCII?String.fromCharCode.apply(null,d):d},getFieldValues:function(c,b,a,d){this.getFieldTypeLength(b)*
a<=(this.bigTiff?8:4)||(d=this.getOffset(d));d=this.getValues(b,a,d);return 1===a&&-1===Ij.indexOf(c)&&b!==ba.RATIONAL&&b!==ba.SRATIONAL?d[0]:d},parseGeoKeyDirectory:function(c){var b=c.GeoKeyDirectory;if(!b)return null;for(var a={},d=4;d<4*b[3];d+=4){var g=Jj[b[d]],e=b[d+1]?Ch[b[d+1]]:null,f=b[d+2],k=b[d+3];if(e){e=c[e];if("undefined"===typeof e||null===e)throw Error("Could not get value of geoKey '"+g+"'.");"string"===typeof e?e=e.substring(k,k+f-1):e.subarray&&(e=e.subarray(k,k+f-1))}else e=k;
a[g]=e}return a},parseFileDirectories:function(c){var b=c;for(c=[];0!==b;){for(var a=this.bigTiff?this.dataView.getUint64(b,this.littleEndian):this.dataView.getUint16(b,this.littleEndian),d={},b=b+(this.bigTiff?8:2),g=0;g<a;b+=this.bigTiff?20:12,++g){var e=this.dataView.getUint16(b,this.littleEndian),f=this.dataView.getUint16(b+2,this.littleEndian),k=this.bigTiff?this.dataView.getUint64(b+4,this.littleEndian):this.dataView.getUint32(b+4,this.littleEndian);d[Ch[e]]=this.getFieldValues(e,f,k,b+(this.bigTiff?
12:8))}c.push([d,this.parseGeoKeyDirectory(d)]);b=this.getOffset(b)}return c},getImage:function(c){c=this.fileDirectories[c||0];if(!c)throw new RangeError("Invalid image index");return new Zf(c[0],c[1],this.dataView,this.littleEndian,this.cache)},getImageCount:function(){return this.fileDirectories.length}};var Kj=qa(function(c){var b=function(a,b){var c,d,f,k;if("string"===typeof a||a instanceof String)for(c=new ArrayBuffer(2*a.length),k=new Uint16Array(c),d=0,f=a.length;d<f;++d)k[d]=a.charCodeAt(d);
else if(a instanceof ArrayBuffer)c=a;else throw Error("Invalid input data given.");return new $f(c,b)};c.exports.parse=b;"undefined"!==typeof window&&(window.GeoTIFF={parse:b})}),Dh=function(c){function b(){N(this,b);var a=P(this,(b.__proto__||Object.getPrototypeOf(b)).call(this));a.addInputValidator(0,ArrayBuffer);return a}M(b,c);O(b,[{key:"_run",value:function(){var a=this._getInput(0);if(a){var b=!1;try{var c=Kj.parse(a).getImage(),e=c.readRasters({interleave:!0}),f=c.getWidth(),k=c.getHeight(),
l=c.getSamplesPerPixel();l==e.length/(f*k)&&(b=!0);b?this._addOutput(S).setData(e,f,k,l):console.warn("Tiff support is experimental and this file is not compatible.")}catch(m){console.warn("This buffer is not from a TIFF file.")}}else console.warn('TiffDecoder requires an ArrayBuffer as input "0". Unable to continue.')}}]);return b}(V),Lj=function(){function c(){N(this,c);this._rawData=null}O(c,[{key:"setRawData",value:function(b){this._rawData=b}},{key:"parse",value:function(){var b=null;try{b=this._parseNoException()}catch(a){console.warn("This file is not compatible.")}return b}},
{key:"_parseNoException",value:function(){if(!this._rawData)return console.warn("The input buffer is null. Nothing to be parsed here."),null;var b=this._rawData,a=new DataView(b),c,g,e,f,k,l,m;a.getUint16(0,!0);c=a.getUint8(2);c=new Uint8Array(b,3,c);c=String.fromCharCode.apply(String,c);g=a.getUint16(83,!0);e=a.getUint16(85,!0);f=a.getUint16(87,!0);k=a.getUint16(89,!0);l=a.getUint16(91,!0);m=a.getUint16(93,!0);for(var n=g*e*f*k,r=n*m,v=new Float32Array(n),q=0;q<n;q++)v[q]=a.getFloat32(95+q*m,!0);
l=95+r+l;m=a.getUint8(l);m=new Uint8Array(b,l+1,m);String.fromCharCode.apply(String,m);m=l+9;l=Array(8);for(q=0;8>q;q++)n={total:a.getUint16(m+6*q+4,!0),labels:null},l[q]=n;l[0].description="list of labels for measure dimension";l[1].description="list of labels for duration dimension";l[2].description="list of labels for first space dimension";l[3].description="list of labels for second space dimension";l[4].description="list of scales";l[5].description="list of units";l[6].description="list of transformations";
l[7].description="list of contexts";m+=48;for(q=0;q<l.length-2;q++){r=l[q].total;l[q].labels=r?Array(r).fill(""):0;for(var t=0;t<r;t++){if(n=a.getUint8(m)){var p=new Uint8Array(b,m+1,n),p=String.fromCharCode.apply(String,bj(p));l[q].labels[t]=p.replace("\u00e6","\u00b5").replace("\u00fd","\u00b2")}m+=n+1}}q=a.getUint8(m);l[6].labels=q;m+=l[6].total*(q+1);q=l[l.length-1];q.contextsByteLength=Array(q.total);q.types=Array(q.total);q.values=Array(q.total);t=/[a-zA-Z ]*\:{1}([a-zA-Z]*)[\[]?\d*[\]]?/;q.labels=
Array(q.total).fill("");for(r=0;r<q.total;r++)n=a.getUint8(m),p=new Uint8Array(b,m+1,n),p=String.fromCharCode.apply(String,p),q.labels[r]=p.split(":")[0],q.contextsByteLength[r]=a.getUint16(m+n+1,!0),p=t.exec(p),q.types[r]=p?p[1].toLowerCase():null,m+=n+3;for(r=0;r<q.total;r++){n=null;if("single"===q.types[r])n=a.getFloat32(m,!0);else if("boolean"===q.types[r])for(n=Array(q.contextsByteLength[r]),p=0;p<n.length;p++)n[p]=!!a.getUint8(m+p);else"string"===q.types[r]&&(n=a.getUint8(m),p=new Uint8Array(b,
m+1,n),n=String.fromCharCode.apply(String,p));m+=q.contextsByteLength[r];q.values[r]=n}for(q=0;q<l.length;q++)delete l[q].total;delete l[7].contextsByteLength;delete l[7].types;return{metadata:{comment:c,sizes:{measure:g,duration:e,firstSpace:f,secondSpace:k},informationList:l},data:v}}}]);return c}();(function(){function c(){var b=0<arguments.length&&void 0!==arguments[0]?arguments[0]:null;N(this,c);this._typeCode=this._qeegModObj=null;this._typeCodeMap={"Z Electrical Tomography for Cortex and Basal Ganglia":"ZETCBG",
"Z Electrical Tomography for Cortex":"ZETC","Z Cross Spectrum":"ZCROSS","Z Broad Band":"ZBBSP",Phase:"PHA","Electrical Tomography for Cortex and Basal Ganglia":"ETCBG","Electrical Tomography for Cortex":"ETC","Cross Spectrum":"CROSS",Correlation:"COR",Coherence:"COH","Broad Band":"BBSP"};this.setQeegModObj(b)}O(c,[{key:"_defineTypeCode",value:function(){var b=this.getType();b in this._typeCodeMap&&(this._typeCode=this._typeCodeMap[b])}},{key:"setQeegModObj",value:function(){var b=0<arguments.length&&
void 0!==arguments[0]?arguments[0]:null;b&&(this._qeegModObj=b,this._defineTypeCode())}},{key:"getType",value:function(){return this._qeegModObj.metadata.comment}},{key:"getTypeCode",value:function(){return this._typeCode}},{key:"getMeasureNames",value:function(){return this._qeegModObj.metadata.informationList[0].labels}},{key:"getDurationsLabels",value:function(){return this._qeegModObj.metadata.informationList[1].labels}},{key:"getFirstSpaceNames",value:function(){return this._qeegModObj.metadata.informationList[2].labels}},
{key:"getSecondSpaceNames",value:function(){return this._qeegModObj.metadata.informationList[3].labels}},{key:"getUnitsLabels",value:function(){return this._qeegModObj.metadata.informationList[5].labels}},{key:"getMeasureSize",value:function(){return this._qeegModObj.metadata.sizes.measure}},{key:"getDurationSize",value:function(){return this._qeegModObj.metadata.sizes.duration}},{key:"getFirstSpaceSize",value:function(){return this._qeegModObj.metadata.sizes.firstSpace}},{key:"getSecondSpaceSize",
value:function(){return this._qeegModObj.metadata.sizes.secondSpace}},{key:"getDimensionSizes",value:function(){return[this._qeegModObj.metadata.sizes.measure,this._qeegModObj.metadata.sizes.duration,this._qeegModObj.metadata.sizes.firstSpace,this._qeegModObj.metadata.sizes.secondSpace]}},{key:"getNumberOfDimensionsUsed",value:function(){for(var b=this.getDimensionSizes(),a=b.length-1;0<=a;a--)if(1<b[a])return a+1;return 0}},{key:"getTranformation",value:function(){return this._qeegModObj.metadata.informationList[6].labels}},
{key:"getContext",value:function(b){return 0>b||b>=this._qeegModObj.metadata.informationList[7].labels.length?(console.warn("The context index is out of range"),null):{label:this._qeegModObj.metadata.informationList[7].labels[b],value:this._qeegModObj.metadata.informationList[7].values[b]}}},{key:"getAllContexts",value:function(){var b=this._qeegModObj.metadata.informationList[7];if(b.labels.length!=b.values.length)return console.warn("The contexts is corrupted. Inequal amount of values/labels."),
null;for(var a=[],c=0;c<b.labels.length;c++)a.push({label:b.labels[c],value:b.values[c]});return a}},{key:"getStartFrequency",value:function(){return"COR"===this._typeCode?-1:this._qeegModObj.metadata.informationList[7].values[0]}},{key:"getFrequencyResolution",value:function(){return"COR"===this._typeCode?-1:this._qeegModObj.metadata.informationList[7].values[1]}},{key:"getScaleFactor",value:function(){var b=2;"COR"===this._typeCode&&(b-=2);return this._qeegModObj.metadata.informationList[7].values[b]}},
{key:"getScaleIfScaleMeasures",value:function(){var b=3;"COR"===this._typeCode&&(b-=2);return this._qeegModObj.metadata.informationList[7].values[b]}},{key:"getMeasureName",value:function(){var b=4;"COR"===this._typeCode&&(b-=2);return this._qeegModObj.metadata.informationList[7].values[b]}},{key:"getDurationName",value:function(){var b=5;"COR"===this._typeCode&&(b-=2);return this._qeegModObj.metadata.informationList[7].values[b]}},{key:"getFirstSpaceName",value:function(){var b=6;"COR"===this._typeCode&&
(b-=2);return this._qeegModObj.metadata.informationList[7].values[b]}},{key:"getSecondSpaceName",value:function(){var b=7;"COR"===this._typeCode&&(b-=2);return this._qeegModObj.metadata.informationList[7].values[b]}},{key:"getAllDimensionsNames",value:function(){return[this.getMeasureName(),this.getDurationName(),this.getFirstSpaceName(),this.getSecondSpaceName()]}},{key:"getValue",value:function(b,a,c,g){var d=this._qeegModObj.metadata.sizes;if(0>b||b>=d.measure)return console.warn("measureIndex is out of range."),
null;if(0>a||a>=d.duration)return console.warn("durationIndex is out of range."),null;if(0>c||c>=d.firstSpace)return console.warn("firstSpaceIndex is out of range."),null;if(0>g||g>=d.secondSpace)return console.warn("secondSpaceIndex is out of range."),null;b=this._getOffset(b,a,c,g);return this._qeegModObj.data[b]}},{key:"getSpectrum",value:function(){var b=0<arguments.length&&void 0!==arguments[0]?arguments[0]:-1,a=1<arguments.length&&void 0!==arguments[1]?arguments[1]:-1,c=2<arguments.length&&
void 0!==arguments[2]?arguments[2]:-1,g=this._qeegModObj.metadata.sizes,e=this._qeegModObj.data;return-1==b&&-1==a&&-1==c?e.slice():0<=b&&b<g.measure&&-1==a&&-1==c?(g=this._getOffset(b,0,0,0),b=this._getOffset(b+1,0,0,0),e.slice(g,b)):0<=b&&b<g.measure&&0<=a&&a<g.duration&&-1==c?(g=this._getOffset(b,a,0,0),b=this._getOffset(b,a+1,0,0),e.slice(g,b)):0<=b&&b<g.measure&&0<=a&&a<g.duration&&0<=c&&c<g.firstSpace?(g=this._getOffset(b,a,c,0),b=this._getOffset(b,a,c+1,0),e.slice(g,b)):null}},{key:"getSpectrumByLabels",
value:function(){var b=0<arguments.length&&void 0!==arguments[0]?arguments[0]:null,a=1<arguments.length&&void 0!==arguments[1]?arguments[1]:null,c=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null,g=this._qeegModObj.metadata.informationList,e=g[0].labels.indexOf(b),f=g[1].labels.indexOf(a),g=g[2].labels.indexOf(c);return b&&-1==e?(console.warn("The measure label "+b+" could not be found."),null):a&&-1==f?(console.warn("The duration label "+a+" could not be found."),null):c&&-1==g?(console.warn("The first-space label "+
c+" could not be found."),null):this.getSpectrum(e,f,g)}},{key:"getSpectrumLabelsByLabels",value:function(){var b=0<arguments.length&&void 0!==arguments[0]?arguments[0]:null,a=1<arguments.length&&void 0!==arguments[1]?arguments[1]:null,c=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null,g=this._qeegModObj.metadata.informationList,e=g[0].labels.indexOf(b),f=g[1].labels.indexOf(a),g=g[2].labels.indexOf(c);return b&&-1==e?(console.warn("The measure label "+b+" could not be found."),null):a&&
-1==f?(console.warn("The duration label "+a+" could not be found."),null):c&&-1==g?(console.warn("The first-space label "+c+" could not be found."),null):this.getSpectrumLabels(e,f,g)}},{key:"getSpectrumLabels",value:function(){var b=0<arguments.length&&void 0!==arguments[0]?arguments[0]:-1,a=1<arguments.length&&void 0!==arguments[1]?arguments[1]:-1,c=2<arguments.length&&void 0!==arguments[2]?arguments[2]:-1,g=this._qeegModObj.metadata.sizes,e=this._qeegModObj.metadata.informationList,f=[];return-1==
b&&-1==a&&-1==c?(e[0].labels&&f.push(e[0].labels.slice()),e[1].labels&&f.push(e[1].labels.slice()),e[2].labels&&f.push(e[2].labels.slice()),e[3].labels&&f.push(e[3].labels.slice()),f):0<=b&&b<g.measure&&-1==a&&-1==c?(this._getOffset(b,0,0,0),this._getOffset(b+1,0,0,0),e[0].labels&&e[0].labels.length>b&&f.push(e[0].labels[b]),e[1].labels&&f.push(e[1].labels.slice()),e[2].labels&&f.push(e[2].labels.slice()),e[3].labels&&f.push(e[3].labels.slice()),f):0<=b&&b<g.measure&&0<=a&&a<g.duration&&-1==c?(this._getOffset(b,
a,0,0),this._getOffset(b,a+1,0,0),e[0].labels&&e[0].labels.length>b&&f.push(e[0].labels[b]),e[1].labels&&e[1].labels.length>a&&f.push(e[1].labels[a]),e[2].labels&&f.push(e[2].labels.slice()),e[3].labels&&f.push(e[3].labels.slice()),f):0<=b&&b<g.measure&&0<=a&&a<g.duration&&0<=c&&c<g.firstSpace?(this._getOffset(b,a,c,0),this._getOffset(b,a,c+1,0),e[0].labels&&e[0].labels.length>b&&f.push(e[0].labels[b]),e[1].labels&&e[1].labels.length>a&&f.push(e[1].labels[a]),e[2].labels&&e[2].labels.length>c&&f.push(e[2].labels[c]),
e[3].labels&&f.push(e[3].labels.slice()),f):null}},{key:"_getOffset",value:function(b,a,c,g){var d=this._qeegModObj.metadata.sizes;return(b*d.duration*d.firstSpace+a*d.firstSpace+c)*d.secondSpace+g}}]);return c})();var Mj=function(c){function b(){N(this,b);var a=P(this,(b.__proto__||Object.getPrototypeOf(b)).call(this));a.addInputValidator(0,ArrayBuffer);a.setMetadata("debug",!1);a._view=null;return a}M(b,c);O(b,[{key:"_run",value:function(){var a=this._getInput(0);if(a){var b=new Lj;b.setRawData(a);
(a=b.parse())&&(this._output[0]=a)}else console.warn('EegModDecoder requires an ArrayBuffer as input "0". Unable to continue.')}}]);return b}(V),Nj="undefined"!==typeof window?window:"undefined"!==typeof Ma?Ma:"undefined"!==typeof self?self:{},U=ag(function(c,b){c="undefined"!==typeof Uint8Array&&"undefined"!==typeof Uint16Array&&"undefined"!==typeof Int32Array;b.assign=function(a){for(var b=Array.prototype.slice.call(arguments,1);b.length;){var c=b.shift();if(c){if("object"!==("undefined"===typeof c?
"undefined":H(c)))throw new TypeError(c+"must be non-object");for(var d in c)Object.prototype.hasOwnProperty.call(c,d)&&(a[d]=c[d])}}return a};b.shrinkBuf=function(a,b){if(a.length===b)return a;if(a.subarray)return a.subarray(0,b);a.length=b;return a};var a={arraySet:function(a,b,c,d,l){if(b.subarray&&a.subarray)a.set(b.subarray(c,c+d),l);else for(var e=0;e<d;e++)a[l+e]=b[c+e]},flattenChunks:function(a){var b,c,d,g,m;b=d=0;for(c=a.length;b<c;b++)d+=a[b].length;m=new Uint8Array(d);b=d=0;for(c=a.length;b<
c;b++)g=a[b],m.set(g,d),d+=g.length;return m}},d={arraySet:function(a,b,c,d,l){for(var e=0;e<d;e++)a[l+e]=b[c+e]},flattenChunks:function(a){return[].concat.apply([],a)}};b.setTyped=function(c){c?(b.Buf8=Uint8Array,b.Buf16=Uint16Array,b.Buf32=Int32Array,b.assign(b,a)):(b.Buf8=Array,b.Buf16=Array,b.Buf32=Array,b.assign(b,d))};b.setTyped(c)});"use strict";var ae=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],fd=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],Oj=[0,
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],Eh=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],gb=Array(576);Yb(gb);var Nc=Array(60);Yb(Nc);var Eb=Array(512);Yb(Eb);var Bc=Array(256);Yb(Bc);var be=Array(29);Yb(be);var gd=Array(30);Yb(gd);var Fh,Gh,Hh,Ih=!1,Ha={_tr_init:function(c){if(!Ih){var b,a,d,g=Array(16);for(d=a=0;28>d;d++)for(be[d]=a,b=0;b<1<<ae[d];b++)Bc[a++]=d;Bc[a-1]=d;for(d=a=0;16>d;d++)for(gd[d]=a,b=0;b<1<<fd[d];b++)Eb[a++]=d;for(a>>=7;30>d;d++)for(gd[d]=a<<7,b=0;b<1<<fd[d]-7;b++)Eb[256+a++]=
d;for(b=0;15>=b;b++)g[b]=0;for(b=0;143>=b;)gb[2*b+1]=8,b++,g[8]++;for(;255>=b;)gb[2*b+1]=9,b++,g[9]++;for(;279>=b;)gb[2*b+1]=7,b++,g[7]++;for(;287>=b;)gb[2*b+1]=8,b++,g[8]++;cg(gb,287,g);for(b=0;30>b;b++)Nc[2*b+1]=5,Nc[2*b]=bg(b,5);Fh=new Yd(gb,ae,257,286,15);Gh=new Yd(Nc,fd,0,30,15);Hh=new Yd([],Oj,0,19,7);Ih=!0}c.l_desc=new Zd(c.dyn_ltree,Fh);c.d_desc=new Zd(c.dyn_dtree,Gh);c.bl_desc=new Zd(c.bl_tree,Hh);c.bi_buf=0;c.bi_valid=0;dg(c)},_tr_stored_block:jg,_tr_flush_block:function(c,b,a,d){var g,
e,f=0;if(0<c.level){2===c.strm.data_type&&(c.strm.data_type=Ci(c));ce(c,c.l_desc);ce(c,c.d_desc);hg(c,c.dyn_ltree,c.l_desc.max_code);hg(c,c.dyn_dtree,c.d_desc.max_code);ce(c,c.bl_desc);for(f=18;3<=f&&0===c.bl_tree[2*Eh[f]+1];f--);c.opt_len+=3*(f+1)+14;g=c.opt_len+3+7>>>3;e=c.static_len+3+7>>>3;e<=g&&(g=e)}else g=e=a+5;if(a+4<=g&&-1!==b)jg(c,b,a,d);else if(4===c.strategy||e===g)xa(c,2+(d?1:0),3),gg(c,gb,Nc);else{xa(c,4+(d?1:0),3);b=c.l_desc.max_code+1;a=c.d_desc.max_code+1;f+=1;xa(c,b-257,5);xa(c,
a-1,5);xa(c,f-4,4);for(g=0;g<f;g++)xa(c,c.bl_tree[2*Eh[g]+1],3);ig(c,c.dyn_ltree,b-1);ig(c,c.dyn_dtree,a-1);gg(c,c.dyn_ltree,c.dyn_dtree)}dg(c);d&&eg(c)},_tr_tally:function(c,b,a){c.pending_buf[c.d_buf+2*c.last_lit]=b>>>8&255;c.pending_buf[c.d_buf+2*c.last_lit+1]=b&255;c.pending_buf[c.l_buf+c.last_lit]=a&255;c.last_lit++;0===b?c.dyn_ltree[2*a]++:(c.matches++,b--,c.dyn_ltree[2*(Bc[a]+256+1)]++,c.dyn_dtree[2*(256>b?Eb[b]:Eb[256+(b>>>7)])]++);return c.last_lit===c.lit_bufsize-1},_tr_align:function(c){xa(c,
2,3);Ta(c,256,gb);16===c.bi_valid?(Ac(c,c.bi_buf),c.bi_buf=0,c.bi_valid=0):8<=c.bi_valid&&(c.pending_buf[c.pending++]=c.bi_buf&255,c.bi_buf>>=8,c.bi_valid-=8)}};"use strict";var Dc=function(c,b,a,d){var g=c&65535|0;c=c>>>16&65535|0;for(var e;0!==a;){e=2E3<a?2E3:a;a-=e;do g=g+b[d++]|0,c=c+g|0;while(--e);g%=65521;c%=65521}return g|c<<16|0};"use strict";var Pj=function(){for(var c,b=[],a=0;256>a;a++){c=a;for(var d=0;8>d;d++)c=c&1?3988292384^c>>>1:c>>>1;b[a]=c}return b}(),oa=function(c,b,a,d){a=d+a;for(c^=
-1;d<a;d++)c=c>>>8^Pj[(c^b[d])&255];return c^-1};"use strict";var Zb={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"};"use strict";var ac;ac=[new Ua(0,0,0,0,function(c,b){var a=65535;for(a>c.pending_buf_size-5&&(a=c.pending_buf_size-5);;){if(1>=c.lookahead){Fb(c);if(0===c.lookahead&&0===b)return 1;if(0===c.lookahead)break}c.strstart+=c.lookahead;c.lookahead=0;var d=c.block_start+
a;if(0===c.strstart||c.strstart>=d)if(c.lookahead=c.strstart-d,c.strstart=d,pa(c,!1),0===c.strm.avail_out)return 1;if(c.strstart-c.block_start>=c.w_size-262&&(pa(c,!1),0===c.strm.avail_out))return 1}c.insert=0;if(4===b)return pa(c,!0),0===c.strm.avail_out?3:4;c.strstart>c.block_start&&pa(c,!1);return 1}),new Ua(4,4,8,4,de),new Ua(4,5,16,8,de),new Ua(4,6,32,32,de),new Ua(4,4,16,16,$b),new Ua(8,16,32,32,$b),new Ua(8,16,128,128,$b),new Ua(8,32,128,256,$b),new Ua(32,128,258,1024,$b),new Ua(32,258,258,
4096,$b)];var Ec={deflateInit:function(c,b){return ng(c,b,8,15,8,0)},deflateInit2:ng,deflateReset:mg,deflateResetKeep:lg,deflateSetHeader:function(c,b){if(!c||!c.state||2!==c.state.wrap)return-2;c.state.gzhead=b;return 0},deflate:function(c,b){var a,d,g,e;if(!c||!c.state||5<b||0>b)return c?ob(c,-2):-2;d=c.state;if(!c.output||!c.input&&0!==c.avail_in||666===d.status&&4!==b)return ob(c,0===c.avail_out?-5:-2);d.strm=c;a=d.last_flush;d.last_flush=b;42===d.status&&(2===d.wrap?(c.adler=0,ca(d,31),ca(d,
139),ca(d,8),d.gzhead?(ca(d,(d.gzhead.text?1:0)+(d.gzhead.hcrc?2:0)+(d.gzhead.extra?4:0)+(d.gzhead.name?8:0)+(d.gzhead.comment?16:0)),ca(d,d.gzhead.time&255),ca(d,d.gzhead.time>>8&255),ca(d,d.gzhead.time>>16&255),ca(d,d.gzhead.time>>24&255),ca(d,9===d.level?2:2<=d.strategy||2>d.level?4:0),ca(d,d.gzhead.os&255),d.gzhead.extra&&d.gzhead.extra.length&&(ca(d,d.gzhead.extra.length&255),ca(d,d.gzhead.extra.length>>8&255)),d.gzhead.hcrc&&(c.adler=oa(c.adler,d.pending_buf,d.pending,0)),d.gzindex=0,d.status=
69):(ca(d,0),ca(d,0),ca(d,0),ca(d,0),ca(d,0),ca(d,9===d.level?2:2<=d.strategy||2>d.level?4:0),ca(d,3),d.status=113)):(g=8+(d.w_bits-8<<4)<<8,g|=(2<=d.strategy||2>d.level?0:6>d.level?1:6===d.level?2:3)<<6,0!==d.strstart&&(g|=32),d.status=113,Cc(d,g+(31-g%31)),0!==d.strstart&&(Cc(d,c.adler>>>16),Cc(d,c.adler&65535)),c.adler=1));if(69===d.status)if(d.gzhead.extra){for(g=d.pending;d.gzindex<(d.gzhead.extra.length&65535)&&(d.pending!==d.pending_buf_size||(d.gzhead.hcrc&&d.pending>g&&(c.adler=oa(c.adler,
d.pending_buf,d.pending-g,g)),qb(c),g=d.pending,d.pending!==d.pending_buf_size));)ca(d,d.gzhead.extra[d.gzindex]&255),d.gzindex++;d.gzhead.hcrc&&d.pending>g&&(c.adler=oa(c.adler,d.pending_buf,d.pending-g,g));d.gzindex===d.gzhead.extra.length&&(d.gzindex=0,d.status=73)}else d.status=73;if(73===d.status)if(d.gzhead.name){g=d.pending;do{if(d.pending===d.pending_buf_size&&(d.gzhead.hcrc&&d.pending>g&&(c.adler=oa(c.adler,d.pending_buf,d.pending-g,g)),qb(c),g=d.pending,d.pending===d.pending_buf_size)){e=
1;break}e=d.gzindex<d.gzhead.name.length?d.gzhead.name.charCodeAt(d.gzindex++)&255:0;ca(d,e)}while(0!==e);d.gzhead.hcrc&&d.pending>g&&(c.adler=oa(c.adler,d.pending_buf,d.pending-g,g));0===e&&(d.gzindex=0,d.status=91)}else d.status=91;if(91===d.status)if(d.gzhead.comment){g=d.pending;do{if(d.pending===d.pending_buf_size&&(d.gzhead.hcrc&&d.pending>g&&(c.adler=oa(c.adler,d.pending_buf,d.pending-g,g)),qb(c),g=d.pending,d.pending===d.pending_buf_size)){e=1;break}e=d.gzindex<d.gzhead.comment.length?d.gzhead.comment.charCodeAt(d.gzindex++)&
255:0;ca(d,e)}while(0!==e);d.gzhead.hcrc&&d.pending>g&&(c.adler=oa(c.adler,d.pending_buf,d.pending-g,g));0===e&&(d.status=103)}else d.status=103;103===d.status&&(d.gzhead.hcrc?(d.pending+2>d.pending_buf_size&&qb(c),d.pending+2<=d.pending_buf_size&&(ca(d,c.adler&255),ca(d,c.adler>>8&255),c.adler=0,d.status=113)):d.status=113);if(0!==d.pending){if(qb(c),0===c.avail_out)return d.last_flush=-1,0}else if(0===c.avail_in&&(b<<1)-(4<b?9:0)<=(a<<1)-(4<a?9:0)&&4!==b)return ob(c,-5);if(666===d.status&&0!==c.avail_in)return ob(c,
-5);if(0!==c.avail_in||0!==d.lookahead||0!==b&&666!==d.status){a=2===d.strategy?Ei(d,b):3===d.strategy?Di(d,b):ac[d.level].func(d,b);if(3===a||4===a)d.status=666;if(1===a||3===a)return 0===c.avail_out&&(d.last_flush=-1),0;if(2===a&&(1===b?Ha._tr_align(d):5!==b&&(Ha._tr_stored_block(d,0,0,!1),3===b&&(pb(d.head),0===d.lookahead&&(d.strstart=0,d.block_start=0,d.insert=0))),qb(c),0===c.avail_out))return d.last_flush=-1,0}if(4!==b)return 0;if(0>=d.wrap)return 1;2===d.wrap?(ca(d,c.adler&255),ca(d,c.adler>>
8&255),ca(d,c.adler>>16&255),ca(d,c.adler>>24&255),ca(d,c.total_in&255),ca(d,c.total_in>>8&255),ca(d,c.total_in>>16&255),ca(d,c.total_in>>24&255)):(Cc(d,c.adler>>>16),Cc(d,c.adler&65535));qb(c);0<d.wrap&&(d.wrap=-d.wrap);return 0!==d.pending?0:1},deflateEnd:function(c){var b;if(!c||!c.state)return-2;b=c.state.status;if(42!==b&&69!==b&&73!==b&&91!==b&&103!==b&&113!==b&&666!==b)return ob(c,-2);c.state=null;return 113===b?ob(c,-3):0},deflateSetDictionary:function(c,b){var a=b.length,d,g,e,f,k;if(!c||
!c.state)return-2;d=c.state;g=d.wrap;if(2===g||1===g&&42!==d.status||d.lookahead)return-2;1===g&&(c.adler=Dc(c.adler,b,a,0));d.wrap=0;a>=d.w_size&&(0===g&&(pb(d.head),d.strstart=0,d.block_start=0,d.insert=0),e=new U.Buf8(d.w_size),U.arraySet(e,b,a-d.w_size,d.w_size,0),b=e,a=d.w_size);e=c.avail_in;f=c.next_in;k=c.input;c.avail_in=a;c.next_in=0;c.input=b;for(Fb(d);3<=d.lookahead;){b=d.strstart;a=d.lookahead-2;do d.ins_h=(d.ins_h<<d.hash_shift^d.window[b+3-1])&d.hash_mask,d.prev[b&d.w_mask]=d.head[d.ins_h],
d.head[d.ins_h]=b,b++;while(--a);d.strstart=b;d.lookahead=2;Fb(d)}d.strstart+=d.lookahead;d.block_start=d.strstart;d.insert=d.lookahead;d.lookahead=0;d.match_length=d.prev_length=2;d.match_available=0;c.next_in=f;c.input=k;c.avail_in=e;d.wrap=g;return 0},deflateInfo:"pako deflate (from Nodeca project)"};"use strict";var qg=!0,pg=!0;try{String.fromCharCode.apply(null,[0])}catch(c){qg=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch(c){pg=!1}for(var Oc=new U.Buf8(256),vb=0;256>vb;vb++)Oc[vb]=
252<=vb?6:248<=vb?5:240<=vb?4:224<=vb?3:192<=vb?2:1;Oc[254]=Oc[254]=1;var Hb={string2buf:function(c){var b,a,d,g,e,f=c.length,k=0;for(g=0;g<f;g++)a=c.charCodeAt(g),55296===(a&64512)&&g+1<f&&(d=c.charCodeAt(g+1),56320===(d&64512)&&(a=65536+(a-55296<<10)+(d-56320),g++)),k+=128>a?1:2048>a?2:65536>a?3:4;b=new U.Buf8(k);for(g=e=0;e<k;g++)a=c.charCodeAt(g),55296===(a&64512)&&g+1<f&&(d=c.charCodeAt(g+1),56320===(d&64512)&&(a=65536+(a-55296<<10)+(d-56320),g++)),128>a?b[e++]=a:(2048>a?b[e++]=192|a>>>6:(65536>
a?b[e++]=224|a>>>12:(b[e++]=240|a>>>18,b[e++]=128|a>>>12&63),b[e++]=128|a>>>6&63),b[e++]=128|a&63);return b},buf2binstring:function(c){return og(c,c.length)},binstring2buf:function(c){for(var b=new U.Buf8(c.length),a=0,d=b.length;a<d;a++)b[a]=c.charCodeAt(a);return b},buf2string:function(c,b){var a,d,g,e=b||c.length,f=Array(2*e);for(b=a=0;b<e;)if(d=c[b++],128>d)f[a++]=d;else if(g=Oc[d],4<g)f[a++]=65533,b+=g-1;else{for(d&=2===g?31:3===g?15:7;1<g&&b<e;)d=d<<6|c[b++]&63,g--;1<g?f[a++]=65533:65536>d?
f[a++]=d:(d-=65536,f[a++]=55296|d>>10&1023,f[a++]=56320|d&1023)}return og(f,a)},utf8border:function(c,b){var a;b=b||c.length;b>c.length&&(b=c.length);for(a=b-1;0<=a&&128===(c[a]&192);)a--;return 0>a||0===a?b:a+Oc[c[a]]>b?a:b}};"use strict";var rg=function(){this.input=null;this.total_in=this.avail_in=this.next_in=0;this.output=null;this.total_out=this.avail_out=this.next_out=0;this.msg="";this.state=null;this.data_type=2;this.adler=0};"use strict";var sg=Object.prototype.toString;Gb.prototype.push=
function(c,b){var a=this.strm,d=this.options.chunkSize;if(this.ended)return!1;b=b===~~b?b:!0===b?4:0;"string"===typeof c?a.input=Hb.string2buf(c):"[object ArrayBuffer]"===sg.call(c)?a.input=new Uint8Array(c):a.input=c;a.next_in=0;a.avail_in=a.input.length;do{0===a.avail_out&&(a.output=new U.Buf8(d),a.next_out=0,a.avail_out=d);c=Ec.deflate(a,b);if(1!==c&&0!==c)return this.onEnd(c),this.ended=!0,!1;if(0===a.avail_out||0===a.avail_in&&(4===b||2===b))if("string"===this.options.to)this.onData(Hb.buf2binstring(U.shrinkBuf(a.output,
a.next_out)));else this.onData(U.shrinkBuf(a.output,a.next_out))}while((0<a.avail_in||0===a.avail_out)&&1!==c);if(4===b)return c=Ec.deflateEnd(this.strm),this.onEnd(c),this.ended=!0,0===c;2===b&&(this.onEnd(0),a.avail_out=0);return!0};Gb.prototype.onData=function(c){this.chunks.push(c)};Gb.prototype.onEnd=function(c){0===c&&(this.result="string"===this.options.to?this.chunks.join(""):U.flattenChunks(this.chunks));this.chunks=[];this.err=c;this.msg=this.strm.msg};var Qj={Deflate:Gb,deflate:ee,deflateRaw:function(c,
b){b=b||{};b.raw=!0;return ee(c,b)},gzip:function(c,b){b=b||{};b.gzip=!0;return ee(c,b)}};"use strict";"use strict";var Rj=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],Sj=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],Tj=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],Uj=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,
25,26,26,27,27,28,28,29,29,64,64],Pc=function(c,b,a,d,g,e,f,k){var l=k.bits,m,n,r,v,q,t,p,x,D,w,A,I,G,u=0,K,y=new U.Buf16(16);q=new U.Buf16(16);var L,B=0,J,E,Y;for(m=0;15>=m;m++)y[m]=0;for(n=0;n<d;n++)y[b[a+n]]++;v=l;for(r=15;1<=r&&0===y[r];r--);v>r&&(v=r);if(0===r)return g[e++]=20971520,g[e++]=20971520,k.bits=1,0;for(l=1;l<r&&0===y[l];l++);v<l&&(v=l);for(m=t=1;15>=m;m++)if(t<<=1,t-=y[m],0>t)return-1;if(0<t&&(0===c||1!==r))return-1;q[1]=0;for(m=1;15>m;m++)q[m+1]=q[m]+y[m];for(n=0;n<d;n++)0!==b[a+
n]&&(f[q[b[a+n]]++]=n);0===c?(G=L=f,K=19):1===c?(G=Rj,u-=257,L=Sj,B-=257,K=256):(G=Tj,L=Uj,K=-1);n=x=0;m=l;I=e;d=v;q=0;w=-1;p=1<<v;A=p-1;if(1===c&&852<p||2===c&&592<p)return 1;for(;;){J=m-q;f[n]<K?(E=0,Y=f[n]):f[n]>K?(E=L[B+f[n]],Y=G[u+f[n]]):(E=96,Y=0);t=1<<m-q;l=D=1<<d;do D-=t,g[I+(x>>q)+D]=J<<24|E<<16|Y|0;while(0!==D);for(t=1<<m-1;x&t;)t>>=1;0!==t?(x&=t-1,x+=t):x=0;n++;if(0===--y[m]){if(m===r)break;m=b[a+f[n]]}if(m>v&&(x&A)!==w){0===q&&(q=v);I+=l;d=m-q;for(t=1<<d;d+q<r;){t-=y[d+q];if(0>=t)break;
d++;t<<=1}p+=1<<d;if(1===c&&852<p||2===c&&592<p)return 1;w=x&A;g[w]=v<<24|d<<16|I-e|0}}0!==x&&(g[I+x]=m-q<<24|4194304);k.bits=v;return 0};"use strict";var Jh=!0,ve,we,Fc={inflateReset:vg,inflateReset2:wg,inflateResetKeep:ug,inflateInit:function(c){return xg(c,15)},inflateInit2:xg,inflate:function(c,b){var a,d,g,e,f,k,l,m,n,r,v,q,t,p,x,D,w,A,I=new U.Buf8(4),G=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!c||!c.state||!c.output||!c.input&&0!==c.avail_in)return-2;a=c.state;12===a.mode&&(a.mode=
13);f=c.next_out;g=c.output;l=c.avail_out;e=c.next_in;d=c.input;k=c.avail_in;m=a.hold;n=a.bits;r=k;v=l;A=0;a:for(;;)switch(a.mode){case 1:if(0===a.wrap){a.mode=13;break}for(;16>n;){if(0===k)break a;k--;m+=d[e++]<<n;n+=8}if(a.wrap&2&&35615===m){a.check=0;I[0]=m&255;I[1]=m>>>8&255;a.check=oa(a.check,I,2,0);n=m=0;a.mode=2;break}a.flags=0;a.head&&(a.head.done=!1);if(!(a.wrap&1)||(((m&255)<<8)+(m>>8))%31){c.msg="incorrect header check";a.mode=30;break}if(8!==(m&15)){c.msg="unknown compression method";
a.mode=30;break}m>>>=4;n-=4;t=(m&15)+8;if(0===a.wbits)a.wbits=t;else if(t>a.wbits){c.msg="invalid window size";a.mode=30;break}a.dmax=1<<t;c.adler=a.check=1;a.mode=m&512?10:12;n=m=0;break;case 2:for(;16>n;){if(0===k)break a;k--;m+=d[e++]<<n;n+=8}a.flags=m;if(8!==(a.flags&255)){c.msg="unknown compression method";a.mode=30;break}if(a.flags&57344){c.msg="unknown header flags set";a.mode=30;break}a.head&&(a.head.text=m>>8&1);a.flags&512&&(I[0]=m&255,I[1]=m>>>8&255,a.check=oa(a.check,I,2,0));n=m=0;a.mode=
3;case 3:for(;32>n;){if(0===k)break a;k--;m+=d[e++]<<n;n+=8}a.head&&(a.head.time=m);a.flags&512&&(I[0]=m&255,I[1]=m>>>8&255,I[2]=m>>>16&255,I[3]=m>>>24&255,a.check=oa(a.check,I,4,0));n=m=0;a.mode=4;case 4:for(;16>n;){if(0===k)break a;k--;m+=d[e++]<<n;n+=8}a.head&&(a.head.xflags=m&255,a.head.os=m>>8);a.flags&512&&(I[0]=m&255,I[1]=m>>>8&255,a.check=oa(a.check,I,2,0));n=m=0;a.mode=5;case 5:if(a.flags&1024){for(;16>n;){if(0===k)break a;k--;m+=d[e++]<<n;n+=8}a.length=m;a.head&&(a.head.extra_len=m);a.flags&
512&&(I[0]=m&255,I[1]=m>>>8&255,a.check=oa(a.check,I,2,0));n=m=0}else a.head&&(a.head.extra=null);a.mode=6;case 6:if(a.flags&1024&&(q=a.length,q>k&&(q=k),q&&(a.head&&(t=a.head.extra_len-a.length,a.head.extra||(a.head.extra=Array(a.head.extra_len)),U.arraySet(a.head.extra,d,e,q,t)),a.flags&512&&(a.check=oa(a.check,d,q,e)),k-=q,e+=q,a.length-=q),a.length))break a;a.length=0;a.mode=7;case 7:if(a.flags&2048){if(0===k)break a;q=0;do t=d[e+q++],a.head&&t&&65536>a.length&&(a.head.name+=String.fromCharCode(t));
while(t&&q<k);a.flags&512&&(a.check=oa(a.check,d,q,e));k-=q;e+=q;if(t)break a}else a.head&&(a.head.name=null);a.length=0;a.mode=8;case 8:if(a.flags&4096){if(0===k)break a;q=0;do t=d[e+q++],a.head&&t&&65536>a.length&&(a.head.comment+=String.fromCharCode(t));while(t&&q<k);a.flags&512&&(a.check=oa(a.check,d,q,e));k-=q;e+=q;if(t)break a}else a.head&&(a.head.comment=null);a.mode=9;case 9:if(a.flags&512){for(;16>n;){if(0===k)break a;k--;m+=d[e++]<<n;n+=8}if(m!==(a.check&65535)){c.msg="header crc mismatch";
a.mode=30;break}n=m=0}a.head&&(a.head.hcrc=a.flags>>9&1,a.head.done=!0);c.adler=a.check=0;a.mode=12;break;case 10:for(;32>n;){if(0===k)break a;k--;m+=d[e++]<<n;n+=8}c.adler=a.check=tg(m);n=m=0;a.mode=11;case 11:if(0===a.havedict)return c.next_out=f,c.avail_out=l,c.next_in=e,c.avail_in=k,a.hold=m,a.bits=n,2;c.adler=a.check=1;a.mode=12;case 12:if(5===b||6===b)break a;case 13:if(a.last){m>>>=n&7;n-=n&7;a.mode=27;break}for(;3>n;){if(0===k)break a;k--;m+=d[e++]<<n;n+=8}a.last=m&1;m>>>=1;--n;switch(m&3){case 0:a.mode=
14;break;case 1:t=a;if(Jh){ve=new U.Buf32(512);we=new U.Buf32(32);for(q=0;144>q;)t.lens[q++]=8;for(;256>q;)t.lens[q++]=9;for(;280>q;)t.lens[q++]=7;for(;288>q;)t.lens[q++]=8;Pc(1,t.lens,0,288,ve,0,t.work,{bits:9});for(q=0;32>q;)t.lens[q++]=5;Pc(2,t.lens,0,32,we,0,t.work,{bits:5});Jh=!1}t.lencode=ve;t.lenbits=9;t.distcode=we;t.distbits=5;a.mode=20;if(6===b){m>>>=2;n-=2;break a}break;case 2:a.mode=17;break;case 3:c.msg="invalid block type",a.mode=30}m>>>=2;n-=2;break;case 14:m>>>=n&7;for(n-=n&7;32>n;){if(0===
k)break a;k--;m+=d[e++]<<n;n+=8}if((m&65535)!==(m>>>16^65535)){c.msg="invalid stored block lengths";a.mode=30;break}a.length=m&65535;n=m=0;a.mode=15;if(6===b)break a;case 15:a.mode=16;case 16:if(q=a.length){q>k&&(q=k);q>l&&(q=l);if(0===q)break a;U.arraySet(g,d,e,q,f);k-=q;e+=q;l-=q;f+=q;a.length-=q;break}a.mode=12;break;case 17:for(;14>n;){if(0===k)break a;k--;m+=d[e++]<<n;n+=8}a.nlen=(m&31)+257;m>>>=5;n-=5;a.ndist=(m&31)+1;m>>>=5;n-=5;a.ncode=(m&15)+4;m>>>=4;n-=4;if(286<a.nlen||30<a.ndist){c.msg=
"too many length or distance symbols";a.mode=30;break}a.have=0;a.mode=18;case 18:for(;a.have<a.ncode;){for(;3>n;){if(0===k)break a;k--;m+=d[e++]<<n;n+=8}a.lens[G[a.have++]]=m&7;m>>>=3;n-=3}for(;19>a.have;)a.lens[G[a.have++]]=0;a.lencode=a.lendyn;a.lenbits=7;q={bits:a.lenbits};A=Pc(0,a.lens,0,19,a.lencode,0,a.work,q);a.lenbits=q.bits;if(A){c.msg="invalid code lengths set";a.mode=30;break}a.have=0;a.mode=19;case 19:for(;a.have<a.nlen+a.ndist;){for(;;){x=a.lencode[m&(1<<a.lenbits)-1];q=x>>>24;x&=65535;
if(q<=n)break;if(0===k)break a;k--;m+=d[e++]<<n;n+=8}if(16>x)m>>>=q,n-=q,a.lens[a.have++]=x;else{if(16===x){for(t=q+2;n<t;){if(0===k)break a;k--;m+=d[e++]<<n;n+=8}m>>>=q;n-=q;if(0===a.have){c.msg="invalid bit length repeat";a.mode=30;break}t=a.lens[a.have-1];q=3+(m&3);m>>>=2;n-=2}else if(17===x){for(t=q+3;n<t;){if(0===k)break a;k--;m+=d[e++]<<n;n+=8}m>>>=q;n-=q;t=0;q=3+(m&7);m>>>=3;n-=3}else{for(t=q+7;n<t;){if(0===k)break a;k--;m+=d[e++]<<n;n+=8}m>>>=q;n-=q;t=0;q=11+(m&127);m>>>=7;n-=7}if(a.have+
q>a.nlen+a.ndist){c.msg="invalid bit length repeat";a.mode=30;break}for(;q--;)a.lens[a.have++]=t}}if(30===a.mode)break;if(0===a.lens[256]){c.msg="invalid code -- missing end-of-block";a.mode=30;break}a.lenbits=9;q={bits:a.lenbits};A=Pc(1,a.lens,0,a.nlen,a.lencode,0,a.work,q);a.lenbits=q.bits;if(A){c.msg="invalid literal/lengths set";a.mode=30;break}a.distbits=6;a.distcode=a.distdyn;q={bits:a.distbits};A=Pc(2,a.lens,a.nlen,a.ndist,a.distcode,0,a.work,q);a.distbits=q.bits;if(A){c.msg="invalid distances set";
a.mode=30;break}a.mode=20;if(6===b)break a;case 20:a.mode=21;case 21:if(6<=k&&258<=l){c.next_out=f;c.avail_out=l;c.next_in=e;c.avail_in=k;a.hold=m;a.bits=n;var u,K,y,L,B,J,E,Y,z,C,H=c;C=H.state;z=H.next_in;g=H.input;Y=z+(H.avail_in-5);E=H.next_out;d=H.output;J=E-(v-H.avail_out);B=E+(H.avail_out-257);L=C.dmax;x=C.wsize;w=C.whave;D=C.wnext;p=C.window;t=C.hold;q=C.bits;n=C.lencode;m=C.distcode;l=(1<<C.lenbits)-1;k=(1<<C.distbits)-1;b:do c:for(15>q&&(t+=g[z++]<<q,q+=8,t+=g[z++]<<q,q+=8),u=n[t&l];;){f=
u>>>24;t>>>=f;q-=f;f=u>>>16&255;if(0===f)d[E++]=u&65535;else if(f&16){e=u&65535;if(f&=15)q<f&&(t+=g[z++]<<q,q+=8),e+=t&(1<<f)-1,t>>>=f,q-=f;15>q&&(t+=g[z++]<<q,q+=8,t+=g[z++]<<q,q+=8);u=m[t&k];d:for(;;){f=u>>>24;t>>>=f;q-=f;f=u>>>16&255;if(f&16){y=u&65535;f&=15;q<f&&(t+=g[z++]<<q,q+=8,q<f&&(t+=g[z++]<<q,q+=8));y+=t&(1<<f)-1;if(y>L){H.msg="invalid distance too far back";C.mode=30;break b}t>>>=f;q-=f;f=E-J;if(y>f){f=y-f;if(f>w&&C.sane){H.msg="invalid distance too far back";C.mode=30;break b}K=0;u=p;
if(0===D){if(K+=x-f,f<e){e-=f;do d[E++]=p[K++];while(--f);K=E-y;u=d}}else if(D<f){if(K+=x+D-f,f-=D,f<e){e-=f;do d[E++]=p[K++];while(--f);K=0;if(D<e){f=D;e-=f;do d[E++]=p[K++];while(--f);K=E-y;u=d}}}else if(K+=D-f,f<e){e-=f;do d[E++]=p[K++];while(--f);K=E-y;u=d}for(;2<e;)d[E++]=u[K++],d[E++]=u[K++],d[E++]=u[K++],e-=3;e&&(d[E++]=u[K++],1<e&&(d[E++]=u[K++]))}else{K=E-y;do d[E++]=d[K++],d[E++]=d[K++],d[E++]=d[K++],e-=3;while(2<e);e&&(d[E++]=d[K++],1<e&&(d[E++]=d[K++]))}}else if(0===(f&64)){u=m[(u&65535)+
(t&(1<<f)-1)];continue d}else{H.msg="invalid distance code";C.mode=30;break b}break}}else if(0===(f&64)){u=n[(u&65535)+(t&(1<<f)-1)];continue c}else{f&32?C.mode=12:(H.msg="invalid literal/length code",C.mode=30);break b}break}while(z<Y&&E<B);e=q>>3;z-=e;q-=e<<3;H.next_in=z;H.next_out=E;H.avail_in=z<Y?5+(Y-z):5-(z-Y);H.avail_out=E<B?257+(B-E):257-(E-B);C.hold=t&(1<<q)-1;C.bits=q;f=c.next_out;g=c.output;l=c.avail_out;e=c.next_in;d=c.input;k=c.avail_in;m=a.hold;n=a.bits;12===a.mode&&(a.back=-1);break}for(a.back=
0;;){x=a.lencode[m&(1<<a.lenbits)-1];q=x>>>24;t=x>>>16&255;x&=65535;if(q<=n)break;if(0===k)break a;k--;m+=d[e++]<<n;n+=8}if(t&&0===(t&240)){p=q;D=t;for(w=x;;){x=a.lencode[w+((m&(1<<p+D)-1)>>p)];q=x>>>24;t=x>>>16&255;x&=65535;if(p+q<=n)break;if(0===k)break a;k--;m+=d[e++]<<n;n+=8}m>>>=p;n-=p;a.back+=p}m>>>=q;n-=q;a.back+=q;a.length=x;if(0===t){a.mode=26;break}if(t&32){a.back=-1;a.mode=12;break}if(t&64){c.msg="invalid literal/length code";a.mode=30;break}a.extra=t&15;a.mode=22;case 22:if(a.extra){for(t=
a.extra;n<t;){if(0===k)break a;k--;m+=d[e++]<<n;n+=8}a.length+=m&(1<<a.extra)-1;m>>>=a.extra;n-=a.extra;a.back+=a.extra}a.was=a.length;a.mode=23;case 23:for(;;){x=a.distcode[m&(1<<a.distbits)-1];q=x>>>24;t=x>>>16&255;x&=65535;if(q<=n)break;if(0===k)break a;k--;m+=d[e++]<<n;n+=8}if(0===(t&240)){p=q;D=t;for(w=x;;){x=a.distcode[w+((m&(1<<p+D)-1)>>p)];q=x>>>24;t=x>>>16&255;x&=65535;if(p+q<=n)break;if(0===k)break a;k--;m+=d[e++]<<n;n+=8}m>>>=p;n-=p;a.back+=p}m>>>=q;n-=q;a.back+=q;if(t&64){c.msg="invalid distance code";
a.mode=30;break}a.offset=x;a.extra=t&15;a.mode=24;case 24:if(a.extra){for(t=a.extra;n<t;){if(0===k)break a;k--;m+=d[e++]<<n;n+=8}a.offset+=m&(1<<a.extra)-1;m>>>=a.extra;n-=a.extra;a.back+=a.extra}if(a.offset>a.dmax){c.msg="invalid distance too far back";a.mode=30;break}a.mode=25;case 25:if(0===l)break a;q=v-l;if(a.offset>q){q=a.offset-q;if(q>a.whave&&a.sane){c.msg="invalid distance too far back";a.mode=30;break}q>a.wnext?(q-=a.wnext,t=a.wsize-q):t=a.wnext-q;q>a.length&&(q=a.length);p=a.window}else p=
g,t=f-a.offset,q=a.length;q>l&&(q=l);l-=q;a.length-=q;do g[f++]=p[t++];while(--q);0===a.length&&(a.mode=21);break;case 26:if(0===l)break a;g[f++]=a.length;l--;a.mode=21;break;case 27:if(a.wrap){for(;32>n;){if(0===k)break a;k--;m|=d[e++]<<n;n+=8}v-=l;c.total_out+=v;a.total+=v;v&&(c.adler=a.check=a.flags?oa(a.check,g,v,f-v):Dc(a.check,g,v,f-v));v=l;if((a.flags?m:tg(m))!==a.check){c.msg="incorrect data check";a.mode=30;break}n=m=0}a.mode=28;case 28:if(a.wrap&&a.flags){for(;32>n;){if(0===k)break a;k--;
m+=d[e++]<<n;n+=8}if(m!==(a.total&4294967295)){c.msg="incorrect length check";a.mode=30;break}n=m=0}a.mode=29;case 29:A=1;break a;case 30:A=-3;break a;case 31:return-4;default:return-2}c.next_out=f;c.avail_out=l;c.next_in=e;c.avail_in=k;a.hold=m;a.bits=n;if((a.wsize||v!==c.avail_out&&30>a.mode&&(27>a.mode||4!==b))&&yg(c,c.output,c.next_out,v-c.avail_out))return a.mode=31,-4;r-=c.avail_in;v-=c.avail_out;c.total_in+=r;c.total_out+=v;a.total+=v;a.wrap&&v&&(c.adler=a.check=a.flags?oa(a.check,g,v,c.next_out-
v):Dc(a.check,g,v,c.next_out-v));c.data_type=a.bits+(a.last?64:0)+(12===a.mode?128:0)+(20===a.mode||15===a.mode?256:0);(0===r&&0===v||4===b)&&0===A&&(A=-5);return A},inflateEnd:function(c){if(!c||!c.state)return-2;var b=c.state;b.window&&(b.window=null);c.state=null;return 0},inflateGetHeader:function(c,b){if(!c||!c.state)return-2;c=c.state;if(0===(c.wrap&2))return-2;c.head=b;b.done=!1;return 0},inflateSetDictionary:function(c,b){var a=b.length,d,g;if(!c||!c.state)return-2;d=c.state;if(0!==d.wrap&&
11!==d.mode)return-2;if(11===d.mode&&(g=Dc(1,b,a,0),g!==d.check))return-3;if(yg(c,b,a,a))return d.mode=31,-4;d.havedict=1;return 0},inflateInfo:"pako inflate (from Nodeca project)"};"use strict";var Z={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,
Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8};"use strict";var Hi=function(){this.os=this.xflags=this.time=this.text=0;this.extra=null;this.extra_len=0;this.comment=this.name="";this.hcrc=0;this.done=!1};"use strict";var Kh=Object.prototype.toString;Ib.prototype.push=function(c,b){var a=this.strm,d=this.options.chunkSize,g=this.options.dictionary,e,f,k,l=!1;if(this.ended)return!1;b=b===~~b?b:!0===b?Z.Z_FINISH:Z.Z_NO_FLUSH;"string"===typeof c?a.input=Hb.binstring2buf(c):
"[object ArrayBuffer]"===Kh.call(c)?a.input=new Uint8Array(c):a.input=c;a.next_in=0;a.avail_in=a.input.length;do{0===a.avail_out&&(a.output=new U.Buf8(d),a.next_out=0,a.avail_out=d);c=Fc.inflate(a,Z.Z_NO_FLUSH);c===Z.Z_NEED_DICT&&g&&(c="string"===typeof g?Hb.string2buf(g):"[object ArrayBuffer]"===Kh.call(g)?new Uint8Array(g):g,c=Fc.inflateSetDictionary(this.strm,c));c===Z.Z_BUF_ERROR&&!0===l&&(c=Z.Z_OK,l=!1);if(c!==Z.Z_STREAM_END&&c!==Z.Z_OK)return this.onEnd(c),this.ended=!0,!1;if(a.next_out&&(0===
a.avail_out||c===Z.Z_STREAM_END||0===a.avail_in&&(b===Z.Z_FINISH||b===Z.Z_SYNC_FLUSH)))if("string"===this.options.to)e=Hb.utf8border(a.output,a.next_out),f=a.next_out-e,k=Hb.buf2string(a.output,e),a.next_out=f,a.avail_out=d-f,f&&U.arraySet(a.output,a.output,e,f,0),this.onData(k);else this.onData(U.shrinkBuf(a.output,a.next_out));0===a.avail_in&&0===a.avail_out&&(l=!0)}while((0<a.avail_in||0===a.avail_out)&&c!==Z.Z_STREAM_END);c===Z.Z_STREAM_END&&(b=Z.Z_FINISH);if(b===Z.Z_FINISH)return c=Fc.inflateEnd(this.strm),
this.onEnd(c),this.ended=!0,c===Z.Z_OK;b===Z.Z_SYNC_FLUSH&&(this.onEnd(Z.Z_OK),a.avail_out=0);return!0};Ib.prototype.onData=function(c){this.chunks.push(c)};Ib.prototype.onEnd=function(c){c===Z.Z_OK&&(this.result="string"===this.options.to?this.chunks.join(""):U.flattenChunks(this.chunks));this.chunks=[];this.err=c;this.msg=this.strm.msg};var Vj={Inflate:Ib,inflate:fe,inflateRaw:function(c,b){b=b||{};b.raw=!0;return fe(c,b)},ungzip:fe};"use strict";var Wj=U.assign,Qc={};Wj(Qc,Qj,Vj,Z);var td=function(c,
b){return b={exports:{}},c(b,b.exports),b.exports}(function(c){function b(a){this.value=a}function a(a,b,c){var e=[],g=[],n=!0;return function D(a){function r(){if("object"===H(F.node)&&null!==F.node){F.keys&&F.node_===F.node||(F.keys=f(F.node));F.isLeaf=0==F.keys.length;for(var b=0;b<g.length;b++)if(g[b].node_===a){F.circular=g[b];break}}else F.isLeaf=!0,F.keys=null;F.notLeaf=!F.isLeaf;F.notRoot=!F.isRoot}var q,v,t,p,w=!0,F={node:c?d(a):a,node_:a,path:[].concat(e),parent:g[g.length-1],parents:g,
key:e.slice(-1)[0],isRoot:0===e.length,level:e.length,circular:null,update:function(a,b){F.isRoot||(F.parent.node[F.key]=a);F.node=a;b&&(w=!1)},"delete":function(a){delete F.parent.node[F.key];a&&(w=!1)},remove:function(a){k(F.parent.node)?F.parent.node.splice(F.key,1):delete F.parent.node[F.key];a&&(w=!1)},keys:null,before:function(a){q=a},after:function(a){v=a},pre:function(a){t=a},post:function(a){p=a},stop:function(){n=!1},block:function(){w=!1}};if(!n)return F;r();var u=b.call(F,F.node);void 0!==
u&&F.update&&F.update(u);q&&q.call(F,F.node);if(!w)return F;"object"!=H(F.node)||null===F.node||F.circular||(g.push(F),r(),l(F.keys,function(a,b){e.push(a);t&&t.call(F,F.node[a],a);var d=D(F.node[a]);c&&m.call(F.node,a)&&(F.node[a]=d.node);d.isLast=b==F.keys.length-1;d.isFirst=0==b;p&&p.call(F,d);e.pop()}),g.pop());v&&v.call(F,F.node);return F}(a).node}function d(a){if("object"===("undefined"===typeof a?"undefined":H(a))&&null!==a){var b;if(k(a))b=[];else if("[object Date]"===g(a))b=new Date(a.getTime?
a.getTime():a);else if("[object RegExp]"===g(a))b=new RegExp(a);else if("[object Error]"===g(a))b={message:a.message};else if("[object Boolean]"===g(a))b=new Boolean(a);else if("[object Number]"===g(a))b=new Number(a);else if("[object String]"===g(a))b=new String(a);else if(Object.create&&Object.getPrototypeOf)b=Object.create(Object.getPrototypeOf(a));else if(a.constructor===Object)b={};else{var c=function(){};c.prototype=a.constructor&&a.constructor.prototype||a.__proto__||{};b=new c}l(f(a),function(c){b[c]=
a[c]});return b}return a}function g(a){return Object.prototype.toString.call(a)}var e=c.exports=function(a){return new b(a)};b.prototype.get=function(a){for(var b=this.value,c=0;c<a.length;c++){var d=a[c];if(!b||!m.call(b,d)){b=void 0;break}b=b[d]}return b};b.prototype.has=function(a){for(var b=this.value,c=0;c<a.length;c++){var d=a[c];if(!b||!m.call(b,d))return!1;b=b[d]}return!0};b.prototype.set=function(a,b){for(var c=this.value,d=0;d<a.length-1;d++){var e=a[d];m.call(c,e)||(c[e]={});c=c[e]}return c[a[d]]=
b};b.prototype.map=function(b){return a(this.value,b,!0)};b.prototype.forEach=function(b){return this.value=a(this.value,b,!1)};b.prototype.reduce=function(a,b){var c=1===arguments.length,d=c?this.value:b;this.forEach(function(b){this.isRoot&&c||(d=a.call(this,d,b))});return d};b.prototype.paths=function(){var a=[];this.forEach(function(b){a.push(this.path)});return a};b.prototype.nodes=function(){var a=[];this.forEach(function(b){a.push(this.node)});return a};b.prototype.clone=function(){var a=[],
b=[];return function q(c){for(var e=0;e<a.length;e++)if(a[e]===c)return b[e];if("object"===("undefined"===typeof c?"undefined":H(c))&&null!==c){var g=d(c);a.push(c);b.push(g);l(f(c),function(a){g[a]=q(c[a])});a.pop();b.pop();return g}return c}(this.value)};var f=Object.keys||function(a){var b=[],c;for(c in a)b.push(c);return b},k=Array.isArray||function(a){return"[object Array]"===Object.prototype.toString.call(a)},l=function(a,b){if(a.forEach)return a.forEach(b);for(var c=0;c<a.length;c++)b(a[c],
c,a)};l(f(b.prototype),function(a){e[a]=function(c){var d=[].slice.call(arguments,1),e=new b(c);return e[a].apply(e,d)}});var m=Object.hasOwnProperty||function(a,b){return b in a}});(function(){function c(a){this.value=a}function b(a){function b(d,e){try{var f=a[d](e),k=f.value;k instanceof c?Promise.resolve(k.value).then(function(a){b("next",a)},function(a){b("throw",a)}):g(f.done?"return":"normal",f.value)}catch(r){g("throw",r)}}function g(a,c){switch(a){case "return":e.resolve({value:c,done:!0});
break;case "throw":e.reject(c);break;default:e.resolve({value:c,done:!1})}(e=e.next)?b(e.key,e.arg):f=null}var e,f;this._invoke=function(a,c){return new Promise(function(d,g){d={key:a,arg:c,resolve:d,reject:g,next:null};f?f=f.next=d:(e=f=d,b(a,c))})};"function"!==typeof a.return&&(this.return=void 0)}"function"===typeof Symbol&&Symbol.asyncIterator&&(b.prototype[Symbol.asyncIterator]=function(){return this});b.prototype.next=function(a){return this._invoke("next",a)};b.prototype.throw=function(a){return this._invoke("throw",
a)};b.prototype.return=function(a){return this._invoke("return",a)};return{wrap:function(a){return function(){return new b(a.apply(this,arguments))}},await:function(a){return new c(a)}}})();var Xj=function(){function c(b,a){for(var c=0;c<a.length;c++){var g=a[c];g.enumerable=g.enumerable||!1;g.configurable=!0;"value"in g&&(g.writable=!0);Object.defineProperty(b,g.key,g)}}return function(b,a,d){a&&c(b.prototype,a);d&&c(b,d);return b}}(),fa=function(){function c(){if(!(this instanceof c))throw new TypeError("Cannot call a class as a function");
}Xj(c,null,[{key:"isPlatformLittleEndian",value:function(){var b=new Uint32Array([305419896]);return 18!=(new Uint8Array(b.buffer,b.byteOffset,b.byteLength))[0]}},{key:"arrayBufferToUnicode",value:function(b){b=new Uint8Array(b);for(var a=[],c=0,g=0;c<b.length;){var e=b[c++];if(128>e)a[g++]=String.fromCharCode(e);else if(191<e&&224>e){var f=b[c++];a[g++]=String.fromCharCode((e&31)<<6|f&63)}else if(239<e&&365>e){var f=b[c++],k=b[c++],l=b[c++],e=((e&7)<<18|(f&63)<<12|(k&63)<<6|l&63)-65536;a[g++]=String.fromCharCode(55296+
(e>>10));a[g++]=String.fromCharCode(56320+(e&1023))}else f=b[c++],k=b[c++],a[g++]=String.fromCharCode((e&15)<<12|(f&63)<<6|k&63)}return a.join("")}},{key:"unicodeToArrayBuffer",value:function(b){for(var a=[],c=0,g=0;g<b.length;g++){var e=b.charCodeAt(g);128>e?a[c++]=e:(2048>e?a[c++]=e>>6|192:(55296==(e&64512)&&g+1<b.length&&56320==(b.charCodeAt(g+1)&64512)?(e=65536+((e&1023)<<10)+(b.charCodeAt(++g)&1023),a[c++]=e>>18|240,a[c++]=e>>12&63|128):a[c++]=e>>12|224,a[c++]=e>>6&63|128),a[c++]=e&63|128)}return(new Uint8Array(a)).buffer}},
{key:"arrayBufferToString8",value:function(b){return String.fromCharCode.apply(null,new Uint8Array(b))}},{key:"string8ToArrayBuffer",value:function(b){for(var a=new ArrayBuffer(b.length),c=new Uint8Array(a),g=0;g<b.length;g++)c[g]=b.charCodeAt(g);return a}},{key:"setString8InBuffer",value:function(b,a){var c=2<arguments.length&&void 0!==arguments[2]?arguments[2]:0;if(0>c)console.warn("The byte offset cannot be negative.");else if(a&&a instanceof ArrayBuffer)if(b.length+c>a.byteLength)console.warn("The string is too long to be writen in this buffer.");
else for(var g=new Uint8Array(a),e=0;e<b.length;e++)g[e+c]=b.charCodeAt(e);else console.warn("The buffer must be a valid ArrayBuffer.")}},{key:"getString8FromBuffer",value:function(b,a){var c=2<arguments.length&&void 0!==arguments[2]?arguments[2]:0;return 0>c?(console.warn("The byte offset cannot be negative."),null):b&&b instanceof ArrayBuffer?a+c>b.byteLength?(console.warn("The string is too long to be writen in this buffer."),null):String.fromCharCode.apply(null,new Uint8Array(b,c,a)):(console.warn("The buffer must be a valid ArrayBuffer."),
null)}},{key:"objectToArrayBuffer",value:function(b){var a=null;b=c.makeSerializeFriendly(b);try{var d=JSON.stringify(b),a=c.unicodeToArrayBuffer(d)}catch(g){console.warn(g)}return a}},{key:"ArrayBufferToObject",value:function(b){var a=null;try{var d=c.arrayBufferToUnicode(b),a=JSON.parse(d)}catch(g){console.warn(g)}return a}},{key:"isTypedArray",value:function(b){return b instanceof Int8Array||b instanceof Uint8Array||b instanceof Uint8ClampedArray||b instanceof Int16Array||b instanceof Uint16Array||
b instanceof Int32Array||b instanceof Uint32Array||b instanceof Float32Array||b instanceof Float64Array}},{key:"mergeBuffers",value:function(b){for(var a=0,c=0;c<b.length;c++)a+=b[c].byteLength;for(var a=new Uint8Array(a),g=0,c=0;c<b.length;c++)a.set(new Uint8Array(b[c]),g),g+=b[c].byteLength;return a.buffer}},{key:"getGlobalObject",value:function(){var b=null;try{b=window}catch(a){try{b=GLOBAL}catch(d){return console.warn("You are not in a Javascript environment?? Weird."),null}}return b}},{key:"extractTypedArray",
value:function(b,a,c,g){if(!b)return console.warn("Input Buffer is null."),null;if(!(b instanceof ArrayBuffer))return console.warn("Buffer must be of type ArrayBuffer"),null;if(0>=g)return console.warn("The number of elements to fetch must be greater than 0"),null;if(0>a)return console.warn("The byte offset must be possitive or 0"),null;if(a>=b.byteLength)return console.warn("The offset cannot be larger than the size of the buffer."),null;if(c instanceof Function&&!("BYTES_PER_ELEMENT"in c))return console.warn("ArrayType must be a typed array constructor function."),
null;if(c.BYTES_PER_ELEMENT*g+a>b.byteLength)console.warn("The requested number of elements is too large for this buffer");else return b=b.slice(a,a+g*c.BYTES_PER_ELEMENT),new c(b)}},{key:"getTypedArrayInfo",value:function(b){var a=null,c=!1;b instanceof Int8Array?(a="int",c=!1):b instanceof Uint8Array?(a="int",c=!0):b instanceof Uint8ClampedArray?(a="int",c=!0):b instanceof Int16Array?(a="int",c=!1):b instanceof Uint16Array?(a="int",c=!0):b instanceof Int32Array?(a="int",c=!1):b instanceof Uint32Array?
(a="int",c=!0):b instanceof Float32Array?(a="float",c=!1):b instanceof Float64Array&&(a="float",c=!1);return{type:a,signed:c,bytesPerElements:b.BYTES_PER_ELEMENT,byteLength:b.byteLength,length:b.length}}},{key:"howManyTypedArrayAttributes",value:function(b){var a=0;td(b).forEach(function(b){a+=c.isTypedArray(b)});return a}},{key:"hasCircularReference",value:function(b){var a=!1;td(b).forEach(function(b){this.circular&&(a=!0)});return a}},{key:"removeCircularReference",value:function(b){var a=!1;b=
td(b).map(function(b){this.circular&&(this.remove(),a=!0)});return a?b:null}},{key:"replaceTypedArrayAttributesByArrays",value:function(b){var a=!1;b=td(b).map(function(b){if(c.isTypedArray(b)){for(var d=Object.keys(b).length,e=Array(d),f=0;f<d;f++)e[f]=b[f];this.update(e);a=!0}});return a?b:null}},{key:"makeSerializeFriendly",value:function(b){var a=c.removeCircularReference(b);a&&(b=a);(a=c.replaceTypedArrayAttributesByArrays(b))&&(b=a);return b}}]);return c}();(function(){function c(a){this.value=
a}function b(a){function b(d,e){try{var f=a[d](e),k=f.value;k instanceof c?Promise.resolve(k.value).then(function(a){b("next",a)},function(a){b("throw",a)}):g(f.done?"return":"normal",f.value)}catch(r){g("throw",r)}}function g(a,c){switch(a){case "return":e.resolve({value:c,done:!0});break;case "throw":e.reject(c);break;default:e.resolve({value:c,done:!1})}(e=e.next)?b(e.key,e.arg):f=null}var e,f;this._invoke=function(a,c){return new Promise(function(d,g){d={key:a,arg:c,resolve:d,reject:g,next:null};
f?f=f.next=d:(e=f=d,b(a,c))})};"function"!==typeof a.return&&(this.return=void 0)}"function"===typeof Symbol&&Symbol.asyncIterator&&(b.prototype[Symbol.asyncIterator]=function(){return this});b.prototype.next=function(a){return this._invoke("next",a)};b.prototype.throw=function(a){return this._invoke("throw",a)};b.prototype.return=function(a){return this._invoke("return",a)};return{wrap:function(a){return function(){return new b(a.apply(this,arguments))}},await:function(a){return new c(a)}}})();var ud=
function(c,b){if(!(c instanceof b))throw new TypeError("Cannot call a class as a function");},vd=function(){function c(b,a){for(var c=0;c<a.length;c++){var g=a[c];g.enumerable=g.enumerable||!1;g.configurable=!0;"value"in g&&(g.writable=!0);Object.defineProperty(b,g.key,g)}}return function(b,a,d){a&&c(b.prototype,a);d&&c(b,d);return b}}(),Lh=function(){function c(){ud(this,c);this._compress=!1;this.reset()}vd(c,[{key:"reset",value:function(){this._output=this._inputCase=this._input=null}},{key:"enableDataCompression",
value:function(b){this._compress=b}},{key:"setInput",value:function(b){if(this._inputCase=c.isGoodCandidate(b))this._input=b}},{key:"getOutput",value:function(){return this._output}},{key:"run",value:function(){var b=this._input;if(b&&this._inputCase){var a=b._data,c,g,e=[],f=!1;switch(this._inputCase){case 1:c=a;var k=this._getDataSubsetInfo(a);k.compressedByteLength=null;this._compress&&(c=Qc.deflate(c.buffer),k.compressedByteLength=c.byteLength);e.push(k);break;case 2:f=!0;g=[];c=Array(a.length);
for(var l=0;l<a.length;l++){var m=a[l],k=this._getDataSubsetInfo(m);k.isTypedArray||(m=new Uint8Array(fa.objectToArrayBuffer(m)),k.byteLength=m.byteLength);if(this._compress){var n=Qc.deflate(m.buffer);k.compressedByteLength=n.byteLength;g.push(n)}e.push(k);c[l]=m}this._compress&&(c=g);break;case 3:k=this._getDataSubsetInfo(a);c=new Uint8Array(fa.objectToArrayBuffer(a));k.byteLength=c.byteLength;this._compress&&(c=Qc.deflate(c),k.compressedByteLength=c.byteLength);e.push(k);break;default:console.warn("A problem occured.");
return}l=fa.objectToArrayBuffer(b._metadata);b=fa.objectToArrayBuffer({byteStreamInfo:e,useMultipleDataStreams:f,originalBlockType:b.constructor.name,metadataByteLength:l.byteLength});b=[(new Uint8Array([+fa.isPlatformLittleEndian()])).buffer,(new Uint32Array([b.byteLength])).buffer,b,l];if(f)for(l=0;l<c.length;l++)b.push(c[l].buffer);else b.push(c.buffer);this._output=fa.mergeBuffers(b)}else console.warn("An input must be given to the PixBlockEncoder.")}},{key:"_getDataSubsetInfo",value:function(b){fa.isTypedArray(b)?
(b=fa.getTypedArrayInfo(b),b.isTypedArray=!0,b.compressedByteLength=null):b={type:b.constructor.name,compressedByteLength:null,byteLength:null,length:null,isTypedArray:!1};return b}}],[{key:"isGoodCandidate",value:function(b){if(!b)return console.warn("Input object cannot be null."),!1;if(!("_metadata"in b))return console.warn("Input object must contain a _metadata object."),!1;if(!("_data"in b))return console.warn("Input object must contain a _data object."),!1;b=c.determineDataCase(b._data);null===
b&&console.warn("The input is invalid.");return b}},{key:"determineDataCase",value:function(b){return b instanceof Object?fa.isTypedArray(b)?1:b instanceof Array?2:3:null}}]);return c}(),Yj=function(){function c(){ud(this,c);this.reset()}vd(c,[{key:"reset",value:function(){this._output=this._input=null}},{key:"setInput",value:function(b){b instanceof ArrayBuffer?this._input=b:console.warn("Input should be a valid ArrayBuffer")}},{key:"getOutput",value:function(){return this._output}},{key:"run",value:function(){var b=
this._input,a=new DataView(b);a.getUint8(0);var c=0;a.getUint8(0);for(var c=c+1,g=a.getUint32(1,c),c=c+4,a=b.slice(c,c+g),a=fa.ArrayBufferToObject(a),c=c+g,g=b.slice(c,c+a.metadataByteLength),g=fa.ArrayBufferToObject(g),c=c+a.metadataByteLength,e=[],f=0;f<a.byteStreamInfo.length;f++){var k=a.byteStreamInfo[f].compressedByteLength,l=this._getDataTypeFromByteStreamInfo(a.byteStreamInfo[f]),m=a.byteStreamInfo[f].isTypedArray;if(k){var n=new Uint8Array(b,c,k),n=Qc.inflate(n),l=m?new l(n.buffer):fa.ArrayBufferToObject(n.buffer);
e.push(l);c+=k}else m?l=fa.extractTypedArray(b,c,this._getDataTypeFromByteStreamInfo(a.byteStreamInfo[f]),a.byteStreamInfo[f].length):(k=fa.extractTypedArray(b,c,Uint8Array,a.byteStreamInfo[f].byteLength),l=fa.ArrayBufferToObject(k.buffer)),e.push(l),c+=a.byteStreamInfo[f].byteLength}a.useMultipleDataStreams||(e=e[0]);this._output={originalBlockType:a.originalBlockType,_data:e,_metadata:g}}},{key:"_getDataTypeFromByteStreamInfo",value:function(b){var a="Object",c=fa.getGlobalObject();"int"===b.type?
(a=b.signed?"Uint":"Int",a+=8*b.bytesPerElements+"Array"):"float"===b.type&&(a="Float"+(8*b.bytesPerElements+"Array"),c=fa.getGlobalObject());return c[a]}}]);return c}(),xe="undefined"!==typeof Ma?Ma:"undefined"!==typeof self?self:"undefined"!==typeof window?window:{},rb=zg,sb=Ag;"function"===typeof xe.setTimeout&&(rb=setTimeout);"function"===typeof xe.clearTimeout&&(sb=clearTimeout);var ab=[],bc=!1,Jb,hd=-1;Dg.prototype.run=function(){this.fun.apply(null,this.array)};var ic=xe.performance||{},Zj=
ic.now||ic.mozNow||ic.msNow||ic.oNow||ic.webkitNow||function(){return(new Date).getTime()},ak=new Date,wd={nextTick:function(c){var b=Array(arguments.length-1);if(1<arguments.length)for(var a=1;a<arguments.length;a++)b[a-1]=arguments[a];ab.push(new Dg(c,b));1!==ab.length||bc||Bg(Cg)},title:"browser",browser:!0,env:{},argv:[],version:"",versions:{},on:Kb,addListener:Kb,once:Kb,off:Kb,removeListener:Kb,removeAllListeners:Kb,emit:Kb,binding:function(c){throw Error("process.binding is not supported");
},cwd:function(){return"/"},chdir:function(c){throw Error("process.chdir is not supported");},umask:function(){return 0},hrtime:function(c){var b=.001*Zj.call(ic),a=Math.floor(b),b=Math.floor(b%1*1E9);c&&(a-=c[0],b-=c[1],0>b&&(a--,b+=1E9));return[a,b]},platform:"browser",release:{},config:{},uptime:function(){return(new Date-ak)/1E3}},Mh=ag(function(c){(function(){function b(a){a?(r[0]=r[16]=r[1]=r[2]=r[3]=r[4]=r[5]=r[6]=r[7]=r[8]=r[9]=r[10]=r[11]=r[12]=r[13]=r[14]=r[15]=0,this.blocks=r,this.buffer8=
v):e?(a=new ArrayBuffer(68),this.buffer8=new Uint8Array(a),this.blocks=new Uint32Array(a)):this.blocks=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];this.h0=this.h1=this.h2=this.h3=this.start=this.bytes=0;this.finalized=this.hashed=!1;this.first=!0}var a="object"===("undefined"===typeof window?"undefined":H(window)),d=a?window:{};d.JS_MD5_NO_WINDOW&&(a=!1);var a=!a&&"object"===("undefined"===typeof self?"undefined":H(self)),g=!d.JS_MD5_NO_NODE_JS&&"object"===("undefined"===typeof wd?"undefined":H(wd))&&wd.versions&&
wd.versions.node;g?d=Nj:a&&(d=self);var a=!d.JS_MD5_NO_COMMON_JS&&!0&&c.exports,e=!d.JS_MD5_NO_ARRAY_BUFFER&&"undefined"!==typeof ArrayBuffer,f="0123456789abcdef".split(""),k=[128,32768,8388608,-2147483648],l=[0,8,16,24],m="hex array digest buffer arrayBuffer base64".split(" "),n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".split(""),r=[],v;if(e){var q=new ArrayBuffer(68);v=new Uint8Array(q);r=new Uint32Array(q)}if(d.JS_MD5_NO_NODE_JS||!Array.isArray)Array.isArray=function(a){return"[object Array]"===
Object.prototype.toString.call(a)};!e||!d.JS_MD5_NO_ARRAY_BUFFER_IS_VIEW&&ArrayBuffer.isView||(ArrayBuffer.isView=function(a){return"object"===("undefined"===typeof a?"undefined":H(a))&&a.buffer&&a.buffer.constructor===ArrayBuffer});var t=function(a){return function(c){return(new b(!0)).update(c)[a]()}},p=function(a){var b=eval("require('crypto')"),c=eval("require('buffer').Buffer");return function(d){if("string"===typeof d)return b.createHash("md5").update(d,"utf8").digest("hex");if(null===d||void 0===
d)throw"input is invalid type";d.constructor===ArrayBuffer&&(d=new Uint8Array(d));return Array.isArray(d)||ArrayBuffer.isView(d)||d.constructor===c?b.createHash("md5").update(new c(d)).digest("hex"):a(d)}};b.prototype.update=function(a){if(!this.finalized){var b,c="undefined"===typeof a?"undefined":H(a);if("string"!==c){if("object"===c){if(null===a)throw"input is invalid type";if(e&&a.constructor===ArrayBuffer)a=new Uint8Array(a);else if(!(Array.isArray(a)||e&&ArrayBuffer.isView(a)))throw"input is invalid type";
}else throw"input is invalid type";b=!0}for(var d=0,f,g=a.length,k=this.blocks,m=this.buffer8;d<g;){this.hashed&&(this.hashed=!1,k[0]=k[16],k[16]=k[1]=k[2]=k[3]=k[4]=k[5]=k[6]=k[7]=k[8]=k[9]=k[10]=k[11]=k[12]=k[13]=k[14]=k[15]=0);if(b)if(e)for(f=this.start;d<g&&64>f;++d)m[f++]=a[d];else for(f=this.start;d<g&&64>f;++d)k[f>>2]|=a[d]<<l[f++&3];else if(e)for(f=this.start;d<g&&64>f;++d)c=a.charCodeAt(d),128>c?m[f++]=c:(2048>c?m[f++]=192|c>>6:(55296>c||57344<=c?m[f++]=224|c>>12:(c=65536+((c&1023)<<10|a.charCodeAt(++d)&
1023),m[f++]=240|c>>18,m[f++]=128|c>>12&63),m[f++]=128|c>>6&63),m[f++]=128|c&63);else for(f=this.start;d<g&&64>f;++d)c=a.charCodeAt(d),128>c?k[f>>2]|=c<<l[f++&3]:(2048>c?k[f>>2]|=(192|c>>6)<<l[f++&3]:(55296>c||57344<=c?k[f>>2]|=(224|c>>12)<<l[f++&3]:(c=65536+((c&1023)<<10|a.charCodeAt(++d)&1023),k[f>>2]|=(240|c>>18)<<l[f++&3],k[f>>2]|=(128|c>>12&63)<<l[f++&3]),k[f>>2]|=(128|c>>6&63)<<l[f++&3]),k[f>>2]|=(128|c&63)<<l[f++&3]);this.lastByteIndex=f;this.bytes+=f-this.start;64<=f?(this.start=f-64,this.hash(),
this.hashed=!0):this.start=f}return this}};b.prototype.finalize=function(){if(!this.finalized){this.finalized=!0;var a=this.blocks,b=this.lastByteIndex;a[b>>2]|=k[b&3];56<=b&&(this.hashed||this.hash(),a[0]=a[16],a[16]=a[1]=a[2]=a[3]=a[4]=a[5]=a[6]=a[7]=a[8]=a[9]=a[10]=a[11]=a[12]=a[13]=a[14]=a[15]=0);a[14]=this.bytes<<3;this.hash()}};b.prototype.hash=function(){var a,b,c,d,e,f=this.blocks;this.first?(a=f[0]-680876937,a=(a<<7|a>>>25)-271733879<<0,d=(-1732584194^a&2004318071)+f[1]-117830708,d=(d<<12|
d>>>20)+a<<0,c=(-271733879^d&(a^-271733879))+f[2]-1126478375,c=(c<<17|c>>>15)+d<<0,b=(a^c&(d^a))+f[3]-1316259209):(a=this.h0,b=this.h1,c=this.h2,d=this.h3,a+=(d^b&(c^d))+f[0]-680876936,a=(a<<7|a>>>25)+b<<0,d+=(c^a&(b^c))+f[1]-389564586,d=(d<<12|d>>>20)+a<<0,c+=(b^d&(a^b))+f[2]+606105819,c=(c<<17|c>>>15)+d<<0,b+=(a^c&(d^a))+f[3]-1044525330);b=(b<<22|b>>>10)+c<<0;a+=(d^b&(c^d))+f[4]-176418897;a=(a<<7|a>>>25)+b<<0;d+=(c^a&(b^c))+f[5]+1200080426;d=(d<<12|d>>>20)+a<<0;c+=(b^d&(a^b))+f[6]-1473231341;c=
(c<<17|c>>>15)+d<<0;b+=(a^c&(d^a))+f[7]-45705983;b=(b<<22|b>>>10)+c<<0;a+=(d^b&(c^d))+f[8]+1770035416;a=(a<<7|a>>>25)+b<<0;d+=(c^a&(b^c))+f[9]-1958414417;d=(d<<12|d>>>20)+a<<0;c+=(b^d&(a^b))+f[10]-42063;c=(c<<17|c>>>15)+d<<0;b+=(a^c&(d^a))+f[11]-1990404162;b=(b<<22|b>>>10)+c<<0;a+=(d^b&(c^d))+f[12]+1804603682;a=(a<<7|a>>>25)+b<<0;d+=(c^a&(b^c))+f[13]-40341101;d=(d<<12|d>>>20)+a<<0;c+=(b^d&(a^b))+f[14]-1502002290;c=(c<<17|c>>>15)+d<<0;b+=(a^c&(d^a))+f[15]+1236535329;b=(b<<22|b>>>10)+c<<0;a+=(c^d&(b^
c))+f[1]-165796510;a=(a<<5|a>>>27)+b<<0;d+=(b^c&(a^b))+f[6]-1069501632;d=(d<<9|d>>>23)+a<<0;c+=(a^b&(d^a))+f[11]+643717713;c=(c<<14|c>>>18)+d<<0;b+=(d^a&(c^d))+f[0]-373897302;b=(b<<20|b>>>12)+c<<0;a+=(c^d&(b^c))+f[5]-701558691;a=(a<<5|a>>>27)+b<<0;d+=(b^c&(a^b))+f[10]+38016083;d=(d<<9|d>>>23)+a<<0;c+=(a^b&(d^a))+f[15]-660478335;c=(c<<14|c>>>18)+d<<0;b+=(d^a&(c^d))+f[4]-405537848;b=(b<<20|b>>>12)+c<<0;a+=(c^d&(b^c))+f[9]+568446438;a=(a<<5|a>>>27)+b<<0;d+=(b^c&(a^b))+f[14]-1019803690;d=(d<<9|d>>>23)+
a<<0;c+=(a^b&(d^a))+f[3]-187363961;c=(c<<14|c>>>18)+d<<0;b+=(d^a&(c^d))+f[8]+1163531501;b=(b<<20|b>>>12)+c<<0;a+=(c^d&(b^c))+f[13]-1444681467;a=(a<<5|a>>>27)+b<<0;d+=(b^c&(a^b))+f[2]-51403784;d=(d<<9|d>>>23)+a<<0;c+=(a^b&(d^a))+f[7]+1735328473;c=(c<<14|c>>>18)+d<<0;b+=(d^a&(c^d))+f[12]-1926607734;b=(b<<20|b>>>12)+c<<0;e=b^c;a+=(e^d)+f[5]-378558;a=(a<<4|a>>>28)+b<<0;d+=(e^a)+f[8]-2022574463;d=(d<<11|d>>>21)+a<<0;e=d^a;c+=(e^b)+f[11]+1839030562;c=(c<<16|c>>>16)+d<<0;b+=(e^c)+f[14]-35309556;b=(b<<23|
b>>>9)+c<<0;e=b^c;a+=(e^d)+f[1]-1530992060;a=(a<<4|a>>>28)+b<<0;d+=(e^a)+f[4]+1272893353;d=(d<<11|d>>>21)+a<<0;e=d^a;c+=(e^b)+f[7]-155497632;c=(c<<16|c>>>16)+d<<0;b+=(e^c)+f[10]-1094730640;b=(b<<23|b>>>9)+c<<0;e=b^c;a+=(e^d)+f[13]+681279174;a=(a<<4|a>>>28)+b<<0;d+=(e^a)+f[0]-358537222;d=(d<<11|d>>>21)+a<<0;e=d^a;c+=(e^b)+f[3]-722521979;c=(c<<16|c>>>16)+d<<0;b+=(e^c)+f[6]+76029189;b=(b<<23|b>>>9)+c<<0;e=b^c;a+=(e^d)+f[9]-640364487;a=(a<<4|a>>>28)+b<<0;d+=(e^a)+f[12]-421815835;d=(d<<11|d>>>21)+a<<0;
e=d^a;c+=(e^b)+f[15]+530742520;c=(c<<16|c>>>16)+d<<0;b+=(e^c)+f[2]-995338651;b=(b<<23|b>>>9)+c<<0;a+=(c^(b|~d))+f[0]-198630844;a=(a<<6|a>>>26)+b<<0;d+=(b^(a|~c))+f[7]+1126891415;d=(d<<10|d>>>22)+a<<0;c+=(a^(d|~b))+f[14]-1416354905;c=(c<<15|c>>>17)+d<<0;b+=(d^(c|~a))+f[5]-57434055;b=(b<<21|b>>>11)+c<<0;a+=(c^(b|~d))+f[12]+1700485571;a=(a<<6|a>>>26)+b<<0;d+=(b^(a|~c))+f[3]-1894986606;d=(d<<10|d>>>22)+a<<0;c+=(a^(d|~b))+f[10]-1051523;c=(c<<15|c>>>17)+d<<0;b+=(d^(c|~a))+f[1]-2054922799;b=(b<<21|b>>>11)+
c<<0;a+=(c^(b|~d))+f[8]+1873313359;a=(a<<6|a>>>26)+b<<0;d+=(b^(a|~c))+f[15]-30611744;d=(d<<10|d>>>22)+a<<0;c+=(a^(d|~b))+f[6]-1560198380;c=(c<<15|c>>>17)+d<<0;b+=(d^(c|~a))+f[13]+1309151649;b=(b<<21|b>>>11)+c<<0;a+=(c^(b|~d))+f[4]-145523070;a=(a<<6|a>>>26)+b<<0;d+=(b^(a|~c))+f[11]-1120210379;d=(d<<10|d>>>22)+a<<0;c+=(a^(d|~b))+f[2]+718787259;c=(c<<15|c>>>17)+d<<0;b+=(d^(c|~a))+f[9]-343485551;b=(b<<21|b>>>11)+c<<0;this.first?(this.h0=a+1732584193<<0,this.h1=b-271733879<<0,this.h2=c-1732584194<<0,this.h3=
d+271733878<<0,this.first=!1):(this.h0=this.h0+a<<0,this.h1=this.h1+b<<0,this.h2=this.h2+c<<0,this.h3=this.h3+d<<0)};b.prototype.hex=function(){this.finalize();var a=this.h0,b=this.h1,c=this.h2,d=this.h3;return f[a>>4&15]+f[a&15]+f[a>>12&15]+f[a>>8&15]+f[a>>20&15]+f[a>>16&15]+f[a>>28&15]+f[a>>24&15]+f[b>>4&15]+f[b&15]+f[b>>12&15]+f[b>>8&15]+f[b>>20&15]+f[b>>16&15]+f[b>>28&15]+f[b>>24&15]+f[c>>4&15]+f[c&15]+f[c>>12&15]+f[c>>8&15]+f[c>>20&15]+f[c>>16&15]+f[c>>28&15]+f[c>>24&15]+f[d>>4&15]+f[d&15]+f[d>>
12&15]+f[d>>8&15]+f[d>>20&15]+f[d>>16&15]+f[d>>28&15]+f[d>>24&15]};b.prototype.toString=b.prototype.hex;b.prototype.digest=function(){this.finalize();var a=this.h0,b=this.h1,c=this.h2,d=this.h3;return[a&255,a>>8&255,a>>16&255,a>>24&255,b&255,b>>8&255,b>>16&255,b>>24&255,c&255,c>>8&255,c>>16&255,c>>24&255,d&255,d>>8&255,d>>16&255,d>>24&255]};b.prototype.array=b.prototype.digest;b.prototype.arrayBuffer=function(){this.finalize();var a=new ArrayBuffer(16),b=new Uint32Array(a);b[0]=this.h0;b[1]=this.h1;
b[2]=this.h2;b[3]=this.h3;return a};b.prototype.buffer=b.prototype.arrayBuffer;b.prototype.base64=function(){for(var a,b,c,d="",e=this.array(),f=0;15>f;)a=e[f++],b=e[f++],c=e[f++],d+=n[a>>>2]+n[(a<<4|b>>>4)&63]+n[(b<<2|c>>>6)&63]+n[c&63];a=e[f];return d+=n[a>>>2]+n[a<<4&63]+"=="};q=function(){var a=t("hex");g&&(a=p(a));a.create=function(){return new b};a.update=function(b){return a.create().update(b)};for(var c=0;c<m.length;++c){var d=m[c];a[d]=t(d)}return a}();a?c.exports=q:d.md5=q})()}),Nh=function(){function c(){ud(this,
c);this._compress=!0;this.reset()}vd(c,[{key:"reset",value:function(){this._inputs=[];this._output=null;this._options={madeWith:"pixbincodec_js",userObject:null,description:null}}},{key:"enableDataCompression",value:function(b){this._compress=b}},{key:"setOption",value:function(b,a){b in this._options&&(this._options[b]=a)}},{key:"addInput",value:function(b){Lh.isGoodCandidate(b)&&this._inputs.push(b)}},{key:"getOutput",value:function(){return this._output}},{key:"run",value:function(){if(this._inputs.length){var b=
this,a=new Date,d=fa.isPlatformLittleEndian(),g=new Lh,a={date:a.toISOString(),createdWith:this._options.madeWith,description:this._options.description,userObject:this._options.userObject,pixblocksInfo:[]},e=[],f=a.pixblocksInfo;this._inputs.forEach(function(a,c){g.setInput(a);g.enableDataCompression(b._compress);g.run();var d=g.getOutput();d?(a={type:a.constructor.name,description:"description"in a._metadata?a._metadata.description:null,byteLength:d.byteLength,checksum:Mh(d)},f.push(a),e.push(d)):
console.warn("The input of index "+c+" could not be encoded as a PixBlock.")});e.length||console.warn("No input was compatible for PixBlock encoding.");var a=fa.objectToArrayBuffer(a),k=c.MAGIC_NUMBER(),l=new ArrayBuffer(k.length+5),m=new DataView(l);fa.setString8InBuffer(k,l);m.setUint8(k.length,+d);m.setUint32(k.length+1,a.byteLength,d);d=[l,a].concat(e);this._output=fa.mergeBuffers(d)}else console.warn("The encoder must be specified at least one input.")}}],[{key:"MAGIC_NUMBER",value:function(){return"PIXPIPE_PIXBIN"}}]);
return c}(),bk=function(){function c(){ud(this,c);this._verifyChecksum=!1;this._binMeta=this._output=this._input=null;this._parsingInfo={offsetToReachFirstBlock:-1,isLittleEndian:-1};this._decodedBlocks={};this._isValid=!1;this.reset()}vd(c,[{key:"setInput",value:function(b){this.reset();b instanceof ArrayBuffer&&(this._input=b,this._isValid=this._parseIndex())}},{key:"isValid",value:function(){return this._isValid}},{key:"getOutput",value:function(){return this._output}},{key:"getNumberOfBlocks",
value:function(){return this._binMeta.pixblocksInfo.length}},{key:"getBinCreationDate",value:function(){return this._binMeta.date}},{key:"getBinDescription",value:function(){return this._binMeta.description}},{key:"getBinUserObject",value:function(){return this._binMeta.userObject}},{key:"getBlockDescription",value:function(b){return 0>b||b>=this.getNumberOfBlocks()?(console.warn("The block index is out of range."),null):this._binMeta.pixblocksInfo[b].description}},{key:"getBlockType",value:function(b){return 0>
b||b>=this.getNumberOfBlocks()?(console.warn("The block index is out of range."),null):this._binMeta.pixblocksInfo[b].type}},{key:"reset",value:function(){this._isValid=!1;this._binMeta=this._output=this._input=null;this._parsingInfo={offsetToReachFirstBlock:-1,isLittleEndian:-1};this._decodedBlocks={}}},{key:"enableBlockVerification",value:function(b){this._verifyChecksum=b}},{key:"_parseIndex",value:function(){var b=this._input;if(!b)return console.warn("Input cannot be null"),!1;var a=b.byteLength,
c=Nh.MAGIC_NUMBER();if(a<c.length+5)return console.warn("This buffer does not match a PixBin file."),!1;var g=new DataView(b);if(fa.getString8FromBuffer(b,c.length)!==c)return console.warn("This file is not of PixBin type. (wrong magic number)"),!1;c=c.length;a=g.getUint8(c);if(0!=a&&1!=a)return console.warn("This file is not of PixBin type. (wrong endianess code)"),!1;c+=1;g=g.getUint32(c,a);c+=4;b=fa.ArrayBufferToObject(b.slice(c,c+g));this._parsingInfo.offsetToReachFirstBlock=c+g;this._parsingInfo.isLittleEndian=
a;this._binMeta=b;return!0}},{key:"fetchBlock",value:function(b){var a=1<arguments.length&&void 0!==arguments[1]?arguments[1]:!1,c=this.getNumberOfBlocks();if(0>b||b>=c)return console.warn("The block index is out of range."),null;if(b in this._decodedBlocks&&!a)return this._decodedBlocks[b];a=this._parsingInfo.offsetToReachFirstBlock;for(c=0;c<b;c++)a+=this._binMeta.pixblocksInfo[c].byteLength;c=this._binMeta.pixblocksInfo[b];a=this._input.slice(a,a+c.byteLength);if(this._verifyChecksum&&Mh(a)!==
c.checksum)return console.warn("The block #"+b+" is corrupted."),null;c=new Yj;c.setInput(a);c.run();a=c.getOutput();return a?this._decodedBlocks[b]=a:(console.warn("The block #"+b+" could not be decoded."),null)}}]);return c}(),ck=function(c){function b(){N(this,b);var a=P(this,(b.__proto__||Object.getPrototypeOf(b)).call(this));a.setMetadata("compress",!0);a.setMetadata("description","no description");a.setMetadata("madeWith","Pixpipejs");a.setMetadata("userObject",null);return a}M(b,c);O(b,[{key:"_run",
value:function(){var a=new Nh;a.enableDataCompression(this.getMetadata("compress"));a.setOption("userObject",this.getMetadata("userObject"));a.setOption("description",this.getMetadata("description"));a.setOption("madeWith",this.getMetadata("madeWith"));this._forEachInput(function(b,c){a.addInput(c)});a.run();this._output[0]=a.getOutput()}}],[{key:"MAGIC_NUMBER",value:function(){return"PIXPIPE_PIXBIN"}}]);return b}(V),dk=function(c){function b(){N(this,b);var a=P(this,(b.__proto__||Object.getPrototypeOf(b)).call(this));
a.addInputValidator(0,ArrayBuffer);a.setMetadata("blockVerification",!1);return a}M(b,c);O(b,[{key:"_run",value:function(){if(this.hasValidInput()){var a=this._getInput(),b=new bk;b.enableBlockVerification(this.getMetadata("blockVerification"));b.setInput(a);if(b.isValid()){for(var a={creationDate:b.getBinCreationDate(),description:b.getBinDescription(),userObject:b.getBinUserObject(),numberOfBlocks:b.getNumberOfBlocks()},c=b.getNumberOfBlocks(),e=0;e<c;e++){var f=b.getBlockType(e),k=b.fetchBlock(e),
l=null,m=cb.getCoreType(f);m?(l=new m,l.setRawData(k._data),l.setRawMetadata(k._metadata)):(m=gc.getGlobalObject(),f in m&&(l=new m[f],l._metadata=k._metadata,l._data=k._data));this._output[e]=l}c&&(this._output.PixBinMeta=a)}else console.warn("The input buffer is invalid.")}else console.warn("PixBinDecoder can only decode ArrayBuffer.")}}]);return b}(V),Va=[],Ia=[],Oi="undefined"!==typeof Uint8Array?Uint8Array:Array,ge=!1,ek={}.toString,Kg=Array.isArray||function(c){return"[object Array]"==ek.call(c)};
C.TYPED_ARRAY_SUPPORT=void 0!==Ma.TYPED_ARRAY_SUPPORT?Ma.TYPED_ARRAY_SUPPORT:!0;C.poolSize=8192;C._augment=function(c){c.__proto__=C.prototype;return c};C.from=function(c,b,a){return Hg(null,c,b,a)};C.TYPED_ARRAY_SUPPORT&&(C.prototype.__proto__=Uint8Array.prototype,C.__proto__=Uint8Array);C.alloc=function(c,b,a){Jg(c);c=0>=c?bb(null,c):void 0!==b?"string"===typeof a?bb(null,c).fill(b,a):bb(null,c).fill(b):bb(null,c);return c};C.allocUnsafe=function(c){return he(null,c)};C.allocUnsafeSlow=function(c){return he(null,
c)};C.isBuffer=Ug;C.compare=function(c,b){if(!Wa(c)||!Wa(b))throw new TypeError("Arguments must be Buffers");if(c===b)return 0;for(var a=c.length,d=b.length,g=0,e=Math.min(a,d);g<e;++g)if(c[g]!==b[g]){a=c[g];d=b[g];break}return a<d?-1:d<a?1:0};C.isEncoding=function(c){switch(String(c).toLowerCase()){case "hex":case "utf8":case "utf-8":case "ascii":case "latin1":case "binary":case "base64":case "ucs2":case "ucs-2":case "utf16le":case "utf-16le":return!0;default:return!1}};C.concat=function(c,b){if(!Kg(c))throw new TypeError('"list" argument must be an Array of Buffers');
if(0===c.length)return C.alloc(0);var a;if(void 0===b)for(a=b=0;a<c.length;++a)b+=c[a].length;b=C.allocUnsafe(b);var d=0;for(a=0;a<c.length;++a){var g=c[a];if(!Wa(g))throw new TypeError('"list" argument must be an Array of Buffers');g.copy(b,d);d+=g.length}return b};C.byteLength=Ig;C.prototype._isBuffer=!0;C.prototype.swap16=function(){var c=this.length;if(0!==c%2)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var b=0;b<c;b+=2)Lb(this,b,b+1);return this};C.prototype.swap32=
function(){var c=this.length;if(0!==c%4)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var b=0;b<c;b+=4)Lb(this,b,b+3),Lb(this,b+1,b+2);return this};C.prototype.swap64=function(){var c=this.length;if(0!==c%8)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var b=0;b<c;b+=8)Lb(this,b,b+7),Lb(this,b+1,b+6),Lb(this,b+2,b+5),Lb(this,b+3,b+4);return this};C.prototype.toString=function(){var c=this.length|0;return 0===c?"":0===arguments.length?Mg(this,0,c):Mi.apply(this,
arguments)};C.prototype.equals=function(c){if(!Wa(c))throw new TypeError("Argument must be a Buffer");return this===c?!0:0===C.compare(this,c)};C.prototype.inspect=function(){var c="";0<this.length&&(c=this.toString("hex",0,50).match(/.{2}/g).join(" "),50<this.length&&(c+=" ... "));return"<Buffer "+c+">"};C.prototype.compare=function(c,b,a,d,g){if(!Wa(c))throw new TypeError("Argument must be a Buffer");void 0===b&&(b=0);void 0===a&&(a=c?c.length:0);void 0===d&&(d=0);void 0===g&&(g=this.length);if(0>
b||a>c.length||0>d||g>this.length)throw new RangeError("out of range index");if(d>=g&&b>=a)return 0;if(d>=g)return-1;if(b>=a)return 1;b>>>=0;a>>>=0;d>>>=0;g>>>=0;if(this===c)return 0;var e=g-d,f=a-b,k=Math.min(e,f);d=this.slice(d,g);c=c.slice(b,a);for(b=0;b<k;++b)if(d[b]!==c[b]){e=d[b];f=c[b];break}return e<f?-1:f<e?1:0};C.prototype.includes=function(c,b,a){return-1!==this.indexOf(c,b,a)};C.prototype.indexOf=function(c,b,a){return Ng(this,c,b,a,!0)};C.prototype.lastIndexOf=function(c,b,a){return Ng(this,
c,b,a,!1)};C.prototype.write=function(c,b,a,d){if(void 0===b)d="utf8",a=this.length,b=0;else if(void 0===a&&"string"===typeof b)d=b,a=this.length,b=0;else if(isFinite(b))b|=0,isFinite(a)?(a|=0,void 0===d&&(d="utf8")):(d=a,a=void 0);else throw Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");var g=this.length-b;if(void 0===a||a>g)a=g;if(0<c.length&&(0>a||0>b)||b>this.length)throw new RangeError("Attempt to write outside buffer bounds");d||(d="utf8");for(g=!1;;)switch(d){case "hex":a:{b=
Number(b)||0;d=this.length-b;a?(a=Number(a),a>d&&(a=d)):a=d;d=c.length;if(0!==d%2)throw new TypeError("Invalid hex string");a>d/2&&(a=d/2);for(d=0;d<a;++d){g=parseInt(c.substr(2*d,2),16);if(isNaN(g)){c=d;break a}this[b+d]=g}c=d}return c;case "utf8":case "utf-8":return Gc(jd(c,this.length-b),this,b,a);case "ascii":return Gc(Tg(c),this,b,a);case "latin1":case "binary":return Gc(Tg(c),this,b,a);case "base64":return Gc(Lg(c),this,b,a);case "ucs2":case "ucs-2":case "utf16le":case "utf-16le":var e;d=c;
for(var g=this.length-b,f=[],k=0;k<d.length&&!(0>(g-=2));++k)e=d.charCodeAt(k),c=e>>8,e%=256,f.push(e),f.push(c);return Gc(f,this,b,a);default:if(g)throw new TypeError("Unknown encoding: "+d);d=(""+d).toLowerCase();g=!0}};C.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var Pg=4096;C.prototype.slice=function(c,b){var a=this.length;c=~~c;b=void 0===b?a:~~b;0>c?(c+=a,0>c&&(c=0)):c>a&&(c=a);0>b?(b+=a,0>b&&(b=0)):b>a&&(b=a);b<c&&(b=c);if(C.TYPED_ARRAY_SUPPORT)b=
this.subarray(c,b),b.__proto__=C.prototype;else{a=b-c;b=new C(a,void 0);for(var d=0;d<a;++d)b[d]=this[d+c]}return b};C.prototype.readUIntLE=function(c,b,a){c|=0;b|=0;a||ka(c,b,this.length);a=this[c];for(var d=1,g=0;++g<b&&(d*=256);)a+=this[c+g]*d;return a};C.prototype.readUIntBE=function(c,b,a){c|=0;b|=0;a||ka(c,b,this.length);a=this[c+--b];for(var d=1;0<b&&(d*=256);)a+=this[c+--b]*d;return a};C.prototype.readUInt8=function(c,b){b||ka(c,1,this.length);return this[c]};C.prototype.readUInt16LE=function(c,
b){b||ka(c,2,this.length);return this[c]|this[c+1]<<8};C.prototype.readUInt16BE=function(c,b){b||ka(c,2,this.length);return this[c]<<8|this[c+1]};C.prototype.readUInt32LE=function(c,b){b||ka(c,4,this.length);return(this[c]|this[c+1]<<8|this[c+2]<<16)+16777216*this[c+3]};C.prototype.readUInt32BE=function(c,b){b||ka(c,4,this.length);return 16777216*this[c]+(this[c+1]<<16|this[c+2]<<8|this[c+3])};C.prototype.readIntLE=function(c,b,a){c|=0;b|=0;a||ka(c,b,this.length);a=this[c];for(var d=1,g=0;++g<b&&
(d*=256);)a+=this[c+g]*d;a>=128*d&&(a-=Math.pow(2,8*b));return a};C.prototype.readIntBE=function(c,b,a){c|=0;b|=0;a||ka(c,b,this.length);a=b;for(var d=1,g=this[c+--a];0<a&&(d*=256);)g+=this[c+--a]*d;g>=128*d&&(g-=Math.pow(2,8*b));return g};C.prototype.readInt8=function(c,b){b||ka(c,1,this.length);return this[c]&128?-1*(255-this[c]+1):this[c]};C.prototype.readInt16LE=function(c,b){b||ka(c,2,this.length);c=this[c]|this[c+1]<<8;return c&32768?c|4294901760:c};C.prototype.readInt16BE=function(c,b){b||
ka(c,2,this.length);c=this[c+1]|this[c]<<8;return c&32768?c|4294901760:c};C.prototype.readInt32LE=function(c,b){b||ka(c,4,this.length);return this[c]|this[c+1]<<8|this[c+2]<<16|this[c+3]<<24};C.prototype.readInt32BE=function(c,b){b||ka(c,4,this.length);return this[c]<<24|this[c+1]<<16|this[c+2]<<8|this[c+3]};C.prototype.readFloatLE=function(c,b){b||ka(c,4,this.length);return id(this,c,!0,23,4)};C.prototype.readFloatBE=function(c,b){b||ka(c,4,this.length);return id(this,c,!1,23,4)};C.prototype.readDoubleLE=
function(c,b){b||ka(c,8,this.length);return id(this,c,!0,52,8)};C.prototype.readDoubleBE=function(c,b){b||ka(c,8,this.length);return id(this,c,!1,52,8)};C.prototype.writeUIntLE=function(c,b,a,d){c=+c;b|=0;a|=0;d||ya(this,c,b,a,Math.pow(2,8*a)-1,0);d=1;var g=0;for(this[b]=c&255;++g<a&&(d*=256);)this[b+g]=c/d&255;return b+a};C.prototype.writeUIntBE=function(c,b,a,d){c=+c;b|=0;a|=0;d||ya(this,c,b,a,Math.pow(2,8*a)-1,0);d=a-1;var g=1;for(this[b+d]=c&255;0<=--d&&(g*=256);)this[b+d]=c/g&255;return b+a};
C.prototype.writeUInt8=function(c,b,a){c=+c;b|=0;a||ya(this,c,b,1,255,0);C.TYPED_ARRAY_SUPPORT||(c=Math.floor(c));this[b]=c&255;return b+1};C.prototype.writeUInt16LE=function(c,b,a){c=+c;b|=0;a||ya(this,c,b,2,65535,0);C.TYPED_ARRAY_SUPPORT?(this[b]=c&255,this[b+1]=c>>>8):kd(this,c,b,!0);return b+2};C.prototype.writeUInt16BE=function(c,b,a){c=+c;b|=0;a||ya(this,c,b,2,65535,0);C.TYPED_ARRAY_SUPPORT?(this[b]=c>>>8,this[b+1]=c&255):kd(this,c,b,!1);return b+2};C.prototype.writeUInt32LE=function(c,b,a){c=
+c;b|=0;a||ya(this,c,b,4,4294967295,0);C.TYPED_ARRAY_SUPPORT?(this[b+3]=c>>>24,this[b+2]=c>>>16,this[b+1]=c>>>8,this[b]=c&255):ld(this,c,b,!0);return b+4};C.prototype.writeUInt32BE=function(c,b,a){c=+c;b|=0;a||ya(this,c,b,4,4294967295,0);C.TYPED_ARRAY_SUPPORT?(this[b]=c>>>24,this[b+1]=c>>>16,this[b+2]=c>>>8,this[b+3]=c&255):ld(this,c,b,!1);return b+4};C.prototype.writeIntLE=function(c,b,a,d){c=+c;b|=0;d||(d=Math.pow(2,8*a-1),ya(this,c,b,a,d-1,-d));d=0;var g=1,e=0;for(this[b]=c&255;++d<a&&(g*=256);)0>
c&&0===e&&0!==this[b+d-1]&&(e=1),this[b+d]=(c/g>>0)-e&255;return b+a};C.prototype.writeIntBE=function(c,b,a,d){c=+c;b|=0;d||(d=Math.pow(2,8*a-1),ya(this,c,b,a,d-1,-d));d=a-1;var g=1,e=0;for(this[b+d]=c&255;0<=--d&&(g*=256);)0>c&&0===e&&0!==this[b+d+1]&&(e=1),this[b+d]=(c/g>>0)-e&255;return b+a};C.prototype.writeInt8=function(c,b,a){c=+c;b|=0;a||ya(this,c,b,1,127,-128);C.TYPED_ARRAY_SUPPORT||(c=Math.floor(c));0>c&&(c=255+c+1);this[b]=c&255;return b+1};C.prototype.writeInt16LE=function(c,b,a){c=+c;
b|=0;a||ya(this,c,b,2,32767,-32768);C.TYPED_ARRAY_SUPPORT?(this[b]=c&255,this[b+1]=c>>>8):kd(this,c,b,!0);return b+2};C.prototype.writeInt16BE=function(c,b,a){c=+c;b|=0;a||ya(this,c,b,2,32767,-32768);C.TYPED_ARRAY_SUPPORT?(this[b]=c>>>8,this[b+1]=c&255):kd(this,c,b,!1);return b+2};C.prototype.writeInt32LE=function(c,b,a){c=+c;b|=0;a||ya(this,c,b,4,2147483647,-2147483648);C.TYPED_ARRAY_SUPPORT?(this[b]=c&255,this[b+1]=c>>>8,this[b+2]=c>>>16,this[b+3]=c>>>24):ld(this,c,b,!0);return b+4};C.prototype.writeInt32BE=
function(c,b,a){c=+c;b|=0;a||ya(this,c,b,4,2147483647,-2147483648);0>c&&(c=4294967295+c+1);C.TYPED_ARRAY_SUPPORT?(this[b]=c>>>24,this[b+1]=c>>>16,this[b+2]=c>>>8,this[b+3]=c&255):ld(this,c,b,!1);return b+4};C.prototype.writeFloatLE=function(c,b,a){return Rg(this,c,b,!0,a)};C.prototype.writeFloatBE=function(c,b,a){return Rg(this,c,b,!1,a)};C.prototype.writeDoubleLE=function(c,b,a){return Sg(this,c,b,!0,a)};C.prototype.writeDoubleBE=function(c,b,a){return Sg(this,c,b,!1,a)};C.prototype.copy=function(c,
b,a,d){a||(a=0);d||0===d||(d=this.length);b>=c.length&&(b=c.length);b||(b=0);0<d&&d<a&&(d=a);if(d===a||0===c.length||0===this.length)return 0;if(0>b)throw new RangeError("targetStart out of bounds");if(0>a||a>=this.length)throw new RangeError("sourceStart out of bounds");if(0>d)throw new RangeError("sourceEnd out of bounds");d>this.length&&(d=this.length);c.length-b<d-a&&(d=c.length-b+a);var g=d-a;if(this===c&&a<b&&b<d)for(d=g-1;0<=d;--d)c[d+b]=this[d+a];else if(1E3>g||!C.TYPED_ARRAY_SUPPORT)for(d=
0;d<g;++d)c[d+b]=this[d+a];else Uint8Array.prototype.set.call(c,this.subarray(a,a+g),b);return g};C.prototype.fill=function(c,b,a,d){if("string"===typeof c){"string"===typeof b?(d=b,b=0,a=this.length):"string"===typeof a&&(d=a,a=this.length);if(1===c.length){var g=c.charCodeAt(0);256>g&&(c=g)}if(void 0!==d&&"string"!==typeof d)throw new TypeError("encoding must be a string");if("string"===typeof d&&!C.isEncoding(d))throw new TypeError("Unknown encoding: "+d);}else"number"===typeof c&&(c&=255);if(0>
b||this.length<b||this.length<a)throw new RangeError("Out of range index");if(a<=b)return this;b>>>=0;a=void 0===a?this.length:a>>>0;c||(c=0);if("number"===typeof c)for(d=b;d<a;++d)this[d]=c;else for(c=Wa(c)?c:jd((new C(c,d)).toString()),g=c.length,d=0;d<a-b;++d)this[d+b]=c[d%g];return this};var Ni=/[^+\/0-9A-Za-z-_]/g,fk=function(){function c(){}function b(a,b){for(var c=0,d=[],e,f,g=16;0<g&&!a[g-1];)g--;d.push({children:[],index:0});var k=d[0],t;for(e=0;e<g;e++){for(f=0;f<a[e];f++){k=d.pop();for(k.children[k.index]=
b[c];0<k.index;)k=d.pop();k.index++;for(d.push(k);d.length<=e;)d.push(t={children:[],index:0}),k.children[k.index]=t.children,k=t;c++}e+1<g&&(d.push(t={children:[],index:0}),k.children[k.index]=t.children,k=t)}return d[0].children}function a(a,b,c,d,g,r,v,q,t){function f(){if(0<J)return J--,z>>J&1;z=a[b++];if(255==z){var c=a[b++];if(c)throw Error("unexpected marker: "+(z<<8|c).toString(16));}J=7;return z>>>7}function k(a){for(var b;null!==(b=f());){a=a[b];if("number"===typeof a)return a;if("object"!==
("undefined"===typeof a?"undefined":H(a)))throw Error("invalid huffman sequence");}return null}function l(a){for(var b=0;0<a;){var c=f();if(null===c)return;b=b<<1|c;a--}return b}function m(a){var b=l(a);return b>=1<<a-1?b:b+(-1<<a)+1}function n(a,b){var c=k(a.huffmanTableDC),c=0===c?0:m(c);b[0]=a.pred+=c;for(c=1;64>c;){var d=k(a.huffmanTableAC),f=d&15,d=d>>4;if(0===f){if(15>d)break;c+=16}else c+=d,b[e[c]]=m(f),c++}}function p(a,b){var c=k(a.huffmanTableDC),c=0===c?0:m(c)<<t;b[0]=a.pred+=c}function u(a,
b){b[0]|=f()<<t}function y(a,b){if(0<E)E--;else for(var c=r;c<=v;){var d=k(a.huffmanTableAC),f=d&15,d=d>>4;if(0===f){if(15>d){E=l(d)+(1<<d)-1;break}c+=16}else c+=d,b[e[c]]=m(f)*(1<<t),c++}}function K(a,b){for(var c=r,d=0;c<=v;){var g=e[c],n=0>b[g]?-1:1;switch(C){case 0:d=k(a.huffmanTableAC);g=d&15;d>>=4;if(0===g)15>d?(E=l(d)+(1<<d),C=4):(d=16,C=1);else{if(1!==g)throw Error("invalid ACn encoding");N=m(g);C=d?2:3}continue;case 1:case 2:b[g]?b[g]+=(f()<<t)*n:(d--,0===d&&(C=2==C?3:0));break;case 3:b[g]?
b[g]+=(f()<<t)*n:(b[g]=N<<t,C=0);break;case 4:b[g]&&(b[g]+=(f()<<t)*n)}c++}4===C&&(E--,0===E&&(C=0))}var B=c.mcusPerLine,L=b,z=0,J=0,E=0,C=0,N,O=d.length,M,P,Q,R,S;q=c.progressive?0===r?0===q?p:u:0===q?y:K:n;var T=0;c=1==O?d[0].blocksPerLine*d[0].blocksPerColumn:B*c.mcusPerColumn;g||(g=c);for(var U,V;T<c;){for(P=0;P<O;P++)d[P].pred=0;E=0;if(1==O)for(M=d[0],S=0;S<g;S++)q(M,M.blocks[T/M.blocksPerLine|0][T%M.blocksPerLine]),T++;else for(S=0;S<g;S++){for(P=0;P<O;P++)for(M=d[P],U=M.h,V=M.v,Q=0;Q<V;Q++)for(R=
0;R<U;R++)q(M,M.blocks[(T/B|0)*M.v+Q][T%B*M.h+R]);T++;if(T===c)break}J=0;M=a[b]<<8|a[b+1];if(65280>M)throw Error("marker was not found");if(65488<=M&&65495>=M)b+=2;else break}return b-L}function d(a,b){a=[];for(var c=b.blocksPerLine,d=b.blocksPerColumn,e=c<<3,f=new Int32Array(64),g=new Uint8Array(64),k,t,p=0;p<d;p++){var x=p<<3;for(k=0;8>k;k++)a.push(new Uint8Array(e));for(var D=0;D<c;D++){var w,A,u,G,y,K,B,L,C;w=b.blocks[p][D];t=g;var J=f;A=b.quantizationTable;var E=J;for(k=0;64>k;k++)E[k]=w[k]*
A[k];for(k=0;8>k;++k){var z=8*k;0==E[1+z]&&0==E[2+z]&&0==E[3+z]&&0==E[4+z]&&0==E[5+z]&&0==E[6+z]&&0==E[7+z]?(w=5793*E[0+z]+512>>10,E[0+z]=w,E[1+z]=w,E[2+z]=w,E[3+z]=w,E[4+z]=w,E[5+z]=w,E[6+z]=w,E[7+z]=w):(C=5793*E[0+z]+128>>8,L=5793*E[4+z]+128>>8,B=E[2+z],K=E[6+z],y=2896*(E[1+z]-E[7+z])+128>>8,A=2896*(E[1+z]+E[7+z])+128>>8,G=E[3+z]<<4,u=E[5+z]<<4,w=C-L+1>>1,C=C+L+1>>1,L=w,w=3784*B+1567*K+128>>8,B=1567*B-3784*K+128>>8,K=w,w=y-u+1>>1,y=y+u+1>>1,u=w,w=A+G+1>>1,G=A-G+1>>1,A=w,w=C-K+1>>1,C=C+K+1>>1,K=
w,w=L-B+1>>1,L=L+B+1>>1,B=w,w=2276*y+3406*A+2048>>12,y=3406*y-2276*A+2048>>12,A=w,w=799*G+4017*u+2048>>12,G=4017*G-799*u+2048>>12,u=w,E[0+z]=C+A,E[7+z]=C-A,E[1+z]=L+u,E[6+z]=L-u,E[2+z]=B+G,E[5+z]=B-G,E[3+z]=K+y,E[4+z]=K-y)}for(k=0;8>k;++k)z=k,0==E[8+z]&&0==E[16+z]&&0==E[24+z]&&0==E[32+z]&&0==E[40+z]&&0==E[48+z]&&0==E[56+z]?(w=5793*J[k+0]+8192>>14,E[0+z]=w,E[8+z]=w,E[16+z]=w,E[24+z]=w,E[32+z]=w,E[40+z]=w,E[48+z]=w,E[56+z]=w):(C=5793*E[0+z]+2048>>12,L=5793*E[32+z]+2048>>12,B=E[16+z],K=E[48+z],y=2896*
(E[8+z]-E[56+z])+2048>>12,A=2896*(E[8+z]+E[56+z])+2048>>12,G=E[24+z],u=E[40+z],w=C-L+1>>1,C=C+L+1>>1,L=w,w=3784*B+1567*K+2048>>12,B=1567*B-3784*K+2048>>12,K=w,w=y-u+1>>1,y=y+u+1>>1,u=w,w=A+G+1>>1,G=A-G+1>>1,A=w,w=C-K+1>>1,C=C+K+1>>1,K=w,w=L-B+1>>1,L=L+B+1>>1,B=w,w=2276*y+3406*A+2048>>12,y=3406*y-2276*A+2048>>12,A=w,w=799*G+4017*u+2048>>12,G=4017*G-799*u+2048>>12,u=w,E[0+z]=C+A,E[56+z]=C-A,E[8+z]=L+u,E[48+z]=L-u,E[16+z]=B+G,E[40+z]=B-G,E[24+z]=K+y,E[32+z]=K-y);for(k=0;64>k;++k)J=128+(E[k]+8>>4),t[k]=
0>J?0:255<J?255:J;E=0;J=D<<3;for(t=0;8>t;t++)for(w=a[x+t],k=0;8>k;k++)w[J+k]=g[E++]}}return a}function g(a){return 0>a?0:255<a?255:a}var e=new Int32Array([0,1,8,16,9,2,3,10,17,24,32,25,18,11,4,5,12,19,26,33,40,48,41,34,27,20,13,6,7,14,21,28,35,42,49,56,57,50,43,36,29,22,15,23,30,37,44,51,58,59,52,45,38,31,39,46,53,60,61,54,47,55,62,63]);c.prototype={load:function(a){var b=new XMLHttpRequest;b.open("GET",a,!0);b.responseType="arraybuffer";b.onload=function(){var a=new Uint8Array(b.response||b.mozResponseArrayBuffer);
this.parse(a);if(this.onload)this.onload()}.bind(this);b.send(null)},parse:function(c){function f(){var a=c[n]<<8|c[n+1];n+=2;return a}function g(){var a=f(),a=c.subarray(n,n+a-2);n+=a.length;return a}function m(a){var b=0,c=0,d,e;for(e in a.components)a.components.hasOwnProperty(e)&&(d=a.components[e],b<d.h&&(b=d.h),c<d.v&&(c=d.v));var f=Math.ceil(a.samplesPerLine/8/b),g=Math.ceil(a.scanLines/8/c);for(e in a.components)if(a.components.hasOwnProperty(e)){d=a.components[e];for(var k=Math.ceil(Math.ceil(a.samplesPerLine/
8)*d.h/b),l=Math.ceil(Math.ceil(a.scanLines/8)*d.v/c),m=f*d.h,n=g*d.v,r=[],q=0;q<n;q++){for(var v=[],t=0;t<m;t++)v.push(new Int32Array(64));r.push(v)}d.blocksPerLine=k;d.blocksPerColumn=l;d.blocks=r}a.maxH=b;a.maxV=c;a.mcusPerLine=f;a.mcusPerColumn=g}var n=0,r=null,v=null,q,t,p=[],x=[],D=[],w=[],A=f();if(65496!=A)throw Error("SOI not found");for(A=f();65497!=A;){var u;switch(A){case 65280:break;case 65504:case 65505:case 65506:case 65507:case 65508:case 65509:case 65510:case 65511:case 65512:case 65513:case 65514:case 65515:case 65516:case 65517:case 65518:case 65519:case 65534:var G=
g();65504===A&&74===G[0]&&70===G[1]&&73===G[2]&&70===G[3]&&0===G[4]&&(r={version:{major:G[5],minor:G[6]},densityUnits:G[7],xDensity:G[8]<<8|G[9],yDensity:G[10]<<8|G[11],thumbWidth:G[12],thumbHeight:G[13],thumbData:G.subarray(14,14+3*G[12]*G[13])});65518===A&&65===G[0]&&100===G[1]&&111===G[2]&&98===G[3]&&101===G[4]&&0===G[5]&&(v={version:G[6],flags0:G[7]<<8|G[8],flags1:G[9]<<8|G[10],transformCode:G[11]});break;case 65499:for(A=f()+n-2;n<A;){var G=c[n++],y=new Int32Array(64);if(0===G>>4)for(u=0;64>
u;u++){var z=e[u];y[z]=c[n++]}else if(1===G>>4)for(u=0;64>u;u++)z=e[u],y[z]=f();else throw Error("DQT: invalid table spec");p[G&15]=y}break;case 65472:case 65473:case 65474:f();q={};q.extended=65473===A;q.progressive=65474===A;q.precision=c[n++];q.scanLines=f();q.samplesPerLine=f();q.components={};q.componentsOrder=[];G=c[n++];for(A=0;A<G;A++){var y=c[n],z=c[n+1]>>4,B=c[n+1]&15,C=c[n+2];q.componentsOrder.push(y);q.components[y]={h:z,v:B,quantizationIdx:C};n+=3}m(q);x.push(q);break;case 65476:G=f();
for(A=2;A<G;){y=c[n++];z=new Uint8Array(16);for(u=B=0;16>u;u++,n++)B+=z[u]=c[n];C=new Uint8Array(B);for(u=0;u<B;u++,n++)C[u]=c[n];A+=17+B;(0===y>>4?w:D)[y&15]=b(z,C)}break;case 65501:f();t=f();break;case 65498:f();y=c[n++];G=[];for(A=0;A<y;A++)z=q.components[c[n++]],B=c[n++],z.huffmanTableDC=w[B>>4],z.huffmanTableAC=D[B&15],G.push(z);A=c[n++];y=c[n++];z=c[n++];A=a(c,n,q,G,t,A,y,z>>4,z&15);n+=A;break;default:if(255==c[n-3]&&192<=c[n-2]&&254>=c[n-2])n-=3;else throw Error("unknown JPEG marker "+A.toString(16));
}A=f()}if(1!=x.length)throw Error("only single frame JPEGs supported");for(A=0;A<x.length;A++)for(u in t=x[A].components,t)t[u].quantizationTable=p[t[u].quantizationIdx],delete t[u].quantizationIdx;this.width=q.samplesPerLine;this.height=q.scanLines;this.jfif=r;this.adobe=v;this.components=[];for(A=0;A<q.componentsOrder.length;A++)z=q.components[q.componentsOrder[A]],this.components.push({lines:d(q,z),scaleX:z.h/q.maxH,scaleY:z.v/q.maxV})},getData:function(a,b){var c=this.width/a,d=this.height/b,
e,f,k,q,t,p,x,D,w,A,u=0,y,z,B,C,L,H,J=new Uint8Array(a*b*this.components.length);switch(this.components.length){case 1:e=this.components[0];for(A=0;A<b;A++)for(t=e.lines[0|A*e.scaleY*d],w=0;w<a;w++)y=t[0|w*e.scaleX*c],J[u++]=y;break;case 2:e=this.components[0];f=this.components[1];for(A=0;A<b;A++)for(t=e.lines[0|A*e.scaleY*d],p=f.lines[0|A*f.scaleY*d],w=0;w<a;w++)y=t[0|w*e.scaleX*c],J[u++]=y,y=p[0|w*f.scaleX*c],J[u++]=y;break;case 3:H=!0;this.adobe&&this.adobe.transformCode?H=!0:"undefined"!==typeof this.colorTransform&&
(H=!!this.colorTransform);e=this.components[0];f=this.components[1];k=this.components[2];for(A=0;A<b;A++)for(t=e.lines[0|A*e.scaleY*d],p=f.lines[0|A*f.scaleY*d],x=k.lines[0|A*k.scaleY*d],w=0;w<a;w++)H?(y=t[0|w*e.scaleX*c],z=p[0|w*f.scaleX*c],B=x[0|w*k.scaleX*c],q=g(y+1.402*(B-128)),D=g(y-.3441363*(z-128)-.71413636*(B-128)),y=g(y+1.772*(z-128))):(q=t[0|w*e.scaleX*c],D=p[0|w*f.scaleX*c],y=x[0|w*k.scaleX*c]),J[u++]=q,J[u++]=D,J[u++]=y;break;case 4:if(!this.adobe)throw"Unsupported color mode (4 components)";
H=!1;this.adobe&&this.adobe.transformCode?H=!0:"undefined"!==typeof this.colorTransform&&(H=!!this.colorTransform);e=this.components[0];f=this.components[1];k=this.components[2];q=this.components[3];for(A=0;A<b;A++)for(t=e.lines[0|A*e.scaleY*d],p=f.lines[0|A*f.scaleY*d],x=k.lines[0|A*k.scaleY*d],D=q.lines[0|A*q.scaleY*d],w=0;w<a;w++)H?(y=t[0|w*e.scaleX*c],z=p[0|w*f.scaleX*c],B=x[0|w*k.scaleX*c],C=D[0|w*q.scaleX*c],L=255-g(y+1.402*(B-128)),B=255-g(y-.3441363*(z-128)-.71413636*(B-128)),y=255-g(y+1.772*
(z-128))):(L=t[0|w*e.scaleX*c],B=p[0|w*f.scaleX*c],y=x[0|w*k.scaleX*c],C=D[0|w*q.scaleX*c]),J[u++]=255-L,J[u++]=255-B,J[u++]=255-y,J[u++]=255-C;break;default:throw"Unsupported color mode";}return J},copyToImageData:function(a){var b=a.width,c=a.height;a=a.data;var d=this.getData(b,c),e=0,f=0,v,q,t,p,x,D;switch(this.components.length){case 1:for(q=0;q<c;q++)for(v=0;v<b;v++)t=d[e++],a[f++]=t,a[f++]=t,a[f++]=t,a[f++]=255;break;case 3:for(q=0;q<c;q++)for(v=0;v<b;v++)x=d[e++],D=d[e++],t=d[e++],a[f++]=
x,a[f++]=D,a[f++]=t,a[f++]=255;break;case 4:for(q=0;q<c;q++)for(v=0;v<b;v++)x=d[e++],D=d[e++],t=d[e++],p=d[e++],x=255-g(x*(1-p/255)+p),D=255-g(D*(1-p/255)+p),t=255-g(t*(1-p/255)+p),a[f++]=x,a[f++]=D,a[f++]=t,a[f++]=255;break;default:throw"Unsupported color mode";}}};return c}(),gk={encode:function(c,b){"undefined"===typeof b&&(b=50);return{data:(new Pi(b)).encode(c,b),width:c.width,height:c.height}},decode:function(c,b){var a=new Uint8Array(c);c=new fk;c.parse(a);b={width:c.width,height:c.height,
data:b?new Uint8Array(c.width*c.height*4):new C(c.width*c.height*4)};c.copyToImageData(b);return b}},Oh=function(c){function b(){N(this,b);var a=P(this,(b.__proto__||Object.getPrototypeOf(b)).call(this));a.addInputValidator(0,ArrayBuffer);return a}M(b,c);O(b,[{key:"_run",value:function(){var a=this._getInput(0);if(a)try{var b=gk.decode(a),c=b.data.length/(b.width*b.height),e=new S,f=new Uint8Array(b.data.buffer);e.setData(f,b.width,b.height,c);this._output[0]=e}catch(k){}else console.warn('JpegDecoder requires an ArrayBuffer as input "0". Unable to continue.')}}]);
return b}(V),hk=qa(function(c){(function(){function b(){"undefined"!=typeof fc&&"development"!=fc.env.NODE_ENV||console.log.apply(console,arguments)}var a={};c.exports=a;(function(a,c){a.toRGBA8=function(c){var d=c.width,e=c.height,g=d*e,m=a.decode._getBPP(c),n=Math.ceil(d*m/8),m=new Uint8Array(4*g),r=new Uint32Array(m.buffer),v=c.data,q=c.ctype,t=c.depth,p=a._bin.readUshort;if(6==q){g<<=2;if(8==t)for(c=0;c<g;c++)m[c]=v[c];if(16==t)for(c=0;c<g;c++)m[c]=v[c<<1]}else if(2==q){c=c.tabs.tRNS;n=e=d=-1;
c&&(d=c[0],e=c[1],n=c[2]);if(8==t)for(c=0;c<g;c++)r=c<<2,q=3*c,m[r]=v[q],m[r+1]=v[q+1],m[r+2]=v[q+2],m[r+3]=255,-1!=d&&v[q]==d&&v[q+1]==e&&v[q+2]==n&&(m[r+3]=0);if(16==t)for(c=0;c<g;c++)r=c<<2,q=6*c,m[r]=v[q],m[r+1]=v[q+2],m[r+2]=v[q+4],m[r+3]=255,-1!=d&&p(v,q)==d&&p(v,q+2)==e&&p(v,q+4)==n&&(m[r+3]=0)}else if(3==q){var p=c.tabs.PLTE,x=(q=c.tabs.tRNS)?q.length:0;if(1==t)for(var D=0;D<e;D++){var w=D*n,A=D*d;for(c=0;c<d;c++){var r=A+c<<2,u=v[w+(c>>3)]>>7-((c&7)<<0)&1,y=3*u;m[r]=p[y];m[r+1]=p[y+1];m[r+
2]=p[y+2];m[r+3]=u<x?q[u]:255}}if(2==t)for(D=0;D<e;D++)for(w=D*n,A=D*d,c=0;c<d;c++)r=A+c<<2,u=v[w+(c>>2)]>>6-((c&3)<<1)&3,y=3*u,m[r]=p[y],m[r+1]=p[y+1],m[r+2]=p[y+2],m[r+3]=u<x?q[u]:255;if(4==t)for(D=0;D<e;D++)for(w=D*n,A=D*d,c=0;c<d;c++)r=A+c<<2,u=v[w+(c>>1)]>>4-((c&1)<<2)&15,y=3*u,m[r]=p[y],m[r+1]=p[y+1],m[r+2]=p[y+2],m[r+3]=u<x?q[u]:255;if(8==t)for(c=0;c<g;c++)r=c<<2,u=v[c],y=3*u,m[r]=p[y],m[r+1]=p[y+1],m[r+2]=p[y+2],m[r+3]=u<x?q[u]:255}else if(4==q){if(8==t)for(c=0;c<g;c++)r=c<<2,d=c<<1,e=v[d],
m[r]=e,m[r+1]=e,m[r+2]=e,m[r+3]=v[d+1];if(16==t)for(c=0;c<g;c++)r=c<<2,d=c<<2,e=v[d],m[r]=e,m[r+1]=e,m[r+2]=e,m[r+3]=v[d+2]}else if(0==q){d=c.tabs.tRNS?c.tabs.tRNS:-1;if(1==t)for(c=0;c<g;c++)e=255*(v[c>>3]>>7-(c&7)&1),n=e==255*d?0:255,r[c]=n<<24|e<<16|e<<8|e;if(2==t)for(c=0;c<g;c++)e=85*(v[c>>2]>>6-((c&3)<<1)&3),n=e==85*d?0:255,r[c]=n<<24|e<<16|e<<8|e;if(4==t)for(c=0;c<g;c++)e=17*(v[c>>1]>>4-((c&1)<<2)&15),n=e==17*d?0:255,r[c]=n<<24|e<<16|e<<8|e;if(8==t)for(c=0;c<g;c++)e=v[c],n=e==d?0:255,r[c]=n<<
24|e<<16|e<<8|e;if(16==t)for(c=0;c<g;c++)e=v[c<<1],n=p(v,c<<1)==d?0:255,r[c]=n<<24|e<<16|e<<8|e}else b("unsupported color type",q);return m};a.encode=function(b,c,d,g){null==g&&(g=0);var e=new Uint8Array(b);b=new Uint8Array(e.length+100);for(var f=[137,80,78,71,13,10,26,10],k=0;8>k;k++)b[k]=f[k];var f=8,l=a._bin,q=a.crc.crc;g=a.encode.compress(e,c,d,g);l.writeUint(b,f,13);f+=4;l.writeASCII(b,f,"IHDR");f+=4;l.writeUint(b,f,c);f+=4;l.writeUint(b,f,d);f+=4;b[f]=g.depth;f++;b[f]=g.ctype;f++;b[f]=0;f++;
b[f]=0;f++;b[f]=0;f++;l.writeUint(b,f,q(b,f-17,17));f+=4;l.writeUint(b,f,1);f+=4;l.writeASCII(b,f,"sRGB");f+=4;b[f]=1;f++;l.writeUint(b,f,q(b,f-5,5));f+=4;if(3==g.ctype){c=g.plte.length;l.writeUint(b,f,3*c);f+=4;l.writeASCII(b,f,"PLTE");f+=4;for(k=0;k<c;k++){d=3*k;var e=g.plte[k],t=e>>8&255,p=e>>16&255;b[f+d+0]=e&255;b[f+d+1]=t;b[f+d+2]=p}f+=3*c;l.writeUint(b,f,q(b,f-3*c-4,3*c+4));f+=4;if(g.gotAlpha){l.writeUint(b,f,c);f+=4;l.writeASCII(b,f,"tRNS");f+=4;for(k=0;k<c;k++)b[f+k]=g.plte[k]>>24&255;f+=
c;l.writeUint(b,f,q(b,f-c-4,c+4));f+=4}}c=g.data.length;l.writeUint(b,f,c);f+=4;l.writeASCII(b,f,"IDAT");f+=4;for(k=0;k<c;k++)b[f+k]=g.data[k];f+=c;l.writeUint(b,f,q(b,f-c-4,c+4));f+=4;l.writeUint(b,f,0);f+=4;l.writeASCII(b,f,"IEND");f+=4;l.writeUint(b,f,q(b,f-4,4));return b.buffer.slice(0,f+4)};a.encode.compress=function(b,c,d,g){0!=g&&(b=a.quantize(b,c,d,g));var e=6;g=8;for(var f=[],k=4,l=4*c,q=new Uint32Array(b.buffer),t=!1,p=[],x=0;x<b.length;x+=4){var u=q[x>>2];600>f.length&&null==p[u]&&(p[u]=
f.length,f.push(u));255!=b[x+3]&&(t=!0)}x=f.length;if(256>=x){g=2>=x?1:4>=x?2:16>=x?4:8;l=Math.ceil(g*c/8);e=new Uint8Array(l*d);for(b=0;b<d;b++){x=b*l;k=b*c;if(1==g)for(u=0;u<c;u++)e[x+(u>>3)]|=p[q[k+u]]<<7-(u&7);if(2==g)for(u=0;u<c;u++)e[x+(u>>2)]|=p[q[k+u]]<<6-2*(u&3);if(4==g)for(u=0;u<c;u++)e[x+(u>>1)]|=p[q[k+u]]<<4-4*(u&1);if(8==g)for(u=0;u<c;u++)e[x+u]=p[q[k+u]]}b=e;e=3;k=1}else if(0==t){e=new Uint8Array(c*d*3);l=c*d;for(x=0;x<l;x++)q=3*x,p=4*x,e[q]=b[p],e[q+1]=b[p+1],e[q+2]=b[p+2];b=e;e=2;
k=3;l=3*c}c=new Uint8Array(c*d*k+d);return{ctype:e,depth:g,plte:f,gotAlpha:t,data:a.encode._filterZero(b,d,k,l,c)}};a.encode._filterZero=function(b,d,g,l,m){for(var e=[],f=0;5>f;f++)if(!(5E5<d*l)||2!=f&&3!=f&&4!=f){for(var k=0;k<d;k++)a.encode._filterLine(m,b,k,l,g,f);e.push(c.deflate(m));if(1==g)break}var q;b=1E9;for(d=0;d<e.length;d++)e[d].length<b&&(q=d,b=e[d].length);return e[q]};a.encode._filterLine=function(b,c,d,g,m,n){var e=d*g,f=e+d,k=a.decode._paeth;b[f]=n;f++;if(0==n)for(d=0;d<g;d++)b[f+
d]=c[e+d];else if(1==n){for(d=0;d<m;d++)b[f+d]=c[e+d];for(d=m;d<g;d++)b[f+d]=c[e+d]-c[e+d-m]+256&255}else if(0==d){for(d=0;d<m;d++)b[f+d]=c[e+d];if(2==n)for(d=m;d<g;d++)b[f+d]=c[e+d];if(3==n)for(d=m;d<g;d++)b[f+d]=c[e+d]-(c[e+d-m]>>1)+256&255;if(4==n)for(d=m;d<g;d++)b[f+d]=c[e+d]-k(c[e+d-m],0,0)+256&255}else{if(2==n)for(d=0;d<g;d++)b[f+d]=c[e+d]+256-c[e+d-g]&255;if(3==n){for(d=0;d<m;d++)b[f+d]=c[e+d]+256-(c[e+d-g]>>1)&255;for(d=m;d<g;d++)b[f+d]=c[e+d]+256-(c[e+d-g]+c[e+d-m]>>1)&255}if(4==n){for(d=
0;d<m;d++)b[f+d]=c[e+d]+256-k(0,c[e+d-g],0)&255;for(d=m;d<g;d++)b[f+d]=c[e+d]+256-k(c[e+d-m],c[e+d-g],c[e+d-m-g])&255}}};a.crc={table:function(){for(var a=new Uint32Array(256),b=0;256>b;b++){for(var c=b,d=0;8>d;d++)c=c&1?3988292384^c>>>1:c>>>1;a[b]=c}return a}(),update:function(b,c,d,g){for(var e=0;e<g;e++)b=a.crc.table[(b^c[d+e])&255]^b>>>8;return b},crc:function(b,c,d){return a.crc.update(4294967295,b,c,d)^4294967295}};a.quantize=function(b,c,d,g){var e=new Uint8Array(b.length),f=new Uint16Array(c*
d);c*=d;var k=a.quantize.dist;for(d=0;d<c;d++){var l=d<<2,q=b[l+3]/255;e[l+0]=b[l+0]*q;e[l+1]=b[l+1]*q;e[l+2]=b[l+2]*q;e[l+3]=b[l+3]}for(var t=[],p=[],x=0,u=Math.max(100,10*g);;){var p=[],t=[],w=255-((1<<x)-1),A=1<<x>>1;for(d=0;d<c;d++){var l=d<<2,y=e[l],z=e[l+1],B=e[l+2],q=e[l+3],l=(y&w)+A,z=(z&w)+A,B=(B&w)+A,q=(q&w)+A,y=q<<24|B<<16|z<<8|l;p[y]?t[p[y]].occ++:(p[y]=t.length,t.push({occ:1,r:l,g:z,b:B,a:q}));if(t.length>u)break}if(t.length>u)x++;else break}if(0==x&&t.length<=g)return b;t.sort(function(a,
b){return b.occ-a.occ});g=Math.min(g,t.length);q=new Uint8Array(4*g);for(d=0;d<g;d++)l=d<<2,B=t[d],q[l]=B.r,q[l+1]=B.g,q[l+2]=B.b,q[l+3]=B.a;t=q;b=Math.max(1,Math.min(10,Math.floor(1024/g)));for(p=0;p<b;p++){x=new Uint32Array(g);u=new Uint32Array(4*g);w=new Uint32Array(g);A=new Uint32Array(g);for(d=0;d<g;d++){for(var l=d<<2,y=t[l],z=t[l+1],B=t[l+2],q=t[l+3],C=0,H=1E9,l=0;l<g;l++)if(l!=d){var L=k(y,z,B,q,t,l<<2);L<H&&(C=l,H=L)}w[d]=H;A[d]=C}for(d=0;d<c;d++){var l=d<<2,y=e[l],z=e[l+1],B=e[l+2],q=e[l+
3],C=0,H=1E9,C=f[d],H=k(y,z,B,q,t,C<<2);if(!(H<=w[C]>>1))for(l=0;l<g;l++)if(L=k(y,z,B,q,t,l<<2),L<H){C=l;H=L;if(L<=w[C]>>1)break;L=k(y,z,B,q,t,A[l]<<2);if(L<=w[C]>>1){C=A[l];break}}f[d]=C;x[C]++;C<<=2;u[C]+=y;u[C+1]+=z;u[C+2]+=B;u[C+3]+=q}for(d=0;d<g;d++)l=d<<2,q=1/x[d],t[l]=u[l]*q,t[l+1]=u[l+1]*q,t[l+2]=u[l+2]*q,t[l+3]=u[l+3]*q}for(d=0;d<c;d++)l=d<<2,C=f[d],C<<=2,g=0==t[C+3]?0:255/t[C+3],e[l+0]=t[C+0]*g,e[l+1]=t[C+1]*g,e[l+2]=t[C+2]*g,e[l+3]=t[C+3];return e};a.quantize.dist=function(a,b,c,d,g,n){var e=
g[n],f=g[n+1],k=g[n+2];g=g[n+3];return(e-a)*(e-a)+(f-b)*(f-b)+(k-c)*(k-c)+(g-d)*(g-d)};a.quantize.dither=function(b,c,d,g,m,n){for(var e=new Float32Array(c*d*4),f=a.quantize.dist,k=Math.round,l=c<<2,p=0;p<d;p++)for(var x=0;x<c;x++){for(var u=p*c+x,w=u<<2,A=0;4>A;A++)e[w+A]=Math.max(-8,Math.min(8,e[w+A]));for(var y=k(b[w]+e[w]),z=k(b[w+1]+e[w+1]),B=k(b[w+2]+e[w+2]),C=k(b[w+3]+e[w+3]),H=0,L=1E9,A=0;A<n;A++){var M=f(y,z,B,C,m,A<<2);M<L&&(H=A,L=M)}g[u]=H;u=H<<2;y-=m[u];z-=m[u+1];B-=m[u+2];C-=m[u+3];e[w+
4+0]+=.4375*y;e[w+4+1]+=.4375*z;e[w+4+2]+=.4375*B;e[w+4+3]+=.4375*C;e[w+l-4+0]+=.1875*y;e[w+l-4+1]+=.1875*z;e[w+l-4+2]+=.1875*B;e[w+l-4+3]+=.1875*C;e[w+l+0]+=.3125*y;e[w+l+1]+=.3125*z;e[w+l+2]+=.3125*B;e[w+l+3]+=.3125*C;e[w+l+4+0]+=.0625*y;e[w+l+4+1]+=.0625*z;e[w+l+4+2]+=.0625*B;e[w+l+4+3]+=.0625*C}};a.decode=function(c){c=new Uint8Array(c);for(var d=8,e=a._bin,g=e.readUshort,m={tabs:{}},n=new Uint8Array(c.length),r=0;;){var v=e.readUint(c,d),d=d+4,q=e.readASCII(c,d,4),d=d+4;if("IHDR"==q)a.decode._IHDR(c,
d,m);else if("IDAT"==q){for(var p=0;p<v;p++)n[r+p]=c[d+p];r+=v}else if("pHYs"==q)m.tabs[q]=[e.readUint(c,d),e.readUint(c,d+4),c[d+8]];else if("cHRM"==q)for(m.tabs[q]=[],p=0;8>p;p++)m.tabs[q].push(e.readUint(c,d+4*p));else if("tEXt"==q){null==m.tabs[q]&&(m.tabs[q]={});var u=e.nextZero(c,d),p=e.readASCII(c,d,u-d),u=e.readASCII(c,u+1,d+v-u-1);m.tabs[q][p]=u}else if("iTXt"==q){null==m.tabs[q]&&(m.tabs[q]={});var x=d,u=e.nextZero(c,x),p=e.readASCII(c,x,u-x),x=u+1,x=x+2,u=e.nextZero(c,x);e.readASCII(c,
x,u-x);x=u+1;u=e.nextZero(c,x);e.readUTF8(c,x,u-x);x=u+1;u=e.readUTF8(c,x,v-(x-d));m.tabs[q][p]=u}else if("PLTE"==q)m.tabs[q]=e.readBytes(c,d,v);else if("hIST"==q)for(u=m.tabs.PLTE.length/3,m.tabs[q]=[],p=0;p<u;p++)m.tabs[q].push(g(c,d+2*p));else if("tRNS"==q)3==m.ctype?m.tabs[q]=e.readBytes(c,d,v):0==m.ctype?m.tabs[q]=g(c,d):2==m.ctype?m.tabs[q]=[g(c,d),g(c,d+2),g(c,d+4)]:b("tRNS for unsupported color type",m.ctype,v);else if("gAMA"==q)m.tabs[q]=e.readUint(c,d)/1E5;else if("sRGB"==q)m.tabs[q]=c[d];
else if("bKGD"==q)0==m.ctype||4==m.ctype?m.tabs[q]=[g(c,d)]:2==m.ctype||6==m.ctype?m.tabs[q]=[g(c,d),g(c,d+2),g(c,d+4)]:3==m.ctype&&(m.tabs[q]=c[d]);else if("IEND"==q){0==m.compress?n=a.decode._inflate(n):b("unsupported compression method:",m.interlace);0!=m.filter&&b("unsupported filter method:",m.filter);0==m.interlace?m.data=a.decode._filterZero(n,m,0,m.width,m.height):1==m.interlace?m.data=a.decode._readInterlace(n,m):b("unsupported interlace method:",m.interlace);break}else b("unknown chunk type",
q,v);d+=v;e.readUint(c,d);d+=4}delete m.compress;delete m.interlace;delete m.filter;return m};a.decode._inflate=function(a){return c.inflate(a)};a.decode._readInterlace=function(b,c){for(var d=c.width,e=c.height,g=a.decode._getBPP(c),f=g>>3,r=Math.ceil(d*g/8),v=new Uint8Array(e*r),q=0,p=[0,0,4,0,2,0,1],u=[0,4,0,2,0,1,0],x=[8,8,8,4,4,2,2],D=[8,8,4,4,2,2,1],w=0;7>w;){for(var A=x[w],y=D[w],z=0,B=0,C=p[w];C<e;)C+=A,B++;for(C=u[w];C<d;)C+=y,z++;C=Math.ceil(z*g/8);a.decode._filterZero(b,c,q,z,B);for(var H=
0,L=p[w];L<e;){for(var M=u[w],J=q+H*C<<3;M<d;){if(1==g){var E=b[J>>3],E=E>>7-(J&7)&1;v[L*r+(M>>3)]|=E<<7-((M&3)<<0)}2==g&&(E=b[J>>3],E=E>>6-(J&7)&3,v[L*r+(M>>2)]|=E<<6-((M&3)<<1));4==g&&(E=b[J>>3],E=E>>4-(J&7)&15,v[L*r+(M>>1)]|=E<<4-((M&1)<<2));if(8<=g)for(var E=L*r+M*f,N=0;N<f;N++)v[E+N]=b[(J>>3)+N];J+=g;M+=y}H++;L+=A}0!=z*B&&(q+=B*(1+C));w+=1}return v};a.decode._getBPP=function(a){var c=[1,null,3,1,2,null,4][a.ctype];null==c&&b("unsupported color type",a.ctype);return c*a.depth};a.decode._filterZero=
function(b,c,d,g,m){c=a.decode._getBPP(c);g=Math.ceil(g*c/8);var e=a.decode._paeth;c=Math.ceil(c/8);for(var f=0;f<m;f++){var k=d+f*g,l=k+f+1,p=b[l-1];if(0==p)for(var u=0;u<g;u++)b[k+u]=b[l+u];else if(1==p){for(u=0;u<c;u++)b[k+u]=b[l+u];for(u=c;u<g;u++)b[k+u]=b[l+u]+b[k+u-c]&255}else if(0==f){for(u=0;u<c;u++)b[k+u]=b[l+u];if(2==p)for(u=c;u<g;u++)b[k+u]=b[l+u]&255;if(3==p)for(u=c;u<g;u++)b[k+u]=b[l+u]+(b[k+u-c]>>1)&255;if(4==p)for(u=c;u<g;u++)b[k+u]=b[l+u]+e(b[k+u-c],0,0)&255}else{if(2==p)for(u=0;u<
g;u++)b[k+u]=b[l+u]+b[k+u-g]&255;if(3==p){for(u=0;u<c;u++)b[k+u]=b[l+u]+(b[k+u-g]>>1)&255;for(u=c;u<g;u++)b[k+u]=b[l+u]+(b[k+u-g]+b[k+u-c]>>1)&255}if(4==p){for(u=0;u<c;u++)b[k+u]=b[l+u]+e(0,b[k+u-g],0)&255;for(u=c;u<g;u++)b[k+u]=b[l+u]+e(b[k+u-c],b[k+u-g],b[k+u-c-g])&255}}}return b};a.decode._paeth=function(a,b,c){var d=a+b-c,e=Math.abs(d-a),g=Math.abs(d-b),d=Math.abs(d-c);return e<=g&&e<=d?a:g<=d?b:c};a.decode._IHDR=function(b,c,d){var e=a._bin;d.width=e.readUint(b,c);c+=4;d.height=e.readUint(b,
c);c+=4;d.depth=b[c];c++;d.ctype=b[c];c++;d.compress=b[c];c++;d.filter=b[c];c++;d.interlace=b[c]};a._bin={nextZero:function(a,b){for(;0!=a[b];)b++;return b},readUshort:function(a,b){return a[b]<<8|a[b+1]},writeUshort:function(a,b,c){a[b]=c>>8&255;a[b+1]=c&255},readUint:function(a,b){return 16777216*a[b]+(a[b+1]<<16|a[b+2]<<8|a[b+3])},writeUint:function(a,b,c){a[b]=c>>24&255;a[b+1]=c>>16&255;a[b+2]=c>>8&255;a[b+3]=c&255},readASCII:function(a,b,c){for(var d="",e=0;e<c;e++)d+=String.fromCharCode(a[b+
e]);return d},writeASCII:function(a,b,c){for(var d=0;d<c.length;d++)a[b+d]=c.charCodeAt(d)},readBytes:function(a,b,c){for(var d=[],e=0;e<c;e++)d.push(a[b+e]);return d},pad:function(a){return 2>a.length?"0"+a:a},readUTF8:function(b,c,d){for(var e="",g,f=0;f<d;f++)e+="%"+a._bin.pad(b[c+f].toString(16));try{g=decodeURIComponent(e)}catch(r){return a._bin.readASCII(b,c,d)}return g}}})(a,"function"==typeof hb?Da:window.pako)})()}),Ph=function(c){function b(){N(this,b);var a=P(this,(b.__proto__||Object.getPrototypeOf(b)).call(this));
a.addInputValidator(0,ArrayBuffer);return a}M(b,c);O(b,[{key:"_run",value:function(){var a=this._getInput(0);if(a)if(this._isPng(a))try{var b=hk.decode(a),c=Math.round(b.data.length/(b.width*b.height)),e=new S,f=new b.data.constructor(b.data.buffer,0,b.width*b.height*c);e.setData(f,b.width,b.height,c);this._output[0]=e}catch(k){console.warn(k)}else console.warn("This is not a PNG file, unable to decode this file.");else console.warn('PngDecoder requires an ArrayBuffer as input "0". Unable to continue.')}},
{key:"_isPng",value:function(a){a=new Uint8Array(a,0,8);for(var b=new Uint8Array([137,80,78,71,13,10,26,10]),c=0;c<a.length;c++)if(a[c]!=b[c])return!1;return!0}}]);return b}(V),ik=function(c){function b(){N(this,b);var a=P(this,(b.__proto__||Object.getPrototypeOf(b)).call(this));a._decoders=[Dh,Oh,Ph,qe];return a}M(b,c);O(b,[{key:"_run",value:function(){var a=this._getInput(0);if(a)for(var b=0;b<this._decoders.length;b++){var c=new this._decoders[b];c.addInput(a);c.update();if(c.getNumberOfOutputs()){this._output[0]=
c.getOutput();this.setMetadata("decoderConstructor",this._decoders[b]);this.setMetadata("decoderName",this._decoders[b].name);break}}else console.warn("The input buffer must not be null.")}}]);return b}(V);(function(){function c(a){this.value=a}function b(a){function b(d,e){try{var f=a[d](e),k=f.value;k instanceof c?Promise.resolve(k.value).then(function(a){b("next",a)},function(a){b("throw",a)}):g(f.done?"return":"normal",f.value)}catch(r){g("throw",r)}}function g(a,c){switch(a){case "return":e.resolve({value:c,
done:!0});break;case "throw":e.reject(c);break;default:e.resolve({value:c,done:!1})}(e=e.next)?b(e.key,e.arg):f=null}var e,f;this._invoke=function(a,c){return new Promise(function(d,g){d={key:a,arg:c,resolve:d,reject:g,next:null};f?f=f.next=d:(e=f=d,b(a,c))})};"function"!==typeof a.return&&(this.return=void 0)}"function"===typeof Symbol&&Symbol.asyncIterator&&(b.prototype[Symbol.asyncIterator]=function(){return this});b.prototype.next=function(a){return this._invoke("next",a)};b.prototype.throw=function(a){return this._invoke("throw",
a)};b.prototype.return=function(a){return this._invoke("return",a)};return{wrap:function(a){return function(){return new b(a.apply(this,arguments))}},await:function(a){return new c(a)}}})();var jk=function(){function c(b,a){for(var c=0;c<a.length;c++){var g=a[c];g.enumerable=g.enumerable||!1;g.configurable=!0;"value"in g&&(g.writable=!0);Object.defineProperty(b,g.key,g)}}return function(b,a,d){a&&c(b.prototype,a);d&&c(b,d);return b}}(),kk=function(){function c(){if(!(this instanceof c))throw new TypeError("Cannot call a class as a function");
this._shapeData=this._tempResult=this._stackIndex=this._stack=null}jk(c,[{key:"copy",value:function(b){this._stack=b._stack;this._stackIndex=b._stackIndex;this._tempResult=b._tempResult;this._shapeData=b._shapeData}},{key:"parse",value:function(b){try{this._parseRawData(b),this._arrangeData()}catch(a){console.warn("MNI OBJ file is invalid."),console.warn(a)}}},{key:"_parseRawData",value:function(b){this._stack=b.trim().split(/\s+/).reverse();this._stackIndex=this._stack.length-1;this._tempResult=
{};b=this._popStack();var a,c,g,e,f,k;this._tempResult.type="P"===b?"polygon":"L"===b?"line":b;if("polygon"===this._tempResult.type)this._parseSurfProp(),this._tempResult.numVertices=parseInt(this._popStack(),10),this._parseVertices(),this._parseNormals(),this._tempResult.nitems=parseInt(this._popStack(),10);else if("line"===this._tempResult.type)this._parseSurfProp(),this._tempResult.numVertices=parseInt(this._popStack(),10),this._parseVertices(),this._tempResult.nitems=parseInt(this._popStack(),
10);else{this._tempResult.error=!0;this._tempResult.errorMessage='Invalid MNI Object class: must be "polygon" or "line"';return}this._parseColors();this._parseEndIndices();this._parseIndices();if("polygon"!==this._tempResult.type&&"line"===this._tempResult.type){g=this._tempResult.indices;e=this._tempResult.endIndices;c=this._tempResult.nitems;for(var l=f=k=0;l<c;l++)a=0===l?0:e[l-1],b=e[l],f+=2*(b-a-1);f=new Uint32Array(f);for(l=0;l<c;l++){a=0===l?0:e[l-1];f[k++]=g[a];b=e[l];for(a+=1;a<b-1;a++)f[k++]=
g[a],f[k++]=g[a];f[k++]=g[b-1]}this._tempResult.indices=f}}},{key:"_arrangeData",value:function(){this._shapeData={type:this._tempResult.type,vertices:this._tempResult.vertices,normals:this._tempResult.normals,colors:this._tempResult.colors,surfaceProperties:this._tempResult.surfaceProperties,error:this._tempResult.error,errorMessage:this._tempResult.errorMessage};var b=[this._shapeData.vertices.buffer,this._shapeData.colors.buffer];this._shapeData.normals&&b.push(this._shapeData.normals.buffer);
this._shapeData.shapes=this._tempResult.indices;b.push(this._tempResult.indices.buffer);4===this._shapeData.colors.length&&this._unrollColors()}},{key:"_unrollColors",value:function(){var b,a,c,g,e=this._shapeData.vertices.length/3*4,f=new Uint8Array(e);b=this._shapeData.colors[0];a=this._shapeData.colors[1];c=this._shapeData.colors[2];g=this._shapeData.colors[3];for(var k=0;k<e;k+=4)f[k]=255*b,f[k+1]=255*a,f[k+2]=255*c,f[k+3]=255*g;this._shapeData.colors=f}},{key:"_parseSurfProp",value:function(){"polygon"===
this._tempResult.type?this._tempResult.surfaceProperties={ambient:parseFloat(this._popStack()),diffuse:parseFloat(this._popStack()),specularReflectance:parseFloat(this._popStack()),specularScattering:parseFloat(this._popStack()),transparency:parseFloat(this._popStack())}:"line"===this._tempResult.type&&(this._tempResult.surfaceProperties={width:this._popStack()})}},{key:"_parseVertices",value:function(){for(var b=3*this._tempResult.numVertices,a=new Float32Array(b),c=0;c<b;c++)a[c]=parseFloat(this._popStack());
this._tempResult.vertices=a}},{key:"_parseNormals",value:function(){for(var b=3*this._tempResult.numVertices,a=new Float32Array(b),c=0;c<b;c++)a[c]=parseFloat(this._popStack());this._tempResult.normals=a}},{key:"_parseColors",value:function(){var b=parseInt(this._popStack(),10),a,c;if(0===b){a=new Float32Array(4);for(var g=0;4>g;g++)a[g]=parseFloat(this._popStack())}else if(1===b)for(c=4*this._tempResult.num_polygons,a=new Float32Array(c),g=0;g<c;g++)a[g]=parseFloat(this._popStack());else if(2===
b)for(c=4*this._tempResult.numVertices,a=new Float32Array(c),g=0;g<c;g++)a[g]=parseFloat(this._popStack());else this._tempResult.error=!0,this._tempResult.errorMessage="Invalid color flag: "+b;this._tempResult.colorFlag=b;this._tempResult.colors=a}},{key:"_parseEndIndices",value:function(){for(var b=this._tempResult.nitems,a=new Uint32Array(b),c=0;c<b;c++)a[c]=parseInt(this._popStack(),10);this._tempResult.endIndices=a}},{key:"_parseIndices",value:function(){for(var b=this._stackIndex+1,a=new Uint32Array(b),
c=0;c<b;c++)a[c]=parseInt(this._popStack(),10);this._tempResult.indices=a}},{key:"_popStack",value:function(){return this._stack[this._stackIndex--]}},{key:"isValid",value:function(){return!this._shapeData.error}},{key:"getErrorMessage",value:function(){return this._shapeData.errorMessage}},{key:"getShapeData",value:function(){return this._shapeData}},{key:"getShapeRawIndices",value:function(){return this._shapeData.error?(console.warn("ERROR while parsing: "+this._shapeData.errorMessage),null):this._shapeData.shapes}},
{key:"getRawVertices",value:function(){return this._shapeData.error?(console.warn("ERROR while parsing: "+this._shapeData.errorMessage),null):this._shapeData.vertices}},{key:"getRawNormals",value:function(){return this._shapeData.error?(console.warn("ERROR while parsing: "+this._shapeData.errorMessage),null):this._shapeData.normals}},{key:"getRawColors",value:function(){return this._shapeData.error?(console.warn("ERROR while parsing: "+this._shapeData.errorMessage),null):this._shapeData.colors}},
{key:"getSurfaceProperties",value:function(){return this._shapeData.error?(console.warn("ERROR while parsing: "+this._shapeData.errorMessage),null):this._shapeData.surfaceProperties}},{key:"getType",value:function(){return this._shapeData.type}},{key:"isPolygon",value:function(){return"polygon"===this._shapeData.type}},{key:"isLine",value:function(){return"line"===this._shapeData.type}}]);return c}(),lk=function(c){function b(){N(this,b);return P(this,(b.__proto__||Object.getPrototypeOf(b)).call(this))}
M(b,c);O(b,[{key:"_run",value:function(){var a=this._getInput();if("string"!==typeof a)console.warn("The input data for MniObjDecoder ust be a String.");else{var b=new kk;b.parse(a);if(b.isValid())if(b.isPolygon()){var a=b.getRawVertices(),c=b.getShapeRawIndices(),e=b.getRawNormals(),f=b.getRawColors();b.getSurfaceProperties();b=new me;b.setVertexPositions(a);b.setPolygonFacesOrder(c);b.setPolygonFacesNormals(e);b.setVertexColors(f);b.setNumberOfVerticesPerShapes(3);b.setNumberOfComponentsPerColor(4);
this._output[0]=b}else console.warn("The MNI OBJ file is valid but does not describe a 3D mesh.");else console.warn("Invalid MNI OBJ file.\nERROR: "+b.getErrorMessage())}}}]);return b}(V),xd=function(c,b){return b={exports:{}},c(b,b.exports),b.exports}(function(c){function b(a){this.value=a}function a(a,b,c){var e=[],g=[],n=!0;return function D(a){function r(){if("object"===H(w.node)&&null!==w.node){w.keys&&w.node_===w.node||(w.keys=f(w.node));w.isLeaf=0==w.keys.length;for(var b=0;b<g.length;b++)if(g[b].node_===
a){w.circular=g[b];break}}else w.isLeaf=!0,w.keys=null;w.notLeaf=!w.isLeaf;w.notRoot=!w.isRoot}var q,p,v,t,u=!0,w={node:c?d(a):a,node_:a,path:[].concat(e),parent:g[g.length-1],parents:g,key:e.slice(-1)[0],isRoot:0===e.length,level:e.length,circular:null,update:function(a,b){w.isRoot||(w.parent.node[w.key]=a);w.node=a;b&&(u=!1)},"delete":function(a){delete w.parent.node[w.key];a&&(u=!1)},remove:function(a){k(w.parent.node)?w.parent.node.splice(w.key,1):delete w.parent.node[w.key];a&&(u=!1)},keys:null,
before:function(a){q=a},after:function(a){p=a},pre:function(a){v=a},post:function(a){t=a},stop:function(){n=!1},block:function(){u=!1}};if(!n)return w;r();var y=b.call(w,w.node);void 0!==y&&w.update&&w.update(y);q&&q.call(w,w.node);if(!u)return w;"object"!=H(w.node)||null===w.node||w.circular||(g.push(w),r(),l(w.keys,function(a,b){e.push(a);v&&v.call(w,w.node[a],a);var d=D(w.node[a]);c&&m.call(w.node,a)&&(w.node[a]=d.node);d.isLast=b==w.keys.length-1;d.isFirst=0==b;t&&t.call(w,d);e.pop()}),g.pop());
p&&p.call(w,w.node);return w}(a).node}function d(a){if("object"===("undefined"===typeof a?"undefined":H(a))&&null!==a){var b;if(k(a))b=[];else if("[object Date]"===g(a))b=new Date(a.getTime?a.getTime():a);else if("[object RegExp]"===g(a))b=new RegExp(a);else if("[object Error]"===g(a))b={message:a.message};else if("[object Boolean]"===g(a))b=new Boolean(a);else if("[object Number]"===g(a))b=new Number(a);else if("[object String]"===g(a))b=new String(a);else if(Object.create&&Object.getPrototypeOf)b=
Object.create(Object.getPrototypeOf(a));else if(a.constructor===Object)b={};else{var c=function(){};c.prototype=a.constructor&&a.constructor.prototype||a.__proto__||{};b=new c}l(f(a),function(c){b[c]=a[c]});return b}return a}function g(a){return Object.prototype.toString.call(a)}var e=c.exports=function(a){return new b(a)};b.prototype.get=function(a){for(var b=this.value,c=0;c<a.length;c++){var d=a[c];if(!b||!m.call(b,d)){b=void 0;break}b=b[d]}return b};b.prototype.has=function(a){for(var b=this.value,
c=0;c<a.length;c++){var d=a[c];if(!b||!m.call(b,d))return!1;b=b[d]}return!0};b.prototype.set=function(a,b){for(var c=this.value,d=0;d<a.length-1;d++){var e=a[d];m.call(c,e)||(c[e]={});c=c[e]}return c[a[d]]=b};b.prototype.map=function(b){return a(this.value,b,!0)};b.prototype.forEach=function(b){return this.value=a(this.value,b,!1)};b.prototype.reduce=function(a,b){var c=1===arguments.length,d=c?this.value:b;this.forEach(function(b){this.isRoot&&c||(d=a.call(this,d,b))});return d};b.prototype.paths=
function(){var a=[];this.forEach(function(b){a.push(this.path)});return a};b.prototype.nodes=function(){var a=[];this.forEach(function(b){a.push(this.node)});return a};b.prototype.clone=function(){var a=[],b=[];return function q(c){for(var e=0;e<a.length;e++)if(a[e]===c)return b[e];if("object"===("undefined"===typeof c?"undefined":H(c))&&null!==c){var g=d(c);a.push(c);b.push(g);l(f(c),function(a){g[a]=q(c[a])});a.pop();b.pop();return g}return c}(this.value)};var f=Object.keys||function(a){var b=[],
c;for(c in a)b.push(c);return b},k=Array.isArray||function(a){return"[object Array]"===Object.prototype.toString.call(a)},l=function(a,b){if(a.forEach)return a.forEach(b);for(var c=0;c<a.length;c++)b(a[c],c,a)};l(f(b.prototype),function(a){e[a]=function(c){var d=[].slice.call(arguments,1),e=new b(c);return e[a].apply(e,d)}});var m=Object.hasOwnProperty||function(a,b){return b in a}});(function(){function c(a){this.value=a}function b(a){function b(d,e){try{var f=a[d](e),k=f.value;k instanceof c?Promise.resolve(k.value).then(function(a){b("next",
a)},function(a){b("throw",a)}):g(f.done?"return":"normal",f.value)}catch(r){g("throw",r)}}function g(a,c){switch(a){case "return":e.resolve({value:c,done:!0});break;case "throw":e.reject(c);break;default:e.resolve({value:c,done:!1})}(e=e.next)?b(e.key,e.arg):f=null}var e,f;this._invoke=function(a,c){return new Promise(function(d,g){d={key:a,arg:c,resolve:d,reject:g,next:null};f?f=f.next=d:(e=f=d,b(a,c))})};"function"!==typeof a.return&&(this.return=void 0)}"function"===typeof Symbol&&Symbol.asyncIterator&&
(b.prototype[Symbol.asyncIterator]=function(){return this});b.prototype.next=function(a){return this._invoke("next",a)};b.prototype.throw=function(a){return this._invoke("throw",a)};b.prototype.return=function(a){return this._invoke("return",a)};return{wrap:function(a){return function(){return new b(a.apply(this,arguments))}},await:function(a){return new c(a)}}})();var mk=function(){function c(b,a){for(var c=0;c<a.length;c++){var g=a[c];g.enumerable=g.enumerable||!1;g.configurable=!0;"value"in g&&
(g.writable=!0);Object.defineProperty(b,g.key,g)}}return function(b,a,d){a&&c(b.prototype,a);d&&c(b,d);return b}}(),Ja=function(){function c(){if(!(this instanceof c))throw new TypeError("Cannot call a class as a function");}mk(c,null,[{key:"isPlatformLittleEndian",value:function(){var b=new Uint32Array([305419896]);return 18!=(new Uint8Array(b.buffer,b.byteOffset,b.byteLength))[0]}},{key:"arrayBufferToUnicode",value:function(b){b=new Uint8Array(b);for(var a=[],c=0,g=0;c<b.length;){var e=b[c++];if(128>
e)a[g++]=String.fromCharCode(e);else if(191<e&&224>e){var f=b[c++];a[g++]=String.fromCharCode((e&31)<<6|f&63)}else if(239<e&&365>e){var f=b[c++],k=b[c++],l=b[c++],e=((e&7)<<18|(f&63)<<12|(k&63)<<6|l&63)-65536;a[g++]=String.fromCharCode(55296+(e>>10));a[g++]=String.fromCharCode(56320+(e&1023))}else f=b[c++],k=b[c++],a[g++]=String.fromCharCode((e&15)<<12|(f&63)<<6|k&63)}return a.join("")}},{key:"unicodeToArrayBuffer",value:function(b){for(var a=[],c=0,g=0;g<b.length;g++){var e=b.charCodeAt(g);128>e?
a[c++]=e:(2048>e?a[c++]=e>>6|192:(55296==(e&64512)&&g+1<b.length&&56320==(b.charCodeAt(g+1)&64512)?(e=65536+((e&1023)<<10)+(b.charCodeAt(++g)&1023),a[c++]=e>>18|240,a[c++]=e>>12&63|128):a[c++]=e>>12|224,a[c++]=e>>6&63|128),a[c++]=e&63|128)}return(new Uint8Array(a)).buffer}},{key:"arrayBufferToString8",value:function(b){return String.fromCharCode.apply(null,new Uint8Array(b))}},{key:"string8ToArrayBuffer",value:function(b){for(var a=new ArrayBuffer(b.length),c=new Uint8Array(a),g=0;g<b.length;g++)c[g]=
b.charCodeAt(g);return a}},{key:"setString8InBuffer",value:function(b,a){var c=2<arguments.length&&void 0!==arguments[2]?arguments[2]:0;if(0>c)console.warn("The byte offset cannot be negative.");else if(a&&a instanceof ArrayBuffer)if(b.length+c>a.byteLength)console.warn("The string is too long to be writen in this buffer.");else for(var g=new Uint8Array(a),e=0;e<b.length;e++)g[e+c]=b.charCodeAt(e);else console.warn("The buffer must be a valid ArrayBuffer.")}},{key:"getString8FromBuffer",value:function(b,
a){var c=2<arguments.length&&void 0!==arguments[2]?arguments[2]:0;return 0>c?(console.warn("The byte offset cannot be negative."),null):b&&b instanceof ArrayBuffer?a+c>b.byteLength?(console.warn("The string is too long to be writen in this buffer."),null):String.fromCharCode.apply(null,new Uint8Array(b,c,a)):(console.warn("The buffer must be a valid ArrayBuffer."),null)}},{key:"objectToArrayBuffer",value:function(b){var a=null;b=c.makeSerializeFriendly(b);try{var d=JSON.stringify(b),a=c.unicodeToArrayBuffer(d)}catch(g){console.warn(g)}return a}},
{key:"ArrayBufferToObject",value:function(b){var a=null;try{var d=c.arrayBufferToUnicode(b),a=JSON.parse(d)}catch(g){console.warn(g)}return a}},{key:"isTypedArray",value:function(b){return b instanceof Int8Array||b instanceof Uint8Array||b instanceof Uint8ClampedArray||b instanceof Int16Array||b instanceof Uint16Array||b instanceof Int32Array||b instanceof Uint32Array||b instanceof Float32Array||b instanceof Float64Array}},{key:"mergeBuffers",value:function(b){for(var a=0,c=0;c<b.length;c++)a+=b[c].byteLength;
for(var a=new Uint8Array(a),g=0,c=0;c<b.length;c++)a.set(new Uint8Array(b[c]),g),g+=b[c].byteLength;return a.buffer}},{key:"getGlobalObject",value:function(){var b=null;try{b=window}catch(a){try{b=GLOBAL}catch(d){return console.warn("You are not in a Javascript environment?? Weird."),null}}return b}},{key:"extractTypedArray",value:function(b,a,c,g){if(!b)return console.warn("Input Buffer is null."),null;if(!(b instanceof ArrayBuffer))return console.warn("Buffer must be of type ArrayBuffer"),null;
if(0>=g)return console.warn("The number of elements to fetch must be greater than 0"),null;if(0>a)return console.warn("The byte offset must be possitive or 0"),null;if(a>=b.byteLength)return console.warn("The offset cannot be larger than the size of the buffer."),null;if(c instanceof Function&&!("BYTES_PER_ELEMENT"in c))return console.warn("ArrayType must be a typed array constructor function."),null;if(c.BYTES_PER_ELEMENT*g+a>b.byteLength)console.warn("The requested number of elements is too large for this buffer");
else return b=b.slice(a,a+g*c.BYTES_PER_ELEMENT),new c(b)}},{key:"getTypedArrayInfo",value:function(b){var a=null,c=!1;b instanceof Int8Array?(a="int",c=!1):b instanceof Uint8Array?(a="int",c=!0):b instanceof Uint8ClampedArray?(a="int",c=!0):b instanceof Int16Array?(a="int",c=!1):b instanceof Uint16Array?(a="int",c=!0):b instanceof Int32Array?(a="int",c=!1):b instanceof Uint32Array?(a="int",c=!0):b instanceof Float32Array?(a="float",c=!1):b instanceof Float64Array&&(a="float",c=!1);return{type:a,
signed:c,bytesPerElements:b.BYTES_PER_ELEMENT,byteLength:b.byteLength,length:b.length}}},{key:"howManyTypedArrayAttributes",value:function(b){var a=0;xd(b).forEach(function(b){a+=c.isTypedArray(b)});return a}},{key:"hasCircularReference",value:function(b){var a=!1;xd(b).forEach(function(b){this.circular&&(a=!0)});return a}},{key:"removeCircularReference",value:function(b){var a=!1;b=xd(b).map(function(b){this.circular&&(this.remove(),a=!0)});return a?b:null}},{key:"replaceTypedArrayAttributesByArrays",
value:function(b){var a=!1;b=xd(b).map(function(b){if(c.isTypedArray(b)){for(var d=Object.keys(b).length,e=Array(d),f=0;f<d;f++)e[f]=b[f];this.update(e);a=!0}});return a?b:null}},{key:"makeSerializeFriendly",value:function(b){var a=c.removeCircularReference(b);a&&(b=a);(a=c.replaceTypedArrayAttributesByArrays(b))&&(b=a);return b}}]);return c}();(function(){function c(a){this.value=a}function b(a){function b(d,e){try{var f=a[d](e),k=f.value;k instanceof c?Promise.resolve(k.value).then(function(a){b("next",
a)},function(a){b("throw",a)}):g(f.done?"return":"normal",f.value)}catch(r){g("throw",r)}}function g(a,c){switch(a){case "return":e.resolve({value:c,done:!0});break;case "throw":e.reject(c);break;default:e.resolve({value:c,done:!1})}(e=e.next)?b(e.key,e.arg):f=null}var e,f;this._invoke=function(a,c){return new Promise(function(d,g){d={key:a,arg:c,resolve:d,reject:g,next:null};f?f=f.next=d:(e=f=d,b(a,c))})};"function"!==typeof a.return&&(this.return=void 0)}"function"===typeof Symbol&&Symbol.asyncIterator&&
(b.prototype[Symbol.asyncIterator]=function(){return this});b.prototype.next=function(a){return this._invoke("next",a)};b.prototype.throw=function(a){return this._invoke("throw",a)};b.prototype.return=function(a){return this._invoke("return",a)};return{wrap:function(a){return function(){return new b(a.apply(this,arguments))}},await:function(a){return new c(a)}}})();var Qh=function(c,b){if(!(c instanceof b))throw new TypeError("Cannot call a class as a function");},Rh=function(){function c(b,a){for(var c=
0;c<a.length;c++){var g=a[c];g.enumerable=g.enumerable||!1;g.configurable=!0;"value"in g&&(g.writable=!0);Object.defineProperty(b,g.key,g)}}return function(b,a,d){a&&c(b.prototype,a);d&&c(b,d);return b}}(),nk=function(){function c(b,a,d){Qh(this,c);this._header=b;this._physicalSignals=d;this._rawSignals=a}Rh(c,[{key:"getRecordDuration",value:function(){return this._header.durationDataRecordsSec}},{key:"getRecordingID",value:function(){return this._header.localRecordingId}},{key:"getNumberOfRecords",
value:function(){return this._header.nbDataRecords}},{key:"getNumberOfSignals",value:function(){return this._header.nbSignals}},{key:"getPatientID",value:function(){return this._header.patientId}},{key:"getRecordingStartDate",value:function(){return this._header.recordingDate}},{key:"getReservedField",value:function(){var b=0<arguments.length&&void 0!==arguments[0]?arguments[0]:-1;return-1===b?this._header.reserved:0<=b&&b<this._header.signalInfo.length?this._header.signalInfo[b].reserved:null}},
{key:"getSignalDigitalMax",value:function(b){return 0>b||b>=this._header.signalInfo.length?(console.warn("Signal index is out of range"),null):this._header.signalInfo[b].digitalMaximum}},{key:"getSignalDigitalMin",value:function(b){return 0>b||b>=this._header.signalInfo.length?(console.warn("Signal index is out of range"),null):this._header.signalInfo[b].digitalMinimum}},{key:"getSignalPhysicalMin",value:function(b){return 0>b||b>=this._header.signalInfo.length?(console.warn("Signal index is out of range"),
null):this._header.signalInfo[b].physicalMinimum}},{key:"getSignalPhysicalMax",value:function(b){return 0>b||b>=this._header.signalInfo.length?(console.warn("Signal index is out of range"),null):this._header.signalInfo[b].physicalMaximum}},{key:"getSignalLabel",value:function(b){return 0>b||b>=this._header.signalInfo.length?(console.warn("Signal index is out of range"),null):this._header.signalInfo[b].label}},{key:"getSignalNumberOfSamplesPerRecord",value:function(b){return 0>b||b>=this._header.signalInfo.length?
(console.warn("Signal index is out of range"),null):this._header.signalInfo[b].nbOfSamples}},{key:"getSignalPhysicalUnit",value:function(b){return 0>b||b>=this._header.signalInfo.length?(console.warn("Signal index is out of range"),null):this._header.signalInfo[b].physicalDimension}},{key:"getSignalPrefiltering",value:function(b){return 0>b||b>=this._header.signalInfo.length?(console.warn("Signal index is out of range"),null):this._header.signalInfo[b].prefiltering}},{key:"getSignalTransducerType",
value:function(b){return 0>b||b>=this._header.signalInfo.length?(console.warn("Signal index is out of range"),null):this._header.signalInfo[b].transducerType}},{key:"getSignalSamplingFrequency",value:function(b){return 0>b||b>=this._header.signalInfo.length?(console.warn("Signal index is out of range"),null):this._header.signalInfo[b].nbOfSamples/this._header.durationDataRecordsSec}},{key:"getPhysicalSignal",value:function(b,a){return 0>b||b>=this._header.signalInfo.length?(console.warn("Signal index is out of range"),
null):0>a&&a>=this._physicalSignals[b].length?(console.warn("Record index is out of range"),null):this._physicalSignals[b][a]}},{key:"getRawSignal",value:function(b,a){return 0>b||b>=this._header.signalInfo.length?(console.warn("Signal index is out of range"),null):0>a&&a>=this._rawSignals[b].length?(console.warn("Record index is out of range"),null):this._rawSignals[b][a]}},{key:"getPhysicalSignalConcatRecords",value:function(b){var a=1<arguments.length&&void 0!==arguments[1]?arguments[1]:-1,c=2<
arguments.length&&void 0!==arguments[2]?arguments[2]:-1;if(0>b||b>=this._header.signalInfo.length)return console.warn("Signal index is out of range"),null;if(0>a&&a>=this._physicalSignals[b].length)return console.warn("The index recordStart is out of range"),null;-1===a&&(a=0);-1===c?c=this._physicalSignals[b].length-a:a+c>this._physicalSignals[b].length&&(console.warn("The number of requested records is too large. Forcing only to available records."),c=this._physicalSignals[b].length-a);var g=a+
c-1;if(0>g&&g>=this._physicalSignals[b].length)return console.warn("Too many records to concatenate, this goes out of range."),null;for(var e=0,g=a;g<a+c;g++)e+=this._physicalSignals[b][g].length;for(var e=new Float32Array(e),f=0,g=a;g<a+c;g++)e.set(this._physicalSignals[b][g],f),f+=this._physicalSignals[b][g].length;return e}}]);return c}(),ok=function(){function c(){Qh(this,c);this._output=this._inputBuffer=null}Rh(c,[{key:"setInput",value:function(b){this._output=null;this._inputBuffer=b}},{key:"decode",
value:function(){try{var b=this._decodeHeader();this._decodeData(b.offset,b.header)}catch(a){console.warn(a)}}},{key:"_decodeHeader",value:function(){function b(b){for(var d=[],e=0;e<a.nbSignals;e++)d.push(Ja.getString8FromBuffer(f._inputBuffer,b,c).trim()),c+=b;return d}if(this._inputBuffer){var a={},c=0;a.dataFormat=Ja.getString8FromBuffer(this._inputBuffer,8,c).trim();c+=8;a.patientId=Ja.getString8FromBuffer(this._inputBuffer,80,c).trim();c+=80;a.localRecordingId=Ja.getString8FromBuffer(this._inputBuffer,
80,c).trim();var c=c+80,g=Ja.getString8FromBuffer(this._inputBuffer,8,c).trim(),c=c+8,e=Ja.getString8FromBuffer(this._inputBuffer,8,c).trim(),c=c+8,g=g.split("."),e=e.split(".");a.recordingDate=new Date(g[2],g[1],g[0],e[0],e[1],e[2],0);a.nbBytesHeaderRecord=parseInt(Ja.getString8FromBuffer(this._inputBuffer,8,c).trim());c+=8;a.reserved=Ja.getString8FromBuffer(this._inputBuffer,44,c);c+=44;a.nbDataRecords=parseInt(Ja.getString8FromBuffer(this._inputBuffer,8,c).trim());c+=8;a.durationDataRecordsSec=
parseInt(Ja.getString8FromBuffer(this._inputBuffer,8,c).trim());c+=8;a.nbSignals=parseInt(Ja.getString8FromBuffer(this._inputBuffer,4,c).trim());var c=c+4,f=this,e=b(16),g=b(80),k=b(8),l=b(8),m=b(8),n=b(8),r=b(8),p=b(80),q=b(8),t=b(32),u=[];a.signalInfo=u;for(var x=0;x<a.nbSignals;x++)u.push({label:e[x],transducerType:g[x],physicalDimension:k[x],physicalMinimum:parseFloat(l[x]),physicalMaximum:parseFloat(m[x]),digitalMinimum:parseInt(n[x]),digitalMaximum:parseInt(r[x]),prefiltering:p[x],nbOfSamples:parseInt(q[x]),
reserved:t[x]});return{offset:c,header:a}}console.warn("A input buffer must be specified.")}},{key:"_decodeData",value:function(b,a){if(this._inputBuffer)if(a){for(var c=Int16Array,g=Array(a.nbSignals),e=Array(a.nbSignals),f=0;f<a.nbSignals;f++)g[f]=Array(a.nbDataRecords),e[f]=Array(a.nbDataRecords);for(var k=0;k<a.nbDataRecords;k++)for(f=0;f<a.nbSignals;f++){var l=a.signalInfo[f].nbOfSamples,m=Ja.extractTypedArray(this._inputBuffer,b,c,l);b+=l*c.BYTES_PER_ELEMENT;g[f][k]=m;for(var n=(new Float32Array(m.length)).fill(0),
r=a.signalInfo[f].digitalMaximum-a.signalInfo[f].digitalMinimum,p=a.signalInfo[f].physicalMaximum-a.signalInfo[f].physicalMinimum,q=0;q<l;q++)n[q]=(m[q]-a.signalInfo[f].digitalMinimum)/r*p+a.signalInfo[f].physicalMinimum;e[f][k]=n}this._output=new nk(a,g,e)}else console.warn("Invalid header");else console.warn("A input buffer must be specified.")}},{key:"getOutput",value:function(){return this._output}}]);return c}(),pk=function(c){function b(){N(this,b);var a=P(this,(b.__proto__||Object.getPrototypeOf(b)).call(this));
a.addInputValidator(0,ArrayBuffer);a.setMetadata("debug",!1);a.setMetadata("concatenateRecords",!0);return a}M(b,c);O(b,[{key:"_run",value:function(){var a=this._getInput(0);if(a){var b=new ok;b.setInput(a);b.decode();if(a=b.getOutput())for(var b=a.getNumberOfSignals(),c=a.getNumberOfRecords(),e=0;e<b;e++){var f=new za;f.setData(a.getPhysicalSignalConcatRecords(e));f.setMetadata("numberOfRecords",c);f.setMetadata("patientID",a.getPatientID());f.setMetadata("recordDuration",a.getRecordDuration());
f.setMetadata("recordingID",a.getRecordingID());f.setMetadata("recordingStartDate",a.getRecordingStartDate());f.setMetadata("reservedField",a.getReservedField());f.setMetadata("signalLabel",a.getSignalLabel(e));f.setMetadata("numberOfSamplesPerRecord",a.getSignalNumberOfSamplesPerRecord(e));f.setMetadata("signalPhysicalMax",a.getSignalPhysicalMax(e));f.setMetadata("signalPhysicalMin",a.getSignalPhysicalMin(e));f.setMetadata("signalPhysicalUnit",a.getSignalPhysicalUnit(e));f.setMetadata("signalPrefiltering",
a.getSignalPrefiltering(e));f.setMetadata("signalTransducerType",a.getSignalTransducerType(e));f.setMetadata("samplingFrequency",a.getSignalSamplingFrequency(e));this._output[e]=f}else console.warn("Invalid EDF file.")}else console.warn('EdfDecoder requires an ArrayBuffer as input "0". Unable to continue.')}}]);return b}(V);"use strict";var Ti=function(c){for(var b=Array(c),a=0;a<c;++a)b[a]=a;return b},Vi="undefined"!==typeof Float64Array,nd={float32:[],float64:[],int8:[],int16:[],int32:[],uint8:[],
uint16:[],uint32:[],array:[],uint8_clamped:[],buffer:[],generic:[]},Ka=function(c,b,a,d){if(void 0===c){var g=nd.array[0];return g([])}"number"===typeof c&&(c=[c]);void 0===b&&(b=[c.length]);g=b.length;if(void 0===a){a=Array(g);for(var e=g-1,f=1;0<=e;--e)a[e]=f,f*=b[e]}if(void 0===d)for(e=d=0;e<g;++e)0>a[e]&&(d-=(b[e]-1)*a[e]);e=Ui(c);for(f=nd[e];f.length<=g+1;)f.push(Si(e,f.length-1));g=f[g+1];return g(c,b,a,d)};"use strict";var Sh=function(c,b){for(var a=1,d=0;d<c.length;++d)a*=c[d];return Ka(new (Wi(b||
"float64"))(a),c)},qk=function(c){function b(){N(this,b);var a=P(this,(b.__proto__||Object.getPrototypeOf(b)).call(this));a.addInputValidator(0,S);a.setMetadata("componentOffset",0);return a}M(b,c);O(b,[{key:"_run",value:function(){if(this.hasValidInput()){for(var a=this._getInput(0),b=a.getMetadata("width"),c=a.getMetadata("height"),e=a.getMetadata("ncpp"),f=this.getMetadata("componentOffset"),a=Ka(a.getData(),[b,c,e]),f=a.pick(null,null,f),a=Sh([b,c],a.dtype),e=0;e<b;e++)for(var k=0;k<c;k++)a.set(e,
k,f.get(e,k));f=new S;f.setData(a.data,b,c,1);this._output[0]=f}else console.warn("A filter of type ComponentProjectionImage2DFilter requires 1 input of Image2D.")}}]);return b}(V),rk=function(c){function b(){N(this,b);var a=P(this,(b.__proto__||Object.getPrototypeOf(b)).call(this));a.addInputValidator("ALL",S);return a}M(b,c);O(b,[{key:"_run",value:function(){var a=this;if(2>this.getNumberOfInputs())console.warn("A filter of type ComponentMergeImage2DFilter needs 2 or more inputs.");else if(this.hasValidInput()){var b=
this.getInputCategories().map(function(b){return a._getInput(b)});if(Xi(b)){var c=b[0].getMetadata("width"),e=b[0].getMetadata("height"),f=b.map(function(a){return a.getMetadata("ncpp")}).reduce(function(a,b){return a+b}),k=Ka(b[0].getData()).dtype,l=Sh([c,e,f],k),m=0;b.forEach(function(a,b){b=a.getMetadata("ncpp");a=Ka(a.getData(),[c,e,b]);for(var d=0;d<c;d++)for(var g=0;g<e;g++)for(var f=0;f<b;f++)l.set(d,g,m+f,a.get(d,g,f));m+=b});this._output[0]=new S;this._output[0].setData(l.data,c,e,f)}else console.warn("A filter of type ComponentMergeImage2DFilter requires inputs to be the same dimensions and array type")}else console.warn("A filter of type ComponentMergeImage2DFilter requires inputs of Image2D.")}}]);
return b}(V);"use strict";"use strict";var sk=function(c,b){for(var a=b[1].length-Math.abs(c.arrayBlockIndices[0])|0,d=Array(c.arrayArgs.length),g=Array(c.arrayArgs.length),e=0;e<c.arrayArgs.length;++e)g[e]=b[2*e],d[e]=b[2*e+1];for(var f=[],k=[],l=[],m=[],n=[],e=0;e<c.arrayArgs.length;++e){0>c.arrayBlockIndices[e]?(l.push(0),m.push(a),f.push(a),k.push(a+c.arrayBlockIndices[e])):(l.push(c.arrayBlockIndices[e]),m.push(c.arrayBlockIndices[e]+a),f.push(0),k.push(c.arrayBlockIndices[e]));for(var r=[],
p=0;p<d[e].length;p++)l[e]<=d[e][p]&&d[e][p]<m[e]&&r.push(d[e][p]-l[e]);n.push(r)}k=["SS"];m=["'use strict'"];r=[];for(p=0;p<a;++p)r.push(["s",p,"=SS[",p,"]"].join(""));for(e=0;e<c.arrayArgs.length;++e){k.push("a"+e);k.push("t"+e);k.push("p"+e);for(p=0;p<a;++p)r.push(["t",e,"p",p,"=t",e,"[",l[e]+p,"]"].join(""));for(p=0;p<Math.abs(c.arrayBlockIndices[e]);++p)r.push(["t",e,"b",p,"=t",e,"[",f[e]+p,"]"].join(""))}for(e=0;e<c.scalarArgs.length;++e)k.push("Y"+e);0<c.shapeArgs.length&&r.push("shape=SS.slice(0)");
if(0<c.indexArgs.length){p=Array(a);for(e=0;e<a;++e)p[e]="0";r.push(["index=[",p.join(","),"]"].join(""))}for(e=0;e<c.offsetArgs.length;++e){f=c.offsetArgs[e];l=[];for(p=0;p<f.offset.length;++p)0!==f.offset[p]&&(1===f.offset[p]?l.push(["t",f.array,"p",p].join("")):l.push([f.offset[p],"*t",f.array,"p",p].join("")));0===l.length?r.push("q"+e+"=0"):r.push(["q",e,"=",l.join("+")].join(""))}e=[].concat(c.pre.thisVars).concat(c.body.thisVars).concat(c.post.thisVars);if(0!==e.length){e.sort();for(var p=
1,f=e.length,l=e[0],q,t=1;t<f;++t)q=l,l=e[t],l!==q&&(t===p?p++:e[p++]=l);e.length=p}r=r.concat(e);0<r.length&&m.push("var "+r.join(","));for(e=0;e<c.arrayArgs.length;++e)m.push("p"+e+"|=0");3<c.pre.body.length&&m.push(ke(c.pre,c,g));r=ke(c.body,c,g);a:for(e=0,p=n[0].length;e<p;){for(f=1;f<n.length;++f)if(n[f][e]!==n[0][e])break a;++e}e<a?m.push(Yi(e,n[0],c,r)):m.push(Zg(n[0],c,r));3<c.post.body.length&&m.push(ke(c.post,c,g));c.debug&&console.log("-----Generated cwise routine for ",b,":\n"+m.join("\n")+
"\n----------");c=[c.funcName||"unnamed","_cwise_loop_",d[0].join("s"),"m",e,Zi(g)].join("");return(new Function(["function ",c,"(",k.join(","),"){",m.join("\n"),"} return ",c].join("")))()};"use strict";"use strict";var Ba=function(c){var b=new $i;b.pre=c.pre;b.body=c.body;b.post=c.post;var a=c.args.slice(0);b.argTypes=a;for(var d=0;d<a.length;++d){var g=a[d];if("array"===g||"object"===("undefined"===typeof g?"undefined":H(g))&&g.blockIndices){b.argTypes[d]="array";b.arrayArgs.push(d);b.arrayBlockIndices.push(g.blockIndices?
g.blockIndices:0);b.shimArgs.push("array"+d);if(d<b.pre.args.length&&0<b.pre.args[d].count)throw Error("cwise: pre() block may not reference array args");if(d<b.post.args.length&&0<b.post.args[d].count)throw Error("cwise: post() block may not reference array args");}else if("scalar"===g)b.scalarArgs.push(d),b.shimArgs.push("scalar"+d);else if("index"===g){b.indexArgs.push(d);if(d<b.pre.args.length&&0<b.pre.args[d].count)throw Error("cwise: pre() block may not reference array index");if(d<b.body.args.length&&
b.body.args[d].lvalue)throw Error("cwise: body() block may not write to array index");if(d<b.post.args.length&&0<b.post.args[d].count)throw Error("cwise: post() block may not reference array index");}else if("shape"===g){b.shapeArgs.push(d);if(d<b.pre.args.length&&b.pre.args[d].lvalue)throw Error("cwise: pre() block may not write to array shape");if(d<b.body.args.length&&b.body.args[d].lvalue)throw Error("cwise: body() block may not write to array shape");if(d<b.post.args.length&&b.post.args[d].lvalue)throw Error("cwise: post() block may not write to array shape");
}else if("object"===("undefined"===typeof g?"undefined":H(g))&&g.offset)b.argTypes[d]="offset",b.offsetArgs.push({array:g.array,offset:g.offset}),b.offsetArgIndex.push(d);else throw Error("cwise: Unknown argument type "+a[d]);}if(0>=b.arrayArgs.length)throw Error("cwise: No array arguments specified");if(b.pre.args.length>a.length)throw Error("cwise: Too many arguments in pre() block");if(b.body.args.length>a.length)throw Error("cwise: Too many arguments in body() block");if(b.post.args.length>a.length)throw Error("cwise: Too many arguments in post() block");
b.debug=!!c.printCode||!!c.debug;b.funcName=c.funcName||"cwise";b.blockSize=c.blockSize||64;c=["'use strict'","var CACHED={}"];a=[];c.push(["return function ",b.funcName+"_cwise_thunk","(",b.shimArgs.join(","),"){"].join(""));for(var d=[],g=[],e=[["array",b.arrayArgs[0],".shape.slice(",Math.max(0,b.arrayBlockIndices[0]),0>b.arrayBlockIndices[0]?","+b.arrayBlockIndices[0]+")":")"].join("")],f=[],k=[],l=0;l<b.arrayArgs.length;++l){var m=b.arrayArgs[l];a.push(["t",m,"=array",m,".dtype,r",m,"=array",
m,".order"].join(""));d.push("t"+m);d.push("r"+m);g.push("t"+m);g.push("r"+m+".join()");e.push("array"+m+".data");e.push("array"+m+".stride");e.push("array"+m+".offset|0");0<l&&(f.push("array"+b.arrayArgs[0]+".shape.length===array"+m+".shape.length+"+(Math.abs(b.arrayBlockIndices[0])-Math.abs(b.arrayBlockIndices[l]))),k.push("array"+b.arrayArgs[0]+".shape[shapeIndex+"+Math.max(0,b.arrayBlockIndices[0])+"]===array"+m+".shape[shapeIndex+"+Math.max(0,b.arrayBlockIndices[l])+"]"))}1<b.arrayArgs.length&&
(c.push("if (!("+f.join(" && ")+")) throw new Error('cwise: Arrays do not all have the same dimensionality!')"),c.push("for(var shapeIndex=array"+b.arrayArgs[0]+".shape.length-"+Math.abs(b.arrayBlockIndices[0])+"; shapeIndex--\x3e0;) {"),c.push("if (!("+k.join(" && ")+")) throw new Error('cwise: Arrays do not all have the same shape!')"),c.push("}"));for(l=0;l<b.scalarArgs.length;++l)e.push("scalar"+b.scalarArgs[l]);a.push(["type=[",g.join(","),"].join()"].join(""));a.push("proc=CACHED[type]");c.push("var "+
a.join(","));c.push(["if(!proc){CACHED[type]=proc=compile([",d.join(","),"])}return proc(",e.join(","),")}"].join(""));b.debug&&console.log("-----Generated thunk:\n"+c.join("\n")+"\n----------");return(new Function("compile",c.join("\n")))(sk.bind(void 0,b))},jc=qa(function(c,b){function a(a){if(!a)return g;for(var b=0;b<a.args.length;++b){var c=a.args[b];a.args[b]=0===b?{name:c,lvalue:!0,rvalue:!!a.rvalue,count:a.count||1}:{name:c,lvalue:!1,rvalue:!0,count:1}}a.thisVars||(a.thisVars=[]);a.localVars||
(a.localVars=[]);return a}function d(b){for(var c=[],d=0;d<b.args.length;++d)c.push("a"+d);c=new Function("P",["return function ",b.funcName,"_ndarrayops(",c.join(","),") {P(",c.join(","),");return a0}"].join(""));b=Ba({args:b.args,pre:a(b.pre),body:a(b.body),post:a(b.proc),funcName:b.funcName});return c(b)}var g={body:"",args:[],thisVars:[],localVars:[]},e={add:"+",sub:"-",mul:"*",div:"/",mod:"%",band:"&",bor:"|",bxor:"^",lshift:"<<",rshift:">>",rrshift:">>>"};(function(){for(var a in e){var c=e[a];
b[a]=d({args:["array","array","array"],body:{args:["a","b","c"],body:"a=b"+c+"c"},funcName:a});b[a+"eq"]=d({args:["array","array"],body:{args:["a","b"],body:"a"+c+"=b"},rvalue:!0,funcName:a+"eq"});b[a+"s"]=d({args:["array","array","scalar"],body:{args:["a","b","s"],body:"a=b"+c+"s"},funcName:a+"s"});b[a+"seq"]=d({args:["array","scalar"],body:{args:["a","s"],body:"a"+c+"=s"},rvalue:!0,funcName:a+"seq"})}})();var f={not:"!",bnot:"~",neg:"-",recip:"1.0/"};(function(){for(var a in f){var c=f[a];b[a]=
d({args:["array","array"],body:{args:["a","b"],body:"a="+c+"b"},funcName:a});b[a+"eq"]=d({args:["array"],body:{args:["a"],body:"a="+c+"a"},rvalue:!0,count:2,funcName:a+"eq"})}})();var k={and:"&&",or:"||",eq:"===",neq:"!==",lt:"<",gt:">",leq:"<=",geq:">="};(function(){for(var a in k){var c=k[a];b[a]=d({args:["array","array","array"],body:{args:["a","b","c"],body:"a=b"+c+"c"},funcName:a});b[a+"s"]=d({args:["array","array","scalar"],body:{args:["a","b","s"],body:"a=b"+c+"s"},funcName:a+"s"});b[a+"eq"]=
d({args:["array","array"],body:{args:["a","b"],body:"a=a"+c+"b"},rvalue:!0,count:2,funcName:a+"eq"});b[a+"seq"]=d({args:["array","scalar"],body:{args:["a","s"],body:"a=a"+c+"s"},rvalue:!0,count:2,funcName:a+"seq"})}})();var l="abs acos asin atan ceil cos exp floor log round sin sqrt tan".split(" ");(function(){for(var a=0;a<l.length;++a){var c=l[a];b[c]=d({args:["array","array"],pre:{args:[],body:"this_f=Math."+c,thisVars:["this_f"]},body:{args:["a","b"],body:"a=this_f(b)",thisVars:["this_f"]},funcName:c});
b[c+"eq"]=d({args:["array"],pre:{args:[],body:"this_f=Math."+c,thisVars:["this_f"]},body:{args:["a"],body:"a=this_f(a)",thisVars:["this_f"]},rvalue:!0,count:2,funcName:c+"eq"})}})();var m=["max","min","atan2","pow"];(function(){for(var a=0;a<m.length;++a){var c=m[a];b[c]=d({args:["array","array","array"],pre:{args:[],body:"this_f=Math."+c,thisVars:["this_f"]},body:{args:["a","b","c"],body:"a=this_f(b,c)",thisVars:["this_f"]},funcName:c});b[c+"s"]=d({args:["array","array","scalar"],pre:{args:[],body:"this_f=Math."+
c,thisVars:["this_f"]},body:{args:["a","b","c"],body:"a=this_f(b,c)",thisVars:["this_f"]},funcName:c+"s"});b[c+"eq"]=d({args:["array","array"],pre:{args:[],body:"this_f=Math."+c,thisVars:["this_f"]},body:{args:["a","b"],body:"a=this_f(a,b)",thisVars:["this_f"]},rvalue:!0,count:2,funcName:c+"eq"});b[c+"seq"]=d({args:["array","scalar"],pre:{args:[],body:"this_f=Math."+c,thisVars:["this_f"]},body:{args:["a","b"],body:"a=this_f(a,b)",thisVars:["this_f"]},rvalue:!0,count:2,funcName:c+"seq"})}})();var n=
["atan2","pow"];(function(){for(var a=0;a<n.length;++a){var c=n[a];b[c+"op"]=d({args:["array","array","array"],pre:{args:[],body:"this_f=Math."+c,thisVars:["this_f"]},body:{args:["a","b","c"],body:"a=this_f(c,b)",thisVars:["this_f"]},funcName:c+"op"});b[c+"ops"]=d({args:["array","array","scalar"],pre:{args:[],body:"this_f=Math."+c,thisVars:["this_f"]},body:{args:["a","b","c"],body:"a=this_f(c,b)",thisVars:["this_f"]},funcName:c+"ops"});b[c+"opeq"]=d({args:["array","array"],pre:{args:[],body:"this_f=Math."+
c,thisVars:["this_f"]},body:{args:["a","b"],body:"a=this_f(b,a)",thisVars:["this_f"]},rvalue:!0,count:2,funcName:c+"opeq"});b[c+"opseq"]=d({args:["array","scalar"],pre:{args:[],body:"this_f=Math."+c,thisVars:["this_f"]},body:{args:["a","b"],body:"a=this_f(b,a)",thisVars:["this_f"]},rvalue:!0,count:2,funcName:c+"opseq"})}})();b.any=Ba({args:["array"],pre:g,body:{args:[{name:"a",lvalue:!1,rvalue:!0,count:1}],body:"if(a){return true}",localVars:[],thisVars:[]},post:{args:[],localVars:[],thisVars:[],
body:"return false"},funcName:"any"});b.all=Ba({args:["array"],pre:g,body:{args:[{name:"x",lvalue:!1,rvalue:!0,count:1}],body:"if(!x){return false}",localVars:[],thisVars:[]},post:{args:[],localVars:[],thisVars:[],body:"return true"},funcName:"all"});b.sum=Ba({args:["array"],pre:{args:[],localVars:[],thisVars:["this_s"],body:"this_s=0"},body:{args:[{name:"a",lvalue:!1,rvalue:!0,count:1}],body:"this_s+=a",localVars:[],thisVars:["this_s"]},post:{args:[],localVars:[],thisVars:["this_s"],body:"return this_s"},
funcName:"sum"});b.prod=Ba({args:["array"],pre:{args:[],localVars:[],thisVars:["this_s"],body:"this_s=1"},body:{args:[{name:"a",lvalue:!1,rvalue:!0,count:1}],body:"this_s*=a",localVars:[],thisVars:["this_s"]},post:{args:[],localVars:[],thisVars:["this_s"],body:"return this_s"},funcName:"prod"});b.norm2squared=Ba({args:["array"],pre:{args:[],localVars:[],thisVars:["this_s"],body:"this_s=0"},body:{args:[{name:"a",lvalue:!1,rvalue:!0,count:2}],body:"this_s+=a*a",localVars:[],thisVars:["this_s"]},post:{args:[],
localVars:[],thisVars:["this_s"],body:"return this_s"},funcName:"norm2squared"});b.norm2=Ba({args:["array"],pre:{args:[],localVars:[],thisVars:["this_s"],body:"this_s=0"},body:{args:[{name:"a",lvalue:!1,rvalue:!0,count:2}],body:"this_s+=a*a",localVars:[],thisVars:["this_s"]},post:{args:[],localVars:[],thisVars:["this_s"],body:"return Math.sqrt(this_s)"},funcName:"norm2"});b.norminf=Ba({args:["array"],pre:{args:[],localVars:[],thisVars:["this_s"],body:"this_s=0"},body:{args:[{name:"a",lvalue:!1,rvalue:!0,
count:4}],body:"if(-a>this_s){this_s=-a}else if(a>this_s){this_s=a}",localVars:[],thisVars:["this_s"]},post:{args:[],localVars:[],thisVars:["this_s"],body:"return this_s"},funcName:"norminf"});b.norm1=Ba({args:["array"],pre:{args:[],localVars:[],thisVars:["this_s"],body:"this_s=0"},body:{args:[{name:"a",lvalue:!1,rvalue:!0,count:3}],body:"this_s+=a<0?-a:a",localVars:[],thisVars:["this_s"]},post:{args:[],localVars:[],thisVars:["this_s"],body:"return this_s"},funcName:"norm1"});b.sup=Ba({args:["array"],
pre:{body:"this_h=-Infinity",args:[],thisVars:["this_h"],localVars:[]},body:{body:"if(_inline_1_arg0_>this_h)this_h=_inline_1_arg0_",args:[{name:"_inline_1_arg0_",lvalue:!1,rvalue:!0,count:2}],thisVars:["this_h"],localVars:[]},post:{body:"return this_h",args:[],thisVars:["this_h"],localVars:[]}});b.inf=Ba({args:["array"],pre:{body:"this_h=Infinity",args:[],thisVars:["this_h"],localVars:[]},body:{body:"if(_inline_1_arg0_<this_h)this_h=_inline_1_arg0_",args:[{name:"_inline_1_arg0_",lvalue:!1,rvalue:!0,
count:2}],thisVars:["this_h"],localVars:[]},post:{body:"return this_h",args:[],thisVars:["this_h"],localVars:[]}});b.argmin=Ba({args:["index","array","shape"],pre:{body:"{this_v=Infinity;this_i=_inline_0_arg2_.slice(0)}",args:[{name:"_inline_0_arg0_",lvalue:!1,rvalue:!1,count:0},{name:"_inline_0_arg1_",lvalue:!1,rvalue:!1,count:0},{name:"_inline_0_arg2_",lvalue:!1,rvalue:!0,count:1}],thisVars:["this_i","this_v"],localVars:[]},body:{body:"{if(_inline_1_arg1_<this_v){this_v=_inline_1_arg1_;for(var _inline_1_k=0;_inline_1_k<_inline_1_arg0_.length;++_inline_1_k){this_i[_inline_1_k]=_inline_1_arg0_[_inline_1_k]}}}",
args:[{name:"_inline_1_arg0_",lvalue:!1,rvalue:!0,count:2},{name:"_inline_1_arg1_",lvalue:!1,rvalue:!0,count:2}],thisVars:["this_i","this_v"],localVars:["_inline_1_k"]},post:{body:"{return this_i}",args:[],thisVars:["this_i"],localVars:[]}});b.argmax=Ba({args:["index","array","shape"],pre:{body:"{this_v=-Infinity;this_i=_inline_0_arg2_.slice(0)}",args:[{name:"_inline_0_arg0_",lvalue:!1,rvalue:!1,count:0},{name:"_inline_0_arg1_",lvalue:!1,rvalue:!1,count:0},{name:"_inline_0_arg2_",lvalue:!1,rvalue:!0,
count:1}],thisVars:["this_i","this_v"],localVars:[]},body:{body:"{if(_inline_1_arg1_>this_v){this_v=_inline_1_arg1_;for(var _inline_1_k=0;_inline_1_k<_inline_1_arg0_.length;++_inline_1_k){this_i[_inline_1_k]=_inline_1_arg0_[_inline_1_k]}}}",args:[{name:"_inline_1_arg0_",lvalue:!1,rvalue:!0,count:2},{name:"_inline_1_arg1_",lvalue:!1,rvalue:!0,count:2}],thisVars:["this_i","this_v"],localVars:["_inline_1_k"]},post:{body:"{return this_i}",args:[],thisVars:["this_i"],localVars:[]}});b.random=d({args:["array"],
pre:{args:[],body:"this_f=Math.random",thisVars:["this_f"]},body:{args:["a"],body:"a=this_f()",thisVars:["this_f"]},funcName:"random"});b.assign=d({args:["array","array"],body:{args:["a","b"],body:"a=b"},funcName:"assign"});b.assigns=d({args:["array","scalar"],body:{args:["a","b"],body:"a=b"},funcName:"assigns"});b.equals=Ba({args:["array","array"],pre:g,body:{args:[{name:"x",lvalue:!1,rvalue:!0,count:1},{name:"y",lvalue:!1,rvalue:!0,count:1}],body:"if(x!==y){return false}",localVars:[],thisVars:[]},
post:{args:[],localVars:[],thisVars:[],body:"return true"},funcName:"equals"})});"use strict";"use restrict";var Rc=Array(256);(function(c){for(var b=0;256>b;++b){for(var a=b,d=b,g=7,a=a>>>1;a;a>>>=1)d<<=1,d|=a&1,--g;c[b]=d<<g&255}})(Rc);var Ca={INT_BITS:32,INT_MAX:2147483647,INT_MIN:-2147483648,sign:function(c){return(0<c)-(0>c)},abs:function(c){var b=c>>31;return(c^b)-b},min:function(c,b){return b^(c^b)&-(c<b)},max:function(c,b){return c^(c^b)&-(c<b)},isPow2:function(c){return!(c&c-1)&&!!c},log2:function(c){var b,
a;b=(65535<c)<<4;c>>>=b;a=(255<c)<<3;c>>>=a;b|=a;a=(15<c)<<2;c>>>=a;b|=a;a=(3<c)<<1;return b|a|c>>>a>>1},log10:function(c){return 1E9<=c?9:1E8<=c?8:1E7<=c?7:1E6<=c?6:1E5<=c?5:1E4<=c?4:1E3<=c?3:100<=c?2:10<=c?1:0},popCount:function(c){c-=c>>>1&1431655765;c=(c&858993459)+(c>>>2&858993459);return 16843009*(c+(c>>>4)&252645135)>>>24},countTrailingZeros:$g,nextPow2:function(c){c+=0===c;--c;c|=c>>>1;c|=c>>>2;c|=c>>>4;c|=c>>>8;return(c|c>>>16)+1},prevPow2:function(c){c|=c>>>1;c|=c>>>2;c|=c>>>4;c|=c>>>8;
c|=c>>>16;return c-(c>>>1)},parity:function(c){c^=c>>>16;c^=c>>>8;return 27030>>>((c^c>>>4)&15)&1},reverse:function(c){return Rc[c&255]<<24|Rc[c>>>8&255]<<16|Rc[c>>>16&255]<<8|Rc[c>>>24&255]},interleave2:function(c,b){c&=65535;c=(c|c<<8)&16711935;c=(c|c<<4)&252645135;c=(c|c<<2)&858993459;b&=65535;b=(b|b<<8)&16711935;b=(b|b<<4)&252645135;b=(b|b<<2)&858993459;return(c|c<<1)&1431655765|((b|b<<1)&1431655765)<<1},deinterleave2:function(c,b){c=c>>>b&1431655765;c=(c|c>>>1)&858993459;c=(c|c>>>2)&252645135;
c=(c|c>>>4)&16711935;return((c|c>>>16)&65535)<<16>>16},interleave3:function(c,b,a){c&=1023;c=(c|c<<16)&4278190335;c=(c|c<<8)&251719695;c=(c|c<<4)&3272356035;b&=1023;b=(b|b<<16)&4278190335;b=(b|b<<8)&251719695;b=(b|b<<4)&3272356035;a&=1023;a=(a|a<<16)&4278190335;a=(a|a<<8)&251719695;a=(a|a<<4)&3272356035;return(c|c<<2)&1227133513|((b|b<<2)&1227133513)<<1|((a|a<<2)&1227133513)<<2},deinterleave3:function(c,b){c=c>>>b&1227133513;c=(c|c>>>2)&3272356035;c=(c|c>>>4)&251719695;c=(c|c>>>8)&4278190335;return((c|
c>>>16)&1023)<<22>>22},nextCombination:function(c){var b=c|c-1;return b+1|(~b&-~b)-1>>>$g(c)+1}};"use strict";var Ea=function(c,b){"undefined"===typeof b&&(b=0);switch("undefined"===typeof c?"undefined":H(c)){case "number":if(0<c){c|=0;var a,d;a=Array(c);for(d=0;d<c;++d)a[d]=b;return a}break;case "object":if("number"===typeof c.length)return ah(c,b,0)}return[]},ye=qa(function(c,b){function a(a){if(a){var b=Ca.log2(a.length||a.byteLength);y[b].push(a)}}function d(a){a=Ca.nextPow2(a);var b=Ca.log2(a),
b=y[b];return 0<b.length?b.pop():new ArrayBuffer(a)}function g(a){return new Uint8Array(d(a),0,a)}function e(a){return new Uint16Array(d(2*a),0,a)}function f(a){return new Uint32Array(d(4*a),0,a)}function k(a){return new Int8Array(d(a),0,a)}function l(a){return new Int16Array(d(2*a),0,a)}function m(a){return new Int32Array(d(4*a),0,a)}function n(a){return new Float32Array(d(4*a),0,a)}function r(a){return new Float64Array(d(8*a),0,a)}function p(a){return u?new Uint8ClampedArray(d(a),0,a):g(a)}function q(a){return new DataView(d(a),
0,a)}function t(a){a=Ca.nextPow2(a);var b=Ca.log2(a),b=w[b];return 0<b.length?b.pop():new C(a)}Mb.__TYPEDARRAY_POOL||(Mb.__TYPEDARRAY_POOL={UINT8:Ea([32,0]),UINT16:Ea([32,0]),UINT32:Ea([32,0]),INT8:Ea([32,0]),INT16:Ea([32,0]),INT32:Ea([32,0]),FLOAT:Ea([32,0]),DOUBLE:Ea([32,0]),DATA:Ea([32,0]),UINT8C:Ea([32,0]),BUFFER:Ea([32,0])});var u="undefined"!==typeof Uint8ClampedArray,x=Mb.__TYPEDARRAY_POOL;x.UINT8C||(x.UINT8C=Ea([32,0]));x.BUFFER||(x.BUFFER=Ea([32,0]));var y=x.DATA,w=x.BUFFER;b.free=function(a){if(Ug(a))w[Ca.log2(a.length)].push(a);
else if("[object ArrayBuffer]"!==Object.prototype.toString.call(a)&&(a=a.buffer),a){var b=Ca.log2(a.length||a.byteLength)|0;y[b].push(a)}};b.freeUint8=b.freeUint16=b.freeUint32=b.freeInt8=b.freeInt16=b.freeInt32=b.freeFloat32=b.freeFloat=b.freeFloat64=b.freeDouble=b.freeUint8Clamped=b.freeDataView=function(b){a(b.buffer)};b.freeArrayBuffer=a;b.freeBuffer=function(a){w[Ca.log2(a.length)].push(a)};b.malloc=function(a,b){if(void 0===b||"arraybuffer"===b)return d(a);switch(b){case "uint8":return g(a);
case "uint16":return e(a);case "uint32":return f(a);case "int8":return k(a);case "int16":return l(a);case "int32":return m(a);case "float":case "float32":return n(a);case "double":case "float64":return r(a);case "uint8_clamped":return p(a);case "buffer":return t(a);case "data":case "dataview":return q(a)}return null};b.mallocArrayBuffer=d;b.mallocUint8=g;b.mallocUint16=e;b.mallocUint32=f;b.mallocInt8=k;b.mallocInt16=l;b.mallocInt32=m;b.mallocFloat32=b.mallocFloat=n;b.mallocFloat64=b.mallocDouble=
r;b.mallocUint8Clamped=p;b.mallocDataView=q;b.mallocBuffer=t;b.clearCache=function(){for(var a=0;32>a;++a)x.UINT8[a].length=0,x.UINT16[a].length=0,x.UINT32[a].length=0,x.INT8[a].length=0,x.INT16[a].length=0,x.INT32[a].length=0,x.FLOAT[a].length=0,x.DOUBLE[a].length=0,x.UINT8C[a].length=0,y[a].length=0,w[a].length=0}}),ze=function(c,b,a,d,g,e,f){c|=0;b|=0;a|=0;g|=0;e|=0;if(Ca.isPow2(a))od(c,b,a,d,g,e);else{var k;c|=0;b|=0;a|=0;g|=0;e|=0;k=f|0;f=Ca.nextPow2(2*a+1);var l=k+a,m=l+a,n=m+f,r=n+f,p=r+f,
q=-c*Math.PI/a,t,u,x,y,w,A;for(A=0;A<a;++A)t=A*A%(2*a)*q,x=Math.cos(t),y=Math.sin(t),d[r+(f-A)]=d[r+A]=d[k+A]=x,d[p+(f-A)]=d[p+A]=d[l+A]=y;for(A=a;A<=f-a;++A)d[r+A]=0;for(A=a;A<=f-a;++A)d[p+A]=0;od(1,1,f,d,r,p);q=0>c?1/a:1;for(c=0;c<b;++c){for(A=0;A<a;++A)t=d[g+A],u=d[e+A],x=d[k+A],y=-d[l+A],w=x*(t+u),t*=y-x,x=u*(x+y),d[m+A]=w-x,d[n+A]=w+t;for(A=a;A<f;++A)d[m+A]=0;for(A=a;A<f;++A)d[n+A]=0;od(1,1,f,d,m,n);for(A=0;A<f;++A)t=d[m+A],u=d[n+A],x=d[r+A],y=d[p+A],w=x*(t+u),t*=y-x,x=u*(x+y),d[m+A]=w-x,d[n+
A]=w+t;od(-1,1,f,d,m,n);for(A=0;A<a;++A)t=d[m+A],u=d[n+A],x=d[k+A],y=-d[l+A],w=x*(t+u),t*=y-x,x=u*(x+y),d[g+A]=q*(w-x),d[e+A]=q*(w+t);g+=a;e+=a}}};ze.scratchMemory=function(c){return Ca.isPow2(c)?0:2*c+4*Ca.nextPow2(2*c+1)};"use strict";var Th=function(c,b,a){var d=b.shape,g=d.length,e=1,f=Array(g),k=0,l,m;for(l=g-1;0<=l;--l)if(f[l]=e,e*=d[l],k=Math.max(k,ze.scratchMemory(d[l])),b.shape[l]!==a.shape[l])throw Error("Shape mismatch, real and imaginary arrays must have same size");l=4*e+k;var k="array"===
b.dtype||"float64"===b.dtype||"custom"===b.dtype?ye.mallocDouble(l):ye.mallocFloat(l),n=Ka(k,d.slice(0),f,0),r=Ka(k,d.slice(0),f.slice(0),e),p=Ka(k,d.slice(0),f.slice(0),2*e),f=Ka(k,d.slice(0),f.slice(0),3*e),q,t,u,x=4*e;jc.assign(n,b);jc.assign(r,a);for(l=g-1;0<=l;--l){ze(c,e/d[l],d[l],k,n.offset,r.offset,x);if(0===l)break;q=1;t=p.stride;u=f.stride;for(m=l-1;m<g;++m)u[m]=t[m]=q,q*=d[m];for(m=l-2;0<=m;--m)u[m]=t[m]=q,q*=d[m];jc.assign(p,n);jc.assign(f,r);m=n;n=p;p=m;m=r;r=f;f=m}jc.assign(b,n);jc.assign(a,
r);ye.free(k)},Ae={FORWARD:1,INVERSE:-1},Uh=function(c){function b(a){N(this,b);var c=P(this,(b.__proto__||Object.getPrototypeOf(b)).call(this));c.direction=a;c.setMetadata("direction",c.direction);if(void 0===Ae[c.direction])throw Error(c.direction+" is not a valid fourier transform direction. Please try one of: "+Object.keys(Ae));c.addInputValidator(0,za);c.addInputValidator(1,za);return c}M(b,c);O(b,[{key:"_run",value:function(){if(this.hasValidInput()){var a=this._getInput(0),b=this._getInput(1),
c=a.getMetadata("length");c!==b.getMetadata("length")&&console.warn("The imaginary and real components of the signal need to be of equal length.");var e=Ka(a.clone().getData(),[c]),b=Ka(b.clone().getData(),[c]);Th(Ae[this.direction],e,b);this._output[0]=new za;this._output[0].setData(e.data);this._output[1]=new za;this._output[1].setData(b.data);this._output[0].setMetadata("samplingFrequency",a.getMetadata("samplingFrequency"));this._output[1].setMetadata("samplingFrequency",a.getMetadata("samplingFrequency"))}else console.warn("A filter of type BaseFourierSignalFilter requires 2 inputs of Signal1D.")}}]);
return b}(V),Vh=function(c){function b(){N(this,b);return P(this,(b.__proto__||Object.getPrototypeOf(b)).call(this,"FORWARD"))}M(b,c);return b}(Uh),tk=function(c){function b(){N(this,b);return P(this,(b.__proto__||Object.getPrototypeOf(b)).call(this,"INVERSE"))}M(b,c);return b}(Uh),Be={FORWARD:1,INVERSE:-1},Wh=function(c){function b(a){N(this,b);var c=P(this,(b.__proto__||Object.getPrototypeOf(b)).call(this));c.direction=a;if(void 0===Be[c.direction])throw Error(c.direction+" is not a valid fourier transform direction. Please try one of: "+
Object.keys(Be));c.addInputValidator(0,S);c.addInputValidator(1,S);return c}M(b,c);O(b,[{key:"_run",value:function(){if(this.hasValidInput()){var a=this._getInput(0),b=this._getInput(1);if(1<a.getMetadata("ncpp"))console.warn("Please make sure the input images are made of exactly 1 channel.");else{var c=a.getMetadata("width"),e=a.getMetadata("height");c===b.getMetadata("width")&&e===b.getMetadata("height")||console.warn("Please make sure the real and imaginary input images are the same dimensions");
a=Ka(a.getDataAsFloat32Array(),[c,e]);b=Ka(b.getDataAsFloat32Array(),[c,e]);this.setMetadata("direction",this.direction);Th(Be[this.direction],a,b);this._output[0]=new S;this._output[0].setData(a.data,c,e,1);this._output[0].setMetadata("ncpp",1);this._output[1]=new S;this._output[1].setData(b.data,c,e,1);this._output[1].setMetadata("ncpp",1)}}else console.warn("A filter of type BaseFourierSignalFilter requires 2 inputs of Signal1D.")}}]);return b}(V),uk=function(c){function b(){N(this,b);return P(this,
(b.__proto__||Object.getPrototypeOf(b)).call(this,"FORWARD"))}M(b,c);return b}(Wh),vk=function(c){function b(){N(this,b);return P(this,(b.__proto__||Object.getPrototypeOf(b)).call(this,"INVERSE"))}M(b,c);return b}(Wh),wk=function(c){function b(){N(this,b);var a=P(this,(b.__proto__||Object.getPrototypeOf(b)).call(this));a.addInputValidator(0,S);return a}M(b,c);O(b,[{key:"_run",value:function(){if(this.hasValidInput()){var a=this._getInput(),b=a.getWidth()*a.getHeight(),c=a.getDataCopy();this._forEachPixelOfSuch(c,
0,b,1);this._addOutput(S).setData(c,a.getWidth(),a.getHeight(),a.getComponentsPerPixel())}}},{key:"_forEachPixelOfSuch",value:function(a,b,c,e){if(this.hasEvent("pixel"))for(var d=this._getInput(),g=d.getData(),l=d.getComponentsPerPixel(),m;b<c;b+=e){var n=b*l,r=d.get2dPositionFrom1dIndex(b);m=g.slice(n,n+l);if((m=this.triggerEvent("pixel",r,m))&&m.length==l)for(r=0;r<l;r++)a[n+r]=m[r]}else console.warn("No function to apply per pixel was specified.")}}]);return b}(ra),xk=function(c){function b(){N(this,
b);var a=P(this,(b.__proto__||Object.getPrototypeOf(b)).call(this));a.addInputValidator(0,S);a.addInputValidator(1,S);return a}M(b,c);O(b,[{key:"_run",value:function(){if(this.hasValidInput()&&this.hasSameSizeInput()&&this.hasValidInput()){var a=this._getInput(0),b=this._getInput(1);if(1!=b.getComponentsPerPixel())console.warn("The scaling image must have one single band.");else{for(var c=a.getWidth()*a.getHeight(),e=a.getComponentsPerPixel(),f=a.getDataCopy(),b=b.getData(),k=0;k<c;k++)for(var l=
0;l<e;l++)f[k*e+l]*=b[k];this._addOutput(S).setData(f,a.getWidth(),a.getHeight())}}}}]);return b}(ra),yk=qa(function(c,b){(function(a,b){c.exports=b()})(Mb,function(){function a(a,b){for(var c=0;c<a.length;c++)if(a[c]===b)return c;return-1}function b(a,b){this.type=a;this.value=void 0!==b&&null!==b?b:0}function c(a,b){this.tokens=a;this.parser=b;this.unaryOps=b.unaryOps;this.binaryOps=b.binaryOps;this.ternaryOps=b.ternaryOps;this.functions=b.functions}function e(a){return"string"===typeof a?JSON.stringify(a).replace(/\u2028/g,
"\\u2028").replace(/\u2029/g,"\\u2029"):a}function f(a,c,d,e,g){for(var k=[],l=[],m,n,q,r,p=0,t=a.length;p<t;p++)if(r=a[p],m=r.type,"INUMBER"===m)k.push(r);else if("IVAR"===m&&g.hasOwnProperty(r.value))r=new b("INUMBER",g[r.value]),k.push(r);else if("IOP2"===m&&1<k.length)n=k.pop(),m=k.pop(),r=d[r.value],r=new b("INUMBER",r(m.value,n.value)),k.push(r);else if("IOP3"===m&&2<k.length)q=k.pop(),n=k.pop(),m=k.pop(),"?"===r.value?k.push(m.value?n.value:q.value):(r=e[r.value],r=new b("INUMBER",r(m.value,
n.value,q.value)),k.push(r));else if("IOP1"===m&&0<k.length)m=k.pop(),r=c[r.value],r=new b("INUMBER",r(m.value)),k.push(r);else if("IEXPR"===m){for(;0<k.length;)l.push(k.shift());l.push(new b("IEXPR",f(r.value,c,d,e,g)))}else if("IMEMBER"===m&&0<k.length)m=k.pop(),k.push(new b("INUMBER",m.value[r.value]));else{for(;0<k.length;)l.push(k.shift());l.push(r)}for(;0<k.length;)l.push(k.shift());return l}function k(a,c,d){for(var e=[],g=0,f=a.length;g<f;g++){var l=a[g],m=l.type;if("IVAR"===m&&l.value===
c)for(l=0;l<d.tokens.length;l++)m=d.tokens[l],m="IOP1"===m.type?ga(m.value):"IOP2"===m.type?fa(m.value):"IOP3"===m.type?ia(m.value):new b(m.type,m.value),e.push(m);else"IEXPR"===m?e.push(new b("IEXPR",k(l.value,c,d))):e.push(l)}return e}function l(a,b,c){for(var d=[],e,g,f,k,m=0,n=a.length;m<n;m++)if(k=a[m],e=k.type,"INUMBER"===e)d.push(k.value);else if("IOP2"===e)g=d.pop(),e=d.pop(),k=b.binaryOps[k.value],d.push(k(e,g));else if("IOP3"===e)f=d.pop(),g=d.pop(),e=d.pop(),"?"===k.value?d.push(l(e?g:
f,b,c)):(k=b.ternaryOps[k.value],d.push(k(e,g,f)));else if("IVAR"===e)if(k.value in b.functions)d.push(b.functions[k.value]);else if(e=c[k.value],void 0!==e)d.push(e);else throw Error("undefined variable: "+k.value);else if("IOP1"===e)e=d.pop(),k=b.unaryOps[k.value],d.push(k(e));else if("IFUNCALL"===e){k=k.value;for(e=[];0<k--;)e.unshift(d.pop());k=d.pop();if(k.apply&&k.call)d.push(k.apply(void 0,e));else throw Error(k+" is not a function");}else if("IEXPR"===e)d.push(k.value);else if("IMEMBER"===
e)e=d.pop(),d.push(e[k.value]);else throw Error("invalid Expression");if(1<d.length)throw Error("invalid Expression (parity)");return d[0]}function m(a,b){for(var c=[],d,g,f,k,l=0,n=a.length;l<n;l++)if(k=a[l],d=k.type,"INUMBER"===d)"number"===typeof k.value&&0>k.value?c.push("("+k.value+")"):c.push(e(k.value));else if("IOP2"===d)g=c.pop(),d=c.pop(),k=k.value,b?"^"===k?c.push("Math.pow("+d+", "+g+")"):"and"===k?c.push("(!!"+d+" && !!"+g+")"):"or"===k?c.push("(!!"+d+" || !!"+g+")"):"||"===k?c.push("(String("+
d+") + String("+g+"))"):"=="===k?c.push("("+d+" === "+g+")"):"!="===k?c.push("("+d+" !== "+g+")"):c.push("("+d+" "+k+" "+g+")"):c.push("("+d+" "+k+" "+g+")");else if("IOP3"===d)if(f=c.pop(),g=c.pop(),d=c.pop(),k=k.value,"?"===k)c.push("("+d+" ? "+g+" : "+f+")");else throw Error("invalid Expression");else if("IVAR"===d)c.push(k.value);else if("IOP1"===d)d=c.pop(),k=k.value,"-"===k||"+"===k?c.push("("+k+d+")"):b?"not"===k?c.push("(!"+d+")"):"!"===k?c.push("fac("+d+")"):c.push(k+"("+d+")"):"!"===k?c.push("("+
d+"!)"):c.push("("+k+" "+d+")");else if("IFUNCALL"===d){g=k.value;for(d=[];0<g--;)d.unshift(c.pop());k=c.pop();c.push(k+"("+d.join(", ")+")")}else if("IMEMBER"===d)d=c.pop(),c.push(d+"."+k.value);else if("IEXPR"===d)c.push("("+m(k.value,b)+")");else throw Error("invalid Expression");if(1<c.length)throw Error("invalid Expression (parity)");return c[0]}function n(b,c){for(var d=0,e=b.length;d<e;d++){var g=b[d];"IVAR"===g.type&&-1===a(c,g.value)?c.push(g.value):"IEXPR"===g.type&&n(g.value,c)}}function r(a,
b){return Number(a)+Number(b)}function p(a,b){return a-b}function q(a,b){return a*b}function t(a,b){return a/b}function u(a,b){return a%b}function x(a,b){return""+a+b}function y(a,b){return a===b}function w(a,b){return a!==b}function A(a,b){return a>b}function z(a,b){return a<b}function B(a,b){return a>=b}function C(a,b){return a<=b}function H(a,b){return!(!a||!b)}function M(a,b){return!(!a&&!b)}function L(a){return(Math.exp(a)-Math.exp(-a))/2}function N(a){return(Math.exp(a)+Math.exp(-a))/2}function J(a){return Infinity===
a?1:-Infinity===a?-1:(Math.exp(a)-Math.exp(-a))/(Math.exp(a)+Math.exp(-a))}function E(a){return-Infinity===a?a:Math.log(a+Math.sqrt(a*a+1))}function O(a){return Math.log(a+Math.sqrt(a*a-1))}function P(a){return Math.log((1+a)/(1-a))/2}function Q(a){return Math.log(a)*Math.LOG10E}function R(a){return-a}function S(a){return!a}function T(a){return 0>a?Math.ceil(a):Math.floor(a)}function U(a){return Math.random()*(a||1)}function V(a){return ca(a+1)}function aa(a){return String(a).length}function ba(){for(var a=
0,b=0,c=0,d=arguments.length;c<d;c++){var e=Math.abs(arguments[c]),g;b<e?(g=b/e,a=a*g*g+1,b=e):0<e?(g=e/b,a+=g*g):a+=e}return Infinity===b?Infinity:b*Math.sqrt(a)}function da(a,b,c){return a?b:c}function ca(a){var b,c;c=a;if(isFinite(c)&&c===Math.round(c)){if(0>=a)return isFinite(a)?Infinity:NaN;if(171<a)return Infinity;c=a-2;for(--a;1<c;)a*=c,c--;0===a&&(a=1);return a}if(.5>a)return Math.PI/(Math.sin(Math.PI*a)*ca(1-a));if(171.35<=a)return Infinity;if(85<a){c=a*a;b=c*a;var d=b*a,e=d*a;return Math.sqrt(2*
Math.PI/a)*Math.pow(a/Math.E,a)*(1+1/(12*a)+1/(288*c)-139/(51840*b)-571/(2488320*d)+163879/(209018880*e)+5246819/(75246796800*e*a))}--a;c=ja[0];for(b=1;b<ja.length;++b)c+=ja[b]/(a+b);b=a+na+.5;return Math.sqrt(2*Math.PI)*Math.pow(b,a+.5)*Math.exp(-b)*c}function ea(a,b,c,d){this.type=a;this.value=b;this.line=c;this.column=d}function X(a,b,c,d,e){this.column=this.line=this.pos=0;this.current=null;this.unaryOps=b;this.binaryOps=c;this.ternaryOps=d;this.consts=e;this.expression=a;this.savedPosition=0;
this.savedCurrent=null;this.savedColumn=this.savedLine=0}function ga(a){var c=ka[a];c||(c=ka[a]=new b("IOP1",a));return c}function fa(a){var c=la[a];c||(c=la[a]=new b("IOP2",a));return c}function ia(a){var c=ma[a];c||(c=ma[a]=new b("IOP3",a));return c}function Z(a,b){this.parser=a;this.tokens=b;this.nextToken=this.current=null;this.next();this.savedNextToken=this.savedCurrent=null}function ha(){this.unaryOps={sin:Math.sin,cos:Math.cos,tan:Math.tan,asin:Math.asin,acos:Math.acos,atan:Math.atan,sinh:Math.sinh||
L,cosh:Math.cosh||N,tanh:Math.tanh||J,asinh:Math.asinh||E,acosh:Math.acosh||O,atanh:Math.atanh||P,sqrt:Math.sqrt,log:Math.log,ln:Math.log,lg:Math.log10||Q,log10:Math.log10||Q,abs:Math.abs,ceil:Math.ceil,floor:Math.floor,round:Math.round,trunc:Math.trunc||T,"-":R,"+":Number,exp:Math.exp,not:S,length:aa,"!":V};this.binaryOps={"+":r,"-":p,"*":q,"/":t,"%":u,"^":Math.pow,"||":x,"==":y,"!=":w,">":A,"<":z,">=":B,"<=":C,and:H,or:M};this.ternaryOps={"?":da};this.functions={random:U,fac:V,min:Math.min,max:Math.max,
hypot:Math.hypot||ba,pyt:Math.hypot||ba,pow:Math.pow,atan2:Math.atan2,"if":da,gamma:ca};this.consts={E:Math.E,PI:Math.PI,"true":!0,"false":!1}}b.prototype.toString=function(){switch(this.type){case "INUMBER":case "IOP1":case "IOP2":case "IOP3":case "IVAR":return this.value;case "IFUNCALL":return"CALL "+this.value;case "IMEMBER":return"."+this.value;default:return"Invalid Instruction"}};c.prototype.simplify=function(a){a=a||{};return new c(f(this.tokens,this.unaryOps,this.binaryOps,this.ternaryOps,
a),this.parser)};c.prototype.substitute=function(a,b){b instanceof c||(b=this.parser.parse(String(b)));return new c(k(this.tokens,a,b),this.parser)};c.prototype.evaluate=function(a){a=a||{};return l(this.tokens,this,a)};c.prototype.toString=function(){return m(this.tokens,!1)};c.prototype.symbols=function(){var a=[];n(this.tokens,a);return a};c.prototype.variables=function(){var a=[];n(this.tokens,a);var b=this.functions;return a.filter(function(a){return!(a in b)})};c.prototype.toJSFunction=function(a,
b){var c=this,d=new Function(a,"with(this.functions) with (this.ternaryOps) with (this.binaryOps) with (this.unaryOps) { return "+m(this.simplify(b).tokens,!0)+"; }");return function(){return d.apply(c,arguments)}};var na=4.7421875,ja=[.9999999999999971,57.15623566586292,-59.59796035547549,14.136097974741746,-.4919138160976202,3.399464998481189E-5,4.652362892704858E-5,-9.837447530487956E-5,1.580887032249125E-4,-2.1026444172410488E-4,2.1743961811521265E-4,-1.643181065367639E-4,8.441822398385275E-5,
-2.6190838401581408E-5,3.6899182659531625E-6];ea.prototype.toString=function(){return this.type+": "+this.value};X.prototype.newToken=function(a,b,c,d){return new ea(a,b,null!=c?c:this.line,null!=d?d:this.column)};X.prototype.save=function(){this.savedPosition=this.pos;this.savedCurrent=this.current;this.savedLine=this.line;this.savedColumn=this.column};X.prototype.restore=function(){this.pos=this.savedPosition;this.current=this.savedCurrent;this.line=this.savedLine;this.column=this.savedColumn};
X.prototype.next=function(){if(this.pos>=this.expression.length)return this.newToken("TEOF","EOF");if(this.isWhitespace()||this.isComment())return this.next();if(this.isNumber()||this.isOperator()||this.isString()||this.isParen()||this.isComma()||this.isNamedOp()||this.isConst()||this.isName())return this.current;this.parseError('Unknown character "'+this.expression.charAt(this.pos)+'"')};X.prototype.isString=function(){var a=!1,b=this.line,c=this.column,d=this.pos,e=this.expression.charAt(d);if("'"===
e||'"'===e){this.pos++;this.column++;for(var g=this.expression.indexOf(e,d+1);0<=g&&this.pos<this.expression.length;){this.pos=g+1;if("\\"!==this.expression.charAt(g-1)){a=this.expression.substring(d+1,g);this.current=this.newToken("TSTRING",this.unescape(a),b,c);b=a.indexOf("\n");for(c=-1;0<=b;)this.line++,this.column=0,c=b,b=a.indexOf("\n",b+1);this.column+=a.length-c;a=!0;break}g=this.expression.indexOf(e,g+1)}}return a};X.prototype.isParen=function(){var a=this.expression.charAt(this.pos);return"("===
a||")"===a?(this.current=this.newToken("TPAREN",a),this.pos++,this.column++,!0):!1};X.prototype.isComma=function(){return","===this.expression.charAt(this.pos)?(this.current=this.newToken("TCOMMA",","),this.pos++,this.column++,!0):!1};X.prototype.isConst=function(){for(var a=this.pos,b=a;b<this.expression.length;b++){var c=this.expression.charAt(b);if(c.toUpperCase()===c.toLowerCase()&&(b===this.pos||"_"!==c&&"."!==c&&("0">c||"9"<c)))break}return b>a&&(a=this.expression.substring(a,b),a in this.consts)?
(this.current=this.newToken("TNUMBER",this.consts[a]),this.pos+=a.length,this.column+=a.length,!0):!1};X.prototype.isNamedOp=function(){for(var a=this.pos,b=a;b<this.expression.length;b++){var c=this.expression.charAt(b);if(c.toUpperCase()===c.toLowerCase()&&(b===this.pos||"_"!==c&&("0">c||"9"<c)))break}return b>a&&(a=this.expression.substring(a,b),a in this.binaryOps||a in this.unaryOps||a in this.ternaryOps)?(this.current=this.newToken("TOP",a),this.pos+=a.length,this.column+=a.length,!0):!1};X.prototype.isName=
function(){for(var a=this.pos,b=a;b<this.expression.length;b++){var c=this.expression.charAt(b);if(c.toUpperCase()===c.toLowerCase()&&(b===this.pos||"_"!==c&&("0">c||"9"<c)))break}return b>a?(a=this.expression.substring(a,b),this.current=this.newToken("TNAME",a),this.pos+=a.length,this.column+=a.length,!0):!1};X.prototype.isWhitespace=function(){for(var a=!1,b=this.expression.charAt(this.pos);" "===b||"\t"===b||"\n"===b||"\r"===b;){a=!0;this.pos++;this.column++;"\n"===b&&(this.line++,this.column=
0);if(this.pos>=this.expression.length)break;b=this.expression.charAt(this.pos)}return a};var oa=/^[0-9a-f]{4}$/i;X.prototype.unescape=function(a){var b=a.indexOf("\\");if(0>b)return a;for(var c=a.substring(0,b);0<=b;){var d=a.charAt(++b);switch(d){case "'":c+="'";break;case '"':c+='"';break;case "\\":c+="\\";break;case "/":c+="/";break;case "b":c+="\b";break;case "f":c+="\f";break;case "n":c+="\n";break;case "r":c+="\r";break;case "t":c+="\t";break;case "u":d=a.substring(b+1,b+5);oa.test(d)||this.parseError("Illegal escape sequence: \\u"+
d);c+=String.fromCharCode(parseInt(d,16));b+=4;break;default:throw this.parseError('Illegal escape sequence: "\\'+d+'"');}++b;d=a.indexOf("\\",b);c+=a.substring(b,0>d?a.length:d);b=d}return c};X.prototype.isComment=function(){if("/"===this.expression.charAt(this.pos)&&"*"===this.expression.charAt(this.pos+1)){var a=this.pos;this.pos=this.expression.indexOf("*/",this.pos)+2;1===this.pos&&(this.pos=this.expression.length);for(var a=this.expression.substring(a,this.pos),b=a.indexOf("\n");0<=b;)this.line++,
this.column=a.length-b,b=a.indexOf("\n",b+1);return!0}return!1};X.prototype.isNumber=function(){for(var a=!1,b=this.pos,c=b,d=b,e=this.column,g=e,f=!1,k=!1,l;b<this.expression.length;)if(l=this.expression.charAt(b),"0"<=l&&"9">=l||!f&&"."===l)"."===l?f=!0:k=!0,b++,e++,a=k;else break;a&&(d=b,g=e);if("e"===l||"E"===l){b++;e++;f=!0;for(k=!1;b<this.expression.length;){l=this.expression.charAt(b);if(!f||"+"!==l&&"-"!==l)if("0"<=l&&"9">=l)k=!0,f=!1;else break;else f=!1;b++;e++}k||(b=d,e=g)}a?(this.current=
this.newToken("TNUMBER",parseFloat(this.expression.substring(c,b))),this.pos=b,this.column=e):(this.pos=d,this.column=g);return a};X.prototype.isOperator=function(){var a=this.expression.charAt(this.pos);if("+"===a||"-"===a||"*"===a||"/"===a||"%"===a||"^"===a||"?"===a||":"===a||"."===a)this.current=this.newToken("TOP",a);else if("\u2219"===a||"\u2022"===a)this.current=this.newToken("TOP","*");else if(">"===a)"="===this.expression.charAt(this.pos+1)?(this.current=this.newToken("TOP",">="),this.pos++,
this.column++):this.current=this.newToken("TOP",">");else if("<"===a)"="===this.expression.charAt(this.pos+1)?(this.current=this.newToken("TOP","<="),this.pos++,this.column++):this.current=this.newToken("TOP","<");else if("|"===a)if("|"===this.expression.charAt(this.pos+1))this.current=this.newToken("TOP","||"),this.pos++,this.column++;else return!1;else if("="===a)if("="===this.expression.charAt(this.pos+1))this.current=this.newToken("TOP","=="),this.pos++,this.column++;else return!1;else if("!"===
a)"="===this.expression.charAt(this.pos+1)?(this.current=this.newToken("TOP","!="),this.pos++,this.column++):this.current=this.newToken("TOP",a);else return!1;this.pos++;this.column++;return!0};X.prototype.parseError=function(a){throw Error("parse error ["+(this.line+1)+":"+(this.column+1)+"]: "+a);};var ka={},la={},ma={};Z.prototype.next=function(){this.current=this.nextToken;return this.nextToken=this.tokens.next()};Z.prototype.tokenMatches=function(b,c){return"undefined"===typeof c?!0:Array.isArray(c)?
0<=a(c,b.value):"function"===typeof c?c(b):b.value===c};Z.prototype.save=function(){this.savedCurrent=this.current;this.savedNextToken=this.nextToken;this.tokens.save()};Z.prototype.restore=function(){this.tokens.restore();this.current=this.savedCurrent;this.nextToken=this.savedNextToken};Z.prototype.accept=function(a,b){return this.nextToken.type===a&&this.tokenMatches(this.nextToken,b)?(this.next(),!0):!1};Z.prototype.expect=function(a,b){if(!this.accept(a,b))throw Error("parse error ["+this.tokens.line+
":"+this.tokens.column+"]: Expected "+(b||a));};Z.prototype.parseAtom=function(a){if(this.accept("TNAME"))a.push(new b("IVAR",this.current.value));else if(this.accept("TNUMBER"))a.push(new b("INUMBER",this.current.value));else if(this.accept("TSTRING"))a.push(new b("INUMBER",this.current.value));else if(this.accept("TPAREN","("))this.parseExpression(a),this.expect("TPAREN",")");else throw Error("unexpected "+this.nextToken);};Z.prototype.parseExpression=function(a){this.parseConditionalExpression(a)};
Z.prototype.parseConditionalExpression=function(a){for(this.parseOrExpression(a);this.accept("TOP","?");){var c=[],d=[];this.parseConditionalExpression(c);this.expect("TOP",":");this.parseConditionalExpression(d);a.push(new b("IEXPR",c));a.push(new b("IEXPR",d));a.push(ia("?"))}};Z.prototype.parseOrExpression=function(a){for(this.parseAndExpression(a);this.accept("TOP","or");)this.parseAndExpression(a),a.push(fa("or"))};Z.prototype.parseAndExpression=function(a){for(this.parseComparison(a);this.accept("TOP",
"and");)this.parseComparison(a),a.push(fa("and"))};Z.prototype.parseComparison=function(a){for(this.parseAddSub(a);this.accept("TOP","== != < <= >= >".split(" "));){var b=this.current;this.parseAddSub(a);a.push(fa(b.value))}};Z.prototype.parseAddSub=function(a){for(this.parseTerm(a);this.accept("TOP",["+","-","||"]);){var b=this.current;this.parseTerm(a);a.push(fa(b.value))}};Z.prototype.parseTerm=function(a){for(this.parseFactor(a);this.accept("TOP",["*","/","%"]);){var b=this.current;this.parseFactor(a);
a.push(fa(b.value))}};Z.prototype.parseFactor=function(a){var b=this.tokens.unaryOps;this.save();if(this.accept("TOP",function(a){return a.value in b}))if("-"!==this.current.value&&"+"!==this.current.value&&"TPAREN"===this.nextToken.type&&"("===this.nextToken.value)this.restore(),this.parseExponential(a);else{var c=this.current;this.parseFactor(a);a.push(ga(c.value))}else this.parseExponential(a)};Z.prototype.parseExponential=function(a){for(this.parsePostfixExpression(a);this.accept("TOP","^");)this.parseFactor(a),
a.push(fa("^"))};Z.prototype.parsePostfixExpression=function(a){for(this.parseFunctionCall(a);this.accept("TOP","!");)a.push(ga("!"))};Z.prototype.parseFunctionCall=function(a){var c=this.tokens.unaryOps;if(this.accept("TOP",function(a){return a.value in c})){var d=this.current;this.parseAtom(a);a.push(ga(d.value))}else for(this.parseMemberExpression(a);this.accept("TPAREN","(");)this.accept("TPAREN",")")?a.push(new b("IFUNCALL",0)):(d=this.parseArgumentList(a),a.push(new b("IFUNCALL",d)))};Z.prototype.parseArgumentList=
function(a){for(var b=0;!this.accept("TPAREN",")");)for(this.parseExpression(a),++b;this.accept("TCOMMA");)this.parseExpression(a),++b;return b};Z.prototype.parseMemberExpression=function(a){for(this.parseAtom(a);this.accept("TOP",".");)this.expect("TNAME"),a.push(new b("IMEMBER",this.current.value))};ha.parse=function(a){return(new ha).parse(a)};ha.evaluate=function(a,b){return ha.parse(a).evaluate(b)};ha.prototype={parse:function(a){var b=[];a=new Z(this,new X(a,this.unaryOps,this.binaryOps,this.ternaryOps,
this.consts));a.parseExpression(b);a.expect("TEOF","EOF");return new c(b,this)},evaluate:function(a,b){return this.parse(a).evaluate(b)}};return{Parser:ha,Expression:c}})}),zk=function(c){function b(){N(this,b);return P(this,(b.__proto__||Object.getPrototypeOf(b)).call(this))}M(b,c);O(b,[{key:"_run",value:function(){if(!this.hasMetadata("expression"))console.warn('A filter of type ImageBlendExpressionFilter requires a blending expression.\nUse \'setMetadata("expression", "...")\' to set it.');else if(this.hasSameNcppInput()&&
this.hasSameSizeInput())if(this.getNumberOfInputs()){for(var a=this.getInputCategories(),b=this._getInput(a[0]),c=b.getDataCopy(),e=(new yk.Parser).parse(this.getMetadata("expression")),f=0;f<c.length;f++){for(var k={},l=0;l<a.length;l++)k[a[l]]=this._getInput(a[l]).getData()[f];c[f]=e.evaluate(k)}this._addOutput(S).setData(c,b.getWidth(),b.getHeight())}else console.warn("A filter of type ImageBlendExpressionFilter requires at least one input.")}}]);return b}(ra),Ak=function(c){function b(){N(this,
b);var a=P(this,(b.__proto__||Object.getPrototypeOf(b)).call(this));a.addInputValidator(0,S);a.setMetadata("filter",null);return a}M(b,c);O(b,[{key:"_run",value:function(){if(this.hasValidInput()){var a=this.getMetadata("filter");if(a){var b=this._getInput(0);b.getData();for(var c=b.getNcpp(),e=b.getWidth(),f=b.getHeight(),k=new S({width:e,height:f,color:Array(c).fill(0)}),l=k.getData(),m=a.length,n=a[0].length,r=Math.floor(n/2),p=Math.floor(m/2),q=e-r,f=f-p,t=r;t<q;t++)for(var u=p;u<f;u++)for(var x=
(u*e+t)*c,y=0;y<n;y++)for(var w=0;w<m;w++)for(var A=b.getPixel({x:t+y-r,y:u+w-p}),z=a[w][y],B=0;B<c;B++)l[x+B]+=A[B]*z;this._output[0]=k}else console.warn("A filter must be specified using .setMetadata('filter', [[]])")}else console.warn("A filter of type SpatialConvolutionFilter requires 1 input of category '0' and one input of category '1'.")}}]);return b}(ra),Bk=function(c){function b(){N(this,b);var a=P(this,(b.__proto__||Object.getPrototypeOf(b)).call(this));a.addInputValidator(0,S);a.addInputValidator(1,
S);return a}M(b,c);O(b,[{key:"_run",value:function(){if(!this.hasValidInput())console.warn("A filter of type MultiplyImageFilter requires 1 input of category '0' and one input of category '1'.");else if(this.hasSameNcppInput()&&this.hasSameSizeInput()){for(var a=this._getInput(0),b=this._getInput(1).getData(),c=a.getDataCopy(),e=0;e<c.length;e++)c[e]*=b[e];this._addOutput(S).setData(c,a.getWidth(),a.getHeight())}}}]);return b}(ra),Ck=function(c){function b(){N(this,b);var a=P(this,(b.__proto__||Object.getPrototypeOf(b)).call(this));
a.addInputValidator(0,S);a.setMetadata("threshold",128);a.setMetadata("lowValue",0);a.setMetadata("highValue",255);a.setMetadata("preserveAlpha",!0);return a}M(b,c);O(b,[{key:"_run",value:function(){if(this.hasValidInput()){var a=this._getInput(0),b=a.clone(),c=a.getComponentsPerPixel(),a=this.getMetadata("threshold"),e=this.getMetadata("lowValue"),f=this.getMetadata("highValue"),k=b.getData();if(1==c||3==c||4==c){if(this.getMetadata("preserveAlpha")&&4==c)for(c=0;c<k.length;c++)3!=c%4&&(k[c]=k[c]<
a?e:f);else for(c=0;c<k.length;c++)k[c]=k[c]<a?e:f;this._output[0]=b}else console.warn("The input data must have 1, 3 or 4 components per pixel.")}}}]);return b}(ra),Dk=function(c){function b(){N(this,b);var a=P(this,(b.__proto__||Object.getPrototypeOf(b)).call(this));a.addInputValidator(0,S);a.setMetadata("dxFilter",[[1,-1]]);a.setMetadata("dyFilter",[[1],[-1]]);return a}M(b,c);O(b,[{key:"_run",value:function(){if(this.hasValidInput()){var a=this._getInput(0),b=this.getMetadata("dxFilter"),c=this.getMetadata("dyFilter"),
e=new pixpipe.SpatialConvolutionFilter;e.addInput(a);e.setMetadata("filter",b);e.update();this._output.dx=e.getOutput();e.setMetadata("filter",c);e.update();this._output.dy=e.getOutput()}else console.warn("A filter of type ImageDerivativeFilter requires 1 input of category '0' and one input of category '1'.")}}]);return b}(ra),Ek=function(c){function b(){N(this,b);var a=P(this,(b.__proto__||Object.getPrototypeOf(b)).call(this));a.addInputValidator("dx",S);a.addInputValidator("dy",S);return a}M(b,
c);O(b,[{key:"_run",value:function(){if(!this.hasValidInput())console.warn("A filter of type GradientImageFilter requires 1 input of category 'dx' and 1 input of category 'dy'.");else if(this.hasSameSizeInput()&&this.hasSameNcppInput()){for(var a=this._getInput("dx"),b=a.getData(),c=this._getInput("dy").getData(),e=a.hollowClone(),f=e.getData(),a=a.hollowClone(),k=a.getData(),l=Infinity,m=-Infinity,n=Infinity,r=-Infinity,p=0;p<b.length;p++)f[p]=Math.sqrt(b[p]*b[p]+c[p]*c[p]),isNaN(f[p])||(l=Math.min(l,
f[p]),m=Math.max(m,f[p])),k[p]=Math.atan(c[p]/b[p]),isNaN(k[p])||(n=Math.min(n,k[p]),r=Math.max(r,k[p]));e.setMetadata("min",l);e.setMetadata("max",m);a.setMetadata("min",n);a.setMetadata("max",r);this._output.direction=a;this._output.magnitude=e}}}]);return b}(ra),Fk=function(c){function b(){N(this,b);var a=P(this,(b.__proto__||Object.getPrototypeOf(b)).call(this));a.addInputValidator(0,S);a.setMetadata("max",NaN);return a}M(b,c);O(b,[{key:"_run",value:function(){if(this.hasValidInput()){var a=this._input[0],
b=a.getData(),c=a.hollowClone(),e=c.getData(),f=this.getMetadata("max");isNaN(f)&&(f=a.getMax());for(a=0;a<b.length;a++)e[a]=b[a]/f;this._output[0]=c}else console.warn("A filter of type */ requires 1 input of category '0'.")}}]);return b}(ra),Ce=function(c){function b(){N(this,b);var a=P(this,(b.__proto__||Object.getPrototypeOf(b)).call(this));a.addInputValidator(0,S);a.setMetadata("connexity",8);a.setMetadata("seed",[0,0]);a._directionListConnexity4=[[0,-1],[-1,0],[0,1],[1,0]];a._directionListConnexity8=
[[0,-1],[-1,-1],[-1,0],[-1,1],[0,1],[1,1],[1,0],[1,-1]];return a}M(b,c);O(b,[{key:"_run",value:function(){function a(a,b){if(a.length!=b.length)return!1;for(var c=0;c<a.length;c++)if(a[c]!=b[c])return!1;return!0}function b(){y[0]=x[0]+k[n][0];y[1]=x[1]+k[n][1];if(0>y[0]||0>y[1]||y[0]>=e||y[1]>=f)return 2;var b=c.getPixel({x:y[0],y:y[1]});if(a(b,r)){if(y[0]==w[0]&&y[1]==w[1])return 0;x[0]=y[0];x[1]=y[1];w.push(x[0]);w.push(x[1]);return 1}return 2}if(this.hasValidInput()){var c=this._getInput(0);c.getNcpp();
var e=c.getWidth(),f=c.getHeight(),k=null,k=8==this.getMetadata("connexity")?this._directionListConnexity8:this._directionListConnexity4,l=this._metadata.seed.slice(),m=k.length/4,n=m;if(0>l[0]||0>l[1]||l[0]>=e||l[1]>=f)console.warn("The seed is out of image range.");else{for(var r=c.getPixel({x:l[0],y:l[1]}),p=r,q=l.slice(),t=!1,p=0;p<this._directionListConnexity4.length;p++){var u=c.getPixel({x:l[0]+this._directionListConnexity4[p][0],y:l[1]+this._directionListConnexity4[p][1]});if(!a(u,r)){t=!0;
n=p;8==this.getMetadata("connexity")&&(n*=2);n+=m;break}}for(;!t;){q[0]+=k[0][0];q[1]+=k[0][1];if(0>q[0]){l[0]=0;l[1]=q[1];break}if((p=c.getPixel({x:q[0],y:q[1]}))&&a(p,r))l[0]=q[0],l[1]=q[1];else break}var x=l.slice(),y=[0,0],w=[];w.push(l[0]);w.push(l[1]);a:for(;;)if(n-=m,0>n&&(n=k.length-m),l=b(),0==l)break a;else if(1!=l){p=q=0;b:for(;p<k.length-1;p++)if(n++,n%=k.length,l=b(),0==l)break a;else if(1==l)break b;else q++;if(q==k.length-1)break}m=new Ic;m.setData(w);m.setMetadata("closed",!0);this._output[0]=
m}}else console.warn("A filter of type AngleToHueWheelHelper requires 1 input of category '0'.")}}]);return b}(V),Xh=function(c){function b(){N(this,b);var a=P(this,(b.__proto__||Object.getPrototypeOf(b)).call(this));a.addInputValidator(0,S);a.setMetadata("tolerance",1);a.setMetadata("connexity",4);a.setMetadata("color",null);a.setMetadata("onlyHits",!1);a._directionListConnexity4=[[0,-1],[-1,0],[0,1],[1,0]];a._directionListConnexity8=[[0,-1],[-1,-1],[-1,0],[-1,1],[0,1],[1,1],[1,0],[1,-1]];return a}
M(b,c);O(b,[{key:"_run",value:function(){if(this.hasValidInput()){var a=this._getInput(0),b=a.getNcpp(),c=a.getWidth(),e=a.getHeight(),f;f=8==this.getMetadata("connexity")?this._directionListConnexity8:this._directionListConnexity4;var k=Array(b);k[0]=255;k=this.getMetadata("color")||k;if(k.length==b||3==k.length&&4==b){var b=new S({width:c,height:e,color:[0]}),l=this.getMetadata("seed"),m=a.getPixel({x:l[0],y:l[1]}),n=this.getMetadata("tolerance"),r=this.getMetadata("onlyHits"),p=null;r||(p=a.clone());
var q=[],t=[];for(t.push(l);0<t.length;){var l=t.pop(),u=l[0],x=l[1];if(!(0>u||u>=c||0>x||x>=e)&&0==b.getPixel({x:u,y:x})[0]){b.setPixel({x:u,y:x},[1]);r||p.setPixel({x:u,y:x},k);for(var y=[0,0],w=!1,A=0;A<f.length;A++)if(y[0]=u+f[A][0],y[1]=x+f[A][1],!(0>y[0]||y[0]>=c||0>y[1]||y[1]>=e)){for(var z=a.getPixel({x:y[0],y:y[1]}),B=!0,C=0;C<m.length;C++)if(Math.abs(z[C]-m[C])>n){B=!1;w=!0;break}B&&t.push([y[0],y[1]])}w&&0!=u&&u!=c-1&&0!=x&&x!=e-1&&q.push(l)}}r||(this._output[0]=p);this._output.edgePoints=
q}else console.warn("The color to fill must have the same number of components as the input image. (RGB color for RGBA image is accepted)")}else console.warn("A filter of type FloodFillImageFilter requires 1 input of category '0'.")}}]);return b}(ra),Gk=function(c){function b(){N(this,b);var a=P(this,(b.__proto__||Object.getPrototypeOf(b)).call(this));a.addInputValidator(0,S);a.setMetadata("connexity",4);a.setMetadata("seed",[0,0]);return a}M(b,c);O(b,[{key:"_run",value:function(){if(this.hasValidInput()){var a=
this._getInput(0);a.getNcpp();a.getWidth();a.getHeight();var b=[],c=this.getMetadata("connexity"),e=this.getMetadata("seed"),f=new Ce;f.addInput(a);f.setMetadata("connexity",c);f.setMetadata("seed",e);f.update();b.push(f.getOutput());f=new Xh;f.addInput(a);f.setMetadata("onlyHits",!1);f.setMetadata("connexity",4);f.setMetadata("tolerance",0);f.setMetadata("seed",e);f.update();e=f.getOutput("edgePoints");f=new Ce;f.setMetadata("time",!1);for(var k=0;k<e.length;k++){for(var l=e[k],m=!1,n=0;n<b.length;n++)if(b[n].hasPoint(l)){m=
!0;break}m||(f.addInput(a),f.setMetadata("connexity",c),f.setMetadata("seed",l),f.update(),b.push(f.getOutput()))}for(k=0;k<b.length;k++)this._output[k]=b[k]}else console.warn("A filter of type ContourHolesImage2DFilter requires 1 input of category '0'.")}}]);return b}(V),Hk=function(c){function b(){N(this,b);var a=P(this,(b.__proto__||Object.getPrototypeOf(b)).call(this));a.addInputValidator(0,S);return a}M(b,c);O(b,[{key:"_run",value:function(){if(this.hasValidInput())if(this.hasEvent("pixel")){var a=
this._getInput(0);a.getNcpp();for(var b=a.getWidth(),c=a.getHeight(),e=0;e<c;e++)for(var f=0;f<b;f++){var k={x:f,y:e},l=a.getPixel(k);this.triggerEvent("pixel",k,l)}}else console.warn("No function to apply per pixel was specified.");else console.warn("A filter of type ForEachPixelReadOnlyFilter requires 1 input of category '0'.")}}]);return b}(V),Ik=function(c){function b(){N(this,b);var a=P(this,(b.__proto__||Object.getPrototypeOf(b)).call(this));a.addInputValidator(0,S);return a}M(b,c);O(b,[{key:"_run",
value:function(){if(this.hasValidInput()){var a=this._getInput(0),b=a.getNcpp(),c=a.getWidth(),e=a.getHeight();if(3>b)console.warn("A filter of type TerrainRgbToElevationImageFilter requires an input with at least 3 components per pixel.");else{var f=new pixpipe.Image2D({width:c,height:e,color:[0]}),b=new pixpipe.ForEachPixelReadOnlyFilter;b.addInput(a);b.on("pixel",function(a,b){f.setPixel(a,[-1E4+.1*(65536*b[0]+256*b[1]+b[2])])});b.update();this._output[0]=f}}else console.warn("A filter of type TerrainRgbToElevationImageFilter requires 1 input of category '0'.")}}]);
return b}(ra),Jk=function(c){function b(){N(this,b);var a=P(this,(b.__proto__||Object.getPrototypeOf(b)).call(this));a.setMetadata("outputSize",{width:0,height:0});return a}M(b,c);O(b,[{key:"_run",value:function(){var a;if("0"in this._input){a=this._input[0];var b=this.getMetadata("outputSize");if(0==b.width||0==b.height)console.warn("The output size cannot be 0.");else{for(var c=new pixpipe.Image2D({width:b.width,height:b.height,color:[0]}),e=0;e<b.width;e++)for(var f=0;f<b.height;f++){for(var k=
0,l=Infinity,m=0;m<a.length;m++){var n=Math.sqrt(Math.pow(a[m].x-e,2)+Math.pow(a[m].y-f,2));n<l&&(l=n,k=m)}c.setPixel({x:e,y:f},[a[k].value])}this._output[0]=c}}else console.warn("No input point set were given.")}}]);return b}(V),Kk=function(c){function b(){N(this,b);var a=P(this,(b.__proto__||Object.getPrototypeOf(b)).call(this));a.setMetadata("strength",2);a.setMetadata("outputSize",{width:0,height:0});return a}M(b,c);O(b,[{key:"_run",value:function(){var a;if("0"in this._input){a=this._input[0];
var b=this.getMetadata("outputSize");if(0==b.width||0==b.height)console.warn("The output size cannot be 0.");else{for(var c=new pixpipe.Image2D({width:b.width,height:b.height,color:[0]}),e=this.getMetadata("strength"),f=0;f<b.width;f++)for(var k=0;k<b.height;k++){90==f&&90==k&&console.log("here");for(var l=0,m=0,n=null,r=!1,p=0;p<a.length;p++){var q=Math.sqrt(Math.pow(a[p].x-f,2)+Math.pow(a[p].y-k,2));if(0==q){r=!0;n=a[p].value;break}l+=a[p].value/Math.pow(q,e);m+=1/Math.pow(q,e)}c.setPixel({x:f,
y:k},[r?n:l/m])}this._output[0]=c}}else console.warn("No input point set were given.")}}]);return b}(V),Yh=qa(function(c){var b;(function(){function a(a){var b=Number.POSITIVE_INFINITY,c=Number.POSITIVE_INFINITY,d=Number.NEGATIVE_INFINITY,e=Number.NEGATIVE_INFINITY,g;for(g=a.length;g--;)a[g][0]<b&&(b=a[g][0]),a[g][0]>d&&(d=a[g][0]),a[g][1]<c&&(c=a[g][1]),a[g][1]>e&&(e=a[g][1]);a=d-b;d=e-c;e=Math.max(a,d);b+=.5*a;c+=.5*d;return[[b-20*e,c-e],[b,c+20*e],[b+20*e,c-e]]}function d(a,b,c,d){var g=a[b][0],
f=a[b][1],k=a[c][0],l=a[c][1],m=a[d][0],p=a[d][1],u=Math.abs(f-l),y=Math.abs(l-p),w,A;if(u<e&&y<e)throw Error("Eek! Coincident points!");u<e?(a=(k+g)/2,u=-((m-k)/(p-l))*(a-(k+m)/2)+(l+p)/2):y<e?(a=(m+k)/2,u=-((k-g)/(l-f))*(a-(g+k)/2)+(f+l)/2):(w=-((k-g)/(l-f)),A=-((m-k)/(p-l)),g=(g+k)/2,m=(k+m)/2,f=(f+l)/2,p=(l+p)/2,a=(w*g-A*m+p-f)/(w-A),u=u>y?w*(a-g)+f:A*(a-m)+p);k-=a;l-=u;return{i:b,j:c,k:d,x:a,y:u,r:k*k+l*l}}function g(a){var b,c,d,e,g,f;for(c=a.length;c;)for(e=a[--c],d=a[--c],b=c;b;)if(f=a[--b],
g=a[--b],d===g&&e===f||d===f&&e===g){a.splice(c,2);a.splice(b,2);break}}var e=1/1048576;b={triangulate:function(b,c){var f=b.length,k,n,p,u,q,t,y,x;if(3>f)return[];b=b.slice(0);if(c)for(k=f;k--;)b[k]=b[k][c];c=Array(f);for(k=f;k--;)c[k]=k;c.sort(function(a,c){var d=b[c][0]-b[a][0];return 0!==d?d:a-c});k=a(b);b.push(k[0],k[1],k[2]);p=[d(b,f+0,f+1,f+2)];u=[];q=[];for(k=c.length;k--;q.length=0){x=c[k];for(n=p.length;n--;)t=b[x][0]-p[n].x,0<t&&t*t>p[n].r?(u.push(p[n]),p.splice(n,1)):(y=b[x][1]-p[n].y,
t*t+y*y-p[n].r>e||(q.push(p[n].i,p[n].j,p[n].j,p[n].k,p[n].k,p[n].i),p.splice(n,1)));g(q);for(n=q.length;n;)y=q[--n],t=q[--n],p.push(d(b,t,y,x))}for(k=p.length;k--;)u.push(p[k]);p.length=0;for(k=u.length;k--;)u[k].i<f&&u[k].j<f&&u[k].k<f&&p.push(u[k].i,u[k].j,u[k].k);return p},contains:function(a,b){if(b[0]<a[0][0]&&b[0]<a[1][0]&&b[0]<a[2][0]||b[0]>a[0][0]&&b[0]>a[1][0]&&b[0]>a[2][0]||b[1]<a[0][1]&&b[1]<a[1][1]&&b[1]<a[2][1]||b[1]>a[0][1]&&b[1]>a[1][1]&&b[1]>a[2][1])return null;var c=a[1][0]-a[0][0],
d=a[2][0]-a[0][0],e=a[1][1]-a[0][1],g=a[2][1]-a[0][1],f=c*g-d*e;if(0===f)return null;d=(g*(b[0]-a[0][0])-d*(b[1]-a[0][1]))/f;a=(c*(b[1]-a[0][1])-e*(b[0]-a[0][0]))/f;return 0>d||0>a||1<d+a?null:[d,a]}};c.exports=b})()}),Lk=function(c){function b(){N(this,b);var a=P(this,(b.__proto__||Object.getPrototypeOf(b)).call(this));a.setMetadata("outputSize",{width:0,height:0});return a}M(b,c);O(b,[{key:"_run",value:function(){function a(a,b,c){var d=[a[0]-b[0],a[1]-b[1]];b=[b[0]-c[0],b[1]-c[1]];c=[c[0]-a[0],
c[1]-a[1]];a=Math.sqrt(b[0]*b[0]+b[1]*b[1]);c=Math.sqrt(c[0]*c[0]+c[1]*c[1]);d=Math.sqrt(d[0]*d[0]+d[1]*d[1]);b=(a+c+d)/2;return Math.sqrt(b*(b-a)*(b-c)*(b-d))}var b=null;if("0"in this._input){var b=this._input[0],c=this.getMetadata("outputSize");if(0==c.width||0==c.height)console.warn("The output size cannot be 0.");else{for(var e=b.map(function(a){return[a.x,a.y]}),f=Yh.triangulate(e),k=[],l=0;l<=f.length-3;l+=3)k.push([f[l],f[l+1],f[l+2]]);console.log(e);console.log(k);f=new pixpipe.Image2D({width:Math.round(c.width),
height:Math.round(c.height),color:[0]});for(l=0;l<c.width;l++)for(var m=0;m<c.height;m++){for(var n=0,p=!1,u=0,q=0;q<k.length;q++)if(Yh.contains([e[k[q][0]],e[k[q][1]],e[k[q][2]]],[l,m])){p=!0;u=k[q];break}if(p)var q=e[u[0]],t=e[u[1]],y=e[u[2]],x=[l,m],n=a(q,t,y),p=a(q,t,x),t=a(t,y,x),q=a(y,q,x),n=p/n*b[u[2]].value+t/n*b[u[0]].value+q/n*b[u[1]].value;f.setPixel({x:l,y:m},[n])}this._output[0]=f}}else console.warn("No input point set were given.")}}]);return b}(V),Mk=function(c){function b(){N(this,
b);var a=P(this,(b.__proto__||Object.getPrototypeOf(b)).call(this));a.addInputValidator(0,S);a.setMetadata("x",0);a.setMetadata("y",0);a.setMetadata("w",0);a.setMetadata("h",0);return a}M(b,c);O(b,[{key:"_run",value:function(){if(this.hasValidInput()){var a=Math.round(this.getMetadata("x")),b=Math.round(this.getMetadata("y")),c=Math.round(this.getMetadata("w")),e=Math.round(this.getMetadata("h")),f=a+c,k=b+e,l=this._getInput(0),m=l.getWidth(),n=l.getHeight(),p=l.getNcpp();if(0>a||0>b||a>=m||b>=n||
0>f||0>k||f>=m||k>=n)console.warn("The query area is out of bound");else{f=l.getData();p=new S({width:c,height:e,color:new f.constructor(p)});for(f=0;f<c;f++)for(k=0;k<e;k++)m=l.getPixel({x:f+a,y:k+b}),p.setPixel({x:f,y:k},m);this._output[0]=p}}else console.warn("A filter of type CropImageFilter requires 1 input of category '0' (Image2D)")}}]);return b}(ra),Nk=qa(function(c){(function(){c.exports=function(b,a,c){a=void 0!==a?a*a:1;var d;if(c)d=b;else{c=b[0];for(var e=[c],f=1,k=b.length;f<k;f++){d=
b[f];var l=d.x-c.x,m=d.y-c.y;l*l+m*m>a&&(e.push(d),c=d)}c!==d&&e.push(d);d=e}b=d.length;c=new ("undefined"!==typeof Uint8Array?Uint8Array:Array)(b);var e=0,f=b-1,k=[],l=[],n,p,u;for(c[e]=c[f]=1;f;){n=0;for(m=e+1;m<f;m++){p=d[m];var q=d[e],t=d[f],y=q.x,q=q.y,x=t.x-y,z=t.y-q;if(0!==x||0!==z){var w=((p.x-y)*x+(p.y-q)*z)/(x*x+z*z);1<w?(y=t.x,q=t.y):0<w&&(y+=x*w,q+=z*w)}x=p.x-y;z=p.y-q;p=x*x+z*z;p>n&&(u=m,n=p)}n>a&&(c[u]=1,k.push(e,u,u,f));f=k.pop();e=k.pop()}for(m=0;m<b;m++)c[m]&&l.push(d[m]);return l}})()}),
Ok=function(c){function b(){N(this,b);var a=P(this,(b.__proto__||Object.getPrototypeOf(b)).call(this));a.addInputValidator(0,Ic);a.setMetadata("tolerance",.1);return a}M(b,c);O(b,[{key:"_run",value:function(){if(this.hasValidInput()){var a=this._getInput(0),b=a.getNod(),c=a.getData(),e=this.getMetadata("tolerance");if(2!=b)console.warn("SimplifyLineStringFilter is only for 2D LineStrings.");else{for(var f=Array(c.length/2),k=0;k<f.length;k++)f[k]={x:c[2*k],y:c[2*k+1]};e=Nk(f,e,!0);c=Array(2*e.length);
for(k=0;k<e.length-1;k++)c[2*k]=e[k].x,c[2*k+1]=e[k+1].y;k=new Ic;k.setData(c,b);k.copyMetadataFrom(a);this._output[0]=k}}else console.warn("A filter of type SimplifyLineStringFilter requires 1 input of category '0' (LineString)")}}]);return b}(V),Zh=function(c){function b(){N(this,b);var a=P(this,(b.__proto__||Object.getPrototypeOf(b)).call(this));a.addInputValidator(0,S);a.setMetadata("outputSize",{w:0,h:0});a.setMetadata("outputColor",[0,0,0,255]);a.setMetadata("patchPosition",{x:0,y:0});a.setMetadata("resetOutput",
!0);a._patchedOutput=null;return a}M(b,c);O(b,[{key:"_run",value:function(){if(this.hasValidInput()){var a=this._getInput(0),b=a.getNcpp(),c=a.getWidth(),e=a.getHeight(),f=this.getMetadata("outputSize");if(0==f.w||0==f.h)console.warn("The output image cannot have a size of (0, 0). Use .setMetadata( 'outputSize', {w: Number, h:Number} ) to specify a size.");else{var k=this.getMetadata("outputColor");if(Array.isArray(k)){var l=k.length;if(b!=l)console.warn("The Image2D specified in input has "+b+" ncpp while the output is configured with "+
l+" ncpp. Unable to continue patching.");else{this.getMetadata("resetOutput")&&(this._patchedOutput=new pixpipe.Image2D({width:f.w,height:f.h,color:k}));this._output[0]=this._patchedOutput;b=this.getMetadata("patchPosition");b.x=Math.round(b.x);b.y=Math.round(b.y);(b.x+c>f.w||b.y+e>f.h||0>b.x||0>b.y)&&console.warn("The patch is partly or totaly out of bound.");for(f=0;f<c;f++)for(k=0;k<e;k++)l=a.getPixel({x:f,y:k}),this._patchedOutput.setPixel({x:f+b.x,y:k+b.y},l);this.setMetadata("resetOutput",!1)}}else console.warn("The filter metadata 'outputColor' must be an Array of non null size.")}}else console.warn("A filter of type PatchImageFilter requires 1 input of category '0' (Image2D)")}}]);
return b}(ra);(function(){function c(a){this.value=a}function b(a){function b(d,e){try{var f=a[d](e),k=f.value;k instanceof c?Promise.resolve(k.value).then(function(a){b("next",a)},function(a){b("throw",a)}):g(f.done?"return":"normal",f.value)}catch(r){g("throw",r)}}function g(a,c){switch(a){case "return":e.resolve({value:c,done:!0});break;case "throw":e.reject(c);break;default:e.resolve({value:c,done:!1})}(e=e.next)?b(e.key,e.arg):f=null}var e,f;this._invoke=function(a,c){return new Promise(function(d,
g){d={key:a,arg:c,resolve:d,reject:g,next:null};f?f=f.next=d:(e=f=d,b(a,c))})};"function"!==typeof a.return&&(this.return=void 0)}"function"===typeof Symbol&&Symbol.asyncIterator&&(b.prototype[Symbol.asyncIterator]=function(){return this});b.prototype.next=function(a){return this._invoke("next",a)};b.prototype.throw=function(a){return this._invoke("throw",a)};b.prototype.return=function(a){return this._invoke("return",a)};return{wrap:function(a){return function(){return new b(a.apply(this,arguments))}},
await:function(a){return new c(a)}}})();var Pk=function(){function c(b,a){for(var c=0;c<a.length;c++){var g=a[c];g.enumerable=g.enumerable||!1;g.configurable=!0;"value"in g&&(g.writable=!0);Object.defineProperty(b,g.key,g)}}return function(b,a,d){a&&c(b.prototype,a);d&&c(b,d);return b}}(),Qk=function(){function c(){if(!(this instanceof c))throw new TypeError("Cannot call a class as a function");this._bCoefficients=this._aCoefficients=this._outputSignal=this._inputSignal=null;this._enableBackwardSecondPass=
!1}Pk(c,[{key:"setInput",value:function(b){this._outputSignal=null;this._inputSignal=b}},{key:"setACoefficients",value:function(b){this._aCoefficients=b}},{key:"setBCoefficients",value:function(b){this._bCoefficients=b}},{key:"getOutput",value:function(){return this._outputSignal}},{key:"enableBackwardSecondPass",value:function(){this._enableBackwardSecondPass=!0}},{key:"disableBackwardSecondPass",value:function(){this._enableBackwardSecondPass=!1}},{key:"run",value:function(){function b(a){for(var b=
0,d=0;d<=k;d++)var m=d>a?0:c[a-d],b=b+e[d]*m;for(var d=0,n=1;n<=l;n++)m=n>a?0:g[a-n],d+=f[n]*m;return b-d}for(var a=(new Float32Array(this._inputSignal.length)).fill(0),c=this._inputSignal,g=a,e=this._bCoefficients,f=this._aCoefficients,k=e.length-1,l=f.length-1,m=0;m<a.length;m++)a[m]=b(m);if(this._enableBackwardSecondPass){a.reverse();c=a;g=a=(new Float32Array(this._inputSignal.length)).fill(0);for(m=0;m<a.length;m++)a[m]=b(m);a.reverse()}this._outputSignal=a}}]);return c}(),Rk=function(c){function b(){N(this,
b);var a=P(this,(b.__proto__||Object.getPrototypeOf(b)).call(this));a.addInputValidator(0,za);a.setMetadata("coefficientsB",null);a.setMetadata("coefficientsA",null);a.setMetadata("enableBackwardSecondPass",!0);return a}M(b,c);O(b,[{key:"_run",value:function(){if(this.hasValidInput()){var a=this._getInput(0),b=this.getMetadata("coefficientsB"),c=this.getMetadata("coefficientsA"),e=this.getMetadata("enableBackwardSecondPass");if(c&&b)if(c.length!=b.length)console.warn("The 'coefficientsB' and 'coefficientsA' metadata must be arrays of the same size.");
else{var f=new Qk;e&&f.enableBackwardSecondPass();f.setInput(a.getData());f.setACoefficients(c);f.setBCoefficients(b);f.run();if(b=f.getOutput())c=new za,c.copyMetadataFrom(a),c.setData(b),this._output[0]=c}else console.warn("Both 'coefficientsB' and 'coefficientsA' metadata must be set to arrays of numbers.")}}}]);return b}(V),$h=function(){function c(){N(this,c)}O(c,null,[{key:"gaussianFrequencyResponse",value:function(b,a,d){for(var g=3<arguments.length&&void 0!==arguments[3]?arguments[3]:1,e=
4<arguments.length&&void 0!==arguments[4]?arguments[4]:0,f=[],k=!1,l=Infinity,m=-Infinity,n=a;n<=d;n+=g){var p=c.gaussianFrequencyResponseSingle(b,n);if(p>e)k||(l=n,k=!0),f.push(p),m=n;else if(k)break}return{data:new Float32Array(f),actualBegin:l,actualEnd:m}}},{key:"gaussianFrequencyResponseSingle",value:function(b,a){return Math.exp(-(a*a/(2*b*b)))}}]);return c}(),ai=["gaussian","rectangular"],bi=function(c){function b(){N(this,b);var a=P(this,(b.__proto__||Object.getPrototypeOf(b)).call(this));
a.addInputValidator("real",za);a.addInputValidator("imaginary",za);a.setMetadata("cutoffFrequency",0);a.setMetadata("filterType","gaussian");a.setMetadata("gaussianTolerance",.01);return a}M(b,c);O(b,[{key:"_run",value:function(){if(this.hasValidInput()){var a=this._getInput("real"),b=this._getInput("imaginary"),c=this.getMetadata("cutoffFrequency"),e=this.getMetadata("filterType");0==c?console.warn("The cutoff frequency cannot be 0."):-1==ai.indexOf(e)?console.warn("The filter type must be one of: "+
ai.join(", ")):(a=a.clone(),b=b.clone(),this["_"+e](a,b,c)&&(this._output.real=a,this._output.imaginary=b))}else console.warn("A filter of type LowPassFreqSignal1D requires 2 input of type Signal1D and of category: 'real' and 'imaginary'.")}},{key:"_getDataIndexFromFrequency",value:function(a,b){return Math.round(b*a.getData().length/a.getMetadata("samplingFrequency"))}},{key:"_rectangular",value:function(a,b,c){a.getMetadata("samplingFrequency");c=this._getDataIndexFromFrequency(a,c);a=a.getData();
b=b.getData();for(var d=c;d<a.length-c;d++)a[d]=0,b[d]=0;return!0}},{key:"_gaussian",value:function(a,b,c){a.getMetadata("samplingFrequency");var d=this._getDataIndexFromFrequency(a,c);a=a.getData();b=b.getData();var g=a.length,k=Math.floor(g/2),l=this.getMetadata("gaussianTolerance");c=$h.gaussianFrequencyResponse(c,0,Math.floor(b.length/2),c/d,l).data;for(d=0;d<c.length&&!(d>=k);d++)a[d]*=c[d],b[d]*=c[d],a[g-1-d]*=c[d],b[g-1-d]*=c[d];try{var m=new Float32Array(a.length-2*c.length);a.set(m,c.length);
b.set(m,c.length)}catch(n){}return!0}}]);return b}(V),ci=function(c){function b(){N(this,b);var a=P(this,(b.__proto__||Object.getPrototypeOf(b)).call(this));a.addInputValidator(0,za);a.setMetadata("cutoffFrequency",0);a.setMetadata("filterType","gaussian");a.setMetadata("gaussianTolerance",.01);return a}M(b,c);O(b,[{key:"_run",value:function(){if(this.hasValidInput()){var a=this._getInput(),b=a.getMetadata("samplingFrequency"),c=this.getMetadata("cutoffFrequency"),e=this.getMetadata("filterType"),
f=this.getMetadata("gaussianTolerance");if(c>b/2)console.warn("The cutoff frequency cannot be greater than half of the sampling frequency (cf. Nyquist).");else{var k=a.hollowClone(),b=new Vh;b.addInput(a,0);b.addInput(k,1);b.update();a=b.getOutput(0);k=b.getOutput(1);b=new bi;b.addInput(a,"real");b.addInput(k,"imaginary");b.setMetadata("filterType",e);b.setMetadata("cutoffFrequency",c);b.setMetadata("gaussianTolerance",f);b.update();c=b.getOutput("real");e=b.getOutput("imaginary");f=new pixpipe.InverseFourierSignalFilter;
f.addInput(c,0);f.addInput(e,1);f.update();(c=f.getOutput())&&(this._output[0]=c)}}else console.warn("A filter of type LowPassSignal1D requires 1 input of type Signal1D and of category 0")}}]);return b}(V),Sk=function(c){function b(){N(this,b);var a=P(this,(b.__proto__||Object.getPrototypeOf(b)).call(this));a.addInputValidator(0,za);a.setMetadata("cutoffFrequency",0);a.setMetadata("filterType","gaussian");a.setMetadata("gaussianTolerance",.01);return a}M(b,c);O(b,[{key:"_run",value:function(){if(this.hasValidInput()){var a=
this._getInput(),b=a.getMetadata("samplingFrequency"),c=this.getMetadata("cutoffFrequency"),e=this.getMetadata("filterType"),f=this.getMetadata("gaussianTolerance");if(c>b/2)console.warn("The cutoff frequency cannot be greater than half of the sampling frequency (cf. Nyquist).");else if(b=new ci,b.setMetadata("cutoffFrequency",c),b.setMetadata("filterType",e),b.setMetadata("gaussianTolerance",f),b.addInput(a),b.update(),e=b.getOutput()){a=a.clone();c=a.getData();e=e.getData();for(f=0;f<c.length;f++)c[f]-=
e[f];this._output[0]=a}else console.warn("couldnt compute the low pass filter.")}else console.warn("A filter of type HighPassSignal1D requires 1 input of type Signal1D and of category 0")}}]);return b}(V),Tk=function(c){function b(){N(this,b);var a=P(this,(b.__proto__||Object.getPrototypeOf(b)).call(this));a.addInputValidator(0,za);a.setMetadata("hiCutoffFrequency",0);a.setMetadata("loCutoffFrequency",0);a.setMetadata("filterType","gaussian");a.setMetadata("gaussianTolerance",.01);return a}M(b,c);
O(b,[{key:"_run",value:function(){if(this.hasValidInput()){var a=this._getInput(),b=a.getMetadata("samplingFrequency"),c=this.getMetadata("hiCutoffFrequency"),e=this.getMetadata("loCutoffFrequency"),f=this.getMetadata("filterType"),k=this.getMetadata("gaussianTolerance");0===c&&0===e?console.warn("At least one of the following metadata must be greater than zero: hiCutoffFrequency loCutoffFrequency"):c>b/2||e>b/2?console.warn("The cutoff frequency cannot be greater than half of the sampling frequency (cf. Nyquist)."):
0<e&&0<c&&c>e?console.warn("Band pass filter: the hiCutoffFrequency cannot be greater than the loCutoffFrequency."):(b=null,0<e&&(b=new pixpipe.LowPassSignal1D,b.addInput(a),b.setMetadata("cutoffFrequency",e),b.setMetadata("filterType",f),b.setMetadata("gaussianTolerance",k),b.update(),b=b.getOutput()),0<c&&(e=new pixpipe.HighPassSignal1D,e.addInput(b||a),e.setMetadata("cutoffFrequency",c),e.setMetadata("filterType",f),e.setMetadata("gaussianTolerance",k),e.update(),b=e.getOutput()),this._output[0]=
b)}else console.warn("A filter of type BandPassSignal1D requires 1 input of type Signal1D and of category 0")}}]);return b}(V),Uk=function(c){function b(){N(this,b);var a=P(this,(b.__proto__||Object.getPrototypeOf(b)).call(this));a.addInputValidator(0,S);a.setMetadata("component",0);a.setMetadata("minAngle",0);a.setMetadata("maxAngle",Math.PI/2);return a}M(b,c);O(b,[{key:"_run",value:function(){if(this.hasValidInput()){var a=this,b=this._getInput(0).getNcpp(),c=this.getMetadata("component");if(0>
c&&c>=b)console.warn("The component to filter must be valid.");else{var e=this._getInput(),f=e.getWidth(),k=e.getHeight(),b=e.getNcpp(),l=this.getMetadata("minAngle"),m=this.getMetadata("maxAngle");if("auto"===l||"auto"===m)l=e.getMin(),m=e.getMax();b=new S({width:f,height:k,color:[0,0,0,255]});f=new pixpipe.ForEachPixelImageFilter;f.addInput(b);f.on("pixel",function(b,d){b=(e.getPixel(b)[c]-l)/(m-l)*360;return a._hsl2Rgba(b,100,50)});f.update();0==f.getNumberOfOutputs()?console.warn("No output of ForEachPixelImageFilter."):
this._output[0]=f.getOutput()}}else console.warn("A filter of type AngleToHueWheelHelper requires 1 input of category '0'.")}},{key:"_hsl2Rgba",value:function(a){var b=1<arguments.length&&void 0!==arguments[1]?arguments[1]:100,c=2<arguments.length&&void 0!==arguments[2]?arguments[2]:100,e;a=360===a?1:a%360/360;b=100===b?1:b%100/100;c=100===c?1:c%100/100;if(0===b)c=b=e=c;else{e=function(a,b,c){0>c&&(c+=1);1<c&&--c;return c<1/6?a+6*(b-a)*c:.5>c?b:c<2/3?a+(b-a)*(2/3-c)*6:a};var f=.5>c?c*(1+b):c+b-c*
b,k=2*c-f,c=e(k,f,a+1/3),b=e(k,f,a);e=e(k,f,a-1/3)}return[Math.round(255*c),Math.round(255*b),Math.round(255*e),255]}}]);return b}(ra),Vk=function(c){function b(){N(this,b);var a=P(this,(b.__proto__||Object.getPrototypeOf(b)).call(this));a.addInputValidator(0,S);a.setMetadata("lineStrings",[]);a.setMetadata("lineStringsColors",[]);return a}M(b,c);O(b,[{key:"addLineString",value:function(a,b){this._metadata.lineStrings.push(a);this._metadata.lineStringsColors.push(b)}},{key:"_run",value:function(){if(this.hasValidInput()){var a=
this._getInput(),b=a.clone();a.getWidth();a.getHeight();for(var a=a.getNcpp(),c=!1,e=this._metadata.lineStrings,f=this._metadata.lineStringsColors,k=0;k<e.length;k++)if(2!=e[k].getMetadata("nod"))console.warn("Linstring must be 2D to be printed on images.");else if(a==f[k].length||4==a&&3==f[k].length){for(var c=e[k].getData(),l=0;l<c.length-1;l+=2)b.setPixel({x:c[l],y:c[l+1]},f[k]);c=!0}c&&(this._output[0]=b)}else console.warn("A filter of type LineStringPrinterOnImage2DHelper requires 1 input of category '0'.")}}]);
return b}(ra),yd={jet:[{index:0,rgb:[0,0,131]},{index:.125,rgb:[0,60,170]},{index:.375,rgb:[5,255,255]},{index:.625,rgb:[255,255,0]},{index:.875,rgb:[250,0,0]},{index:1,rgb:[128,0,0]}],hsv:[{index:0,rgb:[255,0,0]},{index:.169,rgb:[253,255,2]},{index:.173,rgb:[247,255,2]},{index:.337,rgb:[0,252,4]},{index:.341,rgb:[0,252,10]},{index:.506,rgb:[1,249,255]},{index:.671,rgb:[2,0,253]},{index:.675,rgb:[8,0,253]},{index:.839,rgb:[255,0,251]},{index:.843,rgb:[255,0,245]},{index:1,rgb:[255,0,6]}],hot:[{index:0,
rgb:[0,0,0]},{index:.3,rgb:[230,0,0]},{index:.6,rgb:[255,210,0]},{index:1,rgb:[255,255,255]}],cool:[{index:0,rgb:[0,255,255]},{index:1,rgb:[255,0,255]}],spring:[{index:0,rgb:[255,0,255]},{index:1,rgb:[255,255,0]}],summer:[{index:0,rgb:[0,128,102]},{index:1,rgb:[255,255,102]}],autumn:[{index:0,rgb:[255,0,0]},{index:1,rgb:[255,255,0]}],winter:[{index:0,rgb:[0,0,255]},{index:1,rgb:[0,255,128]}],bone:[{index:0,rgb:[0,0,0]},{index:.376,rgb:[84,84,116]},{index:.753,rgb:[169,200,200]},{index:1,rgb:[255,
255,255]}],copper:[{index:0,rgb:[0,0,0]},{index:.804,rgb:[255,160,102]},{index:1,rgb:[255,199,127]}],greys:[{index:0,rgb:[0,0,0]},{index:1,rgb:[255,255,255]}],yignbu:[{index:0,rgb:[8,29,88]},{index:.125,rgb:[37,52,148]},{index:.25,rgb:[34,94,168]},{index:.375,rgb:[29,145,192]},{index:.5,rgb:[65,182,196]},{index:.625,rgb:[127,205,187]},{index:.75,rgb:[199,233,180]},{index:.875,rgb:[237,248,217]},{index:1,rgb:[255,255,217]}],greens:[{index:0,rgb:[0,68,27]},{index:.125,rgb:[0,109,44]},{index:.25,rgb:[35,
139,69]},{index:.375,rgb:[65,171,93]},{index:.5,rgb:[116,196,118]},{index:.625,rgb:[161,217,155]},{index:.75,rgb:[199,233,192]},{index:.875,rgb:[229,245,224]},{index:1,rgb:[247,252,245]}],yiorrd:[{index:0,rgb:[128,0,38]},{index:.125,rgb:[189,0,38]},{index:.25,rgb:[227,26,28]},{index:.375,rgb:[252,78,42]},{index:.5,rgb:[253,141,60]},{index:.625,rgb:[254,178,76]},{index:.75,rgb:[254,217,118]},{index:.875,rgb:[255,237,160]},{index:1,rgb:[255,255,204]}],bluered:[{index:0,rgb:[0,0,255]},{index:1,rgb:[255,
0,0]}],rdbu:[{index:0,rgb:[5,10,172]},{index:.35,rgb:[106,137,247]},{index:.5,rgb:[190,190,190]},{index:.6,rgb:[220,170,132]},{index:.7,rgb:[230,145,90]},{index:1,rgb:[178,10,28]}],picnic:[{index:0,rgb:[0,0,255]},{index:.1,rgb:[51,153,255]},{index:.2,rgb:[102,204,255]},{index:.3,rgb:[153,204,255]},{index:.4,rgb:[204,204,255]},{index:.5,rgb:[255,255,255]},{index:.6,rgb:[255,204,255]},{index:.7,rgb:[255,153,255]},{index:.8,rgb:[255,102,204]},{index:.9,rgb:[255,102,102]},{index:1,rgb:[255,0,0]}],rainbow:[{index:0,
rgb:[150,0,90]},{index:.125,rgb:[0,0,200]},{index:.25,rgb:[0,25,255]},{index:.375,rgb:[0,152,255]},{index:.5,rgb:[44,255,150]},{index:.625,rgb:[151,255,0]},{index:.75,rgb:[255,234,0]},{index:.875,rgb:[255,111,0]},{index:1,rgb:[255,0,0]}],portland:[{index:0,rgb:[12,51,131]},{index:.25,rgb:[10,136,186]},{index:.5,rgb:[242,211,56]},{index:.75,rgb:[242,143,56]},{index:1,rgb:[217,30,30]}],blackbody:[{index:0,rgb:[0,0,0]},{index:.2,rgb:[230,0,0]},{index:.4,rgb:[230,210,0]},{index:.7,rgb:[255,255,255]},
{index:1,rgb:[160,200,255]}],earth:[{index:0,rgb:[0,0,130]},{index:.1,rgb:[0,180,180]},{index:.2,rgb:[40,210,40]},{index:.4,rgb:[230,230,50]},{index:.6,rgb:[120,70,20]},{index:1,rgb:[255,255,255]}],electric:[{index:0,rgb:[0,0,0]},{index:.15,rgb:[30,0,100]},{index:.4,rgb:[120,0,100]},{index:.6,rgb:[160,90,0]},{index:.8,rgb:[230,200,0]},{index:1,rgb:[255,250,220]}],viridis:[{index:0,rgb:[68,1,84]},{index:.13,rgb:[71,44,122]},{index:.25,rgb:[59,81,139]},{index:.38,rgb:[44,113,142]},{index:.5,rgb:[33,
144,141]},{index:.63,rgb:[39,173,129]},{index:.75,rgb:[92,200,99]},{index:.88,rgb:[170,220,50]},{index:1,rgb:[253,231,37]}],inferno:[{index:0,rgb:[0,0,4]},{index:.13,rgb:[31,12,72]},{index:.25,rgb:[85,15,109]},{index:.38,rgb:[136,34,106]},{index:.5,rgb:[186,54,85]},{index:.63,rgb:[227,89,51]},{index:.75,rgb:[249,140,10]},{index:.88,rgb:[249,201,50]},{index:1,rgb:[252,255,164]}],magma:[{index:0,rgb:[0,0,4]},{index:.13,rgb:[28,16,68]},{index:.25,rgb:[79,18,123]},{index:.38,rgb:[129,37,129]},{index:.5,
rgb:[181,54,122]},{index:.63,rgb:[229,80,100]},{index:.75,rgb:[251,135,97]},{index:.88,rgb:[254,194,135]},{index:1,rgb:[252,253,191]}],plasma:[{index:0,rgb:[13,8,135]},{index:.13,rgb:[75,3,161]},{index:.25,rgb:[125,3,168]},{index:.38,rgb:[168,34,150]},{index:.5,rgb:[203,70,121]},{index:.63,rgb:[229,107,93]},{index:.75,rgb:[248,148,65]},{index:.88,rgb:[253,195,40]},{index:1,rgb:[240,249,33]}],warm:[{index:0,rgb:[125,0,179]},{index:.13,rgb:[172,0,187]},{index:.25,rgb:[219,0,170]},{index:.38,rgb:[255,
0,130]},{index:.5,rgb:[255,63,74]},{index:.63,rgb:[255,123,0]},{index:.75,rgb:[234,176,0]},{index:.88,rgb:[190,228,0]},{index:1,rgb:[147,255,0]}],cool2:[{index:0,rgb:[125,0,179]},{index:.13,rgb:[116,0,218]},{index:.25,rgb:[98,74,237]},{index:.38,rgb:[68,146,231]},{index:.5,rgb:[0,204,197]},{index:.63,rgb:[0,247,146]},{index:.75,rgb:[0,255,88]},{index:.88,rgb:[40,255,8]},{index:1,rgb:[147,255,0]}],"rainbow-soft":[{index:0,rgb:[125,0,179]},{index:.1,rgb:[199,0,180]},{index:.2,rgb:[255,0,121]},{index:.3,
rgb:[255,108,0]},{index:.4,rgb:[222,194,0]},{index:.5,rgb:[150,255,0]},{index:.6,rgb:[0,255,55]},{index:.7,rgb:[0,246,150]},{index:.8,rgb:[50,167,222]},{index:.9,rgb:[103,51,235]},{index:1,rgb:[124,0,186]}],bathymetry:[{index:0,rgb:[40,26,44]},{index:.13,rgb:[59,49,90]},{index:.25,rgb:[64,76,139]},{index:.38,rgb:[63,110,151]},{index:.5,rgb:[72,142,158]},{index:.63,rgb:[85,174,163]},{index:.75,rgb:[120,206,163]},{index:.88,rgb:[187,230,172]},{index:1,rgb:[253,254,204]}],cdom:[{index:0,rgb:[47,15,62]},
{index:.13,rgb:[87,23,86]},{index:.25,rgb:[130,28,99]},{index:.38,rgb:[171,41,96]},{index:.5,rgb:[206,67,86]},{index:.63,rgb:[230,106,84]},{index:.75,rgb:[242,149,103]},{index:.88,rgb:[249,193,135]},{index:1,rgb:[254,237,176]}],chlorophyll:[{index:0,rgb:[18,36,20]},{index:.13,rgb:[25,63,41]},{index:.25,rgb:[24,91,59]},{index:.38,rgb:[13,119,72]},{index:.5,rgb:[18,148,80]},{index:.63,rgb:[80,173,89]},{index:.75,rgb:[132,196,122]},{index:.88,rgb:[175,221,162]},{index:1,rgb:[215,249,208]}],density:[{index:0,
rgb:[54,14,36]},{index:.13,rgb:[89,23,80]},{index:.25,rgb:[110,45,132]},{index:.38,rgb:[120,77,178]},{index:.5,rgb:[120,113,213]},{index:.63,rgb:[115,151,228]},{index:.75,rgb:[134,185,227]},{index:.88,rgb:[177,214,227]},{index:1,rgb:[230,241,241]}],"freesurface-blue":[{index:0,rgb:[30,4,110]},{index:.13,rgb:[47,14,176]},{index:.25,rgb:[41,45,236]},{index:.38,rgb:[25,99,212]},{index:.5,rgb:[68,131,200]},{index:.63,rgb:[114,156,197]},{index:.75,rgb:[157,181,203]},{index:.88,rgb:[200,208,216]},{index:1,
rgb:[241,237,236]}],"freesurface-red":[{index:0,rgb:[60,9,18]},{index:.13,rgb:[100,17,27]},{index:.25,rgb:[142,20,29]},{index:.38,rgb:[177,43,27]},{index:.5,rgb:[192,87,63]},{index:.63,rgb:[205,125,105]},{index:.75,rgb:[216,162,148]},{index:.88,rgb:[227,199,193]},{index:1,rgb:[241,237,236]}],oxygen:[{index:0,rgb:[64,5,5]},{index:.13,rgb:[106,6,15]},{index:.25,rgb:[144,26,7]},{index:.38,rgb:[168,64,3]},{index:.5,rgb:[188,100,4]},{index:.63,rgb:[206,136,11]},{index:.75,rgb:[220,174,25]},{index:.88,
rgb:[231,215,44]},{index:1,rgb:[248,254,105]}],par:[{index:0,rgb:[51,20,24]},{index:.13,rgb:[90,32,35]},{index:.25,rgb:[129,44,34]},{index:.38,rgb:[159,68,25]},{index:.5,rgb:[182,99,19]},{index:.63,rgb:[199,134,22]},{index:.75,rgb:[212,171,35]},{index:.88,rgb:[221,210,54]},{index:1,rgb:[225,253,75]}],phase:[{index:0,rgb:[145,105,18]},{index:.13,rgb:[184,71,38]},{index:.25,rgb:[186,58,115]},{index:.38,rgb:[160,71,185]},{index:.5,rgb:[110,97,218]},{index:.63,rgb:[50,123,164]},{index:.75,rgb:[31,131,
110]},{index:.88,rgb:[77,129,34]},{index:1,rgb:[145,105,18]}],salinity:[{index:0,rgb:[42,24,108]},{index:.13,rgb:[33,50,162]},{index:.25,rgb:[15,90,145]},{index:.38,rgb:[40,118,137]},{index:.5,rgb:[59,146,135]},{index:.63,rgb:[79,175,126]},{index:.75,rgb:[120,203,104]},{index:.88,rgb:[193,221,100]},{index:1,rgb:[253,239,154]}],temperature:[{index:0,rgb:[4,35,51]},{index:.13,rgb:[23,51,122]},{index:.25,rgb:[85,59,157]},{index:.38,rgb:[129,79,143]},{index:.5,rgb:[175,95,130]},{index:.63,rgb:[222,112,
101]},{index:.75,rgb:[249,146,66]},{index:.88,rgb:[249,196,65]},{index:1,rgb:[232,250,91]}],turbidity:[{index:0,rgb:[34,31,27]},{index:.13,rgb:[65,50,41]},{index:.25,rgb:[98,69,52]},{index:.38,rgb:[131,89,57]},{index:.5,rgb:[161,112,59]},{index:.63,rgb:[185,140,66]},{index:.75,rgb:[202,174,88]},{index:.88,rgb:[216,209,126]},{index:1,rgb:[233,246,171]}],"velocity-blue":[{index:0,rgb:[17,32,64]},{index:.13,rgb:[35,52,116]},{index:.25,rgb:[29,81,156]},{index:.38,rgb:[31,113,162]},{index:.5,rgb:[50,144,
169]},{index:.63,rgb:[87,173,176]},{index:.75,rgb:[149,196,189]},{index:.88,rgb:[203,221,211]},{index:1,rgb:[254,251,230]}],"velocity-green":[{index:0,rgb:[23,35,19]},{index:.13,rgb:[24,64,38]},{index:.25,rgb:[11,95,45]},{index:.38,rgb:[39,123,35]},{index:.5,rgb:[95,146,12]},{index:.63,rgb:[152,165,18]},{index:.75,rgb:[201,186,69]},{index:.88,rgb:[233,216,137]},{index:1,rgb:[255,253,205]}],cubehelix:[{index:0,rgb:[0,0,0]},{index:.07,rgb:[22,5,59]},{index:.13,rgb:[60,4,105]},{index:.2,rgb:[109,1,135]},
{index:.27,rgb:[161,0,147]},{index:.33,rgb:[210,2,142]},{index:.4,rgb:[251,11,123]},{index:.47,rgb:[255,29,97]},{index:.53,rgb:[255,54,69]},{index:.6,rgb:[255,85,46]},{index:.67,rgb:[255,120,34]},{index:.73,rgb:[255,157,37]},{index:.8,rgb:[241,191,57]},{index:.87,rgb:[224,220,93]},{index:.93,rgb:[218,241,142]},{index:1,rgb:[227,253,198]}]},Wk=function(c){function b(){var a=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};N(this,b);var c=P(this,(b.__proto__||Object.getPrototypeOf(b)).call(this));
c._type=b.TYPE();c._colormapDescription=null;c._LUT=[];c.setMetadata("flip",!1);var g=c._getOption(a,"style",null);g?c.setStyle(g):(g=c._getOption(a,"description",null),c.setDescription(g));c._colormapDescription&&(a=c._getOption(a,"lutSize",null))&&c.buildLut(a);return c}M(b,c);O(b,[{key:"setStyle",value:function(a){a in yd?this._validateDescription(yd[a])&&(this._colormapDescription=JSON.parse(JSON.stringify(yd[a]))):console.warn("The given colormap style des not exist.")}},{key:"setDescription",
value:function(a){(a="string"===typeof a?JSON.parse(a):a)&&this._validateDescription(a)&&(this._colormapDescription=a)}},{key:"_validateDescription",value:function(a){if(!Array.isArray(a))return console.warn("The colormap description has to be an Array"),!1;for(var b=0;b<a.length;b++)if(null!==a[b]&&"object"===H(a[b]))if("index"in a[b]&&"rgb"in a[b]){if("number"===typeof a[b].index){if(0>a[b].index||1<a[b].index)return console.warn("Each colormap segment 'index' property should be in [0, 1]"),!1}else return console.warn("Each colormap segment 'index' property should be a number."),
!1;if(Array.isArray(a[b].rgb))if(3==a[b].rgb.length)for(var c=0;c<a[b].rgb.length;c++){if(0>a[b].rgb[c]||255<a[b].rgb[c])return console.warn("The colormap must have only values in [0, 255]"),!1}else return console.warn("Each colormap segment 'rgb' should contain 3 values"),!1}else return console.warn("Each colormap segment must have a 'index' property and a 'rgb' property."),!1;else return console.warn("Each colormap segment must be a non-null object"),!1;return!0}},{key:"getValueAt",value:function(a){if(!this._colormapDescription)return console.warn("The colormap description is not defined."),
null;if(a<=this._colormapDescription[0].index)return this._colormapDescription[0].rgb.slice();if(a>=this._colormapDescription[this._colormapDescription.length-1].index)return this._colormapDescription[this._colormapDescription.length-1].rgb.slice();for(var b=0;b<this._colormapDescription.length-1;b++)if(a>=this._colormapDescription[b].index&&a<this._colormapDescription[b+1].index){a=(a-this._colormapDescription[b].index)/(this._colormapDescription[b+1].index-this._colormapDescription[b].index);var c=
1-a;return[Math.round(this._colormapDescription[b].rgb[0]*c+this._colormapDescription[b+1].rgb[0]*a),Math.round(this._colormapDescription[b].rgb[1]*c+this._colormapDescription[b+1].rgb[1]*a),Math.round(this._colormapDescription[b].rgb[2]*c+this._colormapDescription[b+1].rgb[2]*a)]}}},{key:"buildLut",value:function(a){if(!this._colormapDescription)return console.warn("The colormap description is not defined, the LUT cannot be created"),null;if(0>a)console.warn("Size of the colormap can not be negative.");
else{this._LUT=Array(a);for(var b=0;b<a;b++)this._LUT[b]=this.getValueAt(b/a+.5/a)}}},{key:"getLutAt",value:function(a){return 0>a||a>this._LUT.length?null:this._LUT[a]}},{key:"createHorizontalLutImage",value:function(){if(this._LUT){for(var a=this.getMetadata("flip"),b=this._LUT.length,c=new S({width:b,height:1,color:[0,0,0]}),e=0;e<b;e++)c.setPixel({x:e,y:0},this._LUT[a?b-e-1:e]);return c}console.warn("The LUT must be built before creating a LUT image.")}},{key:"createVerticalLutImage",value:function(){if(this._LUT){for(var a=
this.getMetadata("flip"),b=this._LUT.length,c=new S({width:1,height:b,color:[0,0,0]}),e=0;e<b;e++)c.setPixel({x:0,y:e},this._LUT[a?b-e-1:e]);return c}console.warn("The LUT must be built before creating a LUT image.")}},{key:"addColor",value:function(a,b){this._colormapDescription||(this._colormapDescription=[]);if(0>a||1<a)return console.warn("The color cannot be added because its index is out of range [0, 1]"),!1;if(this._colormapDescription.find(function(b){return b.index==a}))return console.warn("A color is already present at index "+
a),!1;if(b&&Array.isArray(b)&&3==b.length)for(var c=0;c<b.length;c++){if("number"!==typeof b[c]||0>b[c]||255<b[c])return console.warn("The rgb colors must be in [0, 255]"),!1}else return console.warn("The color cannot be added because its rgb array is the wrong size."),!1;this._colormapDescription.push({index:a,rgb:b.slice()});this._colormapDescription.sort(function(a,b){return a.index-b.index});return!0}},{key:"removeColor",value:function(a){if(!this._colormapDescription)return console.warn("The colormap description is empty."),
!1;var b=this._colormapDescription.findIndex(function(b){return b.index==a});if(-1==b)return console.warn("Such index does not exist."),!1;this._colormapDescription.splice(b,1);return!0}},{key:"toJson",value:function(){return JSON.stringify(this._colormapDescription)}}],[{key:"TYPE",value:function(){return"COLORMAP"}},{key:"getAvailableStyles",value:function(){return Object.keys(yd)}}]);return b}(pd),Xk=function(c){function b(){N(this,b);var a=P(this,(b.__proto__||Object.getPrototypeOf(b)).call(this));
a.addInputValidator(0,Hc);a.setMetadata("maxWidth",4096);a.setMetadata("maxHeight",4096);a.setMetadata("axis","xspace");a.setMetadata("time",0);return a}M(b,c);O(b,[{key:"_run",value:function(){function a(a,b,c,d){return e.getIntensity_xyzOrientation(c,a,b,d)}function b(a,b,c,d){return e.getIntensity_xyzOrientation(a,c,b,d)}function c(a,b,c,d){return e.getIntensity_xyzOrientation(a,b,c,d)}if(this.hasValidInput()){var e=this._getInput(0),f=e.getMetadata(this.getMetadata("axis"));if(f){var k=f.space_length,
l=f.width,f=f.height,m=0,n=1;if(e.hasMetadata("time")){var p=e.getMetadata("time").space_length;-1==this._metadata.time?(m=0,n=p):this._metadata.time<p&&(m=this._metadata.time,n=m+1)}var u=k*(n-m),p=Math.floor(this.getMetadata("maxWidth")/l),q=Math.floor(this.getMetadata("maxHeight")/f),t=p*l,y=q*f,q=p*q;1==Math.ceil(u/q)&&(y=Math.ceil(u/p)*f);this.setMetadata("gridWidth",t/l);this.setMetadata("gridHeight",y/f);var x=u=0,z=0,w=null,A=null;"xspace"===this._metadata.axis?A=a:"yspace"===this._metadata.axis?
A=b:"zspace"===this._metadata.axis&&(A=c);if(A)for(var B=Array(e.getMetadata("ncpp")).fill(0);m<n;m++)for(var C=0;C<k;C++){0==x%q&&(w=new S({width:t,height:y,color:B}),this._output[u]=w,z=0,u++);var H=z%p,K=Math.floor(z/p);z++;for(var H=H*l,K=K*f,M=0;M<f;M++)for(var L=0;L<l;L++){var N=[A(L,M,C,m)];w.setPixel({x:H+L,y:K+(f-M-1)},N)}x++}else console.warn("The axis to sample along for the mosaic was not properly set.")}else console.warn("Sampling axis for mosaicing was not poperly set. Has to be 'xspace', 'yspace' or 'zspace'.")}}}]);
return b}(V),Yk=function(c){function b(){N(this,b);var a=P(this,(b.__proto__||Object.getPrototypeOf(b)).call(this));a.addInputValidator(0,dc);a.setMetadata("maxWidth",4096);a.setMetadata("maxHeight",4096);a.setMetadata("axis","x");a.setMetadata("time",0);return a}M(b,c);O(b,[{key:"_run",value:function(){if(this.hasValidInput()){var a=this._getInput(0),b=this.getMetadata("axis"),c=a.getSliceSize(b),e=a.getNumberOfSlices(b),f=a.getTimeLength(),k;if(-1==this._metadata.time)k=0;else if(0<=this._metadata.time&&
this._metadata.time<f)k=this._metadata.time,f=k+1;else{console.warn("The required time sample is out of bound. Must be 0 <= t < "+f);return}var l=e*(f-k),m=Math.floor(this.getMetadata("maxWidth")/c.w),n=Math.floor(this.getMetadata("maxHeight")/c.h),p=m*c.w,u=n*c.h,n=m*n;1==Math.ceil(l/n)&&(u=Math.ceil(l/m)*c.h);this.setMetadata("gridWidth",p/c.w);this.setMetadata("gridHeight",u/c.h);var q=Array(a.getMetadata("ncpp")).fill(0),l=new Zh;l.setMetadata("time",!1);l.setMetadata("outputSize",{w:p,h:u});
l.setMetadata("outputColor",q);for(q=u=p=0;k<f;k++)for(var t=0;t<e;t++){0==u%n&&(l.setMetadata("resetOutput",!0),q=0);var y=q%m*c.w,x=Math.floor(q/m)*c.h,z=a.getSlice(b,t,k);l.addInput(z);l.setMetadata("patchPosition",{x:y,y:x});l.update();0==u%n&&(this._output[p]=l.getOutput(),p++);q++;u++}}else console.warn("A filter of type Image3DToMosaicFilterAlt requires 1 input of category '0' (Image3DAlt)")}}]);return b}(V);"use strict";Na=Array;p.CoreTypes=cb;p.PixpipeObject=pd;p.Filter=V;p.Signal1D=za;p.Image2D=
S;p.Image3D=Hc;p.ImageToImageFilter=ra;p.MniVolume=db;p.LineString=Ic;p.Image3DAlt=dc;p.Mesh3D=me;p.CanvasImageWriter=cj;p.UrlImageReader=dj;p.FileImageReader=ej;p.FileToArrayBufferReader=tj;p.UrlToArrayBufferReader=uj;p.BrowserDownloadBuffer=vj;p.Minc2Decoder=oh;p.NiftiDecoder=ph;p.NiftiDecoderAlt=rh;p.PixpEncoder=xj;p.PixpDecoder=qe;p.Image3DGenericDecoder=yj;p.Image3DGenericDecoderAlt=zj;p.TiffDecoder=Dh;p.MghDecoder=sh;p.MghDecoderAlt=uh;p.EegModDecoder=Mj;p.PixBinEncoder=ck;p.PixBinDecoder=dk;
p.JpegDecoder=Oh;p.PngDecoder=Ph;p.Image2DGenericDecoder=ik;p.Minc2DecoderAlt=th;p.MniObjDecoder=lk;p.EdfDecoder=pk;p.ComponentProjectionImage2DFilter=qk;p.ComponentMergeImage2DFilter=rk;p.ForwardFourierSignalFilter=Vh;p.InverseFourierSignalFilter=tk;p.ForwardFourierImageFilter=uk;p.InverseFourierImageFilter=vk;p.ForEachPixelImageFilter=wk;p.SpectralScaleImageFilter=xk;p.ImageBlendExpressionFilter=zk;p.SpatialConvolutionFilter=Ak;p.MultiplyImageFilter=Bk;p.SimpleThresholdFilter=Ck;p.ImageDerivativeFilter=
Dk;p.GradientImageFilter=Ek;p.NormalizeImageFilter=Fk;p.ContourImage2DFilter=Ce;p.FloodFillImageFilter=Xh;p.ContourHolesImage2DFilter=Gk;p.ForEachPixelReadOnlyFilter=Hk;p.TerrainRgbToElevationImageFilter=Ik;p.NearestNeighborSparseInterpolationImageFilter=Jk;p.IDWSparseInterpolationImageFilter=Kk;p.TriangulationSparseInterpolationImageFilter=Lk;p.CropImageFilter=Mk;p.SimplifyLineStringFilter=Ok;p.PatchImageFilter=Zh;p.DifferenceEquationSignal1D=Rk;p.LowPassFreqSignal1D=bi;p.LowPassSignal1D=ci;p.HighPassSignal1D=
Sk;p.BandPassSignal1D=Tk;p.AngleToHueWheelHelper=Uk;p.LineStringPrinterOnImage2DHelper=Vk;p.Colormap=Wk;p.Image3DToMosaicFilter=Xk;p.Image3DToMosaicFilterAlt=Yk;p.Image3DMetadataConverter=Mc;p.MatrixTricks=Nb;p.FunctionGenerator=$h;Object.defineProperty(p,"__esModule",{value:!0})});
